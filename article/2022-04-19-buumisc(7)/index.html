<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>buumisc(7) | Valen的博客</title><meta name="keywords" content="ctf,misc,刷题"><meta name="author" content="Valen"><meta name="copyright" content="Valen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="buu刷题目记录(第7页)">
<meta property="og:type" content="article">
<meta property="og:title" content="buumisc(7)">
<meta property="og:url" content="https://0314valen.github.io/article/2022-04-19-buumisc(7)/index.html">
<meta property="og:site_name" content="Valen的博客">
<meta property="og:description" content="buu刷题目记录(第7页)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://api.btstu.cn/sjbz/">
<meta property="article:published_time" content="2022-04-18T16:00:00.000Z">
<meta property="article:modified_time" content="2023-02-08T03:05:34.942Z">
<meta property="article:author" content="Valen">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="misc">
<meta property="article:tag" content="刷题">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://api.btstu.cn/sjbz/"><link rel="shortcut icon" href="/image/UI_images/favicon.png"><link rel="canonical" href="https://0314valen.github.io/article/2022-04-19-buumisc(7)/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'buumisc(7)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-08 11:05:34'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/image/UI_images/avatar.jpg" onerror="onerror=null;src='/image/UI_images/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/CyberChef/"><i class="fa-fw fas fa-music"></i><span> CyberChef</span></a></li><li><a class="site-page child" href="/Linux-command/"><i class="fa-fw fas fa-video"></i><span> Linux命令大全</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('http://api.btstu.cn/sjbz/')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Valen的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/CyberChef/"><i class="fa-fw fas fa-music"></i><span> CyberChef</span></a></li><li><a class="site-page child" href="/Linux-command/"><i class="fa-fw fas fa-video"></i><span> Linux命令大全</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">buumisc(7)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-18T16:00:00.000Z" title="发表于 2022-04-19 00:00:00">2022-04-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-08T03:05:34.942Z" title="更新于 2023-02-08 11:05:34">2023-02-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/%E5%88%B7%E9%A2%98/">刷题</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>21分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="buumisc(7)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>buu刷题目记录(第7页)</p>
<span id="more"></span>

<h1 id="buumisc-7"><a href="#buumisc-7" class="headerlink" title="buumisc(7)"></a>buumisc(7)</h1><p>buu第七页，取证什么的后面在一块学习一下，目前暂时跳过了</p>
<p><img src="../../image/media/2022/ctf/buu/7/0.png"></p>
<h2 id="羊城杯-2020-TCP-IP"><a href="#羊城杯-2020-TCP-IP" class="headerlink" title="[羊城杯 2020]TCP_IP"></a>[羊城杯 2020]TCP_IP</h2><p>得到一个流量包，但是发现每个IP信息都不一样，然后挨个提取出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r attachment.pcap -Y &quot;tcp&quot; -T fields -e ip.id &gt;out.txt</span><br></pre></td></tr></table></figure>

<p>然后转换成ascii字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = open(r&#x27;out.txt&#x27;)</span><br><span class="line">for i in f.readlines():</span><br><span class="line">    print(chr(int(i[-3:-1], 16)),end=&#x27;&#x27;)</span><br><span class="line">#@iH&lt;,&#123;*;oUp/im&quot;QPl`yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,&#123;*;oUp/im&quot;QPl`yR</span><br></pre></td></tr></table></figure>

<p>通过base91解密，但是发现存在干扰导致异常，然后每次使用依次拼接的方式得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import base91</span><br><span class="line">strs = &#x27;@iH&lt;,&#123;*;oUp/im&quot;QPl`yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P@iH&lt;,&#123;*;oUp/im&quot;QPl`yRPS&#x27;</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">for str in strs:</span><br><span class="line">    flag += str</span><br><span class="line">    try:</span><br><span class="line">        c = base91.decode(v).decode() #解密</span><br><span class="line">        print(c)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">#@iH&lt;,&#123;*;oUp/im&quot;QPl`yR*ie&#125;NK;.D!Xu)b:J[Rj+6KKM7P</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;wMt84iS06mCbbfuOfuVXCZ8MSsAFN1GA&#125;</span><br></pre></td></tr></table></figure>

<h2 id="羊城杯-2020-image-rar"><a href="#羊城杯-2020-image-rar" class="headerlink" title="[羊城杯 2020]image_rar"></a>[羊城杯 2020]image_rar</h2><p>得到一个MP4文件，经过binwalk+foremost可以确认是一个zip文件，里面有大量图片，修改后缀名得到hint</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">压缩包密码（6位）：GWxxxx	后面可能会用到的哦</span><br></pre></td></tr></table></figure>

<p>可以发现压缩包密码并不是指当前压缩包，直接解压得到一堆图片，发现65.jpg存在异常</p>
<p><img src="../../image/media/2022/ctf/buu/7/1.png"></p>
<p>查看65.jpg文件头，可以看到当前文件头是61726121跟52617221(rar)很相似，改成rar文件头和rar后缀名，打开需要密码</p>
<p>可以结合之前的hint和file 65.rar得到的结果，在kali下用工具rar2john 65.rar得到hash结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">65.rar:$rar5$16$a2dce3925af59efb2df9851dbfc24fb1$15$bb005ea8f91bf0356c8dddcfa41ac4cb$8$62293dc5e26e9e7f</span><br></pre></td></tr></table></figure>

<p>然后用hashcat.exe（<a target="_blank" rel="noopener" href="https://hashcat.net/files/hashcat-6.1.1.7z%EF%BC%89">https://hashcat.net/files/hashcat-6.1.1.7z）</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\hashcat.exe -m 13000 -a 3 $rar5$16$a2dce3925af59efb2df9851dbfc24fb1$15$bb005ea8f91bf0356c8dddcfa41ac4cb$8$62293dc5e26e9e7f GW?a?a?a?a</span><br></pre></td></tr></table></figure>

<p>爆破得到密码GW5!3#，解压得到一个没有后缀名的文件，010打开是png文件头，修改后缀名后得到flag</p>
<p><img src="../../image/media/2022/ctf/buu/7/2.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;R3fresh_1s_so_Cool&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CFI-CTF-2018-Kadyrov’s-Cat"><a href="#CFI-CTF-2018-Kadyrov’s-Cat" class="headerlink" title="[CFI-CTF 2018]Kadyrov’s Cat"></a>[CFI-CTF 2018]Kadyrov’s Cat</h2><p>得到一个图片和pdf，查看图片属性得到一个经纬度坐标用<a target="_blank" rel="noopener" href="https://minigps.net/fc.html">https://minigps.net/fc.html</a></p>
<p><img src="../../image/media/2022/ctf/buu/7/3.png"></p>
<p>定位到city是Riga。</p>
<p><img src="../../image/media/2022/ctf/buu/7/4.png"></p>
<p>然后用npp++找到作者信息Kotik Kadyrov</p>
<p><img src="../../image/media/2022/ctf/buu/7/5.png"></p>
<p>然后结合原题Flag format is : CFI{Firstname_Lastname_of_City}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CFI&#123;Kotik_Kadyrov_of_Riga&#125;</span><br></pre></td></tr></table></figure>

<h2 id="CTF2019-babyflash"><a href="#CTF2019-babyflash" class="headerlink" title="[*CTF2019]babyflash"></a>[*CTF2019]babyflash</h2><p>得到swf文件，用工具<a target="_blank" rel="noopener" href="https://github.com/jindrapetrik/jpexs-decompiler/releases%E6%89%93%E5%BC%80%E5%BE%97%E5%88%B0%E4%B8%80%E4%B8%AA%E9%9F%B3%E9%A2%91%E5%92%8C%E4%B8%80%E5%A0%86%E5%9B%BE%E7%89%87">https://github.com/jindrapetrik/jpexs-decompiler/releases打开得到一个音频和一堆图片</a></p>
<p>用Audacity查看音频文件得到&amp;_the_rest}</p>
<p><img src="../../image/media/2022/ctf/buu/7/6.png"></p>
<p>图片数量是441正好能够分成21*21所以猜测是21×21的二维码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import cv2</span><br><span class="line">from PIL import Image</span><br><span class="line">flag=&#x27;&#x27;</span><br><span class="line">path = r&#x27;C:\Users\30261\new\python\demo\ctf_tools\misc\qr\check\/image/media/2022/ctf/buu/6/\&#x27;</span><br><span class="line">hei = cv2.imread(r&#x27;C:\Users\30261\new\python\demo\ctf_tools\misc\qr\check\/image/media/2022/ctf/buu/6/26.png&#x27;)</span><br><span class="line">bai = cv2.imread(r&#x27;C:\Users\30261\new\python\demo\ctf_tools\misc\qr\check\/image/media/2022/ctf/buu/6/42.png&#x27;)</span><br><span class="line"></span><br><span class="line">for roots, dirs, files in os.walk(path):</span><br><span class="line">    files.sort(key=lambda x:int(x.split(&#x27;.&#x27;)[0]))#排序</span><br><span class="line">    print(files)</span><br><span class="line">    for file in files:</span><br><span class="line">        img_path = path + file</span><br><span class="line">        print(img_path)</span><br><span class="line">        img = cv2.imread(img_path)</span><br><span class="line">        if bai.all()== img.all():</span><br><span class="line">            flag+=&#x27;1&#x27;</span><br><span class="line">        else:</span><br><span class="line">            flag += &#x27;0&#x27;</span><br><span class="line">#111111100110001111111100000100111001000001101110101011001011101101110100100101011101101110100101101011101100000100110001000001111111101010101111111000000001010100000000111011111011111000100110110011011101111011101101111001101111011010010001100000000011111010100000100011000000000001011100110011111111101011100110101100000101101000100010101110101011011000001101110100101101110000101110101101110110001100000101011100010010111111101101100001011</span><br><span class="line"></span><br><span class="line">width=height=21</span><br><span class="line">i=0</span><br><span class="line">new_img = Image.new(&quot;RGB&quot;,(width,height))</span><br><span class="line">for w in range(width):</span><br><span class="line">    for h in range(height):</span><br><span class="line">        if flag[i]==&#x27;0&#x27;:</span><br><span class="line">            new_img.putpixel([w,h],(0,0,0))</span><br><span class="line">        else:</span><br><span class="line">            new_img.putpixel([w, h], (255, 255, 255))</span><br><span class="line">        i=i+1</span><br><span class="line">new_img.show(&#x27;1.png&#x27;)</span><br></pre></td></tr></table></figure>

<p>然后得到二维码，识别得到*ctf{half_flag_&amp;</p>
<p><img src="../../image/media/2022/ctf/buu/7/7.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*ctf&#123;half_flag_&amp;&amp;_the_rest&#125;</span><br><span class="line">flag&#123;halfflag&amp;&amp;_the_rest&#125;#buu录错flag</span><br></pre></td></tr></table></figure>

<h2 id="羊城杯-2020-逃离东南亚"><a href="#羊城杯-2020-逃离东南亚" class="headerlink" title="[羊城杯 2020]逃离东南亚"></a>[羊城杯 2020]逃离东南亚</h2><p>得到三个压缩包，其中日记1需要修改图片的crc得到下面一个密码：wdnmd，猜测是日记二密码</p>
<p><img src="../../image/media/2022/ctf/buu/7/8.png"></p>
<p>使用silenteye分析wav文件得到日记3密码：This1sThe3rdZIPpwd</p>
<p><img src="../../image/media/2022/ctf/buu/7/9.png"></p>
<p>md写了不能明文交流，联想到tab和空格，但是几千个文件，挨个查看不现实，因此考虑写个脚本搜索，由于tab和空格编写的隐藏数据通常是连续的，同时要过滤到常见的双空格和双/t，因此考虑用 \t \t作为搜索字符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">def get_file_list(dir_path):</span><br><span class="line">    _file_list = os.listdir(dir_path)</span><br><span class="line">    file_list = []</span><br><span class="line">    for file_str in _file_list:</span><br><span class="line">        new_dir_path = dir_path+&#x27;\\&#x27;+file_str</span><br><span class="line">        if os.path.isdir(new_dir_path):</span><br><span class="line">            file_list.extend(get_file_list(new_dir_path))</span><br><span class="line">        else:</span><br><span class="line">            file_list.append(new_dir_path)</span><br><span class="line">    return file_list</span><br><span class="line">file_list = get_file_list(r&#x27;.\source_code&#x27;)</span><br><span class="line">for file_str in file_list:</span><br><span class="line">    f = open(file_str, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;)</span><br><span class="line">    try:</span><br><span class="line">        data = f.read()</span><br><span class="line">        if &#x27; \t \t&#x27; in data:</span><br><span class="line">            print(file_str)</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br></pre></td></tr></table></figure>

<p>然后转换一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">f_list = r&#x27;&#x27;&#x27;source_code\elf\rtld.c</span><br><span class="line">source_code\malloc\arena.c</span><br><span class="line">source_code\malloc\malloc.c&#x27;&#x27;&#x27;</span><br><span class="line">f_list = f_list.split(&#x27;\n&#x27;)</span><br><span class="line">result = &#x27;&#x27;</span><br><span class="line">for f in f_list:</span><br><span class="line">    for data in open(f, &#x27;r&#x27;).readlines():</span><br><span class="line">        data = data[:-1]</span><br><span class="line">        if &#x27;&#125;&#x27; in data:</span><br><span class="line">            data = data.split(&#x27;&#125;&#x27;)[-1]</span><br><span class="line">            if &#x27;\t&#x27; in data:</span><br><span class="line">                data1 = data[::].replace(&#x27;\t&#x27;, &#x27;&#x27;)</span><br><span class="line">                data1 = data1.replace(&#x27; &#x27;, &#x27;&#x27;)</span><br><span class="line">                if not data1:</span><br><span class="line">                    print([data])</span><br><span class="line">                    result += data</span><br><span class="line">result = result.replace(&#x27;\t&#x27;, &#x27;1&#x27;)</span><br><span class="line">result = result.replace(&#x27; &#x27;, &#x27;0&#x27;)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p>得到结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">01010011010011110101001100100001001000000111000001101100011001010110000101110011011001010010000001101000011001010110110001110000001000000110110101100101001000000010110100111110001000000111001001110100011011000110010000101110011000110111100101101111011101010111001000100000011001100110110001100001011001110010000001101001011100110010000001101001011011100010000001101101011000010110110001101100011011110110001100101110011000110100011101010111010000110101010001000110011110110110001101101111011001000110010101011111011100110111010001100101011001110110000101101110011011110110011101110010011000010111000001101000011110010101111100110001011100110101111101100110011101010110111001101110011110010010000101111101</span><br></pre></td></tr></table></figure>

<p>然后二进制转字符</p>
<p><img src="../../image/media/2022/ctf/buu/7/10.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWCTF&#123;code_steganography_1s_funny!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="INSHack2019-Crunchy"><a href="#INSHack2019-Crunchy" class="headerlink" title="[INSHack2019]Crunchy"></a>[INSHack2019]Crunchy</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% raw %&#125;</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crunchy</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>: <span class="keyword">return</span> n</span><br><span class="line">    <span class="keyword">return</span> <span class="number">6</span> * crunchy(n - <span class="number">1</span>) + crunchy(n - <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">g = <span class="number">17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751568</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Your flag is: INSA&#123;%d&#125;&quot;</span>%(crunchy(g)%<span class="number">100000007</span>))</span><br><span class="line">&#123;% endraw %&#125;</span><br></pre></td></tr></table></figure>

<p>但是直接运行失败，然后报错超过最大递归限度，需要修改一下本质是对斐波那契数的取模，利用皮萨诺周期即可解，可参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/caozhk/article/details/53407845">https://blog.csdn.net/caozhk/article/details/53407845</a> </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">n = 17665922529512695488143524113273224470194093921285273353477875204196603230641896039854934719468650093602325707751568</span><br><span class="line">m = 100000007</span><br><span class="line">def getSequencePeriod(m):</span><br><span class="line">    s = []</span><br><span class="line">    s.append(0)</span><br><span class="line">    s.append(1)</span><br><span class="line">    for i in range(2, m*6):</span><br><span class="line">        s.append((6 * s[i-1] + s[i-2]) % m)</span><br><span class="line">        if (s[i] == 1 and s[i-1] == 0):</span><br><span class="line">            break</span><br><span class="line">    return s</span><br><span class="line">def getFibonacciRest(n, m):</span><br><span class="line">    s = getSequencePeriod(m)</span><br><span class="line">    period = len(s) - 2</span><br><span class="line">    val = n % period</span><br><span class="line">    return(s[val])</span><br><span class="line">print(getFibonacciRest(n,m))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;41322239&#125; </span><br></pre></td></tr></table></figure>

<h2 id="GWCTF2019-math"><a href="#GWCTF2019-math" class="headerlink" title="[GWCTF2019]math"></a>[GWCTF2019]math</h2><p>远程连上去可以看到，是一个计算公式，需要答对150题目，并且有很少的时间</p>
<p><img src="../../image/media/2022/ctf/buu/7/11.png"></p>
<p>直接写个EXP自动答题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">content = 1</span><br><span class="line">def main():</span><br><span class="line">    sh = remote(&quot;node4.buuoj.cn&quot;, 25432)</span><br><span class="line">    for i in range(150):</span><br><span class="line">        print(i)</span><br><span class="line">        res =sh.recvuntil(&#x27;Math problem: &#x27;)</span><br><span class="line">        res = sh.recvuntil(&#x27; =&#x27;)</span><br><span class="line">        print(res)</span><br><span class="line">        # print((res.decode(encoding=&#x27;UTF-8&#x27;)))#转换一下编码格式</span><br><span class="line">        num=eval(res.decode(encoding=&#x27;UTF-8&#x27;)[:-1])</span><br><span class="line">        print(num)</span><br><span class="line">        sh.sendline(str(num))</span><br><span class="line">    sh.interactive()</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3e0966bd-64fc-41da-a75f-ebd651663184&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BSidesSF2019-bWF0cnlvc2hrYQ"><a href="#BSidesSF2019-bWF0cnlvc2hrYQ" class="headerlink" title="[BSidesSF2019]bWF0cnlvc2hrYQ=="></a>[BSidesSF2019]bWF0cnlvc2hrYQ==</h2><p>用010打开附件能够看到Face的内容是，下面的内容通过base64解码得到二维码识别为：h4ck_the_plan3t</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iVBORw0KGgoAAAANSUhEUgAAADAAAAAwAQMAAABtzGvEAAAABlBMVEX///8AAABVwtN+AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4wMBBAIZ8ky8pwAAAJRJREFUGFdlzbEJwzAQBdAzB04TkhE0gzqrkVYRZIEMIHAgawiyyqWJS69g8AhqXIT8FPERI1evfAQ0GaAV4ZCFK4bS5HH+49OWNu4Q7pKwArjf4DJARG0kUlAWY3PFcsUcoLjyMhSV5ShsJ8XhMHuuIAr3z0UBfP/MijD1FspQOiNmh6cTbUjNTRF2j/NUAfg4vle+pY6V5XCWRiUAAAAASUVORK5CYII=</span><br></pre></td></tr></table></figure>

<p>可以看到有几个文件私钥文件Matry_Oshka.key和加密文件hack.pgp，但是通过base64加密了，可以用下面这个软件解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># #base64写成文件</span><br><span class="line">import  base64</span><br><span class="line">with open(&quot;secret.txt&quot;, &quot;r&quot;) as f:</span><br><span class="line">    imgdata = base64.b64decode(f.read())</span><br><span class="line">    #imgdata = str(f.read())</span><br><span class="line">    file = open(&#x27;zip.key&#x27;, &#x27;wb&#x27;)</span><br><span class="line">    file.write(imgdata)</span><br><span class="line">    file.close()</span><br></pre></td></tr></table></figure>

<p>PGPTool来解密，PGPTool: <a target="_blank" rel="noopener" href="https://pgptool.github.io/">https://pgptool.github.io/</a></p>
<p>首先导入Key ring-&gt;Import PGP Key-&gt;导入Matry_Oshka.key</p>
<p><img src="../../image/media/2022/ctf/buu/7/12.png"></p>
<p>导入之后选择import即可看到弹窗看到具体信息，然后选择Decrypt file中选择hack.pgp</p>
<p><img src="../../image/media/2022/ctf/buu/7/13.png"></p>
<p>这里需要输入前面得到的密码：h4ck_the_plan3t得到一个zip，并且需要找到路径</p>
<p><img src="../../image/media/2022/ctf/buu/7/14.png"></p>
<p>打开zip，里面是一个file.bin文件没有加密直接解压，得到一个用foremost识别的结果是lzip，然后删除文件头LZIP前面的内容另存为</p>
<p>然后用lzip -d file.bin解压得到file.bin.out，file一下是一个pdf文件，然后得到一个png图片</p>
<p><a target="_blank" rel="noopener" href="https://upload.wikimedia.org/wikipedia/en/2/27/Bliss_%28Windows_XP%29.png%E5%8E%9F%E5%9B%BE%E8%BF%9B%E8%A1%8Csub%E6%93%8D%E4%BD%9C%E5%BE%97%E5%88%B0%E4%B8%80%E4%B8%AA%E4%BA%8C%E7%BB%B4%E7%A0%81">https://upload.wikimedia.org/wikipedia/en/2/27/Bliss_%28Windows_XP%29.png原图进行sub操作得到一个二维码</a></p>
<p><img src="../../image/media/2022/ctf/buu/7/15.png"></p>
<p>识别得到，看起来是base64但是通过有一个减号，改成+号，然后解密得到一个7z压缩包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/Td6WFoAAATm1rRGAgAhARwAAAAQz1jM4ELCAORdABhgwwZfNTLh1bKR4pwkkcJw0DSEZd2BcWATAJkrMgnKT8nBgYQaCPtrzORiOeUVq7DDoe9feCLt9PG-MT9ZCLwmtpdfvW0n17pie8v0h7RS4dO/yb7JHn7sFqYYnDWZere/6BI3AiyraCtQ6qZmYZnHemfLVXmCXHan5fN6IiJL7uJdoJBZC3Rb1hiH1MdlFQ/1uOwaoglBdswAGo99HbOhsSFS5gGqo6WQ2dzK3E7NcYP2YIQxS9BGibr4Qulc6e5CaCHAZ4pAhfLVTYoN5R7l/cWvU3mLOSPUkELK6StPUBd0AABBU17Cf970JQABgALDhQEApzo4PbHEZ/sCAAAAAARZWg==</span><br></pre></td></tr></table></figure>

<p><img src="../../image/media/2022/ctf/buu/7/16.png"></p>
<p>然后用前面那个脚本转换一下得到7z压缩包，然后得到大量01组成的文件，CyberChef</p>
<p><img src="../../image/media/2022/ctf/buu/7/17.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;delat_iz_muhi_slona&#125;</span><br></pre></td></tr></table></figure>

<h2 id="INSHack2018-GCorp-Stage-1"><a href="#INSHack2018-GCorp-Stage-1" class="headerlink" title="[INSHack2018]GCorp - Stage 1"></a>[INSHack2018]GCorp - Stage 1</h2><p>得到一个流量包，追踪TCP流在最后得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SU5TQXtjMTgwN2EwYjZkNzcxMzI3NGQ3YmYzYzY0Nzc1NjJhYzQ3NTcwZTQ1MmY3N2I3ZDIwMmI4MWUxNDkxNzJkNmE3fQ==</span><br></pre></td></tr></table></figure>

<p>经过base64解密得flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSA&#123;c1807a0b6d7713274d7bf3c6477562ac47570e452f77b7d202b81e149172d6a7&#125;</span><br></pre></td></tr></table></figure>

<h2 id="b01lers2020-minecraft-purdue"><a href="#b01lers2020-minecraft-purdue" class="headerlink" title="[b01lers2020]minecraft_purdue"></a>[b01lers2020]minecraft_purdue</h2><p>玩游戏找flag，<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av843171515/%E5%8F%82%E8%80%83%E5%A4%A7%E4%BD%AC%E7%9A%84WP">https://www.bilibili.com/video/av843171515/参考大佬的WP</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;M1NE&#125;</span><br></pre></td></tr></table></figure>

<h2 id="NPUCTF2020-HappyCheckInVerification"><a href="#NPUCTF2020-HappyCheckInVerification" class="headerlink" title="[NPUCTF2020]HappyCheckInVerification"></a>[NPUCTF2020]HappyCheckInVerification</h2><p>得到一个破损的二维码跟mp4视频，通过手动的方式修复二维码</p>
<p><img src="../../image/media/2022/ctf/buu/7/18.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;this_is_not_flag&#125;</span><br><span class="line">三曳所諳陀怯耶南夜缽得醯怯勝數不知喝盧瑟侄盡遠故隸怯薩不娑羯涅冥伊盧耶諳提度奢道盧冥以朋罰所即栗諳蒙集皤夷夜集諳利顛呐寫無怯依奢竟#￥#%E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333||254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435...sadwq#asdsadasf faf$use$dasdasdafafa_$ba##se64$</span><br></pre></td></tr></table></figure>

<p>得到假的flag，中间汉字用与佛论禅解密得到：说了这不是佛拉格，你还来转？给爷爪巴</p>
<p><img src="../../image/media/2022/ctf/buu/7/19.png"></p>
<p><code>然后通过||分隔符得到base16解密内容</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E68BBFE4BD9BE68B89E6A0BCE79A84E5A7BFE58ABFE59CA8E69C80E5908E32333333</span><br><span class="line">拿佛拉格的姿势在最后2333</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">254333254242254338254342254231254338254345254432254238254643254236254145254239254441254437254234254232254131254236254245253244253244254343254438254330254341254336254435</span><br><span class="line">%C3%BB%C8%CB%B1%C8%CE%D2%B8%FC%B6%AE%B9%DA%D7%B4%B2%A1%B6%BE%2D%2D%CC%D8%C0%CA%C6%D5</span><br><span class="line">需要选择gb2312的格式：没人比我更懂冠状病毒--特朗普</span><br></pre></td></tr></table></figure>

<p>还有后面一部分的use base64，看大哥们的WP得到一个SSTV，<a href="../../image/media/2022/ctf/buu/7/%E9%AB%98%E6%B8%85%E9%87%8D%E7%BD%AE.m4a">SSTV.mp3</a>手机上用Robot36识别出来一张图，得到flag</p>
<p><img src="../../image/media/2022/ctf/buu/7/20.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;miSc_ChecK_In_Ver16ied&#125;</span><br></pre></td></tr></table></figure>

<h2 id="UTCTF2020-dns-shell"><a href="#UTCTF2020-dns-shell" class="headerlink" title="[UTCTF2020]dns-shell"></a>[UTCTF2020]dns-shell</h2><p>根据题目名称，找到流量包中的dns流量进去查看到有base64加密的东西</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bHMgLWxhCg==</span><br><span class="line">dG90YWwgMjUxMgpkcnd4ci14ci14ICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAgICA0MDk2IE1hciAgNiAwNDo0NCAuCmRyd3hyLXhyLXggICAgMSByb290ICAgICByb290ICAgICAgICAgIDQwOTYgTWFyICA2IDA4OjA5IC4uCi1ydy1yLS1yLS0gICAgMSByb290ICAgICByb290ICAgICAgICAgMTIyODggTWFyICA2IDA0OjQyIC5NYWtlZmlsZS5zd3AKLXJ3LXItLXItLSAgICAxIHJvb3QgICAgIHJvb3QgICAgICAgICAgIDEwNCBNYXIgIDUgMjM6NTAgRG9ja2VyZmlsZQotcnctci0tci0tICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAgICAgMTE5IE1hciAgNSAyMzo1MCBNYWtlZmlsZQotcnctci0tci0tICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAgICAgIDI4IE1hciAgNSAyMzo1MCBmbGFnLnR4dAotcnd4ci14ci14ICAgIDEgcm9vdCAgICAgcm9vdCAgICAgICAyNTMzODIzIE1hciAgNiAwNDo0NCBzZXJ2ZXIKLXJ3LXItLXItLSAgICAxIHJvb3QgICAgIHJvb3QgICAgICAgICAgMTY5MyBNYXIgIDUgMjM6NTAgc2VydmVyLmdv</span><br></pre></td></tr></table></figure>

<p>解密之后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br><span class="line"></span><br><span class="line">total 2512</span><br><span class="line">drwxr-xr-x    1 root     root          4096 Mar  6 04:44 .</span><br><span class="line">drwxr-xr-x    1 root     root          4096 Mar  6 08:09 ..</span><br><span class="line">-rw-r--r--    1 root     root         12288 Mar  6 04:42 .Makefile.swp</span><br><span class="line">-rw-r--r--    1 root     root           104 Mar  5 23:50 Dockerfile</span><br><span class="line">-rw-r--r--    1 root     root           119 Mar  5 23:50 Makefile</span><br><span class="line">-rw-r--r--    1 root     root            28 Mar  5 23:50 flag.txt</span><br><span class="line">-rwxr-xr-x    1 root     root       2533823 Mar  6 04:44 server</span><br><span class="line">-rw-r--r--    1 root     root          1693 Mar  5 23:50 server.go</span><br></pre></td></tr></table></figure>

<p>然后看WP才知道环境关了<a target="_blank" rel="noopener" href="https://meowmeowxw.gitlab.io/ctf/utctf-2020-do-not-stop/">https://meowmeowxw.gitlab.io/ctf/utctf-2020-do-not-stop/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ dig -t TXT -q dns.google.com @35.225.16.21</span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.0 &lt;&lt;&gt;&gt; -t TXT -q dns.google.com @35.225.16.21</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 47829</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;dns.google.com.			IN	TXT</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">dns.google.com.		4919	IN	A	3.88.57.227</span><br><span class="line"></span><br><span class="line">;; Query time: 186 msec</span><br><span class="line">;; SERVER: 35.225.16.21#53(35.225.16.21)</span><br><span class="line">;; WHEN: Mon Mar 09 17:52:17 CET 2020</span><br><span class="line">;; MSG SIZE  rcvd: 48</span><br></pre></td></tr></table></figure>

<p>我们得到了一个新地址：3.88.57.227，让我们尝试使用dig新地址：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ dig -t TXT -q $(echo &quot;cat flag.txt&quot; | base64) @3.88.57.227</span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.0 &lt;&lt;&gt;&gt; -t TXT -q Y2F0IGZsYWcudHh0Cg== @3.88.57.227</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 56905</span><br><span class="line">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span><br><span class="line"></span><br><span class="line">;; QUESTION SECTION:</span><br><span class="line">;Y2F0IGZsYWcudHh0Cg==.		IN	TXT</span><br><span class="line"></span><br><span class="line">;; ANSWER SECTION:</span><br><span class="line">Y2F0IGZsYWcudHh0Cg==.	4919	IN	TXT	&quot;dXRmbGFneyRhbDF5X3MzTDFTX3NFNF9kTiR9&quot;</span><br><span class="line"></span><br><span class="line">;; Query time: 196 msec</span><br><span class="line">;; SERVER: 3.88.57.227#53(3.88.57.227)</span><br><span class="line">;; WHEN: Mon Mar 09 17:53:55 CET 2020</span><br><span class="line">;; MSG SIZE  rcvd: 87</span><br></pre></td></tr></table></figure>

<p>附上大哥的脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"></span><br><span class="line">from scapy.all import *</span><br><span class="line">import base64</span><br><span class="line">packets = rdpcap(&quot;./capture.pcap&quot;)</span><br><span class="line">dns_google = packets[20]</span><br><span class="line">dns_query = packets[42]</span><br><span class="line"></span><br><span class="line">sender = IP()/UDP()/DNS()</span><br><span class="line">sender[DNS] = dns_google[DNS]</span><br><span class="line">sender[IP].dst = dns_google[IP].dst</span><br><span class="line">rec = sr1(sender)</span><br><span class="line">dns_server = rec[DNS].an.rdata</span><br><span class="line"></span><br><span class="line">sender = IP(dst=dns_server)/UDP()/DNS()</span><br><span class="line">sender[DNS] = dns_query[DNS]</span><br><span class="line">sender[DNS].qd.qname = base64.b64encode(b&#x27;cat flag.txt&#x27;).decode()</span><br><span class="line">rec = sr1(sender)</span><br><span class="line">flag = rec[DNS].an.rdata</span><br><span class="line">print(base64.b64decode(flag[0]))</span><br></pre></td></tr></table></figure>

<p>得到的dXRmbGFneyRhbDF5X3MzTDFTX3NFNF9kTiR9用base64解密得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utflag&#123;$al1y_s3L1S_sE4_dN$&#125;</span><br></pre></td></tr></table></figure>

<h2 id="RoarCTF2019-davinci-cipher"><a href="#RoarCTF2019-davinci-cipher" class="headerlink" title="[RoarCTF2019]davinci_cipher"></a>[RoarCTF2019]davinci_cipher</h2><p>得到一个流量包和flag.txt类容发现规律，U+1F643这种样子是表情</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U+1F643U+1F4B5U+1F33FU+1F3A4U+1F6AAU+1F30FU+1F40EU+1F94BU+1F6ABU+1F606U+1F383U+1F993U+2709U+1F33FU+1F4C2U+2603U+1F449U+1F6E9U+2705U+1F385U+2328U+1F30FU+1F6E9U+1F6A8U+1F923U+1F4A7U+1F383U+1F34DU+1F601U+2139U+1F4C2U+1F6ABU+1F463U+1F600U+1F463U+1F643U+1F3A4U+2328U+1F601U+1F923U+1F3A4U+1F579U+1F451U+1F6AAU+1F374U+1F579U+1F607U+1F374U+1F40EU+2705U+2709U+1F30FU+23E9U+1F40DU+1F6A8U+2600U+1F607U+1F3F9U+1F441U+1F463U+2709U+1F30AU+1F6A8U+2716</span><br></pre></td></tr></table></figure>

<p><img src="../../image/media/2022/ctf/buu/7/21.png"></p>
<p>用网站<a target="_blank" rel="noopener" href="https://r12a.github.io/app-conversion/%E8%A7%A3%E5%AF%86%E5%BE%97%E5%88%B0%E7%8C%9C%E6%B5%8B%E5%8F%AF%E8%83%BD%E6%98%AFemoji%E8%A7%A3%E5%AF%86">https://r12a.github.io/app-conversion/解密得到猜测可能是emoji解密</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🙃💵🌿🎤🚪🌏🐎🥋🚫😆🎃🦓✉🌿📂☃👉🛩✅🎅⌨🌏🛩🚨🤣💧🎃🍍😁ℹ📂🚫👣😀👣🙃🎤⌨😁🤣🎤🕹👑🚪🍴🕹😇🍴🐎✅✉🌏⏩🐍🚨☀😇🏹👁👣✉🌊🚨✖</span><br></pre></td></tr></table></figure>

<p>在流量包中发现USB流量过滤并保存下来</p>
<p>全部筛选条件 (usb.src == “1.9.1”) &amp;&amp; (frame.len == 54) 并导出筛选后的分组test.pcapng</p>
<p>用命令提取所有的USB流量（建议使用普通用户操作tshark）可以看到一些信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r &#x27;test.pcapng&#x27; -T fields -e usb.capdata &gt; test.txt</span><br></pre></td></tr></table></figure>

<p>查看test.txt中的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">10:40:2a:46:00:1e:3c:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:20:46:00:0b:3c:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:25:46:00:19:3c:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:34:46:00:05:3a:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:1c:46:00:0e:3a:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:21:46:00:a9:3b:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br><span class="line">10:40:24:46:00:c8:39:00:00:00:00:00:00:00:00:00:3f:00:00:00:00:00:00:00:00:00:00</span><br></pre></td></tr></table></figure>

<p>然后根据数位板的流量规律得到一下脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># coding:utf-8</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">mousePositionX = 0</span><br><span class="line">mousePositionY = 0</span><br><span class="line">X = []</span><br><span class="line">Y = []</span><br><span class="line">DataFileName = &quot;test.txt&quot;</span><br><span class="line">data = []</span><br><span class="line">def main():</span><br><span class="line">    global mousePositionX</span><br><span class="line">    global mousePositionY</span><br><span class="line">    with open(DataFileName, &quot;rb&quot;) as f:</span><br><span class="line">        flag = 1</span><br><span class="line">        for line in f:</span><br><span class="line">            line=line.decode()</span><br><span class="line">            if line[24:26] != &quot;00&quot;:  # 根据压力值筛选，使画图结果更精准</span><br><span class="line">                print(line)</span><br><span class="line">                data.append(line[0:-1])</span><br><span class="line">    for line in data:</span><br><span class="line">        x0 = int(line[6:8], 16)</span><br><span class="line">        x1 = int(line[9:11], 16)</span><br><span class="line">        x = x0 + x1 * 256</span><br><span class="line">        y0 = int(line[15:17], 16)</span><br><span class="line">        y1 = int(line[18:20], 16)</span><br><span class="line">        y = y0 + y1 * 256</span><br><span class="line">        X.append(x)</span><br><span class="line">        Y.append(-y)</span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    ax1 = fig.add_subplot(111)</span><br><span class="line">    ax1.set_title(&#x27;[%s]&#x27; % (&#x27;pcapFilePath&#x27;))</span><br><span class="line">    ax1.scatter(X, Y, c=&#x27;r&#x27;, marker=&#x27;o&#x27;)</span><br><span class="line">    plt.savefig(&quot;out.png&quot;)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>生成图片，得到： MONA_LISA_IS_A_MAN</p>
<p><img src="../../image/media/2022/ctf/buu/7/out.png"></p>
<p>结合前面的emoji和此处的key在<a target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/%E8%83%BD%E8%BF%9B%E8%A1%8C%E8%A7%A3%E5%AF%86%E5%BE%97%E5%88%B0flag">https://aghorler.github.io/emoji-aes/能进行解密得到flag</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RoarCTF&#123;wm-m0de3n_dav1chi&#125;</span><br></pre></td></tr></table></figure>

<h2 id="RoarCTF2019-TankGame"><a href="#RoarCTF2019-TankGame" class="headerlink" title="[RoarCTF2019]TankGame"></a>[RoarCTF2019]TankGame</h2><p>直接string得到一个假的flag：RoarCTF{wm-f1@g_1$_N0t_h3r3}</p>
<p>dnsp打开找到，关键代码在MapManager类中的WinGame方法</p>
<p><img src="../../image/media/2022/ctf/buu/7/22.png"></p>
<p>看大佬的wp，逆向爆破一下python2的脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">data = [[8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 4, 5, 8, 1, 1, 1, 1, 1, 1, 8, 8, 8, 8, 4, 8],</span><br><span class="line">    [8, 2, 8, 1, 8, 8, 5, 1, 8, 8, 8, 1, 8, 1, 8, 4, 8],</span><br><span class="line">    [8, 5, 8, 2, 8, 8, 8, 8, 1, 8, 8, 4, 8, 1, 1, 5, 8],</span><br><span class="line">    [8, 8, 8, 8, 2, 4, 8, 1, 1, 8, 8, 1, 8, 5, 1, 5, 8],</span><br><span class="line">    [8, 8, 8, 8, 5, 8, 8, 1, 5, 1, 8, 8, 8, 1, 8, 8, 8],</span><br><span class="line">    [8, 8, 8, 1, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 1, 5, 8],</span><br><span class="line">    [8, 1, 8, 8, 1, 8, 8, 1, 1, 4, 8, 8, 8, 8, 8, 1, 8],</span><br><span class="line">    [8, 4, 1, 8, 8, 5, 1, 8, 8, 8, 8, 8, 4, 2, 8, 8, 8],</span><br><span class="line">    [1, 1, 8, 5, 8, 2, 8, 5, 1, 4, 8, 8, 8, 1, 5, 1, 8],</span><br><span class="line">    [9, 1, 4, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],</span><br><span class="line">    [1, 1, 8, 1, 8, 8, 2, 1, 8, 8, 5, 2, 1, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 8, 8, 4, 8, 8, 2, 1, 1, 8, 2, 1, 8, 1, 8, 8],</span><br><span class="line">    [8, 1, 1, 8, 8, 4, 4, 1, 8, 4, 2, 4, 8, 4, 8, 8, 8],</span><br><span class="line">    [8, 4, 8, 8, 1, 2, 8, 8, 8, 8, 1, 8, 8, 1, 8, 1, 8],</span><br><span class="line">    [8, 1, 1, 5, 8, 8, 8, 8, 8, 8, 8, 8, 1, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 1, 1, 5, 2, 8, 8, 8, 8, 8, 8, 8, 8, 2, 8, 8],</span><br><span class="line">    [8, 8, 4, 8, 1, 8, 2, 8, 1, 5, 8, 8, 4, 8, 8, 8, 8],</span><br><span class="line">    [8, 8, 2, 8, 1, 8, 8, 1, 8, 8, 1, 8, 2, 2, 5, 8, 8],</span><br><span class="line">    [8, 2, 1, 8, 8, 8, 8, 2, 8, 4, 5, 8, 1, 1, 2, 5, 8],</span><br><span class="line">    [8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]]</span><br><span class="line">text = &#x27;&#x27;</span><br><span class="line">for i in range(21):</span><br><span class="line">    for j in range(17):</span><br><span class="line">        text += str(data[i][j])</span><br><span class="line">text = list(text)</span><br><span class="line">def work(data,index,num):</span><br><span class="line">    if num == 3:</span><br><span class="line">        temp=&#x27;&#x27;.join(data)</span><br><span class="line">        if hashlib.sha1(&#x27;clearlove9&#x27;+temp).hexdigest() == &#x27;3f649f708aafa7a0a94138dc3022f6ea611e8d01&#x27;:</span><br><span class="line">            key=hashlib.md5(&#x27;clearlove9&#x27;+temp).hexdigest().upper()[:10]</span><br><span class="line">            flag=&quot;RoarCTF&#123;wm-&quot;+key+&quot;&#125;&quot;</span><br><span class="line">            print(flag)</span><br><span class="line">        return</span><br><span class="line">    if index == 21*17:</span><br><span class="line">        return</span><br><span class="line">    if data[index] ==&#x27;1&#x27;:</span><br><span class="line">        temp=list(data)</span><br><span class="line">        temp[index]=&#x27;8&#x27;</span><br><span class="line">        work(temp,index+1,num+1)</span><br><span class="line">    work(data,index+1,num)</span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    work(text,0,0)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RoarCTF&#123;wm-805CEC3545&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HITCON2018-ev3basic"><a href="#HITCON2018-ev3basic" class="headerlink" title="[HITCON2018]ev3basic"></a>[HITCON2018]ev3basic</h2><p>得到一个流量包和一个图片，图片上是乐高EV3其中屏幕上显示hitcon{}直接搜特殊字符{得到如下结果</p>
<p><img src="../../image/media/2022/ctf/buu/7/0.jpg"></p>
<p>再搜特殊字符}得到如下结果</p>
<p><img src="../../image/media/2022/ctf/buu/7/1.jpg"></p>
<p>可以猜测flag位置大概在source是localhost()和destination是LEGOSyst_61:30:c1 (EV3)直接，但是长度可能会在28到34之间，然后对比{前面发现flag前缀不是hitcon于是就有可能flag顺序不对：hit_o_pcndo1}{1ncdomiekrfauai5nt_rnimmcmti_wreeavderom0_tn</p>
<p><img src="../../image/media/2022/ctf/buu/7/2.jpg"></p>
<p>可以猜测从后往前数的第一个84，数据的倒数第五位为显示的字符，即图中7b，</p>
<p>字符显示在不同的行，因此数据需要指示行的位置，通过分析发现倒数第二个“84”前的数据表示行号，即图中00，</p>
<p>除了行以外，还要关注字符在这一行中的顺序，因为数据长度不同，从分析的结果看，表示方法也不同，总体上看是81前面的数字，即五角形标记出来的信息。12位为2个81之间的数字，11位为81前的数字。13位为81前，82后的数字。见下图</p>
<p><img src="../../image/media/2022/ctf/buu/7/3.jpg"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hitcon&#123;m1nd5t0rm_communication_and_firmware_developer_kit&#125;</span><br></pre></td></tr></table></figure>

<h2 id="BSidesSF2020-mpfrag"><a href="#BSidesSF2020-mpfrag" class="headerlink" title="[BSidesSF2020]mpfrag"></a>[BSidesSF2020]mpfrag</h2><p>首先把后缀名修改成mp4，然后用KMPlayer播放，拿到字符串</p>
<p><img src="../../image/media/2022/ctf/buu/7/23.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SF-G0lden-Gl0w-1849</span><br></pre></td></tr></table></figure>

<p>然后用file分析得到是ext2格式的文件系统镜像，尝试挂载：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># file disk.bin              </span><br><span class="line">disk.bin: Linux rev 1.0 ext2 filesystem data, UUID=07a34ef3-2282-447d-b2fd-1ade0b320153 (large files)</span><br><span class="line"># mount disk.bin ./mnt</span><br><span class="line">mount: /root/Desktop/mnt: wrong fs type, bad option, bad superblock on /dev/loop0, missing codepage or helper program, or other error.</span><br></pre></td></tr></table></figure>

<p>报错，给出了可能的错误原因，其中包括 /dev/loop0的超级块损坏。文件系统中8193块存储有超级块的备份数据，用dd命令来提取：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># dd if=disk.bin of=8193.bin bs=1024 skip=8193 count=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000229264 s, 4.5 MB/s</span><br><span class="line">#注释</span><br><span class="line">if      infile，输入文件</span><br><span class="line">of      outfile，输出文件</span><br><span class="line">bs      bytes，设置输入/输出的块大小（以字节为单位）</span><br><span class="line">skip    blocks，从输入文件开头跳过多少个块后开始复制，此处8193是因为超级块备份数据在8193块</span><br><span class="line">count   只拷贝输入的blocks块</span><br><span class="line">记录了1+0 的读入，记录了1+0 的写出，1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000229264 s, 4.5 MB/s</span><br></pre></td></tr></table></figure>

<p>然后把提取出来的备份块放回disk.bin的超级块位置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># dd if=8193.bin of=disk.bin bs=1024 conv=notrunc seek=1</span><br><span class="line">1+0 records in</span><br><span class="line">1+0 records out</span><br><span class="line">1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000216208 s, 4.7 MB/s</span><br><span class="line">#注释</span><br><span class="line">conv=notrunc    不截短输出文件</span><br><span class="line">seek=blocks     从输出文件开头跳过blocks个块后再开始复制</span><br><span class="line">记录了1+0 的读入，记录了1+0 的写出，1024 bytes (1.0 kB, 1.0 KiB) copied, 0.000216208 s, 4.7 MB/s</span><br></pre></td></tr></table></figure>

<p>然后再次挂载disk.bin，成功。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mount disk.bin ./mnt</span><br></pre></td></tr></table></figure>

<p>然后去mnt文件夹查看到一堆图片和一个cloud.zip，用之前的字符串解压得到flag</p>
<p><img src="../../image/media/2022/ctf/buu/7/24.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTF&#123;bridge_ext2_gaps&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://0314valen.github.io">Valen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://0314valen.github.io/article/2022-04-19-buumisc(7)/">https://0314valen.github.io/article/2022-04-19-buumisc(7)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://0314valen.github.io" target="_blank">Valen的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/misc/">misc</a><a class="post-meta__tags" href="/tags/%E5%88%B7%E9%A2%98/">刷题</a></div><div class="post_share"><div class="social-share" data-image="http://api.btstu.cn/sjbz/" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/image/UI_images/alipay-reward-image.jpg" target="_blank"><img class="post-qr-code-img" src="/image/UI_images/alipay-reward-image.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/image/UI_images/alipay-reward-image.jpg" target="_blank"><img class="post-qr-code-img" src="/image/UI_images/alipay-reward-image.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/article/2022-05-06-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%AD%A6/"><img class="prev-cover" src="https://api.ixiaowai.cn/gqapi/gqapi.php" onerror="onerror=null;src='/image/UI_images/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">古典密码学</div></div></a></div><div class="next-post pull-right"><a href="/article/2022-04-01-Wireshark%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%8B%E7%9A%84%E7%94%A8%E6%B3%95/"><img class="next-cover" src="https://img.paulzzh.tech/touhou/random" onerror="onerror=null;src='/image/UI_images/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Wireshark命令行下的用法</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/article/2022-03-02-bmz%E5%88%B7%E9%A2%98%E7%9B%AE%E8%AE%B0%E5%BD%95/" title="bmz刷题目记录"><img class="cover" src="http://api.btstu.cn/sjbz/" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-02-08</div><div class="title">bmz刷题目记录</div></div></a></div><div><a href="/article/2022-03-10-buumisc(5)/" title="buumisc(5)"><img class="cover" src="http://api.btstu.cn/sjbz/" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-02-08</div><div class="title">buumisc(5)</div></div></a></div><div><a href="/article/2022-03-18-buumisc(6)/" title="buumisc(6)"><img class="cover" src="http://api.btstu.cn/sjbz/" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2023-02-08</div><div class="title">buumisc(6)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/image/UI_images/avatar.jpg" onerror="this.onerror=null;this.src='/image/UI_images/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Valen</div><div class="author-info__description">一位精通各种环境的开启和附件的下载的签到型选手</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">21</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/0314Valen/0314Valen.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">不要担心辜负了别人的期待，对你有期待的，只有你自己。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#buumisc-7"><span class="toc-number">1.</span> <span class="toc-text">buumisc(7)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-TCP-IP"><span class="toc-number">1.1.</span> <span class="toc-text">[羊城杯 2020]TCP_IP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-image-rar"><span class="toc-number">1.2.</span> <span class="toc-text">[羊城杯 2020]image_rar</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CFI-CTF-2018-Kadyrov%E2%80%99s-Cat"><span class="toc-number">1.3.</span> <span class="toc-text">[CFI-CTF 2018]Kadyrov’s Cat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CTF2019-babyflash"><span class="toc-number">1.4.</span> <span class="toc-text">[*CTF2019]babyflash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-%E9%80%83%E7%A6%BB%E4%B8%9C%E5%8D%97%E4%BA%9A"><span class="toc-number">1.5.</span> <span class="toc-text">[羊城杯 2020]逃离东南亚</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSHack2019-Crunchy"><span class="toc-number">1.6.</span> <span class="toc-text">[INSHack2019]Crunchy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GWCTF2019-math"><span class="toc-number">1.7.</span> <span class="toc-text">[GWCTF2019]math</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BSidesSF2019-bWF0cnlvc2hrYQ"><span class="toc-number">1.8.</span> <span class="toc-text">[BSidesSF2019]bWF0cnlvc2hrYQ&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSHack2018-GCorp-Stage-1"><span class="toc-number">1.9.</span> <span class="toc-text">[INSHack2018]GCorp - Stage 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b01lers2020-minecraft-purdue"><span class="toc-number">1.10.</span> <span class="toc-text">[b01lers2020]minecraft_purdue</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NPUCTF2020-HappyCheckInVerification"><span class="toc-number">1.11.</span> <span class="toc-text">[NPUCTF2020]HappyCheckInVerification</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UTCTF2020-dns-shell"><span class="toc-number">1.12.</span> <span class="toc-text">[UTCTF2020]dns-shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF2019-davinci-cipher"><span class="toc-number">1.13.</span> <span class="toc-text">[RoarCTF2019]davinci_cipher</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoarCTF2019-TankGame"><span class="toc-number">1.14.</span> <span class="toc-text">[RoarCTF2019]TankGame</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HITCON2018-ev3basic"><span class="toc-number">1.15.</span> <span class="toc-text">[HITCON2018]ev3basic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BSidesSF2020-mpfrag"><span class="toc-number">1.16.</span> <span class="toc-text">[BSidesSF2020]mpfrag</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/article/2023-02-08-Blockchain%E7%BA%AA%E8%A6%81/" title="Blockchain纪要"><img src="https://www.osgeo.cn/solidity/_static/logo.svg" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="Blockchain纪要"/></a><div class="content"><a class="title" href="/article/2023-02-08-Blockchain%E7%BA%AA%E8%A6%81/" title="Blockchain纪要">Blockchain纪要</a><time datetime="2023-02-07T16:00:00.000Z" title="发表于 2023-02-08 00:00:00">2023-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2023-02-07-phpstrom%E9%85%8D%E7%BD%AExdebug%E8%AE%B0%E5%BD%95/" title="phpstrom配置xdebug记录"><img src="https://baike.baidu.com/pic/PHP/9337/1/d01373f082025aafa40f8c09ebbfbc64034f79f0aced?fr=lemma&amp;fromModule=lemma_top-image&amp;ct=single#aid=1&amp;pic=d01373f082025aafa40f8c09ebbfbc64034f79f0aced" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="phpstrom配置xdebug记录"/></a><div class="content"><a class="title" href="/article/2023-02-07-phpstrom%E9%85%8D%E7%BD%AExdebug%E8%AE%B0%E5%BD%95/" title="phpstrom配置xdebug记录">phpstrom配置xdebug记录</a><time datetime="2023-02-06T16:00:00.000Z" title="发表于 2023-02-07 00:00:00">2023-02-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2023-01-07-%E8%AE%B0%E4%B8%80%E4%B8%AABlockchain%E7%AD%BE%E5%88%B0%E9%A2%98%E7%9B%AE/" title="记一个Blockchain签到题目"><img src="https://www.osgeo.cn/solidity/_static/logo.svg" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="记一个Blockchain签到题目"/></a><div class="content"><a class="title" href="/article/2023-01-07-%E8%AE%B0%E4%B8%80%E4%B8%AABlockchain%E7%AD%BE%E5%88%B0%E9%A2%98%E7%9B%AE/" title="记一个Blockchain签到题目">记一个Blockchain签到题目</a><time datetime="2023-01-06T16:00:00.000Z" title="发表于 2023-01-07 00:00:00">2023-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2022-12-13-%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90volatility%E7%BA%AA%E8%A6%81/" title="取证分析volatility纪要"><img src="https://avatars.githubusercontent.com/u/6001145?s=200&amp;v=4" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="取证分析volatility纪要"/></a><div class="content"><a class="title" href="/article/2022-12-13-%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90volatility%E7%BA%AA%E8%A6%81/" title="取证分析volatility纪要">取证分析volatility纪要</a><time datetime="2022-12-12T16:00:00.000Z" title="发表于 2022-12-13 00:00:00">2022-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2022-11-25-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%BA%AA%E8%A6%81/" title="博客搭建纪要"><img src="https://0314valen.github.io//image/UI_images/favicon.png" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="博客搭建纪要"/></a><div class="content"><a class="title" href="/article/2022-11-25-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%BA%AA%E8%A6%81/" title="博客搭建纪要">博客搭建纪要</a><time datetime="2022-11-24T16:00:00.000Z" title="发表于 2022-11-25 00:00:00">2022-11-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By Valen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>